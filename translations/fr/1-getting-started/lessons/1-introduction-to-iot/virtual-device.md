<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "52b4de6144b2efdced7797a5339d6035",
  "translation_date": "2025-08-24T23:32:56+00:00",
  "source_file": "1-getting-started/lessons/1-introduction-to-iot/virtual-device.md",
  "language_code": "fr"
}
-->
# Ordinateur monocarte virtuel

Au lieu d'acheter un appareil IoT avec des capteurs et des actionneurs, vous pouvez utiliser votre ordinateur pour simuler du mat√©riel IoT. Le projet [CounterFit](https://github.com/CounterFit-IoT/CounterFit) vous permet d'ex√©cuter une application localement qui simule du mat√©riel IoT tel que des capteurs et des actionneurs, et d'acc√©der √† ces capteurs et actionneurs depuis du code Python local, √©crit de la m√™me mani√®re que le code que vous √©cririez sur un Raspberry Pi avec du mat√©riel physique.

## Configuration

Pour utiliser CounterFit, vous devrez installer quelques logiciels gratuits sur votre ordinateur.

### T√¢che

Installez les logiciels n√©cessaires.

1. Installez Python. Consultez la [page de t√©l√©chargement de Python](https://www.python.org/downloads/) pour obtenir des instructions sur l'installation de la derni√®re version de Python.

1. Installez Visual Studio Code (VS Code). C'est l'√©diteur que vous utiliserez pour √©crire le code de votre appareil virtuel en Python. Consultez la [documentation de VS Code](https://code.visualstudio.com?WT.mc_id=academic-17441-jabenn) pour obtenir des instructions sur l'installation de VS Code.

    > üíÅ Vous √™tes libre d'utiliser n'importe quel IDE ou √©diteur Python pour ces le√ßons si vous avez un outil pr√©f√©r√©, mais les le√ßons fourniront des instructions bas√©es sur l'utilisation de VS Code.

1. Installez l'extension Pylance pour VS Code. Il s'agit d'une extension pour VS Code qui offre un support pour le langage Python. Consultez la [documentation de l'extension Pylance](https://marketplace.visualstudio.com/items?WT.mc_id=academic-17441-jabenn&itemName=ms-python.vscode-pylance) pour obtenir des instructions sur l'installation de cette extension dans VS Code.

Les instructions pour installer et configurer l'application CounterFit seront donn√©es au moment opportun dans les instructions de l'exercice, car elle est install√©e projet par projet.

## Hello World

Il est traditionnel, lorsque l'on d√©bute avec un nouveau langage de programmation ou une nouvelle technologie, de cr√©er une application 'Hello World' - une petite application qui affiche un texte tel que `"Hello World"` pour montrer que tous les outils sont correctement configur√©s.

L'application Hello World pour le mat√©riel IoT virtuel permettra de v√©rifier que Python et Visual Studio Code sont correctement install√©s. Elle se connectera √©galement √† CounterFit pour les capteurs et actionneurs IoT virtuels. Elle n'utilisera aucun mat√©riel, elle se connectera simplement pour prouver que tout fonctionne.

Cette application sera plac√©e dans un dossier appel√© `nightlight`, et elle sera r√©utilis√©e avec diff√©rents codes dans les parties ult√©rieures de cet exercice pour construire l'application de veilleuse.

### Configurer un environnement virtuel Python

L'une des fonctionnalit√©s puissantes de Python est la possibilit√© d'installer des [packages Pip](https://pypi.org) - ce sont des packages de code √©crits par d'autres personnes et publi√©s sur Internet. Vous pouvez installer un package Pip sur votre ordinateur avec une seule commande, puis utiliser ce package dans votre code. Vous utiliserez Pip pour installer un package permettant de communiquer avec CounterFit.

Par d√©faut, lorsque vous installez un package, il est disponible partout sur votre ordinateur, ce qui peut entra√Æner des probl√®mes de versions de packages - par exemple, une application d√©pendant d'une version d'un package qui cesse de fonctionner lorsque vous installez une nouvelle version pour une autre application. Pour contourner ce probl√®me, vous pouvez utiliser un [environnement virtuel Python](https://docs.python.org/3/library/venv.html), qui est essentiellement une copie de Python dans un dossier d√©di√©, et lorsque vous installez des packages Pip, ils sont install√©s uniquement dans ce dossier.

> üíÅ Si vous utilisez un Raspberry Pi, vous n'avez pas configur√© d'environnement virtuel sur cet appareil pour g√©rer les packages Pip, vous utilisez des packages globaux, car les packages Grove sont install√©s globalement par le script d'installation.

#### T√¢che - configurer un environnement virtuel Python

Configurez un environnement virtuel Python et installez les packages Pip pour CounterFit.

1. Depuis votre terminal ou ligne de commande, ex√©cutez la commande suivante √† l'emplacement de votre choix pour cr√©er et naviguer vers un nouveau r√©pertoire :

    ```sh
    mkdir nightlight
    cd nightlight
    ```

1. Ex√©cutez maintenant la commande suivante pour cr√©er un environnement virtuel dans le dossier `.venv` :

    ```sh
    python3 -m venv .venv
    ```

    > üíÅ Vous devez explicitement appeler `python3` pour cr√©er l'environnement virtuel au cas o√π vous auriez Python 2 install√© en plus de Python 3 (la derni√®re version). Si vous avez Python 2 install√©, appeler `python` utilisera Python 2 au lieu de Python 3.

1. Activez l'environnement virtuel :

    * Sur Windows :
        * Si vous utilisez l'invite de commande ou l'invite de commande via Windows Terminal, ex√©cutez :

            ```cmd
            .venv\Scripts\activate.bat
            ```

        * Si vous utilisez PowerShell, ex√©cutez :

            ```powershell
            .\.venv\Scripts\Activate.ps1
            ```

            > Si vous obtenez une erreur indiquant que l'ex√©cution de scripts est d√©sactiv√©e sur ce syst√®me, vous devrez activer l'ex√©cution de scripts en d√©finissant une politique d'ex√©cution appropri√©e. Vous pouvez le faire en lan√ßant PowerShell en tant qu'administrateur, puis en ex√©cutant la commande suivante :

            ```powershell
            Set-ExecutionPolicy -ExecutionPolicy Unrestricted
            ```

            Entrez `Y` lorsque vous √™tes invit√© √† confirmer. Relancez ensuite PowerShell et r√©essayez.

            Vous pouvez r√©initialiser cette politique d'ex√©cution √† une date ult√©rieure si n√©cessaire. Vous pouvez en savoir plus √† ce sujet dans la [page sur les politiques d'ex√©cution de Microsoft Docs](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_execution_policies?WT.mc_id=academic-17441-jabenn).

    * Sur macOS ou Linux, ex√©cutez :

        ```cmd
        source ./.venv/bin/activate
        ```

    > üíÅ Ces commandes doivent √™tre ex√©cut√©es depuis le m√™me emplacement o√π vous avez ex√©cut√© la commande pour cr√©er l'environnement virtuel. Vous n'aurez jamais besoin de naviguer dans le dossier `.venv`, vous devez toujours ex√©cuter la commande d'activation et toute commande pour installer des packages ou ex√©cuter du code depuis le dossier o√π vous √©tiez lorsque vous avez cr√©√© l'environnement virtuel.

1. Une fois l'environnement virtuel activ√©, la commande `python` par d√©faut ex√©cutera la version de Python utilis√©e pour cr√©er l'environnement virtuel. Ex√©cutez la commande suivante pour obtenir la version :

    ```sh
    python --version
    ```

    La sortie devrait contenir les informations suivantes :

    ```output
    (.venv) ‚ûú  nightlight python --version
    Python 3.9.1
    ```

    > üíÅ Votre version de Python peut √™tre diff√©rente - tant qu'elle est en version 3.6 ou sup√©rieure, c'est bon. Sinon, supprimez ce dossier, installez une version plus r√©cente de Python et r√©essayez.

1. Ex√©cutez les commandes suivantes pour installer les packages Pip pour CounterFit. Ces packages incluent l'application principale CounterFit ainsi que des shims pour le mat√©riel Grove. Ces shims vous permettent d'√©crire du code comme si vous programmiez avec des capteurs et actionneurs physiques du syst√®me Grove, mais connect√©s √† des appareils IoT virtuels.

    ```sh
    pip install CounterFit
    pip install counterfit-connection
    pip install counterfit-shims-grove
    ```

    Ces packages Pip seront uniquement install√©s dans l'environnement virtuel et ne seront pas disponibles en dehors de celui-ci.

### √âcrire le code

Une fois l'environnement virtuel Python pr√™t, vous pouvez √©crire le code pour l'application 'Hello World'.

#### T√¢che - √©crire le code

Cr√©ez une application Python pour afficher `"Hello World"` dans la console.

1. Depuis votre terminal ou ligne de commande, ex√©cutez la commande suivante dans l'environnement virtuel pour cr√©er un fichier Python appel√© `app.py` :

    * Sur Windows, ex√©cutez :

        ```cmd
        type nul > app.py
        ```

    * Sur macOS ou Linux, ex√©cutez :

        ```cmd
        touch app.py
        ```

1. Ouvrez le dossier actuel dans VS Code :

    ```sh
    code .
    ```

    > üíÅ Si votre terminal retourne `command not found` sur macOS, cela signifie que VS Code n'a pas √©t√© ajout√© √† votre PATH. Vous pouvez ajouter VS Code √† votre PATH en suivant les instructions dans la [section Lancer depuis la ligne de commande de la documentation VS Code](https://code.visualstudio.com/docs/setup/mac?WT.mc_id=academic-17441-jabenn#_launching-from-the-command-line) et ex√©cuter la commande ensuite. VS Code est ajout√© au PATH par d√©faut sur Windows et Linux.

1. Lorsque VS Code se lance, il activera l'environnement virtuel Python. L'environnement virtuel s√©lectionn√© appara√Ætra dans la barre d'√©tat en bas :

    ![VS Code montrant l'environnement virtuel s√©lectionn√©](../../../../../translated_images/vscode-virtual-env.8ba42e04c3d533cf677e16cbe5ed9a3b80f62c6964472dc84b6f940800f0909f.fr.png)

1. Si le terminal VS Code est d√©j√† en cours d'ex√©cution lorsque VS Code d√©marre, il n'aura pas l'environnement virtuel activ√©. La solution la plus simple est de fermer le terminal en utilisant le bouton **Kill the active terminal instance** :

    ![Bouton VS Code Kill the active terminal instance](../../../../../translated_images/vscode-kill-terminal.1cc4de7c6f25ee08f423f0ead714e61d069fac1eb2089e97b8a7bbcb3d45fe5e.fr.png)

    Vous pouvez savoir si le terminal a l'environnement virtuel activ√© car le nom de l'environnement virtuel sera un pr√©fixe sur l'invite du terminal. Par exemple, cela pourrait √™tre :

    ```sh
    (.venv) ‚ûú  nightlight
    ```

    Si vous n'avez pas `.venv` comme pr√©fixe sur l'invite, l'environnement virtuel n'est pas activ√© dans le terminal.

1. Lancez un nouveau terminal VS Code en s√©lectionnant *Terminal -> New Terminal*, ou en appuyant sur `` CTRL+` ``. Le nouveau terminal chargera l'environnement virtuel, et l'appel pour l'activer appara√Ætra dans le terminal. L'invite aura √©galement le nom de l'environnement virtuel (`.venv`) :

    ```output
    ‚ûú  nightlight source .venv/bin/activate
    (.venv) ‚ûú  nightlight 
    ```

1. Ouvrez le fichier `app.py` depuis l'explorateur VS Code et ajoutez le code suivant :

    ```python
    print('Hello World!')
    ```

    La fonction `print` affiche dans la console tout ce qui lui est pass√©.

1. Depuis le terminal VS Code, ex√©cutez la commande suivante pour ex√©cuter votre application Python :

    ```sh
    python app.py
    ```

    La sortie sera la suivante :

    ```output
    (.venv) ‚ûú  nightlight python app.py 
    Hello World!
    ```

üòÄ Votre programme 'Hello World' a √©t√© un succ√®s !

### Connecter le 'mat√©riel'

Comme deuxi√®me √©tape 'Hello World', vous allez ex√©cuter l'application CounterFit et connecter votre code √† celle-ci. C'est l'√©quivalent virtuel de brancher du mat√©riel IoT √† un kit de d√©veloppement.

#### T√¢che - connecter le 'mat√©riel'

1. Depuis le terminal VS Code, lancez l'application CounterFit avec la commande suivante :

    ```sh
    counterfit
    ```

    L'application commencera √† s'ex√©cuter et s'ouvrira dans votre navigateur web :

    ![L'application CounterFit s'ex√©cutant dans un navigateur](../../../../../translated_images/counterfit-first-run.433326358b669b31d0e99c3513cb01bfbb13724d162c99cdcc8f51ecf5f9c779.fr.png)

    Elle sera marqu√©e comme *Disconnected*, avec la LED en haut √† droite √©teinte.

1. Ajoutez le code suivant en haut de `app.py` :

    ```python
    from counterfit_connection import CounterFitConnection
    CounterFitConnection.init('127.0.0.1', 5000)
    ```

    Ce code importe la classe `CounterFitConnection` du module `counterfit_connection`, qui provient du package pip `counterfit-connection` que vous avez install√© pr√©c√©demment. Il initialise ensuite une connexion √† l'application CounterFit ex√©cut√©e sur `127.0.0.1`, qui est une adresse IP que vous pouvez toujours utiliser pour acc√©der √† votre ordinateur local (souvent appel√©e *localhost*), sur le port 5000.

    > üíÅ Si vous avez d'autres applications ex√©cut√©es sur le port 5000, vous pouvez changer cela en mettant √† jour le port dans le code, et en ex√©cutant CounterFit avec `CounterFit --port <port_number>`, en rempla√ßant `<port_number>` par le port que vous souhaitez utiliser.

1. Vous devrez lancer un nouveau terminal VS Code en s√©lectionnant le bouton **Create a new integrated terminal**. Cela est d√ª au fait que l'application CounterFit s'ex√©cute dans le terminal actuel.

    ![Bouton VS Code Create a new integrated terminal](../../../../../translated_images/vscode-new-terminal.77db8fc0f9cd31824b0e49a201beafe4ae4616d6c7339992cb2819e789b3eff9.fr.png)

1. Dans ce nouveau terminal, ex√©cutez le fichier `app.py` comme pr√©c√©demment. Le statut de CounterFit passera √† **Connected** et la LED s'allumera.

    ![CounterFit affichant le statut connect√©](../../../../../translated_images/counterfit-connected.ed30b46d8f79b0921f3fc70be10366e596a89dca3f80c2224a9d9fc98fccf884.fr.png)

> üíÅ Vous pouvez trouver ce code dans le dossier [code/virtual-device](../../../../../1-getting-started/lessons/1-introduction-to-iot/code/virtual-device).

üòÄ Votre connexion au mat√©riel a √©t√© un succ√®s !

**Avertissement** :  
Ce document a √©t√© traduit √† l'aide du service de traduction automatique [Co-op Translator](https://github.com/Azure/co-op-translator). Bien que nous nous efforcions d'assurer l'exactitude, veuillez noter que les traductions automatis√©es peuvent contenir des erreurs ou des inexactitudes. Le document original dans sa langue d'origine doit √™tre consid√©r√© comme la source faisant autorit√©. Pour des informations critiques, il est recommand√© de recourir √† une traduction professionnelle r√©alis√©e par un humain. Nous d√©clinons toute responsabilit√© en cas de malentendus ou d'interpr√©tations erron√©es r√©sultant de l'utilisation de cette traduction.