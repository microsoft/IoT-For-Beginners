<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "3ac42e284a7222c0e83d2d43231a364f",
  "translation_date": "2025-08-28T15:03:09+00:00",
  "source_file": "2-farm/lessons/4-migrate-your-plant-to-the-cloud/single-board-computer-connect-hub.md",
  "language_code": "sr"
}
-->
# –ü–æ–≤–µ–∂–∏—Ç–µ –≤–∞—à IoT —É—Ä–µ—í–∞—ò —Å–∞ –æ–±–ª–∞–∫–æ–º - –í–∏—Ä—Ç—É–µ–ª–Ω–∏ IoT —Ö–∞—Ä–¥–≤–µ—Ä –∏ Raspberry Pi

–£ –æ–≤–æ–º –¥–µ–ª—É –ª–µ–∫—Ü–∏—ò–µ, –ø–æ–≤–µ–∑–∞—õ–µ—Ç–µ –≤–∞—à –≤–∏—Ä—Ç—É–µ–ª–Ω–∏ IoT —É—Ä–µ—í–∞—ò –∏–ª–∏ Raspberry Pi —Å–∞ –≤–∞—à–∏–º IoT Hub-–æ–º, –∫–∞–∫–æ –±–∏—Å—Ç–µ —Å–ª–∞–ª–∏ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—ò—É –∏ –ø—Ä–∏–º–∞–ª–∏ –∫–æ–º–∞–Ω–¥–µ.

## –ü–æ–≤–µ–∂–∏—Ç–µ –≤–∞—à —É—Ä–µ—í–∞—ò —Å–∞ IoT Hub-–æ–º

–°–ª–µ–¥–µ—õ–∏ –∫–æ—Ä–∞–∫ —ò–µ –¥–∞ –ø–æ–≤–µ–∂–µ—Ç–µ –≤–∞—à —É—Ä–µ—í–∞—ò —Å–∞ IoT Hub-–æ–º.

### –ó–∞–¥–∞—Ç–∞–∫ - –ø–æ–≤–µ–∑–∏–≤–∞—ö–µ —Å–∞ IoT Hub-–æ–º

1. –û—Ç–≤–æ—Ä–∏—Ç–µ —Ñ–∞—Å—Ü–∏–∫–ª—É `soil-moisture-sensor` —É VS Code-—É. –£–≤–µ—Ä–∏—Ç–µ —Å–µ –¥–∞ —ò–µ –≤–∏—Ä—Ç—É–µ–ª–Ω–æ –æ–∫—Ä—É–∂–µ—ö–µ –ø–æ–∫—Ä–µ–Ω—É—Ç–æ —É —Ç–µ—Ä–º–∏–Ω–∞–ª—É –∞–∫–æ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ –≤–∏—Ä—Ç—É–µ–ª–Ω–∏ IoT —É—Ä–µ—í–∞—ò.

1. –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞—ò—Ç–µ –¥–æ–¥–∞—Ç–Ω–µ Pip –ø–∞–∫–µ—Ç–µ:

    ```sh
    pip3 install azure-iot-device
    ```

    `azure-iot-device` —ò–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∑–∞ –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏—ò—É —Å–∞ –≤–∞—à–∏–º IoT Hub-–æ–º.

1. –î–æ–¥–∞—ò—Ç–µ —Å–ª–µ–¥–µ—õ–µ —É–≤–æ–∑–µ –Ω–∞ –≤—Ä—Ö –¥–∞—Ç–æ—Ç–µ–∫–µ `app.py`, –∏—Å–ø–æ–¥ –ø–æ—Å—Ç–æ—ò–µ—õ–∏—Ö —É–≤–æ–∑–∞:

    ```python
    from azure.iot.device import IoTHubDeviceClient, Message, MethodResponse
    ```

    –û–≤–∞—ò –∫–æ–¥ —É–≤–æ–∑–∏ SDK –∑–∞ –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏—ò—É —Å–∞ –≤–∞—à–∏–º IoT Hub-–æ–º.

1. –£–∫–ª–æ–Ω–∏—Ç–µ –ª–∏–Ω–∏—ò—É `import paho.mqtt.client as mqtt`, —ò–µ—Ä –æ–≤–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≤–∏—à–µ –Ω–∏—ò–µ –ø–æ—Ç—Ä–µ–±–Ω–∞. –£–∫–ª–æ–Ω–∏—Ç–µ —Å–∞–≤ MQTT –∫–æ–¥, —É–∫—ô—É—á—É—ò—É—õ–∏ –Ω–∞–∑–∏–≤–µ —Ç–µ–º–∞, —Å–∞–≤ –∫–æ–¥ –∫–æ—ò–∏ –∫–æ—Ä–∏—Å—Ç–∏ `mqtt_client` –∏ `handle_command`. –ó–∞–¥—Ä–∂–∏—Ç–µ `while True:` –ø–µ—Ç—ô—É, —Å–∞–º–æ –∏–∑–±—Ä–∏—à–∏—Ç–µ –ª–∏–Ω–∏—ò—É `mqtt_client.publish` –∏–∑ –æ–≤–µ –ø–µ—Ç—ô–µ.

1. –î–æ–¥–∞—ò—Ç–µ —Å–ª–µ–¥–µ—õ–∏ –∫–æ–¥ –∏—Å–ø–æ–¥ —É–≤–æ–∑–Ω–∏—Ö –∏–∑—ò–∞–≤–∞:

    ```python
    connection_string = "<connection string>"
    ```

    –ó–∞–º–µ–Ω–∏—Ç–µ `<connection string>` —Å–∞ –Ω–∏–∑–æ–º –∑–∞ –ø–æ–≤–µ–∑–∏–≤–∞—ö–µ –∫–æ—ò–∏ —Å—Ç–µ –ø—Ä–µ—É–∑–µ–ª–∏ –∑–∞ —É—Ä–µ—í–∞—ò —Ä–∞–Ω–∏—ò–µ —É –æ–≤–æ—ò –ª–µ–∫—Ü–∏—ò–∏.

    > üíÅ –û–≤–æ –Ω–∏—ò–µ –Ω–∞—ò–±–æ—ô–∞ –ø—Ä–∞–∫—Å–∞. –ù–∏–∑–æ–≤–∏ –∑–∞ –ø–æ–≤–µ–∑–∏–≤–∞—ö–µ –Ω–∏–∫–∞–¥–∞ –Ω–µ –±–∏ —Ç—Ä–µ–±–∞–ª–æ –¥–∞ —Å–µ —á—É–≤–∞—ò—É —É –∏–∑–≤–æ—Ä–Ω–æ–º –∫–æ–¥—É, —ò–µ—Ä –º–æ–≥—É –±–∏—Ç–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∏ —É —Å–∏—Å—Ç–µ–º –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª—É –≤–µ—Ä–∑–∏—ò–∞ –∏ –ø—Ä–æ–Ω–∞—í–µ–Ω–∏ –æ–¥ —Å—Ç—Ä–∞–Ω–µ –±–∏–ª–æ –∫–æ–≥–∞. –û–≤–¥–µ —Ç–æ —Ä–∞–¥–∏–º–æ —Ä–∞–¥–∏ —ò–µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–æ—Å—Ç–∏. –ò–¥–µ–∞–ª–Ω–æ –±–∏ –±–∏–ª–æ –¥–∞ –∫–æ—Ä–∏—Å—Ç–∏—Ç–µ –Ω–µ—à—Ç–æ –ø–æ–ø—É—Ç –ø—Ä–æ–º–µ–Ω—ô–∏–≤–µ –æ–∫—Ä—É–∂–µ—ö–∞ –∏ –∞–ª–∞—Ç –∫–∞–æ —à—Ç–æ —ò–µ [`python-dotenv`](https://pypi.org/project/python-dotenv/). –û –æ–≤–æ–º–µ —õ–µ—Ç–µ –≤–∏—à–µ –Ω–∞—É—á–∏—Ç–∏ —É –Ω–∞—Ä–µ–¥–Ω–æ—ò –ª–µ–∫—Ü–∏—ò–∏.

1. –ò—Å–ø–æ–¥ –æ–≤–æ–≥ –∫–æ–¥–∞, –¥–æ–¥–∞—ò—Ç–µ —Å–ª–µ–¥–µ—õ–µ –∫–∞–∫–æ –±–∏—Å—Ç–µ –∫—Ä–µ–∏—Ä–∞–ª–∏ –æ–±—ò–µ–∫–∞—Ç –∫–ª–∏—ò–µ–Ω—Ç–∞ —É—Ä–µ—í–∞—ò–∞ –∫–æ—ò–∏ –º–æ–∂–µ –∫–æ–º—É–Ω–∏—Ü–∏—Ä–∞—Ç–∏ —Å–∞ IoT Hub-–æ–º –∏ –ø–æ–≤–µ–∑–∞—Ç–∏ –≥–∞:

    ```python
    device_client = IoTHubDeviceClient.create_from_connection_string(connection_string)

    print('Connecting')
    device_client.connect()
    print('Connected')
    ```

1. –ü–æ–∫—Ä–µ–Ω–∏—Ç–µ –æ–≤–∞—ò –∫–æ–¥. –í–∏–¥–µ—õ–µ—Ç–µ –¥–∞ —Å–µ –≤–∞—à —É—Ä–µ—í–∞—ò –ø–æ–≤–µ–∑–∞–æ.

    ```output
    pi@raspberrypi:~/soil-moisture-sensor $ python3 app.py 
    Connecting
    Connected
    Soil moisture: 379
    ```

## –°–ª–∞—ö–µ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—ò–µ

–°–∞–¥–∞ –∫–∞–¥–∞ —ò–µ –≤–∞—à —É—Ä–µ—í–∞—ò –ø–æ–≤–µ–∑–∞–Ω, –º–æ–∂–µ—Ç–µ —Å–ª–∞—Ç–∏ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—ò—É IoT Hub-—É —É–º–µ—Å—Ç–æ MQTT –±—Ä–æ–∫–µ—Ä—É.

### –ó–∞–¥–∞—Ç–∞–∫ - —Å–ª–∞—ö–µ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—ò–µ

1. –î–æ–¥–∞—ò—Ç–µ —Å–ª–µ–¥–µ—õ–∏ –∫–æ–¥ —É–Ω—É—Ç–∞—Ä `while True` –ø–µ—Ç—ô–µ, –Ω–µ–ø–æ—Å—Ä–µ–¥–Ω–æ –ø—Ä–µ –ø–∞—É–∑–µ:

    ```python
    message = Message(json.dumps({ 'soil_moisture': soil_moisture }))
    device_client.send_message(message)
    ```

    –û–≤–∞—ò –∫–æ–¥ –∫—Ä–µ–∏—Ä–∞ IoT Hub `Message` –∫–æ—ò–∏ —Å–∞–¥—Ä–∂–∏ –æ—á–∏—Ç–∞–≤–∞—ö–µ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –∑–µ–º—ô–∏—à—Ç–∞ –∫–∞–æ JSON —Å—Ç—Ä–∏–Ω–≥, –∞ –∑–∞—Ç–∏–º –≥–∞ —à–∞—ô–µ IoT Hub-—É –∫–∞–æ –ø–æ—Ä—É–∫—É –æ–¥ —É—Ä–µ—í–∞—ò–∞ –∫–∞ –æ–±–ª–∞–∫—É.

## –û–±—Ä–∞–¥–∞ –∫–æ–º–∞–Ω–¥–∏

–í–∞—à —É—Ä–µ—í–∞—ò —Ç—Ä–µ–±–∞ –¥–∞ –æ–±—Ä–∞–¥–∏ –∫–æ–º–∞–Ω–¥—É —Å–∞ —Å–µ—Ä–≤–µ—Ä—Å–∫–æ–≥ –∫–æ–¥–∞ –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª—É —Ä–µ–ª–µ—ò–∞. –û–≤–æ —Å–µ —à–∞—ô–µ –∫–∞–æ –∑–∞—Ö—Ç–µ–≤ –∑–∞ –¥–∏—Ä–µ–∫—Ç–Ω–∏ –º–µ—Ç–æ–¥.

## –ó–∞–¥–∞—Ç–∞–∫ - –æ–±—Ä–∞–¥–∞ –∑–∞—Ö—Ç–µ–≤–∞ –∑–∞ –¥–∏—Ä–µ–∫—Ç–Ω–∏ –º–µ—Ç–æ–¥

1. –î–æ–¥–∞—ò—Ç–µ —Å–ª–µ–¥–µ—õ–∏ –∫–æ–¥ –ø—Ä–µ `while True` –ø–µ—Ç—ô–µ:

    ```python
    def handle_method_request(request):
        print("Direct method received - ", request.name)
    
        if request.name == "relay_on":
            relay.on()
        elif request.name == "relay_off":
            relay.off()    
    ```

    –û–≤–æ –¥–µ—Ñ–∏–Ω–∏—à–µ –º–µ—Ç–æ–¥, `handle_method_request`, –∫–æ—ò–∏ —õ–µ –±–∏—Ç–∏ –ø–æ–∑–≤–∞–Ω –∫–∞–¥–∞ IoT Hub –ø–æ–∑–æ–≤–µ –¥–∏—Ä–µ–∫—Ç–Ω–∏ –º–µ—Ç–æ–¥. –°–≤–∞–∫–∏ –¥–∏—Ä–µ–∫—Ç–Ω–∏ –º–µ—Ç–æ–¥ –∏–º–∞ –Ω–∞–∑–∏–≤, –∞ –æ–≤–∞—ò –∫–æ–¥ –æ—á–µ–∫—É—ò–µ –º–µ—Ç–æ–¥ –Ω–∞–∑–≤–∞–Ω `relay_on` –∑–∞ —É–∫—ô—É—á–∏–≤–∞—ö–µ —Ä–µ–ª–µ—ò–∞ –∏ `relay_off` –∑–∞ –∏—Å–∫—ô—É—á–∏–≤–∞—ö–µ —Ä–µ–ª–µ—ò–∞.

    > üíÅ –û–≤–æ –±–∏ —Ç–∞–∫–æ—í–µ –º–æ–≥–ª–æ –±–∏—Ç–∏ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω–æ —É —ò–µ–¥–Ω–æ–º –∑–∞—Ö—Ç–µ–≤—É –∑–∞ –¥–∏—Ä–µ–∫—Ç–Ω–∏ –º–µ—Ç–æ–¥, –ø—Ä–æ—Å–ª–µ—í—É—ò—É—õ–∏ –∂–µ—ô–µ–Ω–æ —Å—Ç–∞—ö–µ —Ä–µ–ª–µ—ò–∞ —É payload-—É –∫–æ—ò–∏ –º–æ–∂–µ –±–∏—Ç–∏ –ø—Ä–æ—Å–ª–µ—í–µ–Ω —Å–∞ –∑–∞—Ö—Ç–µ–≤–æ–º –∑–∞ –º–µ—Ç–æ–¥ –∏ –¥–æ—Å—Ç—É–ø–∞–Ω –∏–∑ –æ–±—ò–µ–∫—Ç–∞ `request`.

1. –î–∏—Ä–µ–∫—Ç–Ω–∏ –º–µ—Ç–æ–¥–∏ –∑–∞—Ö—Ç–µ–≤–∞—ò—É –æ–¥–≥–æ–≤–æ—Ä –∫–∞–∫–æ –±–∏ –æ–±–∞–≤–µ—Å—Ç–∏–ª–∏ –ø–æ–∑–∏–≤–∞—ò—É—õ–∏ –∫–æ–¥ –¥–∞ —Å—É –æ–±—Ä–∞—í–µ–Ω–∏. –î–æ–¥–∞—ò—Ç–µ —Å–ª–µ–¥–µ—õ–∏ –∫–æ–¥ –Ω–∞ –∫—Ä–∞—ò —Ñ—É–Ω–∫—Ü–∏—ò–µ `handle_method_request` –∫–∞–∫–æ –±–∏—Å—Ç–µ –∫—Ä–µ–∏—Ä–∞–ª–∏ –æ–¥–≥–æ–≤–æ—Ä –Ω–∞ –∑–∞—Ö—Ç–µ–≤:

    ```python
    method_response = MethodResponse.create_from_method_request(request, 200)
    device_client.send_method_response(method_response)
    ```

    –û–≤–∞—ò –∫–æ–¥ —à–∞—ô–µ –æ–¥–≥–æ–≤–æ—Ä –Ω–∞ –∑–∞—Ö—Ç–µ–≤ –∑–∞ –¥–∏—Ä–µ–∫—Ç–Ω–∏ –º–µ—Ç–æ–¥ —Å–∞ HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥–æ–º 200 –∏ –≤—Ä–∞—õ–∞ –≥–∞ IoT Hub-—É.

1. –î–æ–¥–∞—ò—Ç–µ —Å–ª–µ–¥–µ—õ–∏ –∫–æ–¥ –∏—Å–ø–æ–¥ –¥–µ—Ñ–∏–Ω–∏—Ü–∏—ò–µ –æ–≤–µ —Ñ—É–Ω–∫—Ü–∏—ò–µ:

    ```python
    device_client.on_method_request_received = handle_method_request
    ```

    –û–≤–∞—ò –∫–æ–¥ –≥–æ–≤–æ—Ä–∏ IoT Hub –∫–ª–∏—ò–µ–Ω—Ç—É –¥–∞ –ø–æ–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏—ò—É `handle_method_request` –∫–∞–¥–∞ —Å–µ –ø–æ–∑–æ–≤–µ –¥–∏—Ä–µ–∫—Ç–Ω–∏ –º–µ—Ç–æ–¥.

> üíÅ –û–≤–∞—ò –∫–æ–¥ –º–æ–∂–µ—Ç–µ –ø—Ä–æ–Ω–∞—õ–∏ —É —Ñ–∞—Å—Ü–∏–∫–ª–∏ [code/pi](../../../../../2-farm/lessons/4-migrate-your-plant-to-the-cloud/code/pi) –∏–ª–∏ [code/virtual-device](../../../../../2-farm/lessons/4-migrate-your-plant-to-the-cloud/code/virtual-device).

üòÄ –í–∞—à –ø—Ä–æ–≥—Ä–∞–º –∑–∞ —Å–µ–Ω–∑–æ—Ä –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –∑–µ–º—ô–∏—à—Ç–∞ —ò–µ –ø–æ–≤–µ–∑–∞–Ω —Å–∞ –≤–∞—à–∏–º IoT Hub-–æ–º!

---

**–û–¥—Ä–∏—Ü–∞—ö–µ –æ–¥ –æ–¥–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç–∏**:  
–û–≤–∞—ò –¥–æ–∫—É–º–µ–Ω—Ç —ò–µ –ø—Ä–µ–≤–µ–¥–µ–Ω –∫–æ—Ä–∏—à—õ–µ—ö–µ–º —É—Å–ª—É–≥–µ –∑–∞ –ø—Ä–µ–≤–æ—í–µ—ö–µ –ø–æ–º–æ—õ—É –≤–µ—à—Ç–∞—á–∫–µ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ü–∏—ò–µ [Co-op Translator](https://github.com/Azure/co-op-translator). –ò–∞–∫–æ —Å–µ —Ç—Ä—É–¥–∏–º–æ –¥–∞ –æ–±–µ–∑–±–µ–¥–∏–º–æ —Ç–∞—á–Ω–æ—Å—Ç, –º–æ–ª–∏–º–æ –≤–∞—Å –¥–∞ –∏–º–∞—Ç–µ —É –≤–∏–¥—É –¥–∞ –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ –ø—Ä–µ–≤–æ–¥–∏ –º–æ–≥—É —Å–∞–¥—Ä–∂–∞—Ç–∏ –≥—Ä–µ—à–∫–µ –∏–ª–∏ –Ω–µ—Ç–∞—á–Ω–æ—Å—Ç–∏. –û—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏ –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ —ö–µ–≥–æ–≤–æ–º –∏–∑–≤–æ—Ä–Ω–æ–º —ò–µ–∑–∏–∫—É —Ç—Ä–µ–±–∞ —Å–º–∞—Ç—Ä–∞—Ç–∏ –º–µ—Ä–æ–¥–∞–≤–Ω–∏–º –∏–∑–≤–æ—Ä–æ–º. –ó–∞ –∫—Ä–∏—Ç–∏—á–Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ –ø—Ä–µ–ø–æ—Ä—É—á—É—ò–µ —Å–µ –ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–Ω–∏ –ø—Ä–µ–≤–æ–¥ –æ–¥ —Å—Ç—Ä–∞–Ω–µ —ô—É–¥–∏. –ù–µ –ø—Ä–µ—É–∑–∏–º–∞–º–æ –æ–¥–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç –∑–∞ –±–∏–ª–æ –∫–∞–∫–≤–∞ –ø–æ–≥—Ä–µ—à–Ω–∞ —Ç—É–º–∞—á–µ—ö–∞ –∏–ª–∏ –Ω–µ—Å–ø–æ—Ä–∞–∑—É–º–µ –∫–æ—ò–∏ –º–æ–≥—É –Ω–∞—Å—Ç–∞—Ç–∏ —É—Å–ª–µ–¥ –∫–æ—Ä–∏—à—õ–µ—ö–∞ –æ–≤–æ–≥ –ø—Ä–µ–≤–æ–¥–∞.