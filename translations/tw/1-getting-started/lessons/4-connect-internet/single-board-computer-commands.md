<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "c527ce85d69b1a3875366ec61cbed8aa",
  "translation_date": "2025-08-24T23:00:03+00:00",
  "source_file": "1-getting-started/lessons/4-connect-internet/single-board-computer-commands.md",
  "language_code": "tw"
}
-->
# é€šéäº’è¯ç¶²æ§åˆ¶æ‚¨çš„å¤œç‡ˆ - è™›æ“¬ç‰©è¯ç¶²ç¡¬ä»¶èˆ‡æ¨¹è“æ´¾

åœ¨æœ¬èª²ç¨‹çš„é€™éƒ¨åˆ†ï¼Œæ‚¨å°‡è¨‚é–±å¾ MQTT broker ç™¼é€åˆ°æ‚¨çš„æ¨¹è“æ´¾æˆ–è™›æ“¬ç‰©è¯ç¶²è¨­å‚™çš„æŒ‡ä»¤ã€‚

## è¨‚é–±æŒ‡ä»¤

ä¸‹ä¸€æ­¥æ˜¯è¨‚é–±å¾ MQTT broker ç™¼é€çš„æŒ‡ä»¤ä¸¦å°å…¶ä½œå‡ºå›æ‡‰ã€‚

### ä»»å‹™

è¨‚é–±æŒ‡ä»¤ã€‚

1. åœ¨ VS Code ä¸­æ‰“é–‹å¤œç‡ˆé …ç›®ã€‚

1. å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯è™›æ“¬ç‰©è¯ç¶²è¨­å‚™ï¼Œè«‹ç¢ºä¿çµ‚ç«¯æ­£åœ¨é‹è¡Œè™›æ“¬ç’°å¢ƒã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯æ¨¹è“æ´¾ï¼Œå‰‡ä¸éœ€è¦ä½¿ç”¨è™›æ“¬ç’°å¢ƒã€‚

1. åœ¨ `client_telemetry_topic` å®šç¾©ä¹‹å¾Œæ·»åŠ ä»¥ä¸‹ä»£ç¢¼ï¼š

    ```python
    server_command_topic = id + '/commands'
    ```

    `server_command_topic` æ˜¯è¨­å‚™å°‡è¨‚é–±ä»¥æ¥æ”¶ LED æŒ‡ä»¤çš„ MQTT ä¸»é¡Œã€‚

1. åœ¨ä¸»å¾ªç’°çš„ä¸Šæ–¹ï¼Œ`mqtt_client.loop_start()` è¡Œä¹‹å¾Œæ·»åŠ ä»¥ä¸‹ä»£ç¢¼ï¼š

    ```python
    def handle_command(client, userdata, message):
        payload = json.loads(message.payload.decode())
        print("Message received:", payload)
    
        if payload['led_on']:
            led.on()
        else:
            led.off()
    
    mqtt_client.subscribe(server_command_topic)
    mqtt_client.on_message = handle_command
    ```

    æ­¤ä»£ç¢¼å®šç¾©äº†ä¸€å€‹å‡½æ•¸ `handle_command`ï¼Œè©²å‡½æ•¸å°‡æ¶ˆæ¯ä½œç‚º JSON æ–‡æª”è®€å–ï¼Œä¸¦æŸ¥æ‰¾ `led_on` å±¬æ€§çš„å€¼ã€‚å¦‚æœè©²å±¬æ€§è¨­ç½®ç‚º `True`ï¼Œå‰‡ LED æœƒè¢«æ‰“é–‹ï¼Œå¦å‰‡æœƒè¢«é—œé–‰ã€‚

    MQTT å®¢æˆ¶ç«¯æœƒè¨‚é–±æœå‹™å™¨ç™¼é€æ¶ˆæ¯çš„ä¸»é¡Œï¼Œä¸¦è¨­ç½®åœ¨æ¥æ”¶åˆ°æ¶ˆæ¯æ™‚èª¿ç”¨ `handle_command` å‡½æ•¸ã€‚

    > ğŸ’ `on_message` è™•ç†å™¨æœƒé‡å°æ‰€æœ‰å·²è¨‚é–±çš„ä¸»é¡Œè¢«èª¿ç”¨ã€‚å¦‚æœæ‚¨ç¨å¾Œç·¨å¯«çš„ä»£ç¢¼éœ€è¦ç›£è½å¤šå€‹ä¸»é¡Œï¼Œå¯ä»¥å¾å‚³éçµ¦è™•ç†å‡½æ•¸çš„ `message` å°è±¡ä¸­ç²å–æ¶ˆæ¯æ‰€å±¬çš„ä¸»é¡Œã€‚

1. ä»¥èˆ‡å®Œæˆä¸Šä¸€éƒ¨åˆ†ä»»å‹™ç›¸åŒçš„æ–¹å¼é‹è¡Œä»£ç¢¼ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯è™›æ“¬ç‰©è¯ç¶²è¨­å‚™ï¼Œè«‹ç¢ºä¿ CounterFit æ‡‰ç”¨æ­£åœ¨é‹è¡Œï¼Œä¸¦ä¸”å…‰å‚³æ„Ÿå™¨å’Œ LED å·²åœ¨æ­£ç¢ºçš„å¼•è…³ä¸Šå‰µå»ºã€‚

1. èª¿æ•´æ‚¨çš„ç‰©ç†æˆ–è™›æ“¬è¨­å‚™æª¢æ¸¬åˆ°çš„å…‰ç·šæ°´å¹³ã€‚æ¥æ”¶åˆ°çš„æ¶ˆæ¯å’Œç™¼é€çš„æŒ‡ä»¤å°‡é¡¯ç¤ºåœ¨çµ‚ç«¯ä¸Šã€‚LED ä¹Ÿæœƒæ ¹æ“šå…‰ç·šæ°´å¹³è¢«æ‰“é–‹æˆ–é—œé–‰ã€‚

> ğŸ’ æ‚¨å¯ä»¥åœ¨ [code-commands/virtual-device](../../../../../1-getting-started/lessons/4-connect-internet/code-commands/virtual-device) æ–‡ä»¶å¤¾æˆ– [code-commands/pi](../../../../../1-getting-started/lessons/4-connect-internet/code-commands/pi) æ–‡ä»¶å¤¾ä¸­æ‰¾åˆ°æ­¤ä»£ç¢¼ã€‚

ğŸ˜€ æ‚¨å·²æˆåŠŸç·¨å¯«ä»£ç¢¼ï¼Œä½¿æ‚¨çš„è¨­å‚™èƒ½å¤ éŸ¿æ‡‰ä¾†è‡ª MQTT broker çš„æŒ‡ä»¤ã€‚

**å…è²¬è²æ˜**ï¼š  
æœ¬æ–‡ä»¶ä½¿ç”¨ AI ç¿»è­¯æœå‹™ [Co-op Translator](https://github.com/Azure/co-op-translator) é€²è¡Œç¿»è­¯ã€‚æˆ‘å€‘è‡´åŠ›æ–¼æä¾›æº–ç¢ºçš„ç¿»è­¯ï¼Œä½†è«‹æ³¨æ„ï¼Œè‡ªå‹•ç¿»è­¯å¯èƒ½åŒ…å«éŒ¯èª¤æˆ–ä¸æº–ç¢ºä¹‹è™•ã€‚æ‡‰ä»¥åŸæ–‡æ–‡ä»¶ä½œç‚ºæ¬Šå¨ä¾†æºã€‚å°æ–¼é—œéµè³‡è¨Šï¼Œå»ºè­°å°‹æ±‚å°ˆæ¥­äººå·¥ç¿»è­¯ã€‚æˆ‘å€‘å°å› ä½¿ç”¨æ­¤ç¿»è­¯è€Œå¼•èµ·çš„ä»»ä½•èª¤è§£æˆ–éŒ¯èª¤è§£é‡‹æ¦‚ä¸è² è²¬ã€‚