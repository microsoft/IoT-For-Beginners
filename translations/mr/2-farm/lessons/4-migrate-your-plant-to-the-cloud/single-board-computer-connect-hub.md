<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "3ac42e284a7222c0e83d2d43231a364f",
  "translation_date": "2025-08-27T12:02:39+00:00",
  "source_file": "2-farm/lessons/4-migrate-your-plant-to-the-cloud/single-board-computer-connect-hub.md",
  "language_code": "mr"
}
-->
# рдЖрдкрд▓реЗ IoT рдбрд┐рд╡реНрд╣рд╛рдЗрд╕ рдХреНрд▓рд╛рдЙрдбрд╢реА рдЬреЛрдбрд╛ - рд╡реНрд╣рд░реНрдЪреНрдпреБрдЕрд▓ IoT рд╣рд╛рд░реНрдбрд╡реЗрдЕрд░ рдЖрдгрд┐ рд░рд╛рд╕реНрдкрдмреЗрд░реА рдкрд╛рдп

рдпрд╛ рдзрдбреНрдпрд╛рдЪреНрдпрд╛ рдпрд╛ рднрд╛рдЧрд╛рдд, рдЖрдкрдг рдЖрдкрд▓реЗ рд╡реНрд╣рд░реНрдЪреНрдпреБрдЕрд▓ IoT рдбрд┐рд╡реНрд╣рд╛рдЗрд╕ рдХрд┐рдВрд╡рд╛ рд░рд╛рд╕реНрдкрдмреЗрд░реА рдкрд╛рдп рдЖрдкрд▓реНрдпрд╛ IoT рд╣рдмрд╢реА рдЬреЛрдбрд╛рд▓, рдЯреЗрд▓рд┐рдореЗрдЯреНрд░реА рдкрд╛рдард╡рдгреНрдпрд╛рд╕рд╛рдареА рдЖрдгрд┐ рдЖрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА.

## рдЖрдкрд▓реЗ рдбрд┐рд╡реНрд╣рд╛рдЗрд╕ IoT рд╣рдмрд╢реА рдЬреЛрдбрд╛

рдкреБрдвреАрд▓ рдкрд╛рдКрд▓ рдореНрд╣рдгрдЬреЗ рдЖрдкрд▓реЗ рдбрд┐рд╡реНрд╣рд╛рдЗрд╕ IoT рд╣рдмрд╢реА рдЬреЛрдбрдгреЗ.

### рдХрд╛рд░реНрдп - IoT рд╣рдмрд╢реА рдХрдиреЗрдХреНрдЯ рдХрд░рд╛

1. VS рдХреЛрдбрдордзреНрдпреЗ `soil-moisture-sensor` рдлреЛрд▓реНрдбрд░ рдЙрдШрдбрд╛. рдЬрд░ рдЖрдкрдг рд╡реНрд╣рд░реНрдЪреНрдпреБрдЕрд▓ IoT рдбрд┐рд╡реНрд╣рд╛рдЗрд╕ рд╡рд╛рдкрд░рдд рдЕрд╕рд╛рд▓, рддрд░ рдЯрд░реНрдорд┐рдирд▓рдордзреНрдпреЗ рд╡реНрд╣рд░реНрдЪреНрдпреБрдЕрд▓ рд╡рд╛рддрд╛рд╡рд░рдг рдЪрд╛рд▓реВ рдЕрд╕рд▓реНрдпрд╛рдЪреА рдЦрд╛рддреНрд░реА рдХрд░рд╛.

1. рдХрд╛рд╣реА рдЕрддрд┐рд░рд┐рдХреНрдд Pip рдкреЕрдХреЗрдЬреЗрд╕ рдЗрдиреНрд╕реНрдЯреЙрд▓ рдХрд░рд╛:

    ```sh
    pip3 install azure-iot-device
    ```

    `azure-iot-device` рд╣реЗ рдЖрдкрд▓реНрдпрд╛рд▓рд╛ IoT рд╣рдмрд╢реА рд╕рдВрд╡рд╛рдж рд╕рд╛рдзрдгреНрдпрд╛рд╕рд╛рдареА рд▓рд╛рдЧрдгрд╛рд░реЗ рд▓рд╛рдпрдмреНрд░рд░реА рдЖрд╣реЗ.

1. рдЦрд╛рд▓реАрд▓ рдЗрдореНрдкреЛрд░реНрдЯреНрд╕ `app.py` рдлрд╛рдИрд▓рдЪреНрдпрд╛ рд╢реАрд░реНрд╖рд╕реНрдерд╛рдиреА, рдЖрдзреАрдЪреНрдпрд╛ рдЗрдореНрдкреЛрд░реНрдЯреНрд╕рдЪреНрдпрд╛ рдЦрд╛рд▓реА рдЬреЛрдбрд╛:

    ```python
    from azure.iot.device import IoTHubDeviceClient, Message, MethodResponse
    ```

    рд╣рд╛ рдХреЛрдб IoT рд╣рдмрд╢реА рд╕рдВрд╡рд╛рдж рд╕рд╛рдзрдгреНрдпрд╛рд╕рд╛рдареА рдЖрд╡рд╢реНрдпрдХ SDK рдЗрдореНрдкреЛрд░реНрдЯ рдХрд░рддреЛ.

1. `import paho.mqtt.client as mqtt` рд╣реА рдУрд│ рдХрд╛рдвреВрди рдЯрд╛рдХрд╛ рдХрд╛рд░рдг рд╣реА рд▓рд╛рдпрдмреНрд░рд░реА рдЖрддрд╛ рдЖрд╡рд╢реНрдпрдХ рдирд╛рд╣реА. MQTT рдХреЛрдб, рдЯреЙрдкрд┐рдХ рдирд╛рд╡реЗ, `mqtt_client` рд╡рд╛рдкрд░рдгрд╛рд░рд╛ рд╕рд░реНрд╡ рдХреЛрдб рдЖрдгрд┐ `handle_command` рдХрд╛рдвреВрди рдЯрд╛рдХрд╛. `while True:` рд▓реВрдк рдареЗрд╡рд╛, рдлрдХреНрдд рдпрд╛ рд▓реВрдкрдордзреАрд▓ `mqtt_client.publish` рдУрд│ рдХрд╛рдвреВрди рдЯрд╛рдХрд╛.

1. рдЗрдореНрдкреЛрд░реНрдЯ рд╕реНрдЯреЗрдЯрдореЗрдВрдЯреНрд╕рдЪреНрдпрд╛ рдЦрд╛рд▓реАрд▓ рдХреЛрдб рдЬреЛрдбрд╛:

    ```python
    connection_string = "<connection string>"
    ```

    `<connection string>` рдЪреНрдпрд╛ рдЬрд╛рдЧреА рдпрд╛ рдзрдбреНрдпрд╛рдд рдЖрдзреА рдорд┐рд│рд╡рд▓реЗрд▓реА рдбрд┐рд╡реНрд╣рд╛рдЗрд╕ рдХрдиреЗрдХреНрд╢рди рд╕реНрдЯреНрд░рд┐рдВрдЧ рдареЗрд╡рд╛.

    > ЁЯТБ рд╣реЗ рд╕рд░реНрд╡реЛрддреНрддрдо рдкрджреНрдзрдд рдирд╛рд╣реА. рдХрдиреЗрдХреНрд╢рди рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХрдзреАрд╣реА рд╕реЛрд░реНрд╕ рдХреЛрдбрдордзреНрдпреЗ рд╕рд╛рдард╡реВ рдирдпреЗрдд, рдХрд╛рд░рдг рддреЗ рд╕реЛрд░реНрд╕ рдХреЛрдб рдХрдВрдЯреНрд░реЛрд▓рдордзреНрдпреЗ рдЪреЗрдХ рдЗрди рд╣реЛрдК рд╢рдХрддрд╛рдд рдЖрдгрд┐ рдХреЛрдгрд╛рд▓рд╛рд╣реА рд╕рд╛рдкрдбреВ рд╢рдХрддрд╛рдд. рдпреЗрдереЗ рдЖрдкрдг рд╕реЛрдкреЗрдкрдгрд╛рд╕рд╛рдареА рдЕрд╕реЗ рдХрд░рдд рдЖрд╣реЛрдд. рдЖрджрд░реНрд╢рддрдГ, рдЖрдкрдг рдкрд░реНрдпрд╛рд╡рд░рдгреАрдп рд╡реНрд╣реЗрд░рд┐рдПрдмрд▓реНрд╕ рдЖрдгрд┐ [`python-dotenv`](https://pypi.org/project/python-dotenv/) рд╕рд╛рд░рдЦреНрдпрд╛ рд╕рд╛рдзрдирд╛рдВрдЪрд╛ рд╡рд╛рдкрд░ рдХрд░рд╛рд╡рд╛. рдЖрдкрдг рдпрд╛рдмрджреНрджрд▓ рдкреБрдвреАрд▓ рдзрдбреНрдпрд╛рдд рдЕрдзрд┐рдХ рд╢рд┐рдХрд╛рд▓.

1. рдпрд╛ рдХреЛрдбрдЦрд╛рд▓реА, IoT рд╣рдмрд╢реА рд╕рдВрд╡рд╛рдж рд╕рд╛рдзрдгреНрдпрд╛рд╕рд╛рдареА рдбрд┐рд╡реНрд╣рд╛рдЗрд╕ рдХреНрд▓рд╛рдпрдВрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рддрдпрд╛рд░ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдЖрдгрд┐ рддреНрдпрд╛рд▓рд╛ рдХрдиреЗрдХреНрдЯ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдЦрд╛рд▓реАрд▓ рдХреЛрдб рдЬреЛрдбрд╛:

    ```python
    device_client = IoTHubDeviceClient.create_from_connection_string(connection_string)

    print('Connecting')
    device_client.connect()
    print('Connected')
    ```

1. рд╣рд╛ рдХреЛрдб рдЪрд╛рд▓рд╡рд╛. рдЖрдкрд▓реЗ рдбрд┐рд╡реНрд╣рд╛рдЗрд╕ рдХрдиреЗрдХреНрдЯ рд╣реЛрдИрд▓.

    ```output
    pi@raspberrypi:~/soil-moisture-sensor $ python3 app.py 
    Connecting
    Connected
    Soil moisture: 379
    ```

## рдЯреЗрд▓рд┐рдореЗрдЯреНрд░реА рдкрд╛рдард╡рд╛

рдЖрддрд╛ рдЖрдкрд▓реЗ рдбрд┐рд╡реНрд╣рд╛рдЗрд╕ рдХрдиреЗрдХреНрдЯ рдЭрд╛рд▓реЗ рдЖрд╣реЗ, рдЖрдкрдг MQTT рдмреНрд░реЛрдХрд░реНрд╕рдРрд╡рдЬреА IoT рд╣рдмрд▓рд╛ рдЯреЗрд▓рд┐рдореЗрдЯреНрд░реА рдкрд╛рдард╡реВ рд╢рдХрддрд╛.

### рдХрд╛рд░реНрдп - рдЯреЗрд▓рд┐рдореЗрдЯреНрд░реА рдкрд╛рдард╡рд╛

1. `while True` рд▓реВрдкрдЪреНрдпрд╛ рдЖрдд, `sleep` рдЪреНрдпрд╛ рдЖрдзреА рдЦрд╛рд▓реАрд▓ рдХреЛрдб рдЬреЛрдбрд╛:

    ```python
    message = Message(json.dumps({ 'soil_moisture': soil_moisture }))
    device_client.send_message(message)
    ```

    рд╣рд╛ рдХреЛрдб IoT рд╣рдмрд╕рд╛рдареА JSON рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╕реНрд╡рд░реВрдкрд╛рдд рдорд╛рддреАрддреАрд▓ рдУрд▓рд╕рд░рддреЗрдЪреЗ рд╡рд╛рдЪрди рдЕрд╕рд▓реЗрд▓рд╛ `Message` рддрдпрд╛рд░ рдХрд░рддреЛ рдЖрдгрд┐ рдбрд┐рд╡реНрд╣рд╛рдЗрд╕-рдЯреВ-рдХреНрд▓рд╛рдЙрдб рд╕рдВрджреЗрд╢ рдореНрд╣рдгреВрди IoT рд╣рдмрд▓рд╛ рдкрд╛рдард╡рддреЛ.

## рдЖрджреЗрд╢ рд╣рд╛рддрд╛рд│рд╛

рдЖрдкрд▓реНрдпрд╛ рдбрд┐рд╡реНрд╣рд╛рдЗрд╕рд▓рд╛ рд░рд┐рд▓реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рд╕рд░реНрд╡реНрд╣рд░ рдХреЛрдбрдХрдбреВрди рдЖрджреЗрд╢ рд╣рд╛рддрд╛рд│рдгреНрдпрд╛рдЪреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдЖрд╣реЗ. рд╣реЗ рдереЗрдЯ рдкрджреНрдзрддреАрдЪреНрдпрд╛ рд╡рд┐рдирдВрддреАрджреНрд╡рд╛рд░реЗ рдкрд╛рдард╡рд▓реЗ рдЬрд╛рддреЗ.

## рдХрд╛рд░реНрдп - рдереЗрдЯ рдкрджреНрдзрддреАрдЪреА рд╡рд┐рдирдВрддреА рд╣рд╛рддрд╛рд│рд╛

1. `while True` рд▓реВрдкрдЪреНрдпрд╛ рдЖрдзреА рдЦрд╛рд▓реАрд▓ рдХреЛрдб рдЬреЛрдбрд╛:

    ```python
    def handle_method_request(request):
        print("Direct method received - ", request.name)
    
        if request.name == "relay_on":
            relay.on()
        elif request.name == "relay_off":
            relay.off()    
    ```

    рд╣рд╛ рдХреЛрдб `handle_method_request` рдирд╛рд╡рд╛рдЪреА рдкрджреНрдзрдд рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЛ, рдЬреА IoT рд╣рдмрджреНрд╡рд╛рд░реЗ рдереЗрдЯ рдкрджреНрдзрдд рдХреЙрд▓ рдХреЗрд▓реНрдпрд╛рд╡рд░ рдХреЙрд▓ рдХреЗрд▓реА рдЬрд╛рдИрд▓. рдкреНрд░рддреНрдпреЗрдХ рдереЗрдЯ рдкрджреНрдзрддреАрд▓рд╛ рдПрдХ рдирд╛рд╡ рдЕрд╕рддреЗ, рдЖрдгрд┐ рд╣рд╛ рдХреЛрдб `relay_on` рдирд╛рд╡рд╛рдЪреНрдпрд╛ рдкрджреНрдзрддреАрдЪреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддреЛ рд░рд┐рд▓реЗ рдЪрд╛рд▓реВ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА, рдЖрдгрд┐ `relay_off` рд░рд┐рд▓реЗ рдмрдВрдж рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА.

    > ЁЯТБ рд╣реЗ рдПрдХрд╛ рдереЗрдЯ рдкрджреНрдзрддреАрдЪреНрдпрд╛ рд╡рд┐рдирдВрддреАрдордзреНрдпреЗ рджреЗрдЦреАрд▓ рдЕрдВрдорд▓рд╛рдд рдЖрдгрд▓реЗ рдЬрд╛рдК рд╢рдХрддреЗ, рд░рд┐рд▓реЗрдЪреА рдЗрдЪреНрдЫрд┐рдд рд╕реНрдерд┐рддреА рдкреЗрд▓реЛрдбрдордзреНрдпреЗ рдкрд╛рд╕ рдХрд░реВрди, рдЬреА рдкрджреНрдзрддреАрдЪреНрдпрд╛ рд╡рд┐рдирдВрддреАрд╕рд╣ рдкрд╛рд╕ рдХреЗрд▓реА рдЬрд╛рдК рд╢рдХрддреЗ рдЖрдгрд┐ `request` рдСрдмреНрдЬреЗрдХреНрдЯрдордзреВрди рдЙрдкрд▓рдмреНрдз рд╣реЛрдК рд╢рдХрддреЗ.

1. рдереЗрдЯ рдкрджреНрдзрддреАрдВрдирд╛ рдХреЙрд▓рд┐рдВрдЧ рдХреЛрдбрд▓рд╛ рд╕рд╛рдВрдЧрдгреНрдпрд╛рд╕рд╛рдареА рдкреНрд░рддрд┐рд╕рд╛рджрд╛рдЪреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдЕрд╕рддреЗ рдХреА рддреНрдпрд╛рдВрдирд╛ рд╣рд╛рддрд╛рд│рд▓реЗ рдЧреЗрд▓реЗ рдЖрд╣реЗ. `handle_method_request` рдлрдВрдХреНрд╢рдирдЪреНрдпрд╛ рд╢реЗрд╡рдЯреА рдЦрд╛рд▓реАрд▓ рдХреЛрдб рдЬреЛрдбрд╛:

    ```python
    method_response = MethodResponse.create_from_method_request(request, 200)
    device_client.send_method_response(method_response)
    ```

    рд╣рд╛ рдХреЛрдб рдереЗрдЯ рдкрджреНрдзрддреАрдЪреНрдпрд╛ рд╡рд┐рдирдВрддреАрд▓рд╛ HTTP рд╕реНрдерд┐рддреА рдХреЛрдб 200 рд╕рд╣ рдкреНрд░рддрд┐рд╕рд╛рдж рдкрд╛рдард╡рддреЛ рдЖрдгрд┐ IoT рд╣рдмрд▓рд╛ рдкрд░рдд рдкрд╛рдард╡рддреЛ.

1. рдпрд╛ рдлрдВрдХреНрд╢рдирдЪреНрдпрд╛ рдкрд░рд┐рднрд╛рд╖реЗрдирдВрддрд░ рдЦрд╛рд▓реАрд▓ рдХреЛрдб рдЬреЛрдбрд╛:

    ```python
    device_client.on_method_request_received = handle_method_request
    ```

    рд╣рд╛ рдХреЛрдб IoT рд╣рдм рдХреНрд▓рд╛рдпрдВрдЯрд▓рд╛ рд╕рд╛рдВрдЧрддреЛ рдХреА рдереЗрдЯ рдкрджреНрдзрдд рдХреЙрд▓ рдХреЗрд▓реНрдпрд╛рд╡рд░ `handle_method_request` рдлрдВрдХреНрд╢рди рдХреЙрд▓ рдХрд░рд╛рд╡реЗ.

> ЁЯТБ рд╣рд╛ рдХреЛрдб [code/pi](../../../../../2-farm/lessons/4-migrate-your-plant-to-the-cloud/code/pi) рдХрд┐рдВрд╡рд╛ [code/virtual-device](../../../../../2-farm/lessons/4-migrate-your-plant-to-the-cloud/code/virtual-device) рдлреЛрд▓реНрдбрд░рдордзреНрдпреЗ рд╕рд╛рдкрдбреВ рд╢рдХрддреЛ.

ЁЯША рдЖрдкрд▓рд╛ рдорд╛рддреАрддреАрд▓ рдУрд▓рд╕рд░рддрд╛ рд╕реЗрдиреНрд╕рд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо IoT рд╣рдмрд╢реА рдХрдиреЗрдХреНрдЯ рдЭрд╛рд▓рд╛ рдЖрд╣реЗ!

---

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рд╣рд╛ рджрд╕реНрддрдРрд╡рдЬ AI рднрд╛рд╖рд╛рдВрддрд░ рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рд╡рд╛рдкрд░реВрди рднрд╛рд╖рд╛рдВрддрд░рд┐рдд рдХрд░рдгреНрдпрд╛рдд рдЖрд▓рд╛ рдЖрд╣реЗ. рдЖрдореНрд╣реА рдЕрдЪреВрдХрддреЗрд╕рд╛рдареА рдкреНрд░рдпрддреНрдирд╢реАрд▓ рдЕрд╕рд▓реЛ рддрд░реА рдХреГрдкрдпрд╛ рд▓рдХреНрд╖рд╛рдд рдареЗрд╡рд╛ рдХреА рд╕реНрд╡рдпрдВрдЪрд▓рд┐рдд рднрд╛рд╖рд╛рдВрддрд░рд╛рдВрдордзреНрдпреЗ рддреНрд░реБрдЯреА рдХрд┐рдВрд╡рд╛ рдЕрдЪреВрдХрддреЗрдЪрд╛ рдЕрднрд╛рд╡ рдЕрд╕реВ рд╢рдХрддреЛ. рдореВрд│ рднрд╛рд╖реЗрддреАрд▓ рджрд╕реНрддрдРрд╡рдЬ рд╣рд╛ рдЕрдзрд┐рдХреГрдд рд╕реНрд░реЛрдд рдорд╛рдирд▓рд╛ рдЬрд╛рд╡рд╛. рдорд╣рддреНрддреНрд╡рд╛рдЪреНрдпрд╛ рдорд╛рд╣рд┐рддреАрд╕рд╛рдареА рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡реА рднрд╛рд╖рд╛рдВрддрд░рд╛рдЪреА рд╢рд┐рдлрд╛рд░рд╕ рдХреЗрд▓реА рдЬрд╛рддреЗ. рдпрд╛ рднрд╛рд╖рд╛рдВрддрд░рд╛рдЪрд╛ рд╡рд╛рдкрд░ рдХрд░реВрди рдирд┐рд░реНрдорд╛рдг рд╣реЛрдгрд╛рд▒реНрдпрд╛ рдХреЛрдгрддреНрдпрд╛рд╣реА рдЧреИрд░рд╕рдордЬ рдХрд┐рдВрд╡рд╛ рдЪреБрдХреАрдЪреНрдпрд╛ рдЕрд░реНрдерд╛рд╕рд╛рдареА рдЖрдореНрд╣реА рдЬрдмрд╛рдмрджрд╛рд░ рд░рд╛рд╣рдгрд╛рд░ рдирд╛рд╣реА.