<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "e5896207b304ce1abaf065b8acc0cc79",
  "translation_date": "2025-08-27T10:22:35+00:00",
  "source_file": "4-manufacturing/lessons/2-check-fruit-from-device/single-board-computer-classify-image.md",
  "language_code": "mr"
}
-->
# рдкреНрд░рддрд┐рдорд╛ рд╡рд░реНрдЧреАрдХреГрдд рдХрд░рд╛ - рд╡реНрд╣рд░реНрдЪреНрдпреБрдЕрд▓ IoT рд╣рд╛рд░реНрдбрд╡реЗрдЕрд░ рдЖрдгрд┐ рд░рд╛рд╕реНрдкрдмреЗрд░реА рдкрд╛рдп

рдпрд╛ рдзрдбреНрдпрд╛рдЪреНрдпрд╛ рдпрд╛ рднрд╛рдЧрд╛рдд, рддреБрдореНрд╣реА рдХреЕрдореЗрд▒реНрдпрд╛рдиреЗ рдХреЕрдкреНрдЪрд░ рдХреЗрд▓реЗрд▓реА рдкреНрд░рддрд┐рдорд╛ рд╡рд░реНрдЧреАрдХреГрдд рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА Custom Vision рд╕реЗрд╡реЗрдХрдбреЗ рдкрд╛рдард╡рд╛рд▓.

## Custom Vision рдХрдбреЗ рдкреНрд░рддрд┐рдорд╛ рдкрд╛рдард╡рд╛

Custom Vision рд╕реЗрд╡реЗрд╕рд╛рдареА рдПрдХ Python SDK рдЙрдкрд▓рдмреНрдз рдЖрд╣реЗ, рдЬреНрдпрд╛рдЪрд╛ рд╡рд╛рдкрд░ рдкреНрд░рддрд┐рдорд╛ рд╡рд░реНрдЧреАрдХреГрдд рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдХреЗрд▓рд╛ рдЬрд╛рдК рд╢рдХрддреЛ.

### рдХрд╛рд░реНрдп - Custom Vision рдХрдбреЗ рдкреНрд░рддрд┐рдорд╛ рдкрд╛рдард╡рд╛

1. VS Code рдордзреНрдпреЗ `fruit-quality-detector` рдлреЛрд▓реНрдбрд░ рдЙрдШрдбрд╛. рдЬрд░ рддреБрдореНрд╣реА рд╡реНрд╣рд░реНрдЪреНрдпреБрдЕрд▓ IoT рдбрд┐рд╡реНрд╣рд╛рдЗрд╕ рд╡рд╛рдкрд░рдд рдЕрд╕рд╛рд▓, рддрд░ рдЯрд░реНрдорд┐рдирд▓рдордзреНрдпреЗ рд╡реНрд╣рд░реНрдЪреНрдпреБрдЕрд▓ рд╡рд╛рддрд╛рд╡рд░рдг рдЪрд╛рд▓реВ рдЕрд╕рд▓реНрдпрд╛рдЪреА рдЦрд╛рддреНрд░реА рдХрд░рд╛.

1. Custom Vision рдХрдбреЗ рдкреНрд░рддрд┐рдорд╛ рдкрд╛рдард╡рдгреНрдпрд╛рд╕рд╛рдареА Python SDK Pip рдкреЕрдХреЗрдЬ рдореНрд╣рдгреВрди рдЙрдкрд▓рдмреНрдз рдЖрд╣реЗ. рддреЗ рдЦрд╛рд▓реАрд▓ рдХрдорд╛рдВрдбрд╕рд╣ рдЗрдиреНрд╕реНрдЯреЙрд▓ рдХрд░рд╛:

    ```sh
    pip3 install azure-cognitiveservices-vision-customvision
    ```

1. `app.py` рдлрд╛рдЗрд▓рдЪреНрдпрд╛ рд╢реАрд░реНрд╖рд╕реНрдерд╛рдиреА рдЦрд╛рд▓реАрд▓ рдЖрдпрд╛рдд рд╕реНрдЯреЗрдЯрдореЗрдВрдЯреНрд╕ рдЬреЛрдбрд╛:

    ```python
    from msrest.authentication import ApiKeyCredentials
    from azure.cognitiveservices.vision.customvision.prediction import CustomVisionPredictionClient
    ```

    рд╣реЗ Custom Vision рд▓рд╛рдпрдмреНрд░рд░реАрдордзреАрд▓ рдХрд╛рд╣реА рдореЙрдбреНрдпреВрд▓реНрд╕ рдЖрдгрддреЗ, рдЬреНрдпрд╛рдордзреНрдпреЗ рдкреНрд░реЗрдбрд┐рдХреНрд╢рди рдХреАрд╕рд╣ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдПрдХ рдореЙрдбреНрдпреВрд▓ рдЖрдгрд┐ Custom Vision рдХреЙрд▓ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдкреНрд░реЗрдбрд┐рдХреНрд╢рди рдХреНрд▓рд╛рдпрдВрдЯ рдХреНрд▓рд╛рд╕ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдЖрд╣реЗ.

1. рдлрд╛рдЗрд▓рдЪреНрдпрд╛ рд╢реЗрд╡рдЯреА рдЦрд╛рд▓реАрд▓ рдХреЛрдб рдЬреЛрдбрд╛:

    ```python
    prediction_url = '<prediction_url>'
    prediction_key = '<prediction key>'
    ```

    `<prediction_url>` рдЪреНрдпрд╛ рдЬрд╛рдЧреА рдпрд╛ рдзрдбреНрдпрд╛рддреАрд▓ *Prediction URL* рдбрд╛рдпрд▓реЙрдЧрдордзреВрди рдХреЙрдкреА рдХреЗрд▓реЗрд▓рд╛ URL рдареЗрд╡рд╛. `<prediction key>` рдЪреНрдпрд╛ рдЬрд╛рдЧреА рддреНрдпрд╛рдЪ рдбрд╛рдпрд▓реЙрдЧрдордзреВрди рдХреЙрдкреА рдХреЗрд▓реЗрд▓реА рдкреНрд░реЗрдбрд┐рдХреНрд╢рди рдХреА рдареЗрд╡рд╛.

1. *Prediction URL* рдбрд╛рдпрд▓реЙрдЧрдиреЗ рджрд┐рд▓реЗрд▓рд╛ рдкреНрд░реЗрдбрд┐рдХреНрд╢рди URL рдереЗрдЯ REST рдПрдиреНрдбрдкреЙрдЗрдВрдЯ рдХреЙрд▓ рдХрд░рддрд╛рдирд╛ рд╡рд╛рдкрд░рдгреНрдпрд╛рд╕рд╛рдареА рдбрд┐рдЭрд╛рдЗрди рдХреЗрд▓реЗрд▓рд╛ рдЖрд╣реЗ. Python SDK URL рдЪреЗ рднрд╛рдЧ рд╡реЗрдЧрд╡реЗрдЧрд│реНрдпрд╛ рдард┐рдХрд╛рдгреА рд╡рд╛рдкрд░рддреЛ. URL рдЪреЗ рднрд╛рдЧ рд╡реЗрдЧрд│реЗ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдЦрд╛рд▓реАрд▓ рдХреЛрдб рдЬреЛрдбрд╛:

    ```python
    parts = prediction_url.split('/')
    endpoint = 'https://' + parts[2]
    project_id = parts[6]
    iteration_name = parts[9]
    ```

    рд╣рд╛ рдХреЛрдб URL рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреЛ, рдЬреНрдпрд╛рдордзреНрдпреЗ `https://<location>.api.cognitive.microsoft.com` рд╣рд╛ рдПрдиреНрдбрдкреЙрдЗрдВрдЯ, рдкреНрд░реЛрдЬреЗрдХреНрдЯ ID, рдЖрдгрд┐ рдкреНрд░рдХрд╛рд╢рд┐рдд рдЖрд╡реГрддреНрддреАрдЪреЗ рдирд╛рд╡ рдХрд╛рдврд▓реЗ рдЬрд╛рддреЗ.

1. рдкреНрд░реЗрдбрд┐рдХреНрд╢рди рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдЦрд╛рд▓реАрд▓ рдХреЛрдбрд╕рд╣ рдПрдХ рдкреНрд░реЗрдбрд┐рдХреНрдЯрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рддрдпрд╛рд░ рдХрд░рд╛:

    ```python
    prediction_credentials = ApiKeyCredentials(in_headers={"Prediction-key": prediction_key})
    predictor = CustomVisionPredictionClient(endpoint, prediction_credentials)
    ```

    `prediction_credentials` рдкреНрд░реЗрдбрд┐рдХреНрд╢рди рдХреАрд▓рд╛ рд░реЕрдк рдХрд░рддреЛ. рдпрд╛рдЪрд╛ рд╡рд╛рдкрд░ рдПрдиреНрдбрдкреЙрдЗрдВрдЯрдХрдбреЗ рдкреЙрдЗрдВрдЯ рдХрд░рдгрд╛рд░рд╛ рдкреНрд░реЗрдбрд┐рдХреНрд╢рди рдХреНрд▓рд╛рдпрдВрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рддрдпрд╛рд░ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдХреЗрд▓рд╛ рдЬрд╛рддреЛ.

1. рдЦрд╛рд▓реАрд▓ рдХреЛрдбрд╕рд╣ рдкреНрд░рддрд┐рдорд╛ Custom Vision рдХрдбреЗ рдкрд╛рдард╡рд╛:

    ```python
    image.seek(0)
    results = predictor.classify_image(project_id, iteration_name, image)
    ```

    рд╣рд╛ рдХреЛрдб рдкреНрд░рддрд┐рдореЗрд▓рд╛ рд╕реБрд░реБрд╡рд╛рддреАрд▓рд╛ рдкрд░рдд рдиреЗрддреЛ рдЖрдгрд┐ рдирдВрддрд░ рддреА рдкреНрд░реЗрдбрд┐рдХреНрд╢рди рдХреНрд▓рд╛рдпрдВрдЯрдХрдбреЗ рдкрд╛рдард╡рддреЛ.

1. рд╢реЗрд╡рдЯреА, рдЦрд╛рд▓реАрд▓ рдХреЛрдбрд╕рд╣ рдкрд░рд┐рдгрд╛рдо рджрд╛рдЦрд╡рд╛:

    ```python
    for prediction in results.predictions:
        print(f'{prediction.tag_name}:\t{prediction.probability * 100:.2f}%')
    ```

    рд╣рд╛ рдХреЛрдб рдкрд░рдд рдЖрд▓реЗрд▓реНрдпрд╛ рд╕рд░реНрд╡ рдкреНрд░реЗрдбрд┐рдХреНрд╢рдиреНрд╕рдордзреВрди рд▓реВрдк рдХрд░рддреЛ рдЖрдгрд┐ рддреЗ рдЯрд░реНрдорд┐рдирд▓рд╡рд░ рджрд╛рдЦрд╡рддреЛ. рдкрд░рдд рдЖрд▓реЗрд▓реНрдпрд╛ рд╕рдВрднрд╛рд╡реНрдпрддрд╛ 0-1 рджрд░рдореНрдпрд╛рди рдлреНрд▓реЛрдЯрд┐рдВрдЧ рдкреЙрдЗрдВрдЯ рдирдВрдмрд░ рдЕрд╕рддрд╛рдд, рдЬрд┐рдереЗ 0 рдореНрд╣рдгрдЬреЗ 0% рд╢рдХреНрдпрддрд╛ рдЖрдгрд┐ 1 рдореНрд╣рдгрдЬреЗ 100% рд╢рдХреНрдпрддрд╛.

    > ЁЯТБ рдкреНрд░рддрд┐рдорд╛ рд╡рд░реНрдЧреАрдХрд░реНрддреЗ рд╡рд╛рдкрд░рд▓реЗрд▓реНрдпрд╛ рд╕рд░реНрд╡ рдЯреЕрдЧреНрд╕рд╕рд╛рдареА рдЯрдХреНрдХреЗрд╡рд╛рд░реА рдкрд░рдд рдХрд░рддрд╛рдд. рдкреНрд░рддреНрдпреЗрдХ рдЯреЕрдЧрд╕рд╛рдареА рдкреНрд░рддрд┐рдореЗрдиреЗ рддреНрдпрд╛ рдЯреЕрдЧрд╢реА рдЬреБрд│рдгреНрдпрд╛рдЪреА рд╢рдХреНрдпрддрд╛ рдЕрд╕рддреЗ.

1. рддреБрдордЪрд╛ рдХреЛрдб рдЪрд╛рд▓рд╡рд╛, рддреБрдордЪрд╛ рдХреЕрдореЗрд░рд╛ рдлрд│рд╛рдВрдХрдбреЗ рдХрд┐рдВрд╡рд╛ рдпреЛрдЧреНрдп рдкреНрд░рддрд┐рдорд╛рд╕реЗрдЯрдХрдбреЗ рдХрд┐рдВрд╡рд╛ рд╡реНрд╣рд░реНрдЪреНрдпреБрдЕрд▓ IoT рд╣рд╛рд░реНрдбрд╡реЗрдЕрд░ рд╡рд╛рдкрд░рдд рдЕрд╕рд▓реНрдпрд╛рд╕ рд╡реЗрдмрдХреЕрдорд╡рд░ рджрд┐рд╕рдгрд╛рд▒реНрдпрд╛ рдлрд│рд╛рдВрдХрдбреЗ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рд╛. рддреБрдореНрд╣рд╛рд▓рд╛ рдХрдиреНрд╕реЛрд▓рдордзреНрдпреЗ рдЖрдЙрдЯрдкреБрдЯ рджрд┐рд╕реЗрд▓:

    ```output
    (.venv) тЮЬ  fruit-quality-detector python app.py
    ripe:   56.84%
    unripe: 43.16%
    ```

    рддреБрдореНрд╣реА рдШреЗрддрд▓реЗрд▓реА рдкреНрд░рддрд┐рдорд╛ рдЖрдгрд┐ **Predictions** рдЯреЕрдмрдордзреНрдпреЗ рд╣реЗ рдореВрд▓реНрдпреЗ Custom Vision рдордзреНрдпреЗ рдкрд╛рд╣реВ рд╢рдХрд╛рд▓.

    ![Custom Vision рдордзреНрдпреЗ рдПрдХ рдХреЗрд│реЗ, 56.8% рдкрд┐рдХрд▓реЗрд▓реЗ рдЖрдгрд┐ 43.1% рди рдкрд┐рдХрд▓реЗрд▓реЗ рдореНрд╣рдгреВрди рдкреНрд░реЗрдбрд┐рдХреНрдЯ рдХреЗрд▓реЗрд▓реЗ](../../../../../translated_images/custom-vision-banana-prediction.30cdff4e1d72db5d9a0be0193790a47c2b387da034e12dc1314dd57ca2131b59.mr.png)

> ЁЯТБ рддреБрдореНрд╣рд╛рд▓рд╛ рд╣рд╛ рдХреЛрдб [code-classify/pi](../../../../../4-manufacturing/lessons/2-check-fruit-from-device/code-classify/pi) рдХрд┐рдВрд╡рд╛ [code-classify/virtual-iot-device](../../../../../4-manufacturing/lessons/2-check-fruit-from-device/code-classify/virtual-iot-device) рдлреЛрд▓реНрдбрд░рдордзреНрдпреЗ рд╕рд╛рдкрдбреЗрд▓.

ЁЯША рддреБрдордЪрд╛ рдлрд│ рдЧреБрдгрд╡рддреНрддрд╛ рд╡рд░реНрдЧреАрдХрд░реНрддрд╛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдпрд╢рд╕реНрд╡реА рдЭрд╛рд▓рд╛!

---

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рд╣рд╛ рджрд╕реНрддрдРрд╡рдЬ AI рднрд╛рд╖рд╛рдВрддрд░ рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдЪрд╛ рд╡рд╛рдкрд░ рдХрд░реВрди рднрд╛рд╖рд╛рдВрддрд░рд┐рдд рдХрд░рдгреНрдпрд╛рдд рдЖрд▓рд╛ рдЖрд╣реЗ. рдЖрдореНрд╣реА рдЕрдЪреВрдХрддреЗрд╕рд╛рдареА рдкреНрд░рдпрддреНрдирд╢реАрд▓ рдЕрд╕рд▓реЛ рддрд░реА, рдХреГрдкрдпрд╛ рд▓рдХреНрд╖рд╛рдд рдШреНрдпрд╛ рдХреА рд╕реНрд╡рдпрдВрдЪрд▓рд┐рдд рднрд╛рд╖рд╛рдВрддрд░рд╛рдВрдордзреНрдпреЗ рддреНрд░реБрдЯреА рдХрд┐рдВрд╡рд╛ рдЕрдЪреВрдХрддреЗрдЪрд╛ рдЕрднрд╛рд╡ рдЕрд╕реВ рд╢рдХрддреЛ. рдореВрд│ рднрд╛рд╖реЗрддреАрд▓ рджрд╕реНрддрдРрд╡рдЬ рд╣рд╛ рдЕрдзрд┐рдХреГрдд рд╕реНрд░реЛрдд рдорд╛рдирд▓рд╛ рдЬрд╛рд╡рд╛. рдорд╣рддреНрддреНрд╡рд╛рдЪреНрдпрд╛ рдорд╛рд╣рд┐рддреАрд╕рд╛рдареА рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡реА рднрд╛рд╖рд╛рдВрддрд░рд╛рдЪреА рд╢рд┐рдлрд╛рд░рд╕ рдХреЗрд▓реА рдЬрд╛рддреЗ. рдпрд╛ рднрд╛рд╖рд╛рдВрддрд░рд╛рдЪрд╛ рд╡рд╛рдкрд░ рдХреЗрд▓реНрдпрд╛рдореБрд│реЗ рдЙрджреНрднрд╡рдгрд╛рд▒реНрдпрд╛ рдХреЛрдгрддреНрдпрд╛рд╣реА рдЧреИрд░рд╕рдордЬ рдХрд┐рдВрд╡рд╛ рдЪреБрдХреАрдЪреНрдпрд╛ рдЕрд░реНрдерд╛рд╕рд╛рдареА рдЖрдореНрд╣реА рдЬрдмрд╛рдмрджрд╛рд░ рд░рд╛рд╣рдгрд╛рд░ рдирд╛рд╣реА.