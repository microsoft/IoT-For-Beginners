<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "28320305a35ea3bc59c41fe146a2e6ed",
  "translation_date": "2025-08-26T23:01:14+00:00",
  "source_file": "2-farm/lessons/4-migrate-your-plant-to-the-cloud/wio-terminal-connect-hub.md",
  "language_code": "ur"
}
-->
# ุงูพู IoT ฺูุงุฆุณ ฺฉู ฺฉูุงุคฺ ุณ ุฌูฺฺบ - Wio Terminal

ุงุณ ุณุจู ฺฉ ุงุณ ุญุต ูฺบุ ุขูพ ุงูพู Wio Terminal ฺฉู IoT Hub ุณ ุฌูฺฺบ ฺฏ ุชุงฺฉ ูนูููนุฑ ุจฺพุฌ ุณฺฉฺบ ุงูุฑ ฺฉูุงูฺุฒ ูุตูู ฺฉุฑ ุณฺฉฺบ

## ุงูพู ฺูุงุฆุณ ฺฉู IoT Hub ุณ ุฌูฺฺบ

ุงฺฏูุง ูุฑุญู   ฺฉ ุงูพู ฺูุงุฆุณ ฺฉู IoT Hub ุณ ุฌูฺฺบ

### ฺฉุงู - IoT Hub ุณ ุฌฺฺบ

1. VS Code ูฺบ `soil-moisture-sensor` ูพุฑูุฌฺฉูน ฺฉฺพููฺบ

1. `platformio.ini` ูุงุฆู ฺฉฺพููฺบ `knolleary/PubSubClient` ูุงุฆุจุฑุฑ ฺฉ ฺูพูฺูุณ ฺฉู ูนุง ุฏฺบ  ูพุจูฺฉ MQTT ุจุฑูฺฉุฑ ุณ ุฌฺู ฺฉ ู ุงุณุชุนูุงู ฺฉ ฺฏุฆ ุชฺพุ ุงูุฑ IoT Hub ุณ ุฌฺู ฺฉ ู ุถุฑูุฑ ูฺบ 

1. ุฏุฑุฌ ุฐู ูุงุฆุจุฑุฑ ฺูพูฺูุณุฒ ุดุงูู ฺฉุฑฺบ:

    ```ini
    seeed-studio/Seeed Arduino RTC @ 2.0.0
    arduino-libraries/AzureIoTHub @ 1.6.0
    azure/AzureIoTUtility @ 1.6.1
    azure/AzureIoTProtocol_MQTT @ 1.6.0
    azure/AzureIoTProtocol_HTTP @ 1.6.0
    azure/AzureIoTSocket_WiFi @ 1.0.2
    ```

    `Seeed Arduino RTC` ูุงุฆุจุฑุฑ Wio Terminal ูฺบ ุฑุฆู ูนุงุฆู ฺฉูุงฺฉ ฺฉ ุณุงุชฺพ ุชุนุงูู ฺฉ ู ฺฉูฺ ูุฑุงู ฺฉุฑุช ุ ุฌู ููุช ฺฉู ูนุฑฺฉ ฺฉุฑู ฺฉ ู ุงุณุชุนูุงู ูุช  ุจุงู ูุงุฆุจุฑุฑุงฺบ ุขูพ ฺฉ IoT ฺูุงุฆุณ ฺฉู IoT Hub ุณ ุฌฺู ฺฉ ุงุฌุงุฒุช ุฏุช ฺบ

1. `platformio.ini` ูุงุฆู ฺฉ ุขุฎุฑ ูฺบ ุฏุฑุฌ ุฐู ุดุงูู ฺฉุฑฺบ:

    ```ini
    build_flags =
        -DDONT_USE_UPLOADTOBLOB
    ```

     ุงฺฉ ฺฉููพุงุฆูุฑ ููฺฏ ุณูน ฺฉุฑุชุง  ุฌู Arduino IoT Hub ฺฉูฺ ฺฉู ฺฉููพุงุฆู ฺฉุฑุช ููุช ุถุฑูุฑ 

1. `config.h` ฺุฑ ูุงุฆู ฺฉฺพููฺบ ุชูุงู MQTT ุณูนูฺฏุฒ ฺฉู ูนุง ุฏฺบ ุงูุฑ ฺูุงุฆุณ ฺฉูฺฉุดู ุงุณูนุฑูฺฏ ฺฉ ู ุฏุฑุฌ ุฐู ฺฉุงูุณูนููน ุดุงูู ฺฉุฑฺบ:

    ```cpp
    // IoT Hub settings
    const char *CONNECTION_STRING = "<connection string>";
    ```

    `<connection string>` ฺฉู ุงุณ ฺฉูฺฉุดู ุงุณูนุฑูฺฏ ุณ ุชุจุฏู ฺฉุฑฺบ ุฌู ุขูพ ู ูพู ฺฉุงูพ ฺฉ ุชฺพ

1. IoT Hub ุณ ุฌฺู ฺฉ ู ููุช ูพุฑ ูุจู ูนูฺฉู ุงุณุชุนูุงู ูุชุง  ุงุณ ฺฉุง ูุทูุจ  ฺฉ IoT ฺูุงุฆุณ ฺฉู ููุฌูุฏ ููุช ูุนููู ููุง ฺุง ููฺูุฒุ macOS ุง ููฺฉุณ ุฌุณ ุขูพุฑูนูฺฏ ุณุณูนูุฒ ฺฉ ุจุฑุนฺฉุณุ ูุงุฆฺฉุฑู ฺฉููนุฑููุฑุฒ ุฎูุฏ ุจุฎูุฏ ุงููนุฑููน ฺฉ ุฐุฑุน ููุฌูุฏ ููุช ฺฉู ู ุขูฺฏ ูฺบ ฺฉุฑุช ุงุณ ฺฉุง ูุทูุจ  ฺฉ ุขูพ ฺฉู ฺฉูฺ ุดุงูู ฺฉุฑูุง ูฺฏุง ุชุงฺฉ ููุฌูุฏ ููุช [NTP](https://wikipedia.org/wiki/Network_Time_Protocol) ุณุฑูุฑ ุณ ุญุงุตู ฺฉุง ุฌุง ุณฺฉ ุงฺฉ ุจุงุฑ ููุช ุญุงุตู ู ุฌุงุฆุ ุงุณ Wio Terminal ูฺบ ุฑุฆู ูนุงุฆู ฺฉูุงฺฉ ูฺบ ูุญููุธ ฺฉุง ุฌุง ุณฺฉุชุง ุ ุฌุณ ุณ ุจุนุฏ ูฺบ ุฏุฑุณุช ููุช ฺฉ ุฏุฑุฎูุงุณุช ฺฉ ุฌุง ุณฺฉุช ุ ุจุดุฑุทฺฉ ฺูุงุฆุณ ูพุงูุฑ ู ฺฉฺพูุฆ `ntp.h` ูุงู ุงฺฉ ูุฆ ูุงุฆู ุจูุงุฆฺบ ุงูุฑ ุฏุฑุฌ ุฐู ฺฉูฺ ุดุงูู ฺฉุฑฺบ:

    ```cpp
    #pragma once
    
    #include "DateTime.h"
    #include <time.h>
    #include "samd/NTPClientAz.h"
    #include <sys/time.h>

    static void initTime()
    {
        WiFiUDP _udp;
        time_t epochTime = (time_t)-1;
        NTPClientAz ntpClient;

        ntpClient.begin();

        while (true)
        {
            epochTime = ntpClient.getEpochTime("0.pool.ntp.org");

            if (epochTime == (time_t)-1)
            {
                Serial.println("Fetching NTP epoch time failed! Waiting 2 seconds to retry.");
                delay(2000);
            }
            else
            {
                Serial.print("Fetched NTP epoch time is: ");

                char buff[32];
                sprintf(buff, "%.f", difftime(epochTime, (time_t)0));
                Serial.println(buff);
                break;
            }
        }

        ntpClient.end();

        struct timeval tv;
        tv.tv_sec = epochTime;
        tv.tv_usec = 0;

        settimeofday(&tv, NULL);
    }
    ```

    ุงุณ ฺฉูฺ ฺฉ ุชูุตูุงุช ุงุณ ุณุจู ฺฉ ุฏุงุฆุฑ ฺฉุงุฑ ุณ ุจุงุฑ ฺบ  ุงฺฉ ููฺฉุดู `initTime` ฺฉู ฺูุงุฆู ฺฉุฑุชุง  ุฌู ููุฌูุฏ ููุช ฺฉู NTP ุณุฑูุฑ ุณ ุญุงุตู ฺฉุฑุชุง  ุงูุฑ ุงุณ Wio Terminal ฺฉ ฺฉูุงฺฉ ูพุฑ ุณูน ฺฉุฑุชุง 

1. `main.cpp` ูุงุฆู ฺฉฺพููฺบ ุงูุฑ ุชูุงู MQTT ฺฉูฺ ฺฉู ูนุง ุฏฺบุ ุจุดููู `PubSubClient.h` ฺุฑ ูุงุฆูุ `PubSubClient` ูุฑุจู ฺฉุง ุงุนูุงูุ `reconnectMQTTClient` ุงูุฑ `createMQTTClient` ูุชฺพฺุฒุ ุงูุฑ ุงู ูุฑุจูุฒ ุงูุฑ ูุชฺพฺุฒ ฺฉ ฺฉุณ ุจฺพ ฺฉุงูุฒ ฺฉู ุงุณ ูุงุฆู ูฺบ ุตุฑู WiFi ุณ ุฌฺูุ ููน ฺฉ ูู ุญุงุตู ฺฉุฑู ุงูุฑ ุงุณ ฺฉ ุณุงุชฺพ JSON ฺุงฺฉููููน ุจูุงู ฺฉุง ฺฉูฺ ููุง ฺุง

1. `main.cpp` ูุงุฆู ฺฉ ุงููพุฑ ุฏุฑุฌ ุฐู `#include` ฺุงุฆุฑฺฉูนูุฒ ุดุงูู ฺฉุฑฺบ ุชุงฺฉ IoT Hub ูุงุฆุจุฑุฑูฺบ ุงูุฑ ููุช ุณูน ฺฉุฑู ฺฉ ู ฺุฑ ูุงุฆูุฒ ุดุงูู ฺฉ ุฌุง ุณฺฉฺบ:

    ```cpp
    #include <AzureIoTHub.h>
    #include <AzureIoTProtocol_MQTT.h>
    #include <iothubtransportmqtt.h>
    #include "ntp.h"
    ```

1. `setup` ููฺฉุดู ฺฉ ุขุฎุฑ ูฺบ ุฏุฑุฌ ุฐู ฺฉุงู ุดุงูู ฺฉุฑฺบ ุชุงฺฉ ููุฌูุฏ ููุช ุณูน ฺฉุง ุฌุง ุณฺฉ:

    ```cpp
    initTime();
    ```

1. ูุงุฆู ฺฉ ุงููพุฑุ ุงูฺฉููฺ ฺุงุฆุฑฺฉูนูุฒ ฺฉ ูฺ ุฏุฑุฌ ุฐู ูุฑุจู ุงุนูุงู ุดุงูู ฺฉุฑฺบ:

    ```cpp
    IOTHUB_DEVICE_CLIENT_LL_HANDLE _device_ll_handle;
    ```

     ุงฺฉ `IOTHUB_DEVICE_CLIENT_LL_HANDLE` ฺฉู ฺฺฉูุฆุฑ ฺฉุฑุชุง ุ ุฌู IoT Hub ุณ ฺฉูฺฉุดู ฺฉ ู ุงฺฉ ูฺู 

1. ุงุณ ฺฉ ูฺ ุฏุฑุฌ ุฐู ฺฉูฺ ุดุงูู ฺฉุฑฺบ:

    ```cpp
    static void connectionStatusCallback(IOTHUB_CLIENT_CONNECTION_STATUS result, IOTHUB_CLIENT_CONNECTION_STATUS_REASON reason, void *user_context)
    {
        if (result == IOTHUB_CLIENT_CONNECTION_AUTHENTICATED)
        {
            Serial.println("The device client is connected to iothub");
        }
        else
        {
            Serial.println("The device client has been disconnected");
        }
    }
    ```

     ุงฺฉ ฺฉุงู ุจฺฉ ููฺฉุดู ฺฉู ฺฺฉูุฆุฑ ฺฉุฑุชุง  ุฌู IoT Hub ุณ ฺฉูฺฉุดู ฺฉ ุงุณูนูนุณ ูฺบ ุชุจุฏู ูพุฑ ฺฉุงู ฺฉุง ุฌุงุฆ ฺฏุงุ ุฌุณ ฺฉูฺฉูน ุง ฺุณ ฺฉูฺฉูน ููุง ุงุณูนูนุณ ุณุฑู ูพูุฑูน ูพุฑ ุจฺพุฌุง ุฌุงุชุง 

1. ุงุณ ฺฉ ูฺ IoT Hub ุณ ุฌฺู ฺฉ ู ุงฺฉ ููฺฉุดู ุดุงูู ฺฉุฑฺบ:

    ```cpp
    void connectIoTHub()
    {
        IoTHub_Init();
    
        _device_ll_handle = IoTHubDeviceClient_LL_CreateFromConnectionString(CONNECTION_STRING, MQTT_Protocol);
        
        if (_device_ll_handle == NULL)
        {
            Serial.println("Failure creating Iothub device. Hint: Check your connection string.");
            return;
        }
    
        IoTHubDeviceClient_LL_SetConnectionStatusCallback(_device_ll_handle, connectionStatusCallback, NULL);
    }
    ```

     ฺฉูฺ IoT Hub ูุงุฆุจุฑุฑ ฺฉู ุงูุดุฆูุงุฆุฒ ฺฉุฑุชุง ุ ูพฺพุฑ `config.h` ฺุฑ ูุงุฆู ูฺบ ููุฌูุฏ ฺฉูฺฉุดู ุงุณูนุฑูฺฏ ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ ฺฉูฺฉุดู ุจูุงุชุง   ฺฉูฺฉุดู MQTT ูพุฑ ูุจู  ุงฺฏุฑ ฺฉูฺฉุดู ูุงฺฉุงู ู ุฌุงุฆุ ุชู  ุณุฑู ูพูุฑูน ูพุฑ ุจฺพุฌุง ุฌุงุชุง  - ุงฺฏุฑ ุขูพ ุขุคูน ูพูน ูฺบ  ุฏฺฉฺพฺบุ ุชู ฺฉูฺฉุดู ุงุณูนุฑูฺฏ ฺฺฉ ฺฉุฑฺบ ุขุฎุฑ ูฺบ ฺฉูฺฉุดู ุงุณูนูนุณ ฺฉุงู ุจฺฉ ุณูน ุงูพ ฺฉุง ุฌุงุชุง 

1. `setup` ููฺฉุดู ูฺบ `initTime` ฺฉุงู ฺฉ ูฺ ุงุณ ููฺฉุดู ฺฉู ฺฉุงู ฺฉุฑฺบ:

    ```cpp
    connectIoTHub();
    ```

1. MQTT ฺฉูุงุฆููน ฺฉ ุทุฑุญุ  ฺฉูฺ ุงฺฉ ุณูฺฏู ุชฺพุฑฺ ูพุฑ ฺูุชุง ุ ุงุณ ู ุจ ฺฉ ุฐุฑุน ุจฺพุฌ ฺฏุฆ ูพุบุงูุงุช ฺฉู ูพุฑูุณุณ ฺฉุฑู ุงูุฑ ุจ ฺฉู ุจฺพุฌ ฺฏุฆ ูพุบุงูุงุช ฺฉู ูพุฑูุณุณ ฺฉุฑู ฺฉ ู ููุช ุฏุฑฺฉุงุฑ ูุชุง  `loop` ููฺฉุดู ฺฉ ุงููพุฑ ุฏุฑุฌ ุฐู ุดุงูู ฺฉุฑฺบ ุชุงฺฉ  ฺฉุงู ฺฉุง ุฌุง ุณฺฉ:

    ```cpp
    IoTHubDeviceClient_LL_DoWork(_device_ll_handle);
    ```

1. ุงุณ ฺฉูฺ ฺฉู ุจูฺ ุงูุฑ ุงูพููฺ ฺฉุฑฺบ ุขูพ ุณุฑู ูุงููนุฑ ูฺบ ฺฉูฺฉุดู ุฏฺฉฺพฺบ ฺฏ:

    ```output
    Connecting to WiFi..
    Connected!
    Fetched NTP epoch time is: 1619983687
    Sending telemetry {"soil_moisture":391}
    The device client is connected to iothub
    ```

    ุขุคูน ูพูน ูฺบ ุขูพ NTP ููุช ฺฉู ุญุงุตู ูุช ูุฆ ุฏฺฉฺพ ุณฺฉุช ฺบุ ุงุณ ฺฉ ุจุนุฏ ฺูุงุฆุณ ฺฉูุงุฆููน ฺฉูฺฉูน ูุชุง  ฺฉูฺฉูน ูู ูฺบ ฺูุฏ ุณฺฉูฺ ูฺฏ ุณฺฉุช ฺบุ ุงุณ ู ุขูพ ุขุคูน ูพูน ูฺบ ููน ฺฉ ูู ุฏฺฉฺพ ุณฺฉุช ฺบ ุฌุจ ุชฺฉ ฺฉ ฺูุงุฆุณ ฺฉูฺฉูน ู ุฑุง ู

    > ๐ ุขูพ NTP ฺฉ UNIX ููุช ฺฉู ุฒุงุฏ ูุงุจูู ูุทุงูุน ูุฑฺู ูฺบ ุชุจุฏู ฺฉุฑู ฺฉ ู [unixtimestamp.com](https://www.unixtimestamp.com) ุฌุณ ูุจ ุณุงุฆูน ุงุณุชุนูุงู ฺฉุฑ ุณฺฉุช ฺบ

## ูนูููนุฑ ุจฺพุฌฺบ

ุงุจ ุฌุจ ฺฉ ุขูพ ฺฉุง ฺูุงุฆุณ ฺฉูฺฉูน ู ฺฺฉุง ุ ุขูพ MQTT ุจุฑูฺฉุฑ ฺฉ ุจุฌุงุฆ IoT Hub ฺฉู ูนูููนุฑ ุจฺพุฌ ุณฺฉุช ฺบ

### ฺฉุงู - ูนูููนุฑ ุจฺพุฌฺบ

1. `setup` ููฺฉุดู ฺฉ ุงููพุฑ ุฏุฑุฌ ุฐู ููฺฉุดู ุดุงูู ฺฉุฑฺบ:

    ```cpp
    void sendTelemetry(const char *telemetry)
    {
        IOTHUB_MESSAGE_HANDLE message_handle = IoTHubMessage_CreateFromString(telemetry);
        IoTHubDeviceClient_LL_SendEventAsync(_device_ll_handle, message_handle, NULL, NULL);
        IoTHubMessage_Destroy(message_handle);
    }
    ```

     ฺฉูฺ ุงฺฉ IoT Hub ูุณุฌ ุจูุงุชุง  ุฌู ุงฺฉ ูพุฑุงููนุฑ ฺฉ ุทูุฑ ูพุฑ ูพุงุณ ฺฉ ฺฏุฆ ุงุณูนุฑูฺฏ ุณ ูุชุง ุ ุงุณ ุจ ฺฉู ุจฺพุฌุชุง ุ ูพฺพุฑ ูุณุฌ ุขุจุฌฺฉูน ฺฉู ุตุงู ฺฉุฑุชุง 

1. `loop` ููฺฉุดู ูฺบุ ูนูููนุฑ ฺฉู ุณุฑู ูพูุฑูน ูพุฑ ุจฺพุฌู ูุงู ูุงุฆู ฺฉ ููุฑุงู ุจุนุฏ ุงุณ ฺฉูฺ ฺฉู ฺฉุงู ฺฉุฑฺบ:

    ```cpp
    sendTelemetry(telemetry.c_str());
    ```

## ฺฉูุงูฺุฒ ฺฉู ูฺู ฺฉุฑฺบ

ุขูพ ฺฉ ฺูุงุฆุณ ฺฉู ุณุฑูุฑ ฺฉูฺ ุณ ุงฺฉ ฺฉูุงูฺ ูฺู ฺฉุฑู ฺฉ ุถุฑูุฑุช  ุชุงฺฉ ุฑู ฺฉู ฺฉููนุฑูู ฺฉุง ุฌุง ุณฺฉ  ุงฺฉ ฺุงุฆุฑฺฉูน ูุชฺพฺ ุฑฺฉูุณูน ฺฉ ุทูุฑ ูพุฑ ุจฺพุฌุง ุฌุงุชุง 

### ฺฉุงู - ฺุงุฆุฑฺฉูน ูุชฺพฺ ุฑฺฉูุณูน ฺฉู ูฺู ฺฉุฑฺบ

1. `connectIoTHub` ููฺฉุดู ุณ ูพู ุฏุฑุฌ ุฐู ฺฉูฺ ุดุงูู ฺฉุฑฺบ:

    ```cpp
    int directMethodCallback(const char *method_name, const unsigned char *payload, size_t size, unsigned char **response, size_t *response_size, void *userContextCallback)
    {
        Serial.printf("Direct method received %s\r\n", method_name);
    
        if (strcmp(method_name, "relay_on") == 0)
        {
            digitalWrite(PIN_WIRE_SCL, HIGH);
        }
        else if (strcmp(method_name, "relay_off") == 0)
        {
            digitalWrite(PIN_WIRE_SCL, LOW);
        }
    }
    ```

     ฺฉูฺ ุงฺฉ ฺฉุงู ุจฺฉ ูุชฺพฺ ฺูุงุฆู ฺฉุฑุชุง  ุฌุณ IoT Hub ูุงุฆุจุฑุฑ ุงุณ ููุช ฺฉุงู ฺฉุฑ ุณฺฉุช  ุฌุจ ุงุณ ฺุงุฆุฑฺฉูน ูุชฺพฺ ุฑฺฉูุณูน ููุตูู ู ุฑฺฉูุณูน ฺฉ ฺฏุฆ ูุชฺพฺ `method_name` ูพุฑุงููนุฑ ูฺบ ุจฺพุฌ ุฌุงุช   ููฺฉุดู ุณุฑู ูพูุฑูน ูพุฑ ฺฉุงู ฺฉ ฺฏุฆ ูุชฺพฺ ฺฉู ูพุฑููน ฺฉุฑุชุง ุ ูพฺพุฑ ูุชฺพฺ ูุงู ฺฉ ูุทุงุจู ุฑู ฺฉู ุขู ุง ุขู ฺฉุฑุชุง 

    > ๐  ุงฺฉ ุณูฺฏู ฺุงุฆุฑฺฉูน ูุชฺพฺ ุฑฺฉูุณูน ูฺบ ุจฺพ ูุงูุฐ ฺฉุง ุฌุง ุณฺฉุชุง ุ ูุทููุจ ุฑู ฺฉ ุญุงูุช ฺฉู ุงฺฉ ูพ ููฺ ูฺบ ูพุงุณ ฺฉุฑุช ูุฆ ุฌู ูุชฺพฺ ุฑฺฉูุณูน ฺฉ ุณุงุชฺพ ูพุงุณ ฺฉุง ุฌุง ุณฺฉุชุง  ุงูุฑ `payload` ูพุฑุงููนุฑ ุณ ุฏุณุชุงุจ ู ุณฺฉุชุง 

1. `directMethodCallback` ููฺฉุดู ฺฉ ุขุฎุฑ ูฺบ ุฏุฑุฌ ุฐู ฺฉูฺ ุดุงูู ฺฉุฑฺบ:

    ```cpp
    char resultBuff[16];
    sprintf(resultBuff, "{\"Result\":\"\"}");
    *response_size = strlen(resultBuff);
    *response = (unsigned char *)malloc(*response_size);
    memcpy(*response, resultBuff, *response_size);

    return IOTHUB_CLIENT_OK;
    ```

    ฺุงุฆุฑฺฉูน ูุชฺพฺ ุฑฺฉูุณูนุฒ ฺฉู ุงฺฉ ุฑุณูพุงูุณ ฺฉ ุถุฑูุฑุช ูุช ุ ุงูุฑ ุฑุณูพุงูุณ ุฏู ุญุตูฺบ ูฺบ ูุชุง  - ุงฺฉ ูนฺฉุณูน ฺฉ ุทูุฑ ูพุฑ ุฑุณูพุงูุณุ ุงูุฑ ุงฺฉ ุฑูนุฑู ฺฉูฺ  ฺฉูฺ ุฏุฑุฌ ุฐู JSON ฺุงฺฉููููน ฺฉ ุทูุฑ ูพุฑ ุงฺฉ ุฑุฒููน ุจูุงุฆ ฺฏุง:

    ```JSON
    {
        "Result": ""
    }
    ```

     ูพฺพุฑ `response` ูพุฑุงููนุฑ ูฺบ ฺฉุงูพ ฺฉุง ุฌุงุชุง ุ ุงูุฑ ุงุณ ุฑุณูพุงูุณ ฺฉุง ุณุงุฆุฒ `response_size` ูพุฑุงููนุฑ ูฺบ ุณูน ฺฉุง ุฌุงุชุง   ฺฉูฺ ูพฺพุฑ `IOTHUB_CLIENT_OK` ุฑูนุฑู ฺฉุฑุชุง  ุชุงฺฉ ุธุงุฑ ู ฺฉ ูุชฺพฺ ฺฉู ุตุญุญ ุทุฑู ุณ ูฺู ฺฉุง ฺฏุง

1. ฺฉุงู ุจฺฉ ฺฉู ูุงุฆุฑ ุงูพ ฺฉุฑู ฺฉ ู ุฏุฑุฌ ุฐู ฺฉู `connectIoTHub` ููฺฉุดู ฺฉ ุขุฎุฑ ูฺบ ุดุงูู ฺฉุฑฺบ:

    ```cpp
    IoTHubClient_LL_SetDeviceMethodCallback(_device_ll_handle, directMethodCallback, NULL);
    ```

1. `loop` ููฺฉุดู `IoTHubDeviceClient_LL_DoWork` ููฺฉุดู ฺฉู IoT Hub ฺฉ ุฐุฑุน ุจฺพุฌ ฺฏุฆ ุงูููนุณ ฺฉู ูพุฑูุณุณ ฺฉุฑู ฺฉ ู ฺฉุงู ฺฉุฑ ฺฏุง  ุตุฑู ุฑ 10 ุณฺฉูฺ ฺฉ ุจุนุฏ `delay` ฺฉ ูุฌ ุณ ฺฉุงู ฺฉุง ุฌุงุชุง ุ ุฌุณ ฺฉุง ูุทูุจ  ฺฉ ฺุงุฆุฑฺฉูน ูุชฺพฺุฒ ุตุฑู ุฑ 10 ุณฺฉูฺ ฺฉ ุจุนุฏ ูพุฑูุณุณ ูุช ฺบ ุงุณ ุฒุงุฏ ููุซุฑ ุจูุงู ฺฉ ูุ 10 ุณฺฉูฺ ฺฉ ุชุงุฎุฑ ฺฉู ฺฉุฆ ฺฺพููน ุชุงุฎุฑุงุช ฺฉ ุทูุฑ ูพุฑ ูุงูุฐ ฺฉุง ุฌุง ุณฺฉุชุง ุ ุฑ ุจุงุฑ `IoTHubDeviceClient_LL_DoWork` ฺฉู ฺฉุงู ฺฉุฑุช ูุฆ ุงุณุง ฺฉุฑู ฺฉ ูุ ุฏุฑุฌ ุฐู ฺฉู `loop` ููฺฉุดู ฺฉ ุงููพุฑ ุดุงูู ฺฉุฑฺบ:

    ```cpp
    void work_delay(int delay_time)
    {
        int current = 0;
        do
        {
            IoTHubDeviceClient_LL_DoWork(_device_ll_handle);
            delay(100);
            current += 100;
        } while (current < delay_time);
    }
    ```

     ฺฉูฺ ุจุงุฑ ุจุงุฑ ูููพ ฺฉุฑ ฺฏุงุ `IoTHubDeviceClient_LL_DoWork` ฺฉู ฺฉุงู ฺฉุฑ ฺฏุง ุงูุฑ ุฑ ุจุงุฑ 100ms ฺฉ ู ุชุงุฎุฑ ฺฉุฑ ฺฏุง  ุฌุชู ุจุงุฑ ุถุฑูุฑุช ู ุงุชู ุจุงุฑ ฺฉุฑ ฺฏุง ุชุงฺฉ ุฏ ฺฏุฆ `delay_time` ูพุฑุงููนุฑ ฺฉ ู ุชุงุฎุฑ ฺฉ ุฌุง ุณฺฉ ุงุณ ฺฉุง ูุทูุจ  ฺฉ ฺูุงุฆุณ ุฒุงุฏ ุณ ุฒุงุฏ 100ms ฺฉ ู ฺุงุฆุฑฺฉูน ูุชฺพฺ ุฑฺฉูุณูนุฒ ฺฉู ูพุฑูุณุณ ฺฉุฑู ฺฉ ู ุงูุชุธุงุฑ ฺฉุฑ ุฑุง 

1. `loop` ููฺฉุดู ูฺบุ `IoTHubDeviceClient_LL_DoWork` ฺฉุงู ฺฉู ูนุง ุฏฺบุ ุงูุฑ `delay(10000)` ฺฉุงู ฺฉู ุฏุฑุฌ ุฐู ุณ ุชุจุฏู ฺฉุฑฺบ ุชุงฺฉ ุงุณ ูุฆ ููฺฉุดู ฺฉู ฺฉุงู ฺฉุง ุฌุง ุณฺฉ:

    ```cpp
    work_delay(10000);
    ```

> ๐ ุขูพ ุงุณ ฺฉูฺ ฺฉู [code/wio-terminal](../../../../../2-farm/lessons/4-migrate-your-plant-to-the-cloud/code/wio-terminal) ูููฺุฑ ูฺบ ุชูุงุด ฺฉุฑ ุณฺฉุช ฺบ

๐ ุขูพ ฺฉุง ููน ฺฉ ูู ุณูุณุฑ ูพุฑูฺฏุฑุงู IoT Hub ุณ ุฌฺ ฺฏุง !

---

**ฺุณฺฉููุฑ**:  
 ุฏุณุชุงูุฒ AI ุชุฑุฌู ุณุฑูุณ [Co-op Translator](https://github.com/Azure/co-op-translator) ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ ุชุฑุฌู ฺฉ ฺฏุฆ  ู ุฏุฑุณุชฺฏ ฺฉ ู ฺฉูุดุด ฺฉุฑุช ฺบุ ูฺฉู ุจุฑุง ฺฉุฑู ุขฺฏุง ุฑฺบ ฺฉ ุฎูุฏฺฉุงุฑ ุชุฑุฌู ูฺบ ุบูุทุงฺบ ุง ุบุฑ ุฏุฑุณุชุงฺบ ู ุณฺฉุช ฺบ ุงุตู ุฏุณุชุงูุฒ ฺฉู ุงุณ ฺฉ ุงุตู ุฒุจุงู ูฺบ ูุณุชูุฏ ุฐุฑุน ุณูุฌฺพุง ุฌุงูุง ฺุง ุงู ูุนูููุงุช ฺฉ ูุ ูพุด ูุฑ ุงูุณุงู ุชุฑุฌู ฺฉ ุณูุงุฑุด ฺฉ ุฌุงุช  ู ุงุณ ุชุฑุฌู ฺฉ ุงุณุชุนูุงู ุณ ูพุฏุง ูู ูุงู ฺฉุณ ุจฺพ ุบูุท ูู ุง ุบูุท ุชุดุฑุญ ฺฉ ุฐู ุฏุงุฑ ูฺบ ฺบ