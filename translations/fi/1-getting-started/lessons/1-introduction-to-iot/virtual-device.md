<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "52b4de6144b2efdced7797a5339d6035",
  "translation_date": "2025-08-27T22:01:09+00:00",
  "source_file": "1-getting-started/lessons/1-introduction-to-iot/virtual-device.md",
  "language_code": "fi"
}
-->
# Virtuaalinen yhden piirilevyn tietokone

Sen sijaan, ett√§ ostaisit IoT-laitteen, sensoreita ja toimilaitteita, voit k√§ytt√§√§ tietokonettasi simuloimaan IoT-laitteistoa. [CounterFit-projekti](https://github.com/CounterFit-IoT/CounterFit) mahdollistaa sovelluksen ajamisen paikallisesti, joka simuloi IoT-laitteistoa, kuten sensoreita ja toimilaitteita, ja p√§√§syn n√§ihin sensoreihin ja toimilaitteisiin paikallisesta Python-koodista, joka on kirjoitettu samalla tavalla kuin fyysisell√§ laitteistolla, kuten Raspberry Pi:ll√§.

## Asennus

CounterFitin k√§ytt√∂√§ varten sinun tulee asentaa tietokoneellesi ilmaisia ohjelmistoja.

### Teht√§v√§

Asenna tarvittavat ohjelmistot.

1. Asenna Python. Katso [Pythonin lataussivu](https://www.python.org/downloads/) saadaksesi ohjeet Pythonin uusimman version asentamiseen.

1. Asenna Visual Studio Code (VS Code). T√§m√§ on editori, jota k√§yt√§t virtuaalisen laitteen koodin kirjoittamiseen Pythonilla. Katso [VS Code -dokumentaatio](https://code.visualstudio.com?WT.mc_id=academic-17441-jabenn) saadaksesi ohjeet VS Coden asentamiseen.

    > üíÅ Voit k√§ytt√§√§ mit√§ tahansa Python IDE:t√§ tai editoria n√§iss√§ oppitunneissa, jos sinulla on mieluisampi ty√∂kalu, mutta oppitunnit antavat ohjeita perustuen VS Coden k√§ytt√∂√∂n.

1. Asenna VS Code Pylance -laajennus. T√§m√§ on VS Code -laajennus, joka tarjoaa Python-kielen tukea. Katso [Pylance-laajennuksen dokumentaatio](https://marketplace.visualstudio.com/items?WT.mc_id=academic-17441-jabenn&itemName=ms-python.vscode-pylance) saadaksesi ohjeet t√§m√§n laajennuksen asentamiseen VS Codeen.

Ohjeet CounterFit-sovelluksen asentamiseen ja konfigurointiin annetaan teht√§v√§n ohjeissa, sill√§ se asennetaan projektikohtaisesti.

## Hello world

On perinteist√§ aloittaa uuden ohjelmointikielen tai teknologian k√§ytt√∂ luomalla 'Hello World' -sovellus - pieni sovellus, joka tulostaa esimerkiksi tekstin `"Hello World"` osoittaakseen, ett√§ kaikki ty√∂kalut on konfiguroitu oikein.

Virtuaalisen IoT-laitteiston Hello World -sovellus varmistaa, ett√§ Python ja Visual Studio Code on asennettu oikein. Se my√∂s yhdist√§√§ CounterFitiin virtuaalisia IoT-sensoreita ja toimilaitteita varten. Sovellus ei k√§yt√§ mit√§√§n laitteistoa, vaan yhdist√§√§ vain varmistaakseen, ett√§ kaikki toimii.

T√§m√§ sovellus sijaitsee kansiossa nimelt√§ `nightlight`, ja sit√§ k√§ytet√§√§n uudelleen eri koodilla my√∂hemmiss√§ osissa t√§t√§ teht√§v√§√§ y√∂valosovelluksen rakentamiseksi.

### Konfiguroi Python-virtuaaliymp√§rist√∂

Yksi Pythonin tehokkaista ominaisuuksista on mahdollisuus asentaa [Pip-paketteja](https://pypi.org) - n√§m√§ ovat muiden ihmisten kirjoittamia ja Internetiin julkaistuja koodipaketteja. Voit asentaa Pip-paketin tietokoneellesi yhdell√§ komennolla ja k√§ytt√§√§ sit√§ koodissasi. K√§yt√§t Pip:i√§ CounterFitin kanssa keskustelemiseen.

Oletuksena, kun asennat paketin, se on k√§ytett√§viss√§ kaikkialla tietokoneellasi, mik√§ voi johtaa ongelmiin pakettiversioiden kanssa - esimerkiksi yksi sovellus voi riippua yhdest√§ pakettiversiosta, joka rikkoutuu, kun asennat uuden version toista sovellusta varten. T√§m√§n ongelman kiert√§miseksi voit k√§ytt√§√§ [Python-virtuaaliymp√§rist√∂√§](https://docs.python.org/3/library/venv.html), joka on k√§yt√§nn√∂ss√§ Pythonin kopio omassa kansiossaan, ja kun asennat Pip-paketteja, ne asennetaan vain siihen kansioon.

> üíÅ Jos k√§yt√§t Raspberry Pi:t√§, et konfiguroinut virtuaaliymp√§rist√∂√§ hallitaksesi Pip-paketteja, vaan k√§yt√§t globaaleja paketteja, koska Grove-paketit asennetaan globaalisti asennusskriptin avulla.

#### Teht√§v√§ - konfiguroi Python-virtuaaliymp√§rist√∂

Konfiguroi Python-virtuaaliymp√§rist√∂ ja asenna CounterFitin Pip-paketit.

1. Aja seuraavat komennot terminaalissa tai komentorivill√§ haluamassasi sijainnissa luodaksesi ja siirty√§ksesi uuteen hakemistoon:

    ```sh
    mkdir nightlight
    cd nightlight
    ```

1. Aja seuraava komento luodaksesi virtuaaliymp√§rist√∂n `.venv`-kansioon:

    ```sh
    python3 -m venv .venv
    ```

    > üíÅ Sinun t√§ytyy kutsua `python3` eksplisiittisesti luodaksesi virtuaaliymp√§rist√∂n, koska sinulla saattaa olla Python 2 asennettuna Python 3:n lis√§ksi (uusin versio). Jos sinulla on Python 2 asennettuna, `python` k√§ytt√§√§ Python 2:ta Python 3:n sijaan.

1. Aktivoi virtuaaliymp√§rist√∂:

    * Windowsissa:
        * Jos k√§yt√§t Command Promptia tai Command Promptia Windows Terminalin kautta, aja:

            ```cmd
            .venv\Scripts\activate.bat
            ```

        * Jos k√§yt√§t PowerShelli√§, aja:

            ```powershell
            .\.venv\Scripts\Activate.ps1
            ```

            > Jos saat virheilmoituksen, ett√§ skriptien suorittaminen on estetty t√§ll√§ j√§rjestelm√§ll√§, sinun t√§ytyy sallia skriptien suorittaminen asettamalla sopiva suoritusk√§yt√§nt√∂. Voit tehd√§ t√§m√§n k√§ynnist√§m√§ll√§ PowerShellin j√§rjestelm√§nvalvojana ja ajamalla seuraavan komennon:

            ```powershell
            Set-ExecutionPolicy -ExecutionPolicy Unrestricted
            ```

            Vahvista painamalla `Y`. K√§ynnist√§ sitten PowerShell uudelleen ja yrit√§ uudelleen.

            Voit tarvittaessa palauttaa t√§m√§n suoritusk√§yt√§nn√∂n my√∂hemmin. Voit lukea lis√§√§ t√§st√§ [Microsoft Docsin Execution Policies -sivulta](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_execution_policies?WT.mc_id=academic-17441-jabenn).

    * macOS:ss√§ tai Linuxissa, aja:

        ```cmd
        source ./.venv/bin/activate
        ```

    > üíÅ N√§m√§ komennot tulee ajaa samasta sijainnista, jossa ajoit komennon virtuaaliymp√§rist√∂n luomiseksi. Sinun ei koskaan tarvitse siirty√§ `.venv`-kansioon, vaan sinun tulee aina ajaa aktivointikomento ja kaikki komennot pakettien asentamiseksi tai koodin suorittamiseksi kansiosta, jossa olit virtuaaliymp√§rist√∂n luomisen aikana.

1. Kun virtuaaliymp√§rist√∂ on aktivoitu, oletus `python`-komento ajaa Python-version, jota k√§ytettiin virtuaaliymp√§rist√∂n luomiseen. Aja seuraava komento saadaksesi version:

    ```sh
    python --version
    ```

    Tulosteen tulisi sis√§lt√§√§ seuraava:

    ```output
    (.venv) ‚ûú  nightlight python --version
    Python 3.9.1
    ```

    > üíÅ Python-versiosi saattaa olla erilainen - kunhan se on versio 3.6 tai uudempi, olet hyv√§ss√§ tilanteessa. Jos ei, poista t√§m√§ kansio, asenna uudempi Python-versio ja yrit√§ uudelleen.

1. Aja seuraavat komennot asentaaksesi CounterFitin Pip-paketit. N√§m√§ paketit sis√§lt√§v√§t CounterFit-sovelluksen sek√§ Grove-laitteiston shimit. N√§m√§ shimit mahdollistavat koodin kirjoittamisen ik√§√§n kuin ohjelmoisit fyysisi√§ sensoreita ja toimilaitteita Grove-ekosysteemist√§, mutta yhdistettyn√§ virtuaalisiin IoT-laitteisiin.

    ```sh
    pip install CounterFit
    pip install counterfit-connection
    pip install counterfit-shims-grove
    ```

    N√§m√§ Pip-paketit asennetaan vain virtuaaliymp√§rist√∂√∂n, eiv√§tk√§ ne ole k√§ytett√§viss√§ sen ulkopuolella.

### Kirjoita koodi

Kun Python-virtuaaliymp√§rist√∂ on valmis, voit kirjoittaa 'Hello World' -sovelluksen koodin.

#### Teht√§v√§ - kirjoita koodi

Luo Python-sovellus, joka tulostaa `"Hello World"` konsoliin.

1. Aja seuraava komento terminaalissa tai komentorivill√§ virtuaaliymp√§rist√∂n sis√§ll√§ luodaksesi Python-tiedoston nimelt√§ `app.py`:

    * Windowsissa aja:

        ```cmd
        type nul > app.py
        ```

    * macOS:ss√§ tai Linuxissa aja:

        ```cmd
        touch app.py
        ```

1. Avaa nykyinen kansio VS Codessa:

    ```sh
    code .
    ```

    > üíÅ Jos terminaalisi palauttaa `command not found` macOS:ss√§, se tarkoittaa, ett√§ VS Codea ei ole lis√§tty PATH:iin. Voit lis√§t√§ VS Coden PATH:iin seuraamalla ohjeita [VS Code -dokumentaation Komentorivilt√§ k√§ynnist√§minen -osiossa](https://code.visualstudio.com/docs/setup/mac?WT.mc_id=academic-17441-jabenn#_launching-from-the-command-line) ja ajaa komennon sen j√§lkeen. VS Code lis√§t√§√§n oletuksena PATH:iin Windowsissa ja Linuxissa.

1. Kun VS Code k√§ynnistyy, se aktivoi Python-virtuaaliymp√§rist√∂n. Valittu virtuaaliymp√§rist√∂ n√§kyy alareunan tilapalkissa:

    ![VS Code n√§ytt√§√§ valitun virtuaaliymp√§rist√∂n](../../../../../translated_images/vscode-virtual-env.8ba42e04c3d533cf677e16cbe5ed9a3b80f62c6964472dc84b6f940800f0909f.fi.png)

1. Jos VS Coden terminaali on jo k√§ynniss√§, kun VS Code k√§ynnistyy, virtuaaliymp√§rist√∂ ei ole aktivoitu siin√§. Helpoin tapa on sulkea terminaali k√§ytt√§m√§ll√§ **Sulje aktiivinen terminaali** -painiketta:

    ![VS Code Sulje aktiivinen terminaali -painike](../../../../../translated_images/vscode-kill-terminal.1cc4de7c6f25ee08f423f0ead714e61d069fac1eb2089e97b8a7bbcb3d45fe5e.fi.png)

    Voit tarkistaa, onko terminaalissa aktivoitu virtuaaliymp√§rist√∂, sill√§ virtuaaliymp√§rist√∂n nimi n√§kyy terminaalin kehotteen etuliitteen√§. Esimerkiksi se voi olla:

    ```sh
    (.venv) ‚ûú  nightlight
    ```

    Jos kehotteessa ei ole `.venv`-etuliitett√§, virtuaaliymp√§rist√∂ ei ole aktiivinen terminaalissa.

1. K√§ynnist√§ uusi VS Code -terminaali valitsemalla *Terminal -> New Terminal* tai painamalla `` CTRL+` ``. Uusi terminaali lataa virtuaaliymp√§rist√∂n, ja aktivointikutsu n√§kyy terminaalissa. Kehotteessa n√§kyy my√∂s virtuaaliymp√§rist√∂n nimi (`.venv`):

    ```output
    ‚ûú  nightlight source .venv/bin/activate
    (.venv) ‚ûú  nightlight 
    ```

1. Avaa `app.py`-tiedosto VS Coden tiedostoselaimesta ja lis√§√§ seuraava koodi:

    ```python
    print('Hello World!')
    ```

    `print`-funktio tulostaa sille annetun sis√§ll√∂n konsoliin.

1. Aja seuraava komento VS Coden terminaalista suorittaaksesi Python-sovelluksesi:

    ```sh
    python app.py
    ```

    Tulosteessa n√§kyy seuraava:

    ```output
    (.venv) ‚ûú  nightlight python app.py 
    Hello World!
    ```

üòÄ 'Hello World' -ohjelmasi onnistui!

### Yhdist√§ 'laitteisto'

Toisena 'Hello World' -vaiheena k√§ynnist√§t CounterFit-sovelluksen ja yhdist√§t koodisi siihen. T√§m√§ vastaa virtuaalisesti IoT-laitteiston liitt√§mist√§ kehityskorttiin.

#### Teht√§v√§ - yhdist√§ 'laitteisto'

1. K√§ynnist√§ CounterFit-sovellus VS Coden terminaalista seuraavalla komennolla:

    ```sh
    counterfit
    ```

    Sovellus k√§ynnistyy ja avautuu verkkoselaimessasi:

    ![CounterFit-sovellus k√§ynniss√§ selaimessa](../../../../../translated_images/counterfit-first-run.433326358b669b31d0e99c3513cb01bfbb13724d162c99cdcc8f51ecf5f9c779.fi.png)

    Sovellus on merkitty *Disconnected*-tilaan, ja oikean yl√§kulman LED on sammutettu.

1. Lis√§√§ seuraava koodi `app.py`-tiedoston alkuun:

    ```python
    from counterfit_connection import CounterFitConnection
    CounterFitConnection.init('127.0.0.1', 5000)
    ```

    T√§m√§ koodi tuo `CounterFitConnection`-luokan `counterfit_connection`-moduulista, joka tulee aiemmin asennetusta `counterfit-connection` Pip-paketista. Se alustaa yhteyden CounterFit-sovellukseen, joka toimii osoitteessa `127.0.0.1`, IP-osoite, jota voit aina k√§ytt√§√§ paikallisen tietokoneesi (usein kutsutaan *localhost*) tavoittamiseen, portissa 5000.

    > üíÅ Jos sinulla on muita sovelluksia k√§ynniss√§ portissa 5000, voit muuttaa t√§t√§ p√§ivitt√§m√§ll√§ portin koodissa ja k√§ynnist√§m√§ll√§ CounterFitin komennolla `CounterFit --port <port_number>`, korvaten `<port_number>` haluamallasi portilla.

1. Sinun t√§ytyy k√§ynnist√§√§ uusi VS Code -terminaali valitsemalla **Luo uusi integroitu terminaali** -painike. T√§m√§ johtuu siit√§, ett√§ CounterFit-sovellus on k√§ynniss√§ nykyisess√§ terminaalissa.

    ![VS Code Luo uusi integroitu terminaali -painike](../../../../../translated_images/vscode-new-terminal.77db8fc0f9cd31824b0e49a201beafe4ae4616d6c7339992cb2819e789b3eff9.fi.png)

1. Aja `app.py`-tiedosto uudessa terminaalissa kuten aiemmin. CounterFitin tila muuttuu **Connected**-tilaan ja LED syttyy.

    ![CounterFit n√§ytt√§√§ Connected-tilan](../../../../../translated_images/counterfit-connected.ed30b46d8f79b0921f3fc70be10366e596a89dca3f80c2224a9d9fc98fccf884.fi.png)

> üíÅ L√∂yd√§t t√§m√§n koodin [code/virtual-device](../../../../../1-getting-started/lessons/1-introduction-to-iot/code/virtual-device) -kansiosta.

üòÄ Yhteys laitteistoon onnistui!

---

**Vastuuvapauslauseke**:  
T√§m√§ asiakirja on k√§√§nnetty k√§ytt√§m√§ll√§ teko√§lypohjaista k√§√§nn√∂spalvelua [Co-op Translator](https://github.com/Azure/co-op-translator). Vaikka pyrimme tarkkuuteen, huomioithan, ett√§ automaattiset k√§√§nn√∂kset voivat sis√§lt√§√§ virheit√§ tai ep√§tarkkuuksia. Alkuper√§inen asiakirja sen alkuper√§isell√§ kielell√§ tulisi pit√§√§ ensisijaisena l√§hteen√§. Kriittisen tiedon osalta suositellaan ammattimaista ihmisk√§√§nn√∂st√§. Emme ole vastuussa v√§√§rink√§sityksist√§ tai virhetulkinnoista, jotka johtuvat t√§m√§n k√§√§nn√∂ksen k√§yt√∂st√§.