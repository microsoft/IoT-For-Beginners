<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "11f10c6760fb8202cf368422702fdf70",
  "translation_date": "2025-08-25T22:09:00+00:00",
  "source_file": "1-getting-started/lessons/3-sensors-and-actuators/virtual-device-sensor.md",
  "language_code": "fa"
}
-->
# ساخت چراغ خواب - سخت‌افزار مجازی IoT

در این بخش از درس، شما یک حسگر نور به دستگاه IoT مجازی خود اضافه خواهید کرد.

## سخت‌افزار مجازی

چراغ خواب به یک حسگر نیاز دارد که در برنامه CounterFit ایجاد می‌شود.

این حسگر یک **حسگر نور** است. در یک دستگاه IoT فیزیکی، این حسگر می‌تواند یک [فوتودیود](https://wikipedia.org/wiki/Photodiode) باشد که نور را به سیگنال الکتریکی تبدیل می‌کند. حسگرهای نور حسگرهای آنالوگ هستند که یک مقدار عدد صحیح ارسال می‌کنند که نشان‌دهنده میزان نسبی نور است و به هیچ واحد استانداردی مانند [لوکس](https://wikipedia.org/wiki/Lux) مرتبط نیست.

### افزودن حسگرها به CounterFit

برای استفاده از حسگر نور مجازی، باید آن را به برنامه CounterFit اضافه کنید.

#### وظیفه - افزودن حسگرها به CounterFit

حسگر نور را به برنامه CounterFit اضافه کنید.

1. مطمئن شوید که برنامه وب CounterFit از بخش قبلی این تمرین در حال اجرا است. اگر اجرا نمی‌شود، آن را راه‌اندازی کنید.

1. یک حسگر نور ایجاد کنید:

    1. در جعبه *Create sensor* در بخش *Sensors*، از منوی کشویی *Sensor type* گزینه *Light* را انتخاب کنید.

    1. گزینه *Units* را روی *NoUnits* بگذارید.

    1. مطمئن شوید که *Pin* روی *0* تنظیم شده است.

    1. دکمه **Add** را انتخاب کنید تا حسگر نور روی پین 0 ایجاد شود.

    ![تنظیمات حسگر نور](../../../../../translated_images/counterfit-create-light-sensor.9f36a5e0d4458d8d554d54b34d2c806d56093d6e49fddcda2d20f6fef7f5cce1.fa.png)

    حسگر نور ایجاد خواهد شد و در لیست حسگرها ظاهر می‌شود.

    ![حسگر نور ایجاد شده](../../../../../translated_images/counterfit-light-sensor.5d0f5584df56b90f6b2561910d9cb20dfbd73eeff2177c238d38f4de54aefae1.fa.png)

## برنامه‌نویسی حسگر نور

اکنون می‌توان دستگاه را برای استفاده از حسگر نور داخلی برنامه‌نویسی کرد.

### وظیفه - برنامه‌نویسی حسگر نور

دستگاه را برنامه‌نویسی کنید.

1. پروژه چراغ خواب را در VS Code باز کنید که در بخش قبلی این تمرین ایجاد کرده‌اید. اگر لازم است، ترمینال را متوقف کرده و دوباره ایجاد کنید تا مطمئن شوید که با استفاده از محیط مجازی اجرا می‌شود.

1. فایل `app.py` را باز کنید.

1. کد زیر را به بالای فایل `app.py` اضافه کنید تا کتابخانه‌های مورد نیاز را وارد کنید:

    ```python
    import time
    from counterfit_shims_grove.grove_light_sensor_v1_2 import GroveLightSensor
    ```

    دستور `import time` ماژول `time` پایتون را وارد می‌کند که در ادامه این تمرین استفاده خواهد شد.

    دستور `from counterfit_shims_grove.grove_light_sensor_v1_2 import GroveLightSensor` کلاس `GroveLightSensor` را از کتابخانه‌های شیم CounterFit Grove وارد می‌کند. این کتابخانه شامل کدی برای تعامل با حسگر نوری است که در برنامه CounterFit ایجاد شده است.

1. کد زیر را به انتهای فایل اضافه کنید تا نمونه‌هایی از کلاس‌هایی که حسگر نور را مدیریت می‌کنند ایجاد شود:

    ```python
    light_sensor = GroveLightSensor(0)
    ```

    خط `light_sensor = GroveLightSensor(0)` یک نمونه از کلاس `GroveLightSensor` ایجاد می‌کند که به پین **0** متصل است - پین Grove در CounterFit که حسگر نور به آن متصل شده است.

1. یک حلقه بی‌نهایت بعد از کد بالا اضافه کنید تا مقدار حسگر نور را بخواند و آن را در کنسول چاپ کند:

    ```python
    while True:
        light = light_sensor.light
        print('Light level:', light)
    ```

    این کد سطح نور فعلی را با استفاده از ویژگی `light` کلاس `GroveLightSensor` می‌خواند. این ویژگی مقدار آنالوگ را از پین می‌خواند. سپس این مقدار در کنسول چاپ می‌شود.

1. یک توقف کوتاه یک ثانیه‌ای در انتهای حلقه `while` اضافه کنید، زیرا نیازی نیست که سطح نور به طور مداوم بررسی شود. توقف باعث کاهش مصرف انرژی دستگاه می‌شود.

    ```python
    time.sleep(1)
    ```

1. از ترمینال VS Code، دستور زیر را اجرا کنید تا برنامه پایتون خود را اجرا کنید:

    ```sh
    python3 app.py
    ```

    مقادیر نور در کنسول چاپ خواهند شد. در ابتدا این مقدار 0 خواهد بود.

1. از برنامه CounterFit، مقدار حسگر نور را که توسط برنامه خوانده می‌شود تغییر دهید. می‌توانید این کار را به یکی از دو روش زیر انجام دهید:

    * یک عدد در جعبه *Value* برای حسگر نور وارد کنید، سپس دکمه **Set** را انتخاب کنید. عددی که وارد می‌کنید مقدار بازگشتی حسگر خواهد بود.

    * گزینه *Random* را علامت بزنید و مقادیر *Min* و *Max* را وارد کنید، سپس دکمه **Set** را انتخاب کنید. هر بار که حسگر مقداری را می‌خواند، یک عدد تصادفی بین *Min* و *Max* خواهد بود.

    مقادیر تنظیم‌شده شما در کنسول چاپ خواهند شد. مقدار *Value* یا تنظیمات *Random* را تغییر دهید تا مقدار تغییر کند.

    ```output
    (.venv) ➜  GroveTest python3 app.py 
    Light level: 143
    Light level: 244
    Light level: 246
    Light level: 253
    ```

> 💁 شما می‌توانید این کد را در پوشه [code-sensor/virtual-device](../../../../../1-getting-started/lessons/3-sensors-and-actuators/code-sensor/virtual-device) پیدا کنید.

😀 برنامه چراغ خواب شما موفقیت‌آمیز بود!

**سلب مسئولیت**:  
این سند با استفاده از سرویس ترجمه هوش مصنوعی [Co-op Translator](https://github.com/Azure/co-op-translator) ترجمه شده است. در حالی که ما تلاش می‌کنیم دقت را حفظ کنیم، لطفاً توجه داشته باشید که ترجمه‌های خودکار ممکن است شامل خطاها یا نادرستی‌ها باشند. سند اصلی به زبان اصلی آن باید به عنوان منبع معتبر در نظر گرفته شود. برای اطلاعات حساس، توصیه می‌شود از ترجمه حرفه‌ای انسانی استفاده کنید. ما مسئولیتی در قبال سوء تفاهم‌ها یا تفسیرهای نادرست ناشی از استفاده از این ترجمه نداریم.