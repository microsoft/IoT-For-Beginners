<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "5f2d2f4a5a023c93ab34a0cc5b47c0c4",
  "translation_date": "2025-08-25T21:32:18+00:00",
  "source_file": "2-farm/lessons/5-migrate-application-to-the-cloud/README.md",
  "language_code": "fa"
}
-->
# ุงูุชูุงู ููุทู ุจุฑูุงูู ุจู ูุถุง ุงุจุฑ

![ููุง ฺฉู ุฏุฑุณ ุจู ุตูุฑุช ุงุณฺฉฺโููุช](../../../../../translated_images/lesson-9.dfe99c8e891f48e179724520da9f5794392cf9a625079281ccdcbf09bd85e1b6.fa.jpg)

> ุงุณฺฉฺโููุช ุชูุณุท [ูุชุง ูุงุฑุงุณููุงู](https://github.com/nitya). ุจุฑุง ูุดุงูุฏู ูุณุฎู ุจุฒุฑฺฏโุชุฑ ุฑู ุชุตูุฑ ฺฉูฺฉ ฺฉูุฏ.

ุงู ุฏุฑุณ ุจู ุนููุงู ุจุฎุด ุงุฒ [ูพุฑูฺู IoT ุจุฑุง ูุจุชุฏุงู - ุณุฑ ฺฉุดุงูุฑุฒ ุฏุฌุชุงู](https://youtube.com/playlist?list=PLmsFUfdnGr3yCutmcVg6eAUEfsGiFXgcx) ุงุฒ [Microsoft Reactor](https://developer.microsoft.com/reactor/?WT.mc_id=academic-17441-jabenn) ุชุฏุฑุณ ุดุฏู ุงุณุช.

[![ฺฉูุชุฑู ุฏุณุชฺฏุงู IoT ุฎูุฏ ุจุง ฺฉุฏ ุจุฏูู ุณุฑูุฑ](https://img.youtube.com/vi/VVZDcs5u1_I/0.jpg)](https://youtu.be/VVZDcs5u1_I)

## ุขุฒููู ูพุด ุงุฒ ุฏุฑุณ

[ุขุฒููู ูพุด ุงุฒ ุฏุฑุณ](https://black-meadow-040d15503.1.azurestaticapps.net/quiz/17)

## ููุฏูู

ุฏุฑ ุฏุฑุณ ูุจูุ ุงุฏ ฺฏุฑูุชุฏ ฺฉู ฺฺฏููู ูุธุงุฑุช ุจุฑ ุฑุทูุจุช ุฎุงฺฉ ฺฏุงู ู ฺฉูุชุฑู ุฑูู ุฑุง ุจู ฺฉ ุณุฑูุณ IoT ูุจุชู ุจุฑ ุงุจุฑ ูุชุตู ฺฉูุฏ. ฺฏุงู ุจุนุฏ ุงูุชูุงู ฺฉุฏ ุณุฑูุฑ ฺฉู ุฒูุงูโุจูุฏ ุฑูู ุฑุง ฺฉูุชุฑู ูโฺฉูุฏ ุจู ูุถุง ุงุจุฑ ุงุณุช. ุฏุฑ ุงู ุฏุฑุณ ุงุฏ ูโฺฏุฑุฏ ฺฉู ฺฺฏููู ุงู ฺฉุงุฑ ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุชูุงุจุน ุจุฏูู ุณุฑูุฑ ุงูุฌุงู ุฏูุฏ.

ุฏุฑ ุงู ุฏุฑุณ ุจู ููุงุฑุฏ ุฒุฑ ุฎูุงูู ูพุฑุฏุงุฎุช:

* [ุจุฏูู ุณุฑูุฑ ฺุณุชุ](../../../../../2-farm/lessons/5-migrate-application-to-the-cloud)
* [ุงุฌุงุฏ ฺฉ ุจุฑูุงูู ุจุฏูู ุณุฑูุฑ](../../../../../2-farm/lessons/5-migrate-application-to-the-cloud)
* [ุงุฌุงุฏ ฺฉ ุชุฑฺฏุฑ ุฑูุฏุงุฏ IoT Hub](../../../../../2-farm/lessons/5-migrate-application-to-the-cloud)
* [ุงุฑุณุงู ุฏุฑุฎูุงุณุชโูุง ูุชุฏ ูุณุชูู ุงุฒ ฺฉุฏ ุจุฏูู ุณุฑูุฑ](../../../../../2-farm/lessons/5-migrate-application-to-the-cloud)
* [ุงุณุชูุฑุงุฑ ฺฉุฏ ุจุฏูู ุณุฑูุฑ ุฏุฑ ูุถุง ุงุจุฑ](../../../../../2-farm/lessons/5-migrate-application-to-the-cloud)

## ุจุฏูู ุณุฑูุฑ ฺุณุชุ

ุจุฏูู ุณุฑูุฑุ ุง ูุญุงุณุจุงุช ุจุฏูู ุณุฑูุฑุ ุดุงูู ุงุฌุงุฏ ุจููฺฉโูุง ฺฉูฺฺฉ ฺฉุฏ ุงุณุช ฺฉู ุฏุฑ ูพุงุณุฎ ุจู ุงููุงุน ูุฎุชูู ุฑูุฏุงุฏูุง ุฏุฑ ูุถุง ุงุจุฑ ุงุฌุฑุง ูโุดููุฏ. ููุช ุฑูุฏุงุฏ ุฑุฎ ูโุฏูุฏุ ฺฉุฏ ุดูุง ุงุฌุฑุง ุดุฏู ู ุฏุงุฏูโูุง ูุฑุจูุท ุจู ุฑูุฏุงุฏ ุจู ุขู ุงุฑุณุงู ูโุดูุฏ. ุงู ุฑูุฏุงุฏูุง ูโุชูุงููุฏ ุงุฒ ููุงุจุน ูุฎุชูู ุจุงุดูุฏุ ุงุฒ ุฌููู ุฏุฑุฎูุงุณุชโูุง ูุจุ ูพุงูโูุง ูุฑุงุฑ ุฏุงุฏู ุดุฏู ุฏุฑ ุตูุ ุชุบุฑุงุช ุฏุงุฏู ุฏุฑ ฺฉ ูพุงฺฏุงู ุฏุงุฏูุ ุง ูพุงูโูุง ุงุฑุณุงู ุดุฏู ุจู ฺฉ ุณุฑูุณ IoT ุชูุณุท ุฏุณุชฺฏุงูโูุง IoT.

![ุฑูุฏุงุฏูุง ฺฉู ุงุฒ ฺฉ ุณุฑูุณ IoT ุจู ฺฉ ุณุฑูุณ ุจุฏูู ุณุฑูุฑ ุงุฑุณุงู ูโุดููุฏ ู ููฺฏ ุจู ุทูุฑ ููุฒูุงู ุชูุณุท ฺูุฏู ุชุงุจุน ูพุฑุฏุงุฒุด ูโุดููุฏ](../../../../../translated_images/iot-messages-to-serverless.0194da1cc0732bb7d0f823aed3fce54735c6b1ad3bf36089804d8aaefc0a774f.fa.png)

> ๐ ุงฺฏุฑ ูุจูุงู ุงุฒ ุชุฑฺฏุฑูุง ูพุงฺฏุงู ุฏุงุฏู ุงุณุชูุงุฏู ฺฉุฑุฏูโุงุฏุ ูโุชูุงูุฏ ุงู ุฑุง ูุดุงุจู ููุงู ุจุฏุงูุฏุ ฺฉุฏ ฺฉู ุจุง ฺฉ ุฑูุฏุงุฏ ูุงููุฏ ุฏุฑุฌ ฺฉ ุฑุฏู ูุนุงู ูโุดูุฏ.

![ููุช ุฑูุฏุงุฏูุง ุฒุงุฏ ุจู ุทูุฑ ููุฒูุงู ุงุฑุณุงู ูโุดููุฏุ ุณุฑูุณ ุจุฏูู ุณุฑูุฑ ููุงุณโูพุฐุฑ ูโฺฉูุฏ ุชุง ููู ุขููุง ุฑุง ุจู ุทูุฑ ููุฒูุงู ุงุฌุฑุง ฺฉูุฏ](../../../../../translated_images/serverless-scaling.f8c769adf0413fd17be1af4f07ff63016b347e2ff869be6c4abb211f9e93909d.fa.png)

ฺฉุฏ ุดูุง ููุท ุฒูุงู ุงุฌุฑุง ูโุดูุฏ ฺฉู ุฑูุฏุงุฏ ุฑุฎ ุฏูุฏ ู ุฏุฑ ุฒูุงูโูุง ุฏฺฏุฑ ูุนุงู ูุณุช. ุงู ุจุงุนุซ ูโุดูุฏ ุจุฏูู ุณุฑูุฑ ุจุณุงุฑ ููุงุณโูพุฐุฑ ุจุงุดุฏ - ุงฺฏุฑ ุฑูุฏุงุฏูุง ุฒุงุฏ ุจู ุทูุฑ ููุฒูุงู ุฑุฎ ุฏููุฏุ ุงุฑุงุฆูโุฏููุฏู ุงุจุฑ ูโุชูุงูุฏ ุชุงุจุน ุดูุง ุฑุง ุจู ุชุนุฏุงุฏ ุฏูุนุงุช ููุฑุฏ ูุงุฒ ุจู ุทูุฑ ููุฒูุงู ุงุฌุฑุง ฺฉูุฏ. ููุทู ุถุนู ุงู ูุฏู ุงู ุงุณุช ฺฉู ุงฺฏุฑ ูุงุฒ ุจู ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ ุงุทูุงุนุงุช ุจู ุฑูุฏุงุฏูุง ุฏุงุดุชู ุจุงุดุฏุ ุจุงุฏ ุขู ุฑุง ุฏุฑ ุฌุง ูุงููุฏ ูพุงฺฏุงู ุฏุงุฏู ุฐุฎุฑู ฺฉูุฏ ู ููโุชูุงูุฏ ุขู ุฑุง ุฏุฑ ุญุงูุธู ูฺฏู ุฏุงุฑุฏ.

ฺฉุฏ ุดูุง ุจู ุตูุฑุช ฺฉ ุชุงุจุน ููุดุชู ูโุดูุฏ ฺฉู ุฌุฒุฆุงุช ุฑูุฏุงุฏ ุฑุง ุจู ุนููุงู ฺฉ ูพุงุฑุงูุชุฑ ุฏุฑุงูุช ูโฺฉูุฏ. ุดูุง ูโุชูุงูุฏ ุงุฒ ุทู ฺฏุณุชุฑุฏูโุง ุงุฒ ุฒุจุงูโูุง ุจุฑูุงููโููุณ ุจุฑุง ููุดุชู ุงู ุชูุงุจุน ุจุฏูู ุณุฑูุฑ ุงุณุชูุงุฏู ฺฉูุฏ.

> ๐ ุจุฏูู ุณุฑูุฑ ููฺูู ุจู ุนููุงู "ุชูุงุจุน ุจู ุนููุงู ุณุฑูุณ" (FaaS) ุดูุงุฎุชู ูโุดูุฏุ ุฒุฑุง ูุฑ ุชุฑฺฏุฑ ุฑูุฏุงุฏ ุจู ุนููุงู ฺฉ ุชุงุจุน ุฏุฑ ฺฉุฏ ูพุงุฏูโุณุงุฒ ูโุดูุฏ.

ุจุง ูุฌูุฏ ูุงู ุขูุ ุจุฏูู ุณุฑูุฑ ุฏุฑ ูุงูุน ุงุฒ ุณุฑูุฑูุง ุงุณุชูุงุฏู ูโฺฉูุฏ. ุงู ูุงูโฺฏุฐุงุฑ ุจู ุงู ุฏูู ุงุณุช ฺฉู ุดูุง ุจู ุนููุงู ฺฉ ุชูุณุนูโุฏููุฏู ูุงุฒ ุจู ูฺฏุฑุงู ุฏุฑุจุงุฑู ุณุฑูุฑูุง ููุฑุฏ ูุงุฒ ุจุฑุง ุงุฌุฑุง ฺฉุฏ ุฎูุฏ ูุฏุงุฑุฏุ ุชููุง ฺุฒ ฺฉู ุจุฑุง ุดูุง ููู ุงุณุช ุงู ุงุณุช ฺฉู ฺฉุฏ ุดูุง ุฏุฑ ูพุงุณุฎ ุจู ฺฉ ุฑูุฏุงุฏ ุงุฌุฑุง ุดูุฏ. ุงุฑุงุฆูโุฏููุฏู ุงุจุฑ ฺฉ *ุฒูุงู ุงุฌุฑุง ุจุฏูู ุณุฑูุฑ* ุฏุงุฑุฏ ฺฉู ูุฏุฑุช ุชุฎุตุต ุณุฑูุฑูุงุ ุดุจฺฉูุ ุฐุฎุฑูโุณุงุฒุ CPUุ ุญุงูุธู ู ูุฑ ฺุฒ ุฏฺฏุฑ ฺฉู ุจุฑุง ุงุฌุฑุง ฺฉุฏ ุดูุง ูุงุฒู ุงุณุช ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ. ุงู ูุฏู ุจู ุงู ูุนู ุงุณุช ฺฉู ุดูุง ููโุชูุงูุฏ ุจู ุงุฒุง ูุฑ ุณุฑูุฑ ูุฒูู ูพุฑุฏุงุฎุช ฺฉูุฏุ ุฒุฑุง ุณุฑูุฑ ูุฌูุฏ ูุฏุงุฑุฏ. ุฏุฑ ุนูุถุ ุดูุง ุจุฑุง ุฒูุงู ฺฉู ฺฉุฏ ุดูุง ุงุฌุฑุง ูโุดูุฏ ู ููุฏุงุฑ ุญุงูุธู ุงุณุชูุงุฏู ุดุฏู ูุฒูู ูพุฑุฏุงุฎุช ูโฺฉูุฏ.

> ๐ฐ ุจุฏูู ุณุฑูุฑ ฺฉ ุงุฒ ุงุฑุฒุงูโุชุฑู ุฑูุดโูุง ุจุฑุง ุงุฌุฑุง ฺฉุฏ ุฏุฑ ูุถุง ุงุจุฑ ุงุณุช. ุจู ุนููุงู ูุซุงูุ ุฏุฑ ุฒูุงู ูฺฏุงุฑุด ุงู ูุชูุ ฺฉ ุงุฑุงุฆูโุฏููุฏู ุงุจุฑ ุงุฌุงุฒู ูโุฏูุฏ ุชูุงู ุชูุงุจุน ุจุฏูู ุณุฑูุฑ ุดูุง ุฏุฑ ูุฌููุน ฑ,ฐฐฐ,ฐฐฐ ุจุงุฑ ุฏุฑ ูุงู ุงุฌุฑุง ุดููุฏ ูุจู ุงุฒ ุงูฺฉู ูุฒููโุง ุฏุฑุงูุช ุดูุฏุ ู ูพุณ ุงุฒ ุขู ุจุฑุง ูุฑ ฑ,ฐฐฐ,ฐฐฐ ุงุฌุฑุง ฐ.ฒฐ ุฏูุงุฑ ุขูุฑฺฉุง ูุฒูู ุฏุฑุงูุช ูโฺฉูุฏ. ููุช ฺฉุฏ ุดูุง ุงุฌุฑุง ููโุดูุฏุ ูุฒููโุง ูพุฑุฏุงุฎุช ููโฺฉูุฏ.

ุจุฑุง ฺฉ ุชูุณุนูโุฏููุฏู IoTุ ูุฏู ุจุฏูู ุณุฑูุฑ ุงุฏูโุขู ุงุณุช. ุดูุง ูโุชูุงูุฏ ุชุงุจุน ุจููุณุฏ ฺฉู ุฏุฑ ูพุงุณุฎ ุจู ูพุงูโูุง ุงุฑุณุงู ุดุฏู ุงุฒ ูุฑ ุฏุณุชฺฏุงู IoT ูุชุตู ุจู ุณุฑูุณ IoT ูุฒุจุงู ุดุฏู ุฏุฑ ุงุจุฑ ูุฑุงุฎูุงู ุดูุฏ. ฺฉุฏ ุดูุง ุชูุงู ูพุงูโูุง ุงุฑุณุงู ุดุฏู ุฑุง ูุฏุฑุช ูโฺฉูุฏุ ุงูุง ููุท ุฒูุงู ฺฉู ูุงุฒู ุจุงุดุฏ ุงุฌุฑุง ูโุดูุฏ.

โ ุจู ฺฉุฏ ฺฉู ุจู ุนููุงู ฺฉุฏ ุณุฑูุฑ ุจุฑุง ฺฏูุด ุฏุงุฏู ุจู ูพุงูโูุง ุงุฒ ุทุฑู MQTT ููุดุชูโุงุฏ ูฺฏุงู ุจูุฏุงุฒุฏ. ฺฺฏููู ููฺฉู ุงุณุช ุงู ฺฉุฏ ุฏุฑ ูุถุง ุงุจุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ุจุฏูู ุณุฑูุฑ ุงุฌุฑุง ุดูุฏุ ูฺฉุฑ ูโฺฉูุฏ ฺฉุฏ ฺฺฏููู ุจุงุฏ ุชุบุฑ ฺฉูุฏ ุชุง ุงุฒ ูุญุงุณุจุงุช ุจุฏูู ุณุฑูุฑ ูพุดุชุจุงู ฺฉูุฏุ

> ๐ ูุฏู ุจุฏูู ุณุฑูุฑ ุฏุฑ ุญุงู ฺฏุณุชุฑุด ุจู ุณุงุฑ ุฎุฏูุงุช ุงุจุฑ ูุฒ ูุณุชุ ุนูุงูู ุจุฑ ุงุฌุฑุง ฺฉุฏ. ุจู ุนููุงู ูุซุงูุ ูพุงฺฏุงู ุฏุงุฏูโูุง ุจุฏูู ุณุฑูุฑ ุฏุฑ ูุถุง ุงุจุฑ ุจุง ูุฏู ููุชโฺฏุฐุงุฑ ุจุฏูู ุณุฑูุฑ ุฏุฑ ุฏุณุชุฑุณ ูุณุชูุฏุ ุฌุง ฺฉู ุดูุง ุจู ุงุฒุง ูุฑ ุฏุฑุฎูุงุณุช ุงูุฌุงู ุดุฏู ุนูู ูพุงฺฏุงู ุฏุงุฏู ูุฒูู ูพุฑุฏุงุฎุช ูโฺฉูุฏุ ูุงููุฏ ฺฉ ฺฉูุฆุฑ ุง ุฏุฑุฌุ ูุนูููุงู ุจุง ููุชโฺฏุฐุงุฑ ุจุฑ ุงุณุงุณ ูุฒุงู ฺฉุงุฑ ฺฉู ุจุฑุง ุงูุฌุงู ุฏุฑุฎูุงุณุช ุงูุฌุงู ูโุดูุฏ. ุจู ุนููุงู ูุซุงูุ ฺฉ ุงูุชุฎุงุจ ุณุงุฏู ุงุฒ ฺฉ ุฑุฏู ุจุฑ ุงุณุงุณ ฺฉูุฏ ุงุตู ูุฒูู ฺฉูุชุฑ ูุณุจุช ุจู ฺฉ ุนููุงุช ูพฺุฏู ฺฉู ฺูุฏู ุฌุฏูู ุฑุง ุจู ูู ูุชุตู ูโฺฉูุฏ ู ูุฒุงุฑุงู ุฑุฏู ุฑุง ุจุงุฒูโฺฏุฑุฏุงูุฏ ุฎูุงูุฏ ุฏุงุดุช.

## ุงุฌุงุฏ ฺฉ ุจุฑูุงูู ุจุฏูู ุณุฑูุฑ

ุณุฑูุณ ูุญุงุณุจุงุช ุจุฏูู ุณุฑูุฑ ูุงฺฉุฑูุณุงูุช ุจู ูุงู Azure Functions ุดูุงุฎุชู ูโุดูุฏ.

![ููฺฏู Azure Functions](../../../../../translated_images/azure-functions-logo.1cfc8e3204c9c44aaf80fcf406fc8544d80d7f00f8d3e8ed6fed764563e17564.fa.png)

ูุฏุฆู ฺฉูุชุงู ุฒุฑ ููุง ฺฉู ุงุฒ Azure Functions ุงุฑุงุฆู ูโุฏูุฏ:

[![ูุฏุฆู ููุง ฺฉู Azure Functions](https://img.youtube.com/vi/8-jz5f_JyEQ/0.jpg)](https://www.youtube.com/watch?v=8-jz5f_JyEQ)

> ๐ฅ ุจุฑุง ูุดุงูุฏู ูุฏุฆู ุฑู ุชุตูุฑ ุจุงูุง ฺฉูฺฉ ฺฉูุฏ.

โ ูุญุธูโุง ููุช ุจฺฏุฐุงุฑุฏ ู ููุง ฺฉู Azure Functions ุฑุง ุฏุฑ [ูุณุชูุฏุงุช Microsoft Azure Functions](https://docs.microsoft.com/azure/azure-functions/functions-overview?WT.mc_id=academic-17441-jabenn) ูุทุงูุนู ฺฉูุฏ.

ุจุฑุง ููุดุชู Azure Functionsุ ุดูุง ุจุง ฺฉ ุจุฑูุงูู Azure Functions ุฏุฑ ุฒุจุงู ููุฑุฏ ูุธุฑ ุฎูุฏ ุดุฑูุน ูโฺฉูุฏ. Azure Functions ุจู ุตูุฑุช ูพุดโูุฑุถ ุงุฒ ุฒุจุงูโูุง Pythonุ JavaScriptุ TypeScriptุ C#ุ F#ุ Java ู Powershell ูพุดุชุจุงู ูโฺฉูุฏ. ุฏุฑ ุงู ุฏุฑุณ ุงุฏ ูโฺฏุฑุฏ ฺฉู ฺฺฏููู ฺฉ ุจุฑูุงูู Azure Functions ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ Python ุจููุณุฏ.

> ๐ Azure Functions ููฺูู ุงุฒ ููุฏูุฑูุง ุณูุงุฑุด ูพุดุชุจุงู ูโฺฉูุฏุ ุจูุงุจุฑุงู ูโุชูุงูุฏ ุชูุงุจุน ุฎูุฏ ุฑุง ุฏุฑ ูุฑ ุฒุจุงู ฺฉู ุงุฒ ุฏุฑุฎูุงุณุชโูุง HTTP ูพุดุชุจุงู ูโฺฉูุฏ ุจููุณุฏุ ุงุฒ ุฌููู ุฒุจุงูโูุง ูุฏูโุชุฑ ูุงููุฏ COBOL.

ุจุฑูุงููโูุง ุชูุงุจุน ุดุงูู ฺฉ ุง ฺูุฏ *ุชุฑฺฏุฑ* ูุณุชูุฏ - ุชูุงุจุน ฺฉู ุจู ุฑูุฏุงุฏูุง ูพุงุณุฎ ูโุฏููุฏ. ุดูุง ูโุชูุงูุฏ ฺูุฏู ุชุฑฺฏุฑ ุฏุฑ ฺฉ ุจุฑูุงูู ุชูุงุจุน ุฏุงุดุชู ุจุงุดุฏ ฺฉู ููฺฏ ุชูุธูุงุช ูุดุชุฑฺฉ ุฑุง ุจู ุงุดุชุฑุงฺฉ ูโฺฏุฐุงุฑูุฏ. ุจู ุนููุงู ูุซุงูุ ุฏุฑ ูุงู ุชูุธูุงุช ุจุฑูุงูู ุชูุงุจุน ุฎูุฏ ูโุชูุงูุฏ ุฌุฒุฆุงุช ุงุชุตุงู IoT Hub ุฎูุฏ ุฑุง ุฏุงุดุชู ุจุงุดุฏ ู ุชูุงู ุชูุงุจุน ุฏุฑ ุจุฑูุงูู ูโุชูุงููุฏ ุงุฒ ุงู ุจุฑุง ุงุชุตุงู ู ฺฏูุด ุฏุงุฏู ุจู ุฑูุฏุงุฏูุง ุงุณุชูุงุฏู ฺฉููุฏ.

### ูุธูู - ูุตุจ ุงุจุฒุงุฑูุง Azure Functions

> ุฏุฑ ุฒูุงู ูฺฏุงุฑุด ุงู ูุชูุ ุงุจุฒุงุฑูุง ฺฉุฏููุณ Azure Functions ุจู ุทูุฑ ฺฉุงูู ุจุฑ ุฑู Apple Silicon ุจุง ูพุฑูฺูโูุง Python ฺฉุงุฑ ููโฺฉููุฏ. ุดูุง ุจุงุฏ ุงุฒ ฺฉ ูฺฉ ูุจุชู ุจุฑ Intelุ ฺฉุงููพูุชุฑ ููุฏูุฒ ุง ฺฉุงููพูุชุฑ ูููฺฉุณ ุงุณุชูุงุฏู ฺฉูุฏ.

ฺฉ ุงุฒ ูฺฺฏโูุง ุนุงู Azure Functions ุงู ุงุณุช ฺฉู ูโุชูุงูุฏ ุขููุง ุฑุง ุจู ุตูุฑุช ูุญู ุงุฌุฑุง ฺฉูุฏ. ููุงู ุฒูุงู ุงุฌุฑุง ฺฉู ุฏุฑ ูุถุง ุงุจุฑ ุงุณุชูุงุฏู ูโุดูุฏ ูโุชูุงูุฏ ุฑู ฺฉุงููพูุชุฑ ุดูุง ุงุฌุฑุง ุดูุฏ ู ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ฺฉุฏ ุจููุณุฏ ฺฉู ุจู ูพุงูโูุง IoT ูพุงุณุฎ ุฏูุฏ ู ุขู ุฑุง ุจู ุตูุฑุช ูุญู ุงุฌุฑุง ฺฉูุฏ. ุดูุง ุญุช ูโุชูุงูุฏ ฺฉุฏ ุฎูุฏ ุฑุง ููฺฏุงู ูุฏุฑุช ุฑูุฏุงุฏูุง ุงุดฺฉุงูโุฒุฏุง ฺฉูุฏ. ููฺฏุงู ฺฉู ุงุฒ ฺฉุฏ ุฎูุฏ ุฑุงุถ ุดุฏุฏุ ูโุชูุงูุฏ ุขู ุฑุง ุฏุฑ ูุถุง ุงุจุฑ ูุณุชูุฑ ฺฉูุฏ.

ุงุจุฒุงุฑูุง Azure Functions ุจู ุตูุฑุช ฺฉ CLI ุฏุฑ ุฏุณุชุฑุณ ูุณุชูุฏ ฺฉู ุจู ุนููุงู Azure Functions Core Tools ุดูุงุฎุชู ูโุดูุฏ.

1. ุงุจุฒุงุฑูุง ุงุตู Azure Functions ุฑุง ุจุง ุฏูุจุงู ฺฉุฑุฏู ุฏุณุชูุฑุงูุนููโูุง ููุฌูุฏ ุฏุฑ [ูุณุชูุฏุงุช Azure Functions Core Tools](https://docs.microsoft.com/azure/azure-functions/functions-run-local?WT.mc_id=academic-17441-jabenn) ูุตุจ ฺฉูุฏ.

1. ุงูุฒููู Azure Functions ุฑุง ุจุฑุง VS Code ูุตุจ ฺฉูุฏ. ุงู ุงูุฒููู ุงุฒ ุงุฌุงุฏุ ุงุดฺฉุงูโุฒุฏุง ู ุงุณุชูุฑุงุฑ ุชูุงุจุน Azure ูพุดุชุจุงู ูโฺฉูุฏ. ุจู [ูุณุชูุฏุงุช ุงูุฒููู Azure Functions](https://marketplace.visualstudio.com/items?WT.mc_id=academic-17441-jabenn&itemName=ms-azuretools.vscode-azurefunctions) ูุฑุงุฌุนู ฺฉูุฏ ุชุง ุฏุณุชูุฑุงูุนููโูุง ูุตุจ ุงู ุงูุฒููู ุฏุฑ VS Code ุฑุง ูุดุงูุฏู ฺฉูุฏ.

ููฺฏุงู ฺฉู ุจุฑูุงูู Azure Functions ุฎูุฏ ุฑุง ุฏุฑ ูุถุง ุงุจุฑ ูุณุชูุฑ ูโฺฉูุฏุ ูุงุฒ ุจู ุงุณุชูุงุฏู ุงุฒ ููุฏุงุฑ ฺฉู ูุถุง ุฐุฎุฑูโุณุงุฒ ุงุจุฑ ุจุฑุง ุฐุฎุฑู ููุงุฑุฏ ูุงููุฏ ูุงูโูุง ุจุฑูุงูู ู ูุงูโูุง ฺฏุฒุงุฑุด ุฏุงุฑุฏ. ููุช ุจุฑูุงูู ุชูุงุจุน ุฎูุฏ ุฑุง ุจู ุตูุฑุช ูุญู ุงุฌุฑุง ูโฺฉูุฏุ ููฺูุงู ูุงุฒ ุจู ุงุชุตุงู ุจู ูุถุง ุฐุฎุฑูโุณุงุฒ ุงุจุฑ ุฏุงุฑุฏุ ุงูุง ุจู ุฌุง ุงุณุชูุงุฏู ุงุฒ ูุถุง ุฐุฎุฑูโุณุงุฒ ูุงูุน ุงุจุฑุ ูโุชูุงูุฏ ุงุฒ ฺฉ ุดุจูโุณุงุฒ ุฐุฎุฑูโุณุงุฒ ุจู ูุงู [Azurite](https://github.com/Azure/Azurite) ุงุณุชูุงุฏู ฺฉูุฏ. ุงู ุดุจูโุณุงุฒ ุจู ุตูุฑุช ูุญู ุงุฌุฑุง ูโุดูุฏ ุงูุง ูุงููุฏ ูุถุง ุฐุฎุฑูโุณุงุฒ ุงุจุฑ ุนูู ูโฺฉูุฏ.

> ๐ ุฏุฑ Azureุ ูุถุง ุฐุฎุฑูโุณุงุฒ ฺฉู Azure Functions ุงุณุชูุงุฏู ูโฺฉูุฏ ฺฉ ุญุณุงุจ ุฐุฎุฑูโุณุงุฒ Azure ุงุณุช. ุงู ุญุณุงุจโูุง ูโุชูุงููุฏ ูุงูโูุงุ ุจููโุจโูุงุ ุฏุงุฏูโูุง ุฏุฑ ุฌุฏุงูู ุง ุฏุงุฏูโูุง ุฏุฑ ุตูโูุง ุฑุง ุฐุฎุฑู ฺฉููุฏ. ุดูุง ูโุชูุงูุฏ ฺฉ ุญุณุงุจ ุฐุฎุฑูโุณุงุฒ ุฑุง ุจู ฺูุฏู ุจุฑูุงูู ุจู ุงุดุชุฑุงฺฉ ุจฺฏุฐุงุฑุฏุ ูุงููุฏ ฺฉ ุจุฑูุงูู ุชูุงุจุน ู ฺฉ ุจุฑูุงูู ูุจ.

1. Azurite ฺฉ ุจุฑูุงูู Node.js ุงุณุชุ ุจูุงุจุฑุงู ุจุงุฏ Node.js ุฑุง ูุตุจ ฺฉูุฏ. ูโุชูุงูุฏ ุฏุณุชูุฑุงูุนููโูุง ุฏุงูููุฏ ู ูุตุจ ุฑุง ุฏุฑ [ูุจโุณุงุช Node.js](https://nodejs.org/) ูพุฏุง ฺฉูุฏ. ุงฺฏุฑ ุงุฒ ูฺฉ ุงุณุชูุงุฏู ูโฺฉูุฏุ ูโุชูุงูุฏ ุขู ุฑุง ุงุฒ [Homebrew](https://formulae.brew.sh/formula/node) ูุฒ ูุตุจ ฺฉูุฏ.

1. Azurite ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ูุตุจ ฺฉูุฏ (`npm` ุงุจุฒุงุฑ ุงุณุช ฺฉู ููฺฏุงู ูุตุจ Node.js ูุตุจ ูโุดูุฏ):

    ```sh
    npm install -g azurite
    ```

1. ฺฉ ูพูุดู ุจู ูุงู `azurite` ุจุฑุง Azurite ุงุฌุงุฏ ฺฉูุฏ ุชุง ุฏุงุฏูโูุง ุฑุง ุฏุฑ ุขู ุฐุฎุฑู ฺฉูุฏ:

    ```sh
    mkdir azurite
    ```

1. Azurite ุฑุง ุงุฌุฑุง ฺฉูุฏ ู ุงู ูพูุดู ุฌุฏุฏ ุฑุง ุจู ุขู ุจุฏูุฏ:

    ```sh
    azurite --location azurite
    ```

    ุดุจูโุณุงุฒ ุฐุฎุฑูโุณุงุฒ Azurite ุฑุงูโุงูุฏุงุฒ ุดุฏู ู ุขูุงุฏู ุงุชุตุงู ุฒูุงู ุงุฌุฑุง ูุญู ุชูุงุจุน ุฎูุงูุฏ ุจูุฏ.

    ```output
    โ  ~ azurite --location azurite  
    Azurite Blob service is starting at http://127.0.0.1:10000
    Azurite Blob service is successfully listening at http://127.0.0.1:10000
    Azurite Queue service is starting at http://127.0.0.1:10001
    Azurite Queue service is successfully listening at http://127.0.0.1:10001
    Azurite Table service is starting at http://127.0.0.1:10002
    Azurite Table service is successfully listening at http://127.0.0.1:10002
    ```

### ูุธูู - ุงุฌุงุฏ ฺฉ ูพุฑูฺู Azure Functions

CLI Azure Functions ูโุชูุงูุฏ ุจุฑุง ุงุฌุงุฏ ฺฉ ุจุฑูุงูู ุชูุงุจุน ุฌุฏุฏ ุงุณุชูุงุฏู ุดูุฏ.

1. ฺฉ ูพูุดู ุจุฑุง ุจุฑูุงูู ุชูุงุจุน ุฎูุฏ ุงุฌุงุฏ ฺฉูุฏ ู ุจู ุขู ุจุฑูุฏ. ูุงู ุขู ุฑุง `soil-moisture-trigger` ุจฺฏุฐุงุฑุฏ:

    ```sh
    mkdir soil-moisture-trigger
    cd soil-moisture-trigger
    ```

1. ฺฉ ูุญุท ูุฌุงุฒ Python ุฏุฑ ุงู ูพูุดู ุงุฌุงุฏ ฺฉูุฏ:

    ```sh
    python3 -m venv .venv
    ```

1. ูุญุท ูุฌุงุฒ ุฑุง ูุนุงู ฺฉูุฏ:

    * ุฏุฑ ููุฏูุฒ:
        * ุงฺฏุฑ ุงุฒ Command Prompt ุง Command Prompt ุงุฒ ุทุฑู Windows Terminal ุงุณุชูุงุฏู ูโฺฉูุฏุ ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ:

            ```cmd
            .venv\Scripts\activate.bat
            ```

        * ุงฺฏุฑ ุงุฒ PowerShell ุงุณุชูุงุฏู ูโฺฉูุฏุ ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ:

            ```powershell
            .\.venv\Scripts\Activate.ps1
            ```

    * ุฏุฑ macOS ุง Linuxุ ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ:

        ```cmd
        source ./.venv/bin/activate
        ```

    > ๐ ุงู ุฏุณุชูุฑุงุช ุจุงุฏ ุงุฒ ููุงู ูฺฉุงู ฺฉู ุฏุณุชูุฑ ุงุฌุงุฏ ูุญุท ูุฌุงุฒ ุฑุง ุงุฌุฑุง ฺฉุฑุฏุฏ ุงุฌุฑุง ุดููุฏ. ุดูุง ูุฑฺฏุฒ ูุงุฒ ุจู ุฑูุชู ุจู ูพูุดู `.venv` ูุฏุงุฑุฏุ ููุดู ุจุงุฏ ุฏุณุชูุฑ ูุนุงูโุณุงุฒ ู ูุฑ ุฏุณุชูุฑ ุจุฑุง ูุตุจ ุจุณุชูโูุง ุง ุงุฌุฑุง ฺฉุฏ ุฑุง ุงุฒ ูพูุดูโุง ฺฉู ูุญุท ูุฌุงุฒ ุฑุง ุฏุฑ ุขู ุงุฌุงุฏ ฺฉุฑุฏุฏ ุงุฌุฑุง ฺฉูุฏ.

1. ุฏุณุชูุฑ ุฒุฑ ุฑุง ุจุฑุง ุงุฌุงุฏ ฺฉ ุจุฑูุงูู ุชูุงุจุน ุฏุฑ ุงู ูพูุดู ุงุฌุฑุง ฺฉูุฏ:

    ```sh
    func init --worker-runtime python soil-moisture-trigger
    ```

    ุงู ุฏุณุชูุฑ ุณู ูุงู ุฏุฑ ูพูุดู ูุนู ุงุฌุงุฏ ูโฺฉูุฏ:

    * `host.json` - ุงู ุณูุฏ JSON ุดุงูู ุชูุธูุงุช ุจุฑูุงูู ุชูุงุจุน ุดูุง ุงุณุช. ูุงุฒ ุจู ุชุบุฑ ุงู ุชูุธูุงุช ูุฎูุงูุฏ ุฏุงุดุช.
    * `local.settings.json` - ุงู ุณูุฏ JSON ุดุงูู ุชูุธูุงุช ุงุณุช ฺฉู ุจุฑูุงูู ุดูุง ููฺฏุงู ุงุฌุฑุง ูุญู ุงุณุชูุงุฏู ูโฺฉูุฏุ ูุงููุฏ ุฑุดุชูโูุง ุงุชุตุงู ุจุฑุง IoT Hub. ุงู ุชูุธูุงุช ููุท ูุญู ูุณุชูุฏ ู ูุจุงุฏ ุจู ฺฉูุชุฑู ฺฉุฏ ููุจุน ุงุถุงูู ุดููุฏ. ููฺฏุงู ฺฉู ุจุฑูุงูู ุฏุฑ ูุถุง ุงุจุฑ ูุณุชูุฑ ูโุดูุฏุ ุงู ุชูุธูุงุช ูุณุชูุฑ ููโุดููุฏ ู ุจู ุฌุง ุขู ุชูุธูุงุช ุดูุง ุงุฒ ุชูุธูุงุช ุจุฑูุงูู ุจุงุฑฺฏุฐุงุฑ ูโุดููุฏ. ุงู ููุถูุน ุฏุฑ ุงุฏุงูู ุงู ุฏุฑุณ ูพูุดุด ุฏุงุฏู ุฎูุงูุฏ ุดุฏ.
    * `requirements.txt` - ุงู ฺฉ [ูุงู ูุงุฒููุฏโูุง Pip](https://pip.pypa.io/en/stable/user_guide/#requirements-files) ุงุณุช ฺฉู ุดุงูู ุจุณุชูโูุง Pip ููุฑุฏ ูุงุฒ ุจุฑุง ุงุฌุฑุง ุจุฑูุงูู ุชูุงุจุน ุดูุง ุงุณุช.

1. ูุงู `local.settings.json` ุฏุงุฑุง ุชูุธูุงุช ุจุฑุง ุญุณุงุจ ุฐุฎุฑูโุณุงุฒ ุงุณุช ฺฉู ุจุฑูุงูู ุชูุงุจุน ุงุณุชูุงุฏู ุฎูุงูุฏ ฺฉุฑุฏ. ุงู ููุฏุงุฑ ุจู ุตูุฑุช ูพุดโูุฑุถ ุฎุงู ุงุณุชุ ุจูุงุจุฑุงู ุจุงุฏ ุชูุธู ุดูุฏ. ุจุฑุง ุงุชุตุงู ุจู ุดุจูโุณุงุฒ ุฐุฎุฑูโุณุงุฒ ูุญู Azuriteุ ุงู ููุฏุงุฑ ุฑุง ุจู ููุฏุงุฑ ุฒุฑ ุชูุธู ฺฉูุฏ:

    ```json
    "AzureWebJobsStorage": "UseDevelopmentStorage=true",
    ```

1. ุจุณุชูโูุง Pip ูุงุฒู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุงู ูุงุฒููุฏโูุง ูุตุจ ฺฉูุฏ:

    ```sh
    pip install -r requirements.txt
    ```

    > ๐ ุจุณุชูโูุง Pip ููุฑุฏ ูุงุฒ ุจุงุฏ ุฏุฑ ุงู ูุงู ุจุงุดูุฏุ ุชุง ุฒูุงู ฺฉู ุจุฑูุงูู ุชูุงุจุน ุฏุฑ ูุถุง ุงุจุฑ ูุณุชูุฑ ุดูุฏุ ุฒูุงู ุงุฌุฑุง ุจุชูุงูุฏ ุจุณุชูโูุง ุตุญุญ ุฑุง ูุตุจ ฺฉูุฏ.

1. ุจุฑุง ุขุฒูุงุด ุงูฺฉู ููู ฺุฒ ุจู ุฏุฑุณุช ฺฉุงุฑ ูโฺฉูุฏุ ูโุชูุงูุฏ ุฒูุงู ุงุฌุฑุง ุชูุงุจุน ุฑุง ุดุฑูุน ฺฉูุฏ. ุฏุณุชูุฑ ุฒุฑ ุฑุง ุจุฑุง ุงู ฺฉุงุฑ ุงุฌุฑุง ฺฉูุฏ:

    ```sh
    func start
    ```

    ุฎูุงูุฏ ุฏุฏ ฺฉู ุฒูุงู ุงุฌุฑุง ุดุฑูุน ูโุดูุฏ ู ฺฏุฒุงุฑุด ูโุฏูุฏ ฺฉู ูฺ ุชุงุจุน ุดุบู (ุชุฑฺฏุฑ) ูพุฏุง ูฺฉุฑุฏู ุงุณุช.

    ```output
    (.venv) โ  soil-moisture-trigger func start
    Found Python version 3.9.1 (python3).
    
    Azure Functions Core Tools
    Core Tools Version:       3.0.3442 Commit hash: 6bfab24b2743f8421475d996402c398d2fe4a9e0  (64-bit)
    Function Runtime Version: 3.0.15417.0
    
    [2021-05-05T01:24:46.795Z] No job functions found.
    ```
> โ๏ธ ุงฺฏุฑ ุงุนูุงู ูุงุฑูุงู ุฏุฑุงูุช ฺฉุฑุฏุฏุ ุฏุณุชุฑุณ ุฑุง ุชุฃุฏ ฺฉูุฏ ุฒุฑุง ุจุฑูุงูู `func` ูุงุฒ ุฏุงุฑุฏ ฺฉู ุจุชูุงูุฏ ุจู ุดุจฺฉู ุดูุง ุจุฎูุงูุฏ ู ุจููุณุฏ.
> โ๏ธ ุงฺฏุฑ ุงุฒ macOS ุงุณุชูุงุฏู ูโฺฉูุฏุ ููฺฉู ุงุณุช ูุดุฏุงุฑูุง ุฏุฑ ุฎุฑูุฌ ูุดุงูุฏู ฺฉูุฏ:
>
> ```output
    > (.venv) โ  soil-moisture-trigger func start
    > Found Python version 3.9.1 (python3).
    >
    > Azure Functions Core Tools
    > Core Tools Version:       3.0.3442 Commit hash: 6bfab24b2743f8421475d996402c398d2fe4a9e0  (64-bit)
    > Function Runtime Version: 3.0.15417.0
    >
    > [2021-06-16T08:18:28.315Z] Cannot create directory for shared memory usage: /dev/shm/AzureFunctions
    > [2021-06-16T08:18:28.316Z] System.IO.FileSystem: Access to the path '/dev/shm/AzureFunctions' is denied. Operation not permitted.
    > [2021-06-16T08:18:30.361Z] No job functions found.
    > ```
>
> ูโุชูุงูุฏ ุงู ูุดุฏุงุฑูุง ุฑุง ูุงุฏุฏู ุจฺฏุฑุฏุ ุจู ุดุฑุท ฺฉู ุจุฑูุงูู Functions ุจู ุฏุฑุณุช ุงุฌุฑุง ุดูุฏ ู ูุณุช ุชูุงุจุน ุฏุฑ ุญุงู ุงุฌุฑุง ุฑุง ููุงุด ุฏูุฏ. ููุงูโุทูุฑ ฺฉู ุฏุฑ [ุงู ูพุฑุณุด ุฏุฑ Microsoft Docs Q&A](https://docs.microsoft.com/answers/questions/396617/azure-functions-core-tools-error-osx-devshmazurefu.html?WT.mc_id=academic-17441-jabenn) ุฐฺฉุฑ ุดุฏู ุงุณุชุ ุงู ูุดุฏุงุฑูุง ูุงุจู ฺุดูโูพูุด ูุณุชูุฏ.

1. ุจุฑูุงูู Functions ุฑุง ุจุง ูุดุงุฑ ุฏุงุฏู `ctrl+c` ูุชููู ฺฉูุฏ.

1. ูพูุดู ูุนู ุฑุง ุฏุฑ VS Code ุจุงุฒ ฺฉูุฏุ ุง ุจุง ุจุงุฒ ฺฉุฑุฏู VS Code ู ุณูพุณ ุจุงุฒ ฺฉุฑุฏู ุงู ูพูุดูุ ุง ุจุง ุงุฌุฑุง ุฏุณุชูุฑ ุฒุฑ:

    ```sh
    code .
    ```

    VS Code ูพุฑูฺู Functions ุดูุง ุฑุง ุดูุงุณุง ฺฉุฑุฏู ู ฺฉ ุงุนูุงู ููุงุด ูโุฏูุฏ ฺฉู ูโฺฏูุฏ:

    ```output
    Detected an Azure Functions Project in folder "soil-moisture-trigger" that may have been created outside of
    VS Code. Initialize for optimal use with VS Code?
    ```

    ![ุงุนูุงู](../../../../../translated_images/vscode-azure-functions-init-notification.bd19b49229963edb5311fb3a79445ea469424759d2917ee2f2eb6f92d65d5086.fa.png)

    ฺฏุฒูู **Yes** ุฑุง ุงุฒ ุงู ุงุนูุงู ุงูุชุฎุงุจ ฺฉูุฏ.

1. ูุทูุฆู ุดูุฏ ฺฉู ูุญุท ูุฌุงุฒ Python ุฏุฑ ุชุฑููุงู VS Code ุงุฌุฑุง ุดุฏู ุงุณุช. ุฏุฑ ุตูุฑุช ูุงุฒ ุขู ุฑุง ูุชููู ฺฉุฑุฏู ู ุฏูุจุงุฑู ุฑุงูโุงูุฏุงุฒ ฺฉูุฏ.

## ุงุฌุงุฏ ฺฉ ูุญุฑฺฉ ุฑูุฏุงุฏ IoT Hub

ุจุฑูุงูู Functions ูพูุณุชูโุง ุจุฑุง ฺฉุฏ ุจุฏูู ุณุฑูุฑ ุดูุง ุงุณุช. ุจุฑุง ูพุงุณุฎ ุจู ุฑูุฏุงุฏูุง IoT Hubุ ูโุชูุงูุฏ ฺฉ ูุญุฑฺฉ IoT Hub ุจู ุงู ุจุฑูุงูู ุงุถุงูู ฺฉูุฏ. ุงู ูุญุฑฺฉ ุจุงุฏ ุจู ุฌุฑุงู ูพุงูโูุง ฺฉู ุจู IoT Hub ุงุฑุณุงู ูโุดููุฏ ูุชุตู ุดูุฏ ู ุจู ุขูโูุง ูพุงุณุฎ ุฏูุฏ. ุจุฑุง ุฏุฑุงูุช ุงู ุฌุฑุงู ูพุงูโูุงุ ูุญุฑฺฉ ุดูุง ุจุงุฏ ุจู *ููุทู ูพุงุงู ุณุงุฒฺฏุงุฑ ุจุง Event Hub* ุฏุฑ IoT Hub ูุชุตู ุดูุฏ.

IoT Hub ุจุฑ ุงุณุงุณ ฺฉ ุณุฑูุณ ุฏฺฏุฑ Azure ุจู ูุงู Azure Event Hubs ุณุงุฎุชู ุดุฏู ุงุณุช. Event Hubs ุณุฑูุณ ุงุณุช ฺฉู ุจู ุดูุง ุงูฺฉุงู ุงุฑุณุงู ู ุฏุฑุงูุช ูพุงูโูุง ุฑุง ูโุฏูุฏุ ู IoT Hub ุงู ูุงุจูุช ุฑุง ุจุฑุง ุฏุณุชฺฏุงูโูุง IoT ฺฏุณุชุฑุด ูโุฏูุฏ. ุฑูุด ุงุชุตุงู ุจุฑุง ุฎูุงูุฏู ูพุงูโูุง ุงุฒ IoT Hub ูุดุงุจู ุฑูุด ุงุณุชูุงุฏู ุงุฒ Event Hubs ุงุณุช.

โ ุชุญูู ฺฉูุฏ: ููุง ฺฉู Event Hubs ุฑุง ุฏุฑ [ูุณุชูุฏุงุช Azure Event Hubs](https://docs.microsoft.com/azure/event-hubs/event-hubs-about?WT.mc_id=academic-17441-jabenn) ุจุฎูุงูุฏ. ูฺฺฏโูุง ุงุตู ฺฺฏููู ุจุง IoT Hub ููุงุณู ูโุดููุฏุ

ุจุฑุง ุงูฺฉู ฺฉ ุฏุณุชฺฏุงู IoT ุจู IoT Hub ูุชุตู ุดูุฏุ ุจุงุฏ ุงุฒ ฺฉ ฺฉูุฏ ูุฎู ุงุณุชูุงุฏู ฺฉูุฏ ฺฉู ุงุทููุงู ุญุงุตู ฺฉูุฏ ููุท ุฏุณุชฺฏุงูโูุง ูุฌุงุฒ ูโุชูุงููุฏ ูุชุตู ุดููุฏ. ููู ุงูุฑ ููฺฏุงู ุงุชุตุงู ุจุฑุง ุฎูุงูุฏู ูพุงูโูุง ูุฒ ุตุฏู ูโฺฉูุฏุ ฺฉุฏ ุดูุง ุจู ฺฉ ุฑุดุชู ุงุชุตุงู ูุงุฒ ุฏุงุฑุฏ ฺฉู ุดุงูู ฺฉ ฺฉูุฏ ูุฎู ู ุฌุฒุฆุงุช IoT Hub ุจุงุดุฏ.

> ๐ ุฑุดุชู ุงุชุตุงู ูพุดโูุฑุถ ฺฉู ุฏุฑุงูุช ูโฺฉูุฏ ุฏุงุฑุง ูุฌูุฒูุง **iothubowner** ุงุณุชุ ฺฉู ุจู ูุฑ ฺฉุฏ ฺฉู ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูุฏ ูุฌูุฒ ฺฉุงูู ุฏุฑ IoT Hub ูโุฏูุฏ. ุงุฏูโุขู ุงู ุงุณุช ฺฉู ุจุง ูพุงูโุชุฑู ุณุทุญ ูุฌูุฒูุง ููุฑุฏ ูุงุฒ ูุชุตู ุดูุฏ. ุงู ููุถูุน ุฏุฑ ุฏุฑุณ ุจุนุฏ ูพูุดุด ุฏุงุฏู ุฎูุงูุฏ ุดุฏ.

ูพุณ ุงุฒ ุงุชุตุงู ูุญุฑฺฉุ ฺฉุฏ ุฏุงุฎู ุชุงุจุน ุจุฑุง ูุฑ ูพุงู ุงุฑุณุงู ุดุฏู ุจู IoT Hubุ ุตุฑู ูุธุฑ ุงุฒ ุงูฺฉู ฺฉุฏุงู ุฏุณุชฺฏุงู ุขู ุฑุง ุงุฑุณุงู ฺฉุฑุฏู ุงุณุชุ ูุฑุงุฎูุงู ูโุดูุฏ. ูพุงู ุจู ุนููุงู ฺฉ ูพุงุฑุงูุชุฑ ุจู ูุญุฑฺฉ ุงุฑุณุงู ูโุดูุฏ.

### ูุธูู - ุฏุฑุงูุช ุฑุดุชู ุงุชุตุงู ููุทู ูพุงุงู ุณุงุฒฺฏุงุฑ ุจุง Event Hub

1. ุงุฒ ุชุฑููุงู VS Code ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ ุชุง ุฑุดุชู ุงุชุตุงู ุจุฑุง ููุทู ูพุงุงู ุณุงุฒฺฏุงุฑ ุจุง Event Hub ุฏุฑ IoT Hub ุฏุฑุงูุช ุดูุฏ:

    ```sh
    az iot hub connection-string show --default-eventhub \
                                      --output table \
                                      --hub-name <hub_name>
    ```

    `<hub_name>` ุฑุง ุจุง ูุงู ฺฉู ุจุฑุง IoT Hub ุฎูุฏ ุงุณุชูุงุฏู ฺฉุฑุฏูโุงุฏ ุฌุงฺฏุฒู ฺฉูุฏ.

1. ุฏุฑ VS Codeุ ูุงู `local.settings.json` ุฑุง ุจุงุฒ ฺฉูุฏ. ููุฏุงุฑ ุฒุฑ ุฑุง ุฏุฑ ุจุฎุด `Values` ุงุถุงูู ฺฉูุฏ:

    ```json
    "IOT_HUB_CONNECTION_STRING": "<connection string>"
    ```

    `<connection string>` ุฑุง ุจุง ููุฏุงุฑ ูุฑุญูู ูุจู ุฌุงฺฏุฒู ฺฉูุฏ. ุจุฑุง ูุนุชุจุฑ ุจูุฏู JSONุ ุจุงุฏ ุจุนุฏ ุงุฒ ุฎุท ุจุงูุง ฺฉ ฺฉุงูุง ุงุถุงูู ฺฉูุฏ.

### ูุธูู - ุงุฌุงุฏ ฺฉ ูุญุฑฺฉ ุฑูุฏุงุฏ

ุงฺฉููู ุขูุงุฏู ุงุฌุงุฏ ูุญุฑฺฉ ุฑูุฏุงุฏ ูุณุชุฏ.

1. ุงุฒ ุชุฑููุงู VS Code ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฒ ุฏุงุฎู ูพูุดู `soil-moisture-trigger` ุงุฌุฑุง ฺฉูุฏ:

    ```sh
    func new --name iot-hub-trigger --template "Azure Event Hub trigger"
    ```

    ุงู ุฏุณุชูุฑ ฺฉ ุชุงุจุน ุฌุฏุฏ ุจู ูุงู `iot-hub-trigger` ุงุฌุงุฏ ูโฺฉูุฏ. ุงู ูุญุฑฺฉ ุจู ููุทู ูพุงุงู ุณุงุฒฺฏุงุฑ ุจุง Event Hub ุฏุฑ IoT Hub ูุชุตู ูโุดูุฏุ ุจูุงุจุฑุงู ูโุชูุงูุฏ ุงุฒ ฺฉ ูุญุฑฺฉ Event Hub ุงุณุชูุงุฏู ฺฉูุฏ. ูุญุฑฺฉ ุฎุงุต ุจุฑุง IoT Hub ูุฌูุฏ ูุฏุงุฑุฏ.

ุงู ุฏุณุชูุฑ ฺฉ ูพูุดู ุฏุงุฎู ูพูุดู `soil-moisture-trigger` ุจู ูุงู `iot-hub-trigger` ุงุฌุงุฏ ูโฺฉูุฏ ฺฉู ุดุงูู ุงู ุชุงุจุน ุงุณุช. ุงู ูพูุดู ูุงูโูุง ุฒุฑ ุฑุง ุฏุฑ ุฎูุฏ ุฏุงุฑุฏ:

* `__init__.py` - ุงู ูุงู ฺฉุฏ Python ุงุณุช ฺฉู ุดุงูู ูุญุฑฺฉ ุงุณุช ู ุงุฒ ูุงูโฺฏุฐุงุฑ ุงุณุชุงูุฏุงุฑุฏ ูุงูโูุง Python ุจุฑุง ุชุจุฏู ุงู ูพูุดู ุจู ฺฉ ูุงฺูู Python ุงุณุชูุงุฏู ูโฺฉูุฏ.

    ุงู ูุงู ุดุงูู ฺฉุฏ ุฒุฑ ุฎูุงูุฏ ุจูุฏ:

    ```python
    import logging

    import azure.functions as func


    def main(event: func.EventHubEvent):
        logging.info('Python EventHub trigger processed an event: %s',
                    event.get_body().decode('utf-8'))
    ```

    ูุณุชู ูุญุฑฺฉ ุชุงุจุน `main` ุงุณุช. ุงู ุชุงุจุน ุจุง ุฑูุฏุงุฏูุง IoT Hub ูุฑุงุฎูุงู ูโุดูุฏ. ุงู ุชุงุจุน ฺฉ ูพุงุฑุงูุชุฑ ุจู ูุงู `event` ุฏุงุฑุฏ ฺฉู ุดุงูู ฺฉ `EventHubEvent` ุงุณุช. ูุฑ ุจุงุฑ ฺฉู ูพุงู ุจู IoT Hub ุงุฑุณุงู ูโุดูุฏุ ุงู ุชุงุจุน ูุฑุงุฎูุงู ุดุฏู ู ูพุงู ุจู ุนููุงู `event` ููุฑุงู ุจุง ูฺฺฏโูุง ฺฉู ูุดุงุจู ุชูุถุญุงุช ุฏุฑุณ ูุจู ูุณุชูุฏุ ุงุฑุณุงู ูโุดูุฏ.

    ูุณุชู ุงู ุชุงุจุน ุฑูุฏุงุฏ ุฑุง ุซุจุช ูโฺฉูุฏ.

* `function.json` - ุงู ูุงู ุดุงูู ุชูุธูุงุช ูุญุฑฺฉ ุงุณุช. ุชูุธูุงุช ุงุตู ุฏุฑ ุจุฎุด ุจู ูุงู `bindings` ูุฑุงุฑ ุฏุงุฑุฏ. ฺฉ binding ุจู ูุนูุง ุงุชุตุงู ุจู Azure Functions ู ุณุงุฑ ุณุฑูุณโูุง Azure ุงุณุช. ุงู ุชุงุจุน ฺฉ binding ูุฑูุฏ ุจู ฺฉ Event Hub ุฏุงุฑุฏ - ุจู Event Hub ูุชุตู ุดุฏู ู ุฏุงุฏู ุฏุฑุงูุช ูโฺฉูุฏ.

    > ๐ ุดูุง ููฺูู ูโุชูุงูุฏ bindingโูุง ุฎุฑูุฌ ุฏุงุดุชู ุจุงุดุฏ ุชุง ุฎุฑูุฌ ฺฉ ุชุงุจุน ุจู ุณุฑูุณ ุฏฺฏุฑ ุงุฑุณุงู ุดูุฏ. ุจู ุนููุงู ูุซุงูุ ูโุชูุงูุฏ ฺฉ binding ุฎุฑูุฌ ุจู ฺฉ ูพุงฺฏุงู ุฏุงุฏู ุงุถุงูู ฺฉูุฏ ู ุฑูุฏุงุฏ IoT Hub ุฑุง ุงุฒ ุชุงุจุน ุจุงุฒฺฏุฑุฏุงูุฏุ ู ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุฏุฑุฌ ุดูุฏ.

    โ ุชุญูู ฺฉูุฏ: ุฏุฑุจุงุฑู bindingโูุง ุฏุฑ [ูุณุชูุฏุงุช ููุงูู ูุญุฑฺฉโูุง ู bindingโูุง Azure Functions](https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?WT.mc_id=academic-17441-jabenn&tabs=python) ูุทุงูุนู ฺฉูุฏ.

    ุจุฎุด `bindings` ุดุงูู ุชูุธูุงุช binding ุงุณุช. ููุงุฏุฑ ููู ุนุจุงุฑุชูุฏ ุงุฒ:

  * `"type": "eventHubTrigger"` - ุงู ููุฏุงุฑ ุจู ุชุงุจุน ูโฺฏูุฏ ฺฉู ุจุงุฏ ุจู ุฑูุฏุงุฏูุง Event Hub ฺฏูุด ุฏูุฏ.
  * `"name": "events"` - ุงู ูุงู ูพุงุฑุงูุชุฑ ุจุฑุง ุฑูุฏุงุฏูุง Event Hub ุงุณุช. ุงู ููุฏุงุฑ ุจุง ูุงู ูพุงุฑุงูุชุฑ ุฏุฑ ุชุงุจุน `main` ุฏุฑ ฺฉุฏ Python ูุทุงุจูุช ุฏุงุฑุฏ.
  * `"direction": "in"` - ุงู ฺฉ binding ูุฑูุฏ ุงุณุชุ ุฏุงุฏู ุงุฒ Event Hub ูุงุฑุฏ ุชุงุจุน ูโุดูุฏ.
  * `"connection": ""` - ุงู ููุฏุงุฑ ูุงู ุชูุธูุงุช ุฑุง ุชุนุฑู ูโฺฉูุฏ ฺฉู ุฑุดุชู ุงุชุตุงู ุงุฒ ุขู ุฎูุงูุฏู ูโุดูุฏ. ููฺฏุงู ุงุฌุฑุง ูุญูุ ุงู ุชูุธู ุงุฒ ูุงู `local.settings.json` ุฎูุงูุฏู ูโุดูุฏ.

    > ๐ ุฑุดุชู ุงุชุตุงู ููโุชูุงูุฏ ุฏุฑ ูุงู `function.json` ุฐุฎุฑู ุดูุฏุ ุจูฺฉู ุจุงุฏ ุงุฒ ุชูุธูุงุช ุฎูุงูุฏู ุดูุฏ. ุงู ฺฉุงุฑ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงูุดุง ุชุตุงุฏู ุฑุดุชู ุงุชุตุงู ุงูุฌุงู ูโุดูุฏ.

1. ุจู ุฏูู [ฺฉ ุจุงฺฏ ุฏุฑ ูุงูุจ Azure Functions](https://github.com/Azure/azure-functions-templates/issues/1250)ุ ููุฏุงุฑ `cardinality` ุฏุฑ ูุงู `function.json` ุงุดุชุจุงู ุงุณุช. ุงู ููุฏุงุฑ ุฑุง ุงุฒ `many` ุจู `one` ุชุบุฑ ุฏูุฏ:

    ```json
    "cardinality": "one",
    ```

1. ููุฏุงุฑ `"connection"` ุฏุฑ ูุงู `function.json` ุฑุง ุจู ููุฏุงุฑ ุฌุฏุฏ ฺฉู ุจู ูุงู `local.settings.json` ุงุถุงูู ฺฉุฑุฏูโุงุฏุ ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ:

    ```json
    "connection": "IOT_HUB_CONNECTION_STRING",
    ```

    > ๐ ุจู ุงุฏ ุฏุงุดุชู ุจุงุดุฏ - ุงู ููุฏุงุฑ ุจุงุฏ ุจู ุชูุธูุงุช ุงุดุงุฑู ฺฉูุฏุ ูู ุงูฺฉู ุฑุดุชู ุงุชุตุงู ูุงูุน ุฑุง ุดุงูู ุดูุฏ.

1. ุฑุดุชู ุงุชุตุงู ุดุงูู ููุฏุงุฑ `eventHubName` ุงุณุชุ ุจูุงุจุฑุงู ููุฏุงุฑ ุงู ููุฏ ุฏุฑ ูุงู `function.json` ุจุงุฏ ุฎุงู ุดูุฏ. ุงู ููุฏุงุฑ ุฑุง ุจู ฺฉ ุฑุดุชู ุฎุงู ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ:

    ```json
    "eventHubName": "",
    ```

### ูุธูู - ุงุฌุฑุง ูุญุฑฺฉ ุฑูุฏุงุฏ

1. ูุทูุฆู ุดูุฏ ฺฉู ูุงูุชูุฑ ุฑูุฏุงุฏ IoT Hub ุงุฌุฑุง ููโุดูุฏ. ุงฺฏุฑ ุงู ุจุฑูุงูู ููุฒูุงู ุจุง ุจุฑูุงูู Functions ุงุฌุฑุง ุดูุฏุ ุจุฑูุงูู Functions ููโุชูุงูุฏ ูุชุตู ุดุฏู ู ุฑูุฏุงุฏูุง ุฑุง ูุตุฑู ฺฉูุฏ.

    > ๐ ฺูุฏู ุจุฑูุงูู ูโุชูุงููุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ *ฺฏุฑููโูุง ูุตุฑูโฺฉููุฏู* ูุฎุชูู ุจู ููุงุท ูพุงุงู IoT Hub ูุชุตู ุดููุฏ. ุงู ููุถูุน ุฏุฑ ุฏุฑุณ ุจุนุฏ ูพูุดุด ุฏุงุฏู ุฎูุงูุฏ ุดุฏ.

1. ุจุฑุง ุงุฌุฑุง ุจุฑูุงูู Functionsุ ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฒ ุชุฑููุงู VS Code ุงุฌุฑุง ฺฉูุฏ:

    ```sh
    func start
    ```

    ุจุฑูุงูู Functions ุฑุงูโุงูุฏุงุฒ ุดุฏู ู ุชุงุจุน `iot-hub-trigger` ุฑุง ุดูุงุณุง ูโฺฉูุฏ. ุณูพุณ ูุฑ ุฑูุฏุงุฏ ฺฉู ุฏุฑ ุฑูุฒ ฺฏุฐุดุชู ุจู IoT Hub ุงุฑุณุงู ุดุฏู ุจุงุดุฏ ุฑุง ูพุฑุฏุงุฒุด ูโฺฉูุฏ.

    ```output
    (.venv) โ  soil-moisture-trigger func start
    Found Python version 3.9.1 (python3).
    
    Azure Functions Core Tools
    Core Tools Version:       3.0.3442 Commit hash: 6bfab24b2743f8421475d996402c398d2fe4a9e0  (64-bit)
    Function Runtime Version: 3.0.15417.0
    
    Functions:
    
            iot-hub-trigger: eventHubTrigger
    
    For detailed output, run func with --verbose flag.
    [2021-05-05T02:44:07.517Z] Worker process started and initialized.
    [2021-05-05T02:44:09.202Z] Executing 'Functions.iot-hub-trigger' (Reason='(null)', Id=802803a5-eae9-4401-a1f4-176631456ce4)
    [2021-05-05T02:44:09.205Z] Trigger Details: PartitionId: 0, Offset: 1011240-1011632, EnqueueTimeUtc: 2021-05-04T19:04:04.2030000Z-2021-05-04T19:04:04.3900000Z, SequenceNumber: 2546-2547, Count: 2
    [2021-05-05T02:44:09.352Z] Python EventHub trigger processed an event: {"soil_moisture":628}
    [2021-05-05T02:44:09.354Z] Python EventHub trigger processed an event: {"soil_moisture":624}
    [2021-05-05T02:44:09.395Z] Executed 'Functions.iot-hub-trigger' (Succeeded, Id=802803a5-eae9-4401-a1f4-176631456ce4, Duration=245ms)
    ```

    ูุฑ ูุฑุงุฎูุงู ุจู ุชุงุจุน ุจุง ฺฉ ุจููฺฉ `Executing 'Functions.iot-hub-trigger'`/`Executed 'Functions.iot-hub-trigger'` ุฏุฑ ุฎุฑูุฌ ุงุญุงุทู ุดุฏู ุงุณุชุ ุจูุงุจุฑุงู ูโุชูุงูุฏ ุจุจูุฏ ฺฉู ุฏุฑ ูุฑ ูุฑุงุฎูุงู ุชุงุจุน ฺูุฏ ูพุงู ูพุฑุฏุงุฒุด ุดุฏู ุงุณุช.

1. ูุทูุฆู ุดูุฏ ฺฉู ุฏุณุชฺฏุงู IoT ุดูุง ุงุฌุฑุง ูโุดูุฏ. ูพุงูโูุง ุฌุฏุฏ ุฑุทูุจุช ุฎุงฺฉ ุฑุง ุฏุฑ ุจุฑูุงูู Functions ูุดุงูุฏู ุฎูุงูุฏ ฺฉุฑุฏ.

1. ุจุฑูุงูู Functions ุฑุง ูุชููู ฺฉุฑุฏู ู ุฏูุจุงุฑู ุฑุงูโุงูุฏุงุฒ ฺฉูุฏ. ุฎูุงูุฏ ุฏุฏ ฺฉู ูพุงูโูุง ูุจู ุฏูุจุงุฑู ูพุฑุฏุงุฒุด ููโุดููุฏ ู ููุท ูพุงูโูุง ุฌุฏุฏ ูพุฑุฏุงุฒุด ูโุดููุฏ.

> ๐ VS Code ููฺูู ุงุฒ ุงุดฺฉุงูโุฒุฏุง ุชูุงุจุน ุดูุง ูพุดุชุจุงู ูโฺฉูุฏ. ูโุชูุงูุฏ ููุงุท ุชููู ุฑุง ุจุง ฺฉูฺฉ ุฑู ุญุงุดู ฺฉูุงุฑ ุดุฑูุน ูุฑ ุฎุท ฺฉุฏุ ุง ูุฑุงุฑ ุฏุงุฏู ูุดุงูฺฏุฑ ุฑู ฺฉ ุฎุท ฺฉุฏ ู ุงูุชุฎุงุจ *Run -> Toggle breakpoint*ุ ุง ูุดุงุฑ ุฏุงุฏู `F9` ุชูุธู ฺฉูุฏ. ูโุชูุงูุฏ ุงุดฺฉุงูโุฒุฏุง ุฑุง ุจุง ุงูุชุฎุงุจ *Run -> Start debugging*ุ ูุดุงุฑ ุฏุงุฏู `F5`ุ ุง ุงูุชุฎุงุจ ูพูู *Run and debug* ู ุงูุชุฎุงุจ ุฏฺฉูู **Start debugging** ุฑุงูโุงูุฏุงุฒ ฺฉูุฏ. ุจุง ุงู ฺฉุงุฑ ูโุชูุงูุฏ ุฌุฒุฆุงุช ุฑูุฏุงุฏูุง ูพุฑุฏุงุฒุด ุดุฏู ุฑุง ูุดุงูุฏู ฺฉูุฏ.

#### ุฑูุน ุงุดฺฉุงู

* ุงฺฏุฑ ุฎุทุง ุฒุฑ ุฑุง ุฏุฑุงูุช ฺฉุฑุฏุฏ:

    ```output
    The listener for function 'Functions.iot-hub-trigger' was unable to start. Microsoft.WindowsAzure.Storage: Connection refused. System.Net.Http: Connection refused. System.Private.CoreLib: Connection refused.
    ```

    ุจุฑุฑุณ ฺฉูุฏ ฺฉู Azurite ุงุฌุฑุง ุดุฏู ู ููุฏุงุฑ `AzureWebJobsStorage` ุฏุฑ ูุงู `local.settings.json` ุจู `UseDevelopmentStorage=true` ุชูุธู ุดุฏู ุจุงุดุฏ.

* ุงฺฏุฑ ุฎุทุง ุฒุฑ ุฑุง ุฏุฑุงูุช ฺฉุฑุฏุฏ:

    ```output
    System.Private.CoreLib: Exception while executing function: Functions.iot-hub-trigger. System.Private.CoreLib: Result: Failure Exception: AttributeError: 'list' object has no attribute 'get_body'
    ```

    ุจุฑุฑุณ ฺฉูุฏ ฺฉู ููุฏุงุฑ `cardinality` ุฏุฑ ูุงู `function.json` ุจู `one` ุชูุธู ุดุฏู ุจุงุดุฏ.

* ุงฺฏุฑ ุฎุทุง ุฒุฑ ุฑุง ุฏุฑุงูุช ฺฉุฑุฏุฏ:

    ```output
    Azure.Messaging.EventHubs: The path to an Event Hub may be specified as part of the connection string or as a separate value, but not both.  Please verify that your connection string does not have the `EntityPath` token if you are passing an explicit Event Hub name. (Parameter 'connectionString').
    ```

    ุจุฑุฑุณ ฺฉูุฏ ฺฉู ููุฏุงุฑ `eventHubName` ุฏุฑ ูุงู `function.json` ุจู ฺฉ ุฑุดุชู ุฎุงู ุชูุธู ุดุฏู ุจุงุดุฏ.

## ุงุฑุณุงู ุฏุฑุฎูุงุณุชโูุง ุฑูุด ูุณุชูู ุงุฒ ฺฉุฏ ุจุฏูู ุณุฑูุฑ

ุชุง ุงูุฌุง ุจุฑูุงูู Functions ุดูุง ูพุงูโูุง ุฑุง ุงุฒ IoT Hub ุจุง ุงุณุชูุงุฏู ุงุฒ ููุทู ูพุงุงู ุณุงุฒฺฏุงุฑ ุจุง Event Hub ุฏุฑุงูุช ูโฺฉูุฏ. ุงฺฉููู ุจุงุฏ ุฏุณุชูุฑุงุช ุฑุง ุจู ุฏุณุชฺฏุงู IoT ุงุฑุณุงู ฺฉูุฏ. ุงู ฺฉุงุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ ุงุชุตุงู ูุชูุงูุช ุจู IoT Hub ุงุฒ ุทุฑู *Registry Manager* ุงูุฌุงู ูโุดูุฏ. Registry Manager ุงุจุฒุงุฑ ุงุณุช ฺฉู ุจู ุดูุง ุงูฺฉุงู ูโุฏูุฏ ุจุจูุฏ ฺู ุฏุณุชฺฏุงูโูุง ุฏุฑ IoT Hub ุซุจุช ุดุฏูโุงูุฏ ู ุจุง ุขูโูุง ุงุฑุชุจุงุท ุจุฑูุฑุงุฑ ฺฉูุฏุ ุงุฒ ุฌููู ุงุฑุณุงู ูพุงูโูุง cloud-to-deviceุ ุฏุฑุฎูุงุณุชโูุง ุฑูุด ูุณุชูู ุง ุจูโุฑูุฒุฑุณุงู ุฏุณุชฺฏุงู twin. ููฺูู ูโุชูุงูุฏ ุงุฒ ุขู ุจุฑุง ุซุจุชุ ุจูโุฑูุฒุฑุณุงู ุง ุญุฐู ุฏุณุชฺฏุงูโูุง IoT ุงุฒ IoT Hub ุงุณุชูุงุฏู ฺฉูุฏ.

ุจุฑุง ุงุชุตุงู ุจู Registry Managerุ ุจู ฺฉ ุฑุดุชู ุงุชุตุงู ูุงุฒ ุฏุงุฑุฏ.

### ูุธูู - ุฏุฑุงูุช ุฑุดุชู ุงุชุตุงู Registry Manager

1. ุจุฑุง ุฏุฑุงูุช ุฑุดุชู ุงุชุตุงูุ ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ:

    ```sh
    az iot hub connection-string show --policy-name service \
                                      --output table \
                                      --hub-name <hub_name>
    ```

    `<hub_name>` ุฑุง ุจุง ูุงู ฺฉู ุจุฑุง IoT Hub ุฎูุฏ ุงุณุชูุงุฏู ฺฉุฑุฏูโุงุฏ ุฌุงฺฏุฒู ฺฉูุฏ.

    ุฑุดุชู ุงุชุตุงู ุจุฑุง ุณุงุณุช *ServiceConnect* ุจุง ุงุณุชูุงุฏู ุงุฒ ูพุงุฑุงูุชุฑ `--policy-name service` ุฏุฑุฎูุงุณุช ูโุดูุฏ. ููฺฏุงู ุฏุฑุฎูุงุณุช ุฑุดุชู ุงุชุตุงูุ ูโุชูุงูุฏ ูุดุฎุต ฺฉูุฏ ฺฉู ุงู ุฑุดุชู ุงุชุตุงู ฺู ูุฌูุฒูุง ุฑุง ุงุฌุงุฒู ูโุฏูุฏ. ุณุงุณุช ServiceConnect ุจู ฺฉุฏ ุดูุง ุงุฌุงุฒู ูโุฏูุฏ ูุชุตู ุดุฏู ู ูพุงูโูุง ุฑุง ุจู ุฏุณุชฺฏุงูโูุง IoT ุงุฑุณุงู ฺฉูุฏ.

    โ ุชุญูู ฺฉูุฏ: ุฏุฑุจุงุฑู ุณุงุณุชโูุง ูุฎุชูู ุฏุฑ [ูุณุชูุฏุงุช ูุฌูุฒูุง IoT Hub](https://docs.microsoft.com/azure/iot-hub/iot-hub-devguide-security#iot-hub-permissions?WT.mc_id=academic-17441-jabenn) ูุทุงูุนู ฺฉูุฏ.

1. ุฏุฑ VS Codeุ ูุงู `local.settings.json` ุฑุง ุจุงุฒ ฺฉูุฏ. ููุฏุงุฑ ุฒุฑ ุฑุง ุฏุฑ ุจุฎุด `Values` ุงุถุงูู ฺฉูุฏ:

    ```json
    "REGISTRY_MANAGER_CONNECTION_STRING": "<connection string>"
    ```

    `<connection string>` ุฑุง ุจุง ููุฏุงุฑ ูุฑุญูู ูุจู ุฌุงฺฏุฒู ฺฉูุฏ. ุจุฑุง ูุนุชุจุฑ ุจูุฏู JSONุ ุจุงุฏ ุจุนุฏ ุงุฒ ุฎุท ุจุงูุง ฺฉ ฺฉุงูุง ุงุถุงูู ฺฉูุฏ.

### ูุธูู - ุงุฑุณุงู ุฏุฑุฎูุงุณุช ุฑูุด ูุณุชูู ุจู ฺฉ ุฏุณุชฺฏุงู

1. SDK ุจุฑุง Registry Manager ุงุฒ ุทุฑู ฺฉ ุจุณุชู Pip ุฏุฑ ุฏุณุชุฑุณ ุงุณุช. ุฎุท ุฒุฑ ุฑุง ุจู ูุงู `requirements.txt` ุงุถุงูู ฺฉูุฏ ุชุง ูุงุจุณุชฺฏ ุจู ุงู ุจุณุชู ุงุถุงูู ุดูุฏ:

    ```sh
    azure-iot-hub
    ```

1. ูุทูุฆู ุดูุฏ ฺฉู ุชุฑููุงู VS Code ูุญุท ูุฌุงุฒ ุฑุง ูุนุงู ฺฉุฑุฏู ุงุณุช ู ุฏุณุชูุฑ ุฒุฑ ุฑุง ุจุฑุง ูุตุจ ุจุณุชูโูุง Pip ุงุฌุฑุง ฺฉูุฏ:

    ```sh
    pip install -r requirements.txt
    ```

1. ูุงุฑุฏุงุช ุฒุฑ ุฑุง ุจู ูุงู `__init__.py` ุงุถุงูู ฺฉูุฏ:

    ```python
    import json
    import os
    from azure.iot.hub import IoTHubRegistryManager
    from azure.iot.hub.models import CloudToDeviceMethod
    ```

    ุงู ูุงุฑุฏุงุช ุดุงูู ุจุฑุฎ ฺฉุชุงุจุฎุงููโูุง ุณุณุชู ู ููฺูู ฺฉุชุงุจุฎุงููโูุง ุจุฑุง ุชุนุงูู ุจุง Registry Manager ู ุงุฑุณุงู ุฏุฑุฎูุงุณุชโูุง ุฑูุด ูุณุชูู ุงุณุช.

1. ฺฉุฏ ุฏุงุฎู ูุชุฏ `main` ุฑุง ุญุฐู ฺฉูุฏุ ุงูุง ุฎูุฏ ูุชุฏ ุฑุง ูฺฏู ุฏุงุฑุฏ.

1. ฺฉุฏ ุฒุฑ ุฑุง ุจู ูุชุฏ `main` ุงุถุงูู ฺฉูุฏ:

    ```python
    body = json.loads(event.get_body().decode('utf-8'))
    device_id = event.iothub_metadata['connection-device-id']

    logging.info(f'Received message: {body} from {device_id}')
    ```

    ุงู ฺฉุฏ ุจุฏูู ุฑูุฏุงุฏ ุฑุง ุงุณุชุฎุฑุงุฌ ูโฺฉูุฏ ฺฉู ุดุงูู ูพุงู JSON ุงุฑุณุงู ุดุฏู ุชูุณุท ุฏุณุชฺฏุงู IoT ุงุณุช.

    ุณูพุณ ุดูุงุณู ุฏุณุชฺฏุงู ุฑุง ุงุฒ ุชูุถุญุงุช ุงุฑุณุงู ุดุฏู ุจุง ูพุงู ุฏุฑุงูุช ูโฺฉูุฏ. ุจุฏูู ุฑูุฏุงุฏ ุดุงูู ูพุงู ุงุฑุณุงู ุดุฏู ุจู ุนููุงู telemetry ุงุณุชุ ู ุฏฺฉุดูุฑ `iothub_metadata` ุดุงูู ูฺฺฏโูุง ุงุณุช ฺฉู ุชูุณุท IoT Hub ุชูุธู ุดุฏูโุงูุฏุ ูุงููุฏ ุดูุงุณู ุฏุณุชฺฏุงู ูุฑุณุชูุฏู ู ุฒูุงู ุงุฑุณุงู ูพุงู.

    ุงู ุงุทูุงุนุงุช ุณูพุณ ุซุจุช ูโุดูุฏ. ุงู ุซุจุช ุฏุฑ ุชุฑููุงู ููฺฏุงู ุงุฌุฑุง ุจุฑูุงูู Functions ุจู ุตูุฑุช ูุญู ูุงุจู ูุดุงูุฏู ุฎูุงูุฏ ุจูุฏ.

1. ฺฉุฏ ุฒุฑ ุฑุง ุฏุฑ ุฒุฑ ุงู ุจุฎุด ุงุถุงูู ฺฉูุฏ:

    ```python
    soil_moisture = body['soil_moisture']

    if soil_moisture > 450:
        direct_method = CloudToDeviceMethod(method_name='relay_on', payload='{}')
    else:
        direct_method = CloudToDeviceMethod(method_name='relay_off', payload='{}')
    ```

    ุงู ฺฉุฏ ุฑุทูุจุช ุฎุงฺฉ ุฑุง ุงุฒ ูพุงู ุฏุฑุงูุช ูโฺฉูุฏ. ุณูพุณ ุฑุทูุจุช ุฎุงฺฉ ุฑุง ุจุฑุฑุณ ฺฉุฑุฏู ู ุจุณุชู ุจู ููุฏุงุฑ ุขูุ ฺฉ ฺฉูุงุณ ฺฉูฺฉ ุจุฑุง ุฏุฑุฎูุงุณุช ุฑูุด ูุณุชูู ุจุฑุง ุฑูุดโูุง `relay_on` ุง `relay_off` ุงุฌุงุฏ ูโฺฉูุฏ. ุฏุฑุฎูุงุณุช ุฑูุด ูุงุฒ ุจู payload ูุฏุงุฑุฏุ ุจูุงุจุฑุงู ฺฉ ุณูุฏ JSON ุฎุงู ุงุฑุณุงู ูโุดูุฏ.

1. ฺฉุฏ ุฒุฑ ุฑุง ุฏุฑ ุฒุฑ ุงู ุจุฎุด ุงุถุงูู ฺฉูุฏ:

    ```python
    logging.info(f'Sending direct method request for {direct_method.method_name} for device {device_id}')

    registry_manager_connection_string = os.environ['REGISTRY_MANAGER_CONNECTION_STRING']
    registry_manager = IoTHubRegistryManager(registry_manager_connection_string)
    ```
ุงู ฺฉุฏ `REGISTRY_MANAGER_CONNECTION_STRING` ุฑุง ุงุฒ ูุงู `local.settings.json` ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ. ููุงุฏุฑ ููุฌูุฏ ุฏุฑ ุงู ูุงู ุจู ุนููุงู ูุชุบุฑูุง ูุญุท ุฏุฑ ุฏุณุชุฑุณ ูุฑุงุฑ ูโฺฏุฑูุฏ ู ูโุชูุงู ุขูโูุง ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน `os.environ` ุฎูุงูุฏุ ุชุงุจุน ฺฉู ฺฉ ุฏฺฉุดูุฑ ุงุฒ ุชูุงู ูุชุบุฑูุง ูุญุท ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.

๐ ููุช ุงู ฺฉุฏ ุฏุฑ ูุถุง ุงุจุฑ ูุณุชูุฑ ุดูุฏุ ููุงุฏุฑ ููุฌูุฏ ุฏุฑ ูุงู `local.settings.json` ุจู ุนููุงู *ุชูุธูุงุช ุจุฑูุงูู* ุชูุธู ูโุดููุฏ ู ูโุชูุงู ุขูโูุง ุฑุง ุงุฒ ูุชุบุฑูุง ูุญุท ุฎูุงูุฏ.

ุณูพุณ ฺฉุฏ ฺฉ ููููู ุงุฒ ฺฉูุงุณ ฺฉูฺฉ Registry Manager ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฑุดุชู ุงุชุตุงู ุงุฌุงุฏ ูโฺฉูุฏ.

1. ฺฉุฏ ุฒุฑ ุฑุง ุงุถุงูู ฺฉูุฏ:

    ```python
    registry_manager.invoke_device_method(device_id, direct_method)

    logging.info('Direct method request sent!')
    ```

ุงู ฺฉุฏ ุจู ูุฏุฑ ุฑุฌุณุชุฑ ูโฺฏูุฏ ฺฉู ุฏุฑุฎูุงุณุช ุฑูุด ูุณุชูู ุฑุง ุจู ุฏุณุชฺฏุงู ฺฉู ุฏุงุฏูโูุง ุชููโูุชุฑ ุงุฑุณุงู ฺฉุฑุฏู ุงุณุชุ ุงุฑุณุงู ฺฉูุฏ.

๐ ุฏุฑ ูุณุฎูโูุง ูุจู ุจุฑูุงูู ฺฉู ุฏุฑ ุฏุฑุณโูุง ูุจู ุจุง ุงุณุชูุงุฏู ุงุฒ MQTT ุงุฌุงุฏ ฺฉุฑุฏุฏุ ุฏุณุชูุฑุงุช ฺฉูุชุฑู ุฑูู ุจู ููู ุฏุณุชฺฏุงูโูุง ุงุฑุณุงู ูโุดุฏ. ฺฉุฏ ูุฑุถ ูโฺฉุฑุฏ ฺฉู ููุท ฺฉ ุฏุณุชฺฏุงู ุฏุงุฑุฏ. ุงู ูุณุฎู ุงุฒ ฺฉุฏ ุฏุฑุฎูุงุณุช ุฑูุด ุฑุง ุจู ฺฉ ุฏุณุชฺฏุงู ุงุฑุณุงู ูโฺฉูุฏุ ุจูุงุจุฑุงู ุงฺฏุฑ ฺูุฏู ูุฌููุนู ุงุฒ ุญุณฺฏุฑูุง ุฑุทูุจุช ู ุฑูู ุฏุงุดุชู ุจุงุดุฏุ ุฏุฑุฎูุงุณุช ุฑูุด ูุณุชูู ููุงุณุจ ุฑุง ุจู ุฏุณุชฺฏุงู ููุงุณุจ ุงุฑุณุงู ูโฺฉูุฏ.

1. ุจุฑูุงูู Functions ุฑุง ุงุฌุฑุง ฺฉูุฏ ู ูุทูุฆู ุดูุฏ ฺฉู ุฏุณุชฺฏุงู IoT ุดูุง ุฏุฑ ุญุงู ุงุฑุณุงู ุฏุงุฏู ุงุณุช. ูพุงูโูุง ูพุฑุฏุงุฒุด ุดุฏู ู ุฏุฑุฎูุงุณุชโูุง ุฑูุด ูุณุชูู ุงุฑุณุงู ุฎูุงููุฏ ุดุฏ. ุญุณฺฏุฑ ุฑุทูุจุช ุฎุงฺฉ ุฑุง ุฏุงุฎู ู ุฎุงุฑุฌ ุฎุงฺฉ ุญุฑฺฉุช ุฏูุฏ ุชุง ุชุบุฑ ููุงุฏุฑ ู ุฑูุดู ู ุฎุงููุด ุดุฏู ุฑูู ุฑุง ูุดุงูุฏู ฺฉูุฏ.

๐ ูโุชูุงูุฏ ุงู ฺฉุฏ ุฑุง ุฏุฑ ูพูุดู [code/functions](../../../../../2-farm/lessons/5-migrate-application-to-the-cloud/code/functions) ูพุฏุง ฺฉูุฏ.

## ุงุณุชูุฑุงุฑ ฺฉุฏ ุจุฏูู ุณุฑูุฑ ุฏุฑ ูุถุง ุงุจุฑ

ฺฉุฏ ุดูุง ุงฺฉููู ุจู ุตูุฑุช ูุญู ฺฉุงุฑ ูโฺฉูุฏุ ุจูุงุจุฑุงู ูุฑุญูู ุจุนุฏ ุงุณุชูุฑุงุฑ ุจุฑูุงูู Functions ุฏุฑ ูุถุง ุงุจุฑ ุงุณุช.

### ูุธูู - ุงุฌุงุฏ ููุงุจุน ุงุจุฑ

ุจุฑูุงูู Functions ุดูุง ุจุงุฏ ุฏุฑ ฺฉ ููุจุน Functions App ุฏุฑ Azure ูุณุชูุฑ ุดูุฏ ฺฉู ุฏุฑ ุฏุงุฎู ฺฏุฑูู ููุงุจุน ฺฉู ุจุฑุง IoT Hub ุฎูุฏ ุงุฌุงุฏ ฺฉุฑุฏูโุงุฏ ูุฑุงุฑ ุฏุงุฑุฏ. ููฺูู ุจู ฺฉ ุญุณุงุจ ุฐุฎุฑูโุณุงุฒ ุฏุฑ Azure ูุงุฒ ุฏุงุฑุฏ ุชุง ุฌุงฺฏุฒู ุญุณุงุจ ุดุจูโุณุงุฒ ุดุฏูโุง ุดูุฏ ฺฉู ุจู ุตูุฑุช ูุญู ุงุฌุฑุง ูโฺฉูุฏ.

1. ุฏุณุชูุฑ ุฒุฑ ุฑุง ุจุฑุง ุงุฌุงุฏ ฺฉ ุญุณุงุจ ุฐุฎุฑูโุณุงุฒ ุงุฌุฑุง ฺฉูุฏ:

    ```sh
    az storage account create --resource-group soil-moisture-sensor \
                              --sku Standard_LRS \
                              --name <storage_name> 
    ```

    `<storage_name>` ุฑุง ุจุง ฺฉ ูุงู ุจุฑุง ุญุณุงุจ ุฐุฎุฑูโุณุงุฒ ุฎูุฏ ุฌุงฺฏุฒู ฺฉูุฏ. ุงู ูุงู ุจุงุฏ ุจู ุตูุฑุช ุฌูุงู ููุญุตุฑ ุจู ูุฑุฏ ุจุงุดุฏ ุฒุฑุง ุจุฎุด ุงุฒ URL ููุฑุฏ ุงุณุชูุงุฏู ุจุฑุง ุฏุณุชุฑุณ ุจู ุญุณุงุจ ุฐุฎุฑูโุณุงุฒ ุฑุง ุชุดฺฉู ูโุฏูุฏ. ููุท ูโุชูุงูุฏ ุงุฒ ุญุฑูู ฺฉูฺฺฉ ู ุงุนุฏุงุฏ ุจุฑุง ุงู ูุงู ุงุณุชูุงุฏู ฺฉูุฏุ ูฺ ฺฉุงุฑุงฺฉุชุฑ ุฏฺฏุฑ ูุฌุงุฒ ูุณุช ู ูุญุฏูุฏ ุจู 24 ฺฉุงุฑุงฺฉุชุฑ ุงุณุช. ุงุฒ ฺุฒ ูุงููุฏ `sms` ุงุณุชูุงุฏู ฺฉูุฏ ู ฺฉ ุดูุงุณู ููุญุตุฑ ุจู ูุฑุฏ ุจู ุงูุชูุง ุขู ุงุถุงูู ฺฉูุฏุ ูุงููุฏ ฺูุฏ ฺฉููู ุชุตุงุฏู ุง ูุงู ุฎูุฏ.

    ฺฏุฒูู `--sku Standard_LRS` ุณุทุญ ููุชโฺฏุฐุงุฑ ุฑุง ุงูุชุฎุงุจ ูโฺฉูุฏ ู ฺฉูโูุฒููโุชุฑู ุญุณุงุจ ุนููู ุฑุง ุงูุชุฎุงุจ ูโฺฉูุฏ. ูฺ ุณุทุญ ุฑุงฺฏุงู ุจุฑุง ุฐุฎุฑูโุณุงุฒ ูุฌูุฏ ูุฏุงุฑุฏ ู ุดูุง ุจุฑุง ุขูฺู ุงุณุชูุงุฏู ูโฺฉูุฏ ูุฒูู ูพุฑุฏุงุฎุช ูโฺฉูุฏ. ูุฒููโูุง ูุณุจุชุงู ูพุงู ูุณุชูุฏุ ุจุง ฺฏุฑุงูโุชุฑู ุฐุฎุฑูโุณุงุฒ ฺฉูุชุฑ ุงุฒ 0.05 ุฏูุงุฑ ุขูุฑฺฉุง ุฏุฑ ูุงู ุจู ุงุฒุง ูุฑ ฺฏฺฏุงุจุงุช ุฐุฎุฑู ุดุฏู.

    โ ุฏุฑุจุงุฑู ููุชโฺฏุฐุงุฑ ุฏุฑ ุตูุญู [ููุชโฺฏุฐุงุฑ ุญุณุงุจ ุฐุฎุฑูโุณุงุฒ Azure](https://azure.microsoft.com/pricing/details/storage/?WT.mc_id=academic-17441-jabenn) ูุทุงูุนู ฺฉูุฏ.

1. ุฏุณุชูุฑ ุฒุฑ ุฑุง ุจุฑุง ุงุฌุงุฏ ฺฉ Function App ุงุฌุฑุง ฺฉูุฏ:

    ```sh
    az functionapp create --resource-group soil-moisture-sensor \
                          --runtime python \
                          --functions-version 3 \
                          --os-type Linux \
                          --consumption-plan-location <location> \
                          --storage-account <storage_name> \
                          --name <functions_app_name>
    ```

    `<location>` ุฑุง ุจุง ูฺฉุงู ฺฉู ููฺฏุงู ุงุฌุงุฏ ฺฏุฑูู ููุงุจุน ุฏุฑ ุฏุฑุณ ูุจู ุงุณุชูุงุฏู ฺฉุฑุฏุฏ ุฌุงฺฏุฒู ฺฉูุฏ.

    `<storage_name>` ุฑุง ุจุง ูุงู ุญุณุงุจ ุฐุฎุฑูโุณุงุฒ ฺฉู ุฏุฑ ูุฑุญูู ูุจู ุงุฌุงุฏ ฺฉุฑุฏุฏ ุฌุงฺฏุฒู ฺฉูุฏ.

    `<functions_app_name>` ุฑุง ุจุง ฺฉ ูุงู ููุญุตุฑ ุจู ูุฑุฏ ุจุฑุง Function App ุฎูุฏ ุฌุงฺฏุฒู ฺฉูุฏ. ุงู ูุงู ุจุงุฏ ุจู ุตูุฑุช ุฌูุงู ููุญุตุฑ ุจู ูุฑุฏ ุจุงุดุฏ ุฒุฑุง ุจุฎุด ุงุฒ URL ููุฑุฏ ุงุณุชูุงุฏู ุจุฑุง ุฏุณุชุฑุณ ุจู Function App ุฑุง ุชุดฺฉู ูโุฏูุฏ. ุงุฒ ฺุฒ ูุงููุฏ `soil-moisture-sensor-` ุงุณุชูุงุฏู ฺฉูุฏ ู ฺฉ ุดูุงุณู ููุญุตุฑ ุจู ูุฑุฏ ุจู ุงูุชูุง ุขู ุงุถุงูู ฺฉูุฏุ ูุงููุฏ ฺูุฏ ฺฉููู ุชุตุงุฏู ุง ูุงู ุฎูุฏ.

    ฺฏุฒูู `--functions-version 3` ูุณุฎู Azure Functions ุฑุง ุจุฑุง ุงุณุชูุงุฏู ุชูุธู ูโฺฉูุฏ. ูุณุฎู 3 ุฌุฏุฏุชุฑู ูุณุฎู ุงุณุช.

    ฺฏุฒูู `--os-type Linux` ุจู ูุญุท ุงุฌุฑุง Functions ูโฺฏูุฏ ฺฉู ุงุฒ ูููฺฉุณ ุจู ุนููุงู ุณุณุชูโุนุงูู ุจุฑุง ูุฒุจุงู ุงู ุชูุงุจุน ุงุณุชูุงุฏู ฺฉูุฏ. ุชูุงุจุน ูโุชูุงููุฏ ุจุฑ ุฑู ูููฺฉุณ ุง ููุฏูุฒ ูุฒุจุงู ุดููุฏุ ุจุณุชู ุจู ุฒุจุงู ุจุฑูุงููโููุณ ููุฑุฏ ุงุณุชูุงุฏู. ุจุฑูุงููโูุง ูพุงุชูู ููุท ุจุฑ ุฑู ูููฺฉุณ ูพุดุชุจุงู ูโุดููุฏ.

### ูุธูู - ุขูพููุฏ ุชูุธูุงุช ุจุฑูุงูู

ููฺฏุงู ฺฉู ุจุฑูุงูู Functions ุฎูุฏ ุฑุง ุชูุณุนู ุฏุงุฏุฏุ ุจุฑุฎ ุชูุธูุงุช ุฑุง ุฏุฑ ูุงู `local.settings.json` ุจุฑุง ุฑุดุชูโูุง ุงุชุตุงู IoT Hub ุฐุฎุฑู ฺฉุฑุฏุฏ. ุงู ุชูุธูุงุช ุจุงุฏ ุจู ุชูุธูุงุช ุจุฑูุงูู ุฏุฑ Function App ุดูุง ุฏุฑ Azure ููุดุชู ุดููุฏ ุชุง ุจุชูุงููุฏ ุชูุณุท ฺฉุฏ ุดูุง ุงุณุชูุงุฏู ุดููุฏ.

๐ ูุงู `local.settings.json` ููุท ุจุฑุง ุชูุธูุงุช ุชูุณุนู ูุญู ุงุณุช ู ูุจุงุฏ ุฏุฑ ฺฉูุชุฑู ฺฉุฏ ููุจุนุ ูุงููุฏ GitHubุ ุจุฑุฑุณ ุดูุฏ. ููฺฏุงู ฺฉู ุฏุฑ ูุถุง ุงุจุฑ ูุณุชูุฑ ูโุดูุฏุ ุงุฒ ุชูุธูุงุช ุจุฑูุงูู ุงุณุชูุงุฏู ูโุดูุฏ. ุชูุธูุงุช ุจุฑูุงูู ุฌูุชโูุง ฺฉูุฏ/ููุฏุงุฑ ูุณุชูุฏ ฺฉู ุฏุฑ ูุถุง ุงุจุฑ ูุฒุจุงู ูโุดููุฏ ู ุงุฒ ูุชุบุฑูุง ูุญุท ุง ุฏุฑ ฺฉุฏ ุดูุง ุง ุชูุณุท ูุญุท ุงุฌุฑุง ููฺฏุงู ุงุชุตุงู ฺฉุฏ ุดูุง ุจู IoT Hub ุฎูุงูุฏู ูโุดููุฏ.

1. ุฏุณุชูุฑ ุฒุฑ ุฑุง ุจุฑุง ุชูุธู ููุฏุงุฑ `IOT_HUB_CONNECTION_STRING` ุฏุฑ ุชูุธูุงุช ุจุฑูุงูู Function App ุงุฌุฑุง ฺฉูุฏ:

    ```sh
    az functionapp config appsettings set --resource-group soil-moisture-sensor \
                                          --name <functions_app_name> \
                                          --settings "IOT_HUB_CONNECTION_STRING=<connection string>"
    ```

    `<functions_app_name>` ุฑุง ุจุง ูุงู ฺฉู ุจุฑุง Function App ุฎูุฏ ุงุณุชูุงุฏู ฺฉุฑุฏุฏ ุฌุงฺฏุฒู ฺฉูุฏ.

    `<connection string>` ุฑุง ุจุง ููุฏุงุฑ `IOT_HUB_CONNECTION_STRING` ุงุฒ ูุงู `local.settings.json` ุฎูุฏ ุฌุงฺฏุฒู ฺฉูุฏ.

1. ูุฑุญูู ุจุงูุง ุฑุง ุชฺฉุฑุงุฑ ฺฉูุฏุ ุงูุง ููุฏุงุฑ `REGISTRY_MANAGER_CONNECTION_STRING` ุฑุง ุจู ููุฏุงุฑ ูุฑุจูุทู ุงุฒ ูุงู `local.settings.json` ุฎูุฏ ุชูุธู ฺฉูุฏ.

ููฺฏุงู ฺฉู ุงู ุฏุณุชูุฑุงุช ุฑุง ุงุฌุฑุง ูโฺฉูุฏุ ูุณุช ุงุฒ ุชูุงู ุชูุธูุงุช ุจุฑูุงูู ุจุฑุง Function App ูุฒ ุฎุฑูุฌ ุฏุงุฏู ูโุดูุฏ. ูโุชูุงูุฏ ุงุฒ ุงู ูุณุช ุจุฑุง ุจุฑุฑุณ ุงูฺฉู ููุงุฏุฑ ุดูุง ุจู ุฏุฑุณุช ุชูุธู ุดุฏูโุงูุฏ ุงุณุชูุงุฏู ฺฉูุฏ.

๐ ุดูุง ฺฉ ููุฏุงุฑ ุงุฒ ูพุด ุชูุธู ุดุฏู ุจุฑุง `AzureWebJobsStorage` ุฎูุงูุฏ ุฏุฏ. ุฏุฑ ูุงู `local.settings.json` ุดูุงุ ุงู ููุฏุงุฑ ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุดุจูโุณุงุฒ ุฐุฎุฑูโุณุงุฒ ูุญู ุชูุธู ุดุฏู ุจูุฏ. ููฺฏุงู ฺฉู Function App ุฑุง ุงุฌุงุฏ ฺฉุฑุฏุฏุ ุญุณุงุจ ุฐุฎุฑูโุณุงุฒ ุฑุง ุจู ุนููุงู ฺฉ ูพุงุฑุงูุชุฑ ุงุฑุณุงู ฺฉุฑุฏุฏ ู ุงู ููุฏุงุฑ ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ุฏุฑ ุงู ุชูุธู ุชูุธู ูโุดูุฏ.

### ูุธูู - ุงุณุชูุฑุงุฑ Function App ุฎูุฏ ุฏุฑ ูุถุง ุงุจุฑ

ุงฺฉููู ฺฉู Function App ุขูุงุฏู ุงุณุชุ ฺฉุฏ ุดูุง ูโุชูุงูุฏ ูุณุชูุฑ ุดูุฏ.

1. ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฒ ุชุฑููุงู VS Code ุจุฑุง ุงูุชุดุงุฑ Function App ุฎูุฏ ุงุฌุฑุง ฺฉูุฏ:

    ```sh
    func azure functionapp publish <functions_app_name>
    ```

    `<functions_app_name>` ุฑุง ุจุง ูุงู ฺฉู ุจุฑุง Function App ุฎูุฏ ุงุณุชูุงุฏู ฺฉุฑุฏุฏ ุฌุงฺฏุฒู ฺฉูุฏ.

ฺฉุฏ ุจุณุชูโุจูุฏ ุดุฏู ู ุจู Function App ุงุฑุณุงู ูโุดูุฏุ ุฌุง ฺฉู ูุณุชูุฑ ู ุดุฑูุน ูโุดูุฏ. ุฎุฑูุฌ ฺฉูุณูู ุฒุงุฏ ูุฌูุฏ ุฎูุงูุฏ ุฏุงุดุช ฺฉู ุจุง ุชุฃุฏ ุงุณุชูุฑุงุฑ ู ูุณุช ุงุฒ ุชูุงุจุน ูุณุชูุฑ ุดุฏู ูพุงุงู ูโุงุจุฏ. ุฏุฑ ุงู ููุฑุฏ ูุณุช ููุท ุดุงูู trigger ุฎูุงูุฏ ุจูุฏ.

```output
Deployment successful.
Remote build succeeded!
Syncing triggers...
Functions in soil-moisture-sensor:
    iot-hub-trigger - [eventHubTrigger]
```

ูุทูุฆู ุดูุฏ ฺฉู ุฏุณุชฺฏุงู IoT ุดูุง ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุช. ุณุทุญ ุฑุทูุจุช ุฑุง ุจุง ุชูุธู ุฑุทูุจุช ุฎุงฺฉ ุง ุญุฑฺฉุช ุฏุงุฏู ุญุณฺฏุฑ ุฏุงุฎู ู ุฎุงุฑุฌ ุฎุงฺฉ ุชุบุฑ ุฏูุฏ. ุฎูุงูุฏ ุฏุฏ ฺฉู ุฑูู ุจุง ุชุบุฑ ุฑุทูุจุช ุฎุงฺฉ ุฑูุดู ู ุฎุงููุด ูโุดูุฏ.

---

## ๐ ฺุงูุด

ุฏุฑ ุฏุฑุณ ูุจูุ ุฒูุงูโุจูุฏ ุจุฑุง ุฑูู ุฑุง ุจุง ูุบู ุงุดุชุฑุงฺฉ ุงุฒ ูพุงูโูุง MQTT ุฏุฑ ุญุงู ฺฉู ุฑูู ุฑูุดู ุจูุฏ ู ุจุฑุง ูุฏุช ฺฉูุชุงู ูพุณ ุงุฒ ุฎุงููุด ุดุฏู ุขู ูุฏุฑุช ฺฉุฑุฏุฏ. ููโุชูุงูุฏ ุงุฒ ุงู ุฑูุด ุฏุฑ ุงูุฌุง ุงุณุชูุงุฏู ฺฉูุฏ - ููโุชูุงูุฏ trigger IoT Hub ุฎูุฏ ุฑุง ูุบู ุงุดุชุฑุงฺฉ ฺฉูุฏ.

ุจู ุฑูุดโูุง ูุฎุชูู ูฺฉุฑ ฺฉูุฏ ฺฉู ูโุชูุงูุฏ ุงู ููุถูุน ุฑุง ุฏุฑ Function App ุฎูุฏ ูุฏุฑุช ฺฉูุฏ.

## ุขุฒููู ูพุณ ุงุฒ ุฏุฑุณ

[ุขุฒููู ูพุณ ุงุฒ ุฏุฑุณ](https://black-meadow-040d15503.1.azurestaticapps.net/quiz/18)

## ูุฑูุฑ ู ูุทุงูุนู ุดุฎุต

* ุฏุฑุจุงุฑู ูุญุงุณุจุงุช ุจุฏูู ุณุฑูุฑ ุฏุฑ ุตูุญู [ูุญุงุณุจุงุช ุจุฏูู ุณุฑูุฑ ุฏุฑ ูฺฉโูพุฏุง](https://wikipedia.org/wiki/Serverless_computing) ูุทุงูุนู ฺฉูุฏ.
* ุฏุฑุจุงุฑู ุงุณุชูุงุฏู ุงุฒ ุจุฏูู ุณุฑูุฑ ุฏุฑ Azure ู ุจุฑุฎ ูุซุงูโูุง ุจุดุชุฑ ุฏุฑ ูพุณุช ูุจูุงฺฏ [Go serverless for your IoT needs Azure](https://azure.microsoft.com/blog/go-serverless-for-your-iot-needs/?WT.mc_id=academic-17441-jabenn) ูุทุงูุนู ฺฉูุฏ.
* ุฏุฑุจุงุฑู Azure Functions ุจุดุชุฑ ุจุงููุฒุฏ ุฏุฑ [ฺฉุงูุงู ูุชูุจ Azure Functions](https://www.youtube.com/c/AzureFunctions).

## ุชฺฉูู

[ุงูุฒูุฏู ฺฉูุชุฑู ุฏุณุช ุฑูู](assignment.md)

**ุณูุจ ูุณุฆููุช**:  
ุงู ุณูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุณุฑูุณ ุชุฑุฌูู ููุด ูุตููุน [Co-op Translator](https://github.com/Azure/co-op-translator) ุชุฑุฌูู ุดุฏู ุงุณุช. ุฏุฑ ุญุงู ฺฉู ูุง ุชูุงุด ูโฺฉูู ุฏูุช ุฑุง ุญูุธ ฺฉููุ ูุทูุงู ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุชุฑุฌููโูุง ุฎูุฏฺฉุงุฑ ููฺฉู ุงุณุช ุดุงูู ุฎุทุงูุง ุง ูุงุฏุฑุณุชโูุง ุจุงุดูุฏ. ุณูุฏ ุงุตู ุจู ุฒุจุงู ุงุตู ุขู ุจุงุฏ ุจู ุนููุงู ููุจุน ูุนุชุจุฑ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดูุฏ. ุจุฑุง ุงุทูุงุนุงุช ุญุณุงุณุ ุชูุตู ูโุดูุฏ ุงุฒ ุชุฑุฌูู ุญุฑููโุง ุงูุณุงู ุงุณุชูุงุฏู ฺฉูุฏ. ูุง ูฺ ูุณุฆููุช ุฏุฑ ูุจุงู ุณูุก ุชูุงููโูุง ุง ุชูุณุฑูุง ูุงุฏุฑุณุช ูุงุด ุงุฒ ุงุณุชูุงุฏู ุงุฒ ุงู ุชุฑุฌูู ูุฏุงุฑู.