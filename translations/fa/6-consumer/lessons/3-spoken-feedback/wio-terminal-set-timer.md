<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "012b69d57d898d670adf61304f42a137",
  "translation_date": "2025-08-25T22:37:13+00:00",
  "source_file": "6-consumer/lessons/3-spoken-feedback/wio-terminal-set-timer.md",
  "language_code": "fa"
}
-->
# ุชูุธู ุชุงูุฑ - Wio Terminal

ุฏุฑ ุงู ุจุฎุด ุงุฒ ุฏุฑุณุ ฺฉุฏ ุณุฑูุฑูุณ ุฎูุฏ ุฑุง ูุฑุงุฎูุงู ูโฺฉูุฏ ุชุง ฺฏูุชุงุฑ ุฑุง ุชุดุฎุต ุฏูุฏ ู ุจุฑ ุงุณุงุณ ูุชุงุฌุ ฺฉ ุชุงูุฑ ุฑู Wio Terminal ุชูุธู ฺฉูุฏ.

## ุชูุธู ุชุงูุฑ

ูุชู ฺฉู ุงุฒ ูุฑุงุฎูุงู ุชุจุฏู ฺฏูุชุงุฑ ุจู ูุชู ุจุงุฒูโฺฏุฑุฏุฏ ุจุงุฏ ุจู ฺฉุฏ ุณุฑูุฑูุณ ุดูุง ุงุฑุณุงู ุดูุฏ ุชุง ุชูุณุท LUIS ูพุฑุฏุงุฒุด ุดูุฏ ู ุชุนุฏุงุฏ ุซุงููโูุง ุชุงูุฑ ุฑุง ุจุงุฒฺฏุฑุฏุงูุฏ. ุงู ุชุนุฏุงุฏ ุซุงููโูุง ูโุชูุงูุฏ ุจุฑุง ุชูุธู ุชุงูุฑ ุงุณุชูุงุฏู ุดูุฏ.

ูฺฉุฑูฺฉูุชุฑูุฑูุง ุจู ุทูุฑ ูพุดโูุฑุถ ุงุฒ ฺูุฏู ุฑุดุชู (threads) ุฏุฑ Arduino ูพุดุชุจุงู ููโฺฉููุฏุ ุจูุงุจุฑุงู ฺฉูุงุณโูุง ุชุงูุฑ ุงุณุชุงูุฏุงุฑุฏ ูุงููุฏ ุขูฺู ุฏุฑ ุฒุจุงูโูุง ูุซู Python ุง ุฏฺฏุฑ ุฒุจุงูโูุง ุณุทุญ ุจุงูุง ูุฌูุฏ ุฏุงุฑุฏุ ูุฏุงุฑูุฏ. ุฏุฑ ุนูุถุ ูโุชูุงูุฏ ุงุฒ ฺฉุชุงุจุฎุงููโูุง ุชุงูุฑ ุงุณุชูุงุฏู ฺฉูุฏ ฺฉู ุจุง ุงูุฏุงุฒูโฺฏุฑ ุฒูุงู ุณูพุฑโุดุฏู ุฏุฑ ุชุงุจุน `loop` ฺฉุงุฑ ูโฺฉููุฏ ู ูพุณ ุงุฒ ุงุชูุงู ุฒูุงูุ ุชูุงุจุน ุฑุง ูุฑุงุฎูุงู ูโฺฉููุฏ.

### ูุธูู - ุงุฑุณุงู ูุชู ุจู ุชุงุจุน ุณุฑูุฑูุณ

1. ุงฺฏุฑ ูพุฑูฺู `smart-timer` ุฏุฑ VS Code ุจุงุฒ ูุณุชุ ุขู ุฑุง ุจุงุฒ ฺฉูุฏ.

1. ูุงู ูุฏุฑ `config.h` ุฑุง ุจุงุฒ ฺฉูุฏ ู URL ูุฑุจูุท ุจู ุจุฑูุงูู ุชุงุจุน ุฎูุฏ ุฑุง ุงุถุงูู ฺฉูุฏ:

    ```cpp
    const char *TEXT_TO_TIMER_FUNCTION_URL = "<URL>";
    ```

    `<URL>` ุฑุง ุจุง URL ุจุฑูุงูู ุชุงุจุน ุฎูุฏ ฺฉู ุฏุฑ ูุฑุญูู ุขุฎุฑ ุฏุฑุณ ูุจู ุจู ุฏุณุช ุขูุฑุฏุฏ ุฌุงฺฏุฒู ฺฉูุฏุ ุจู ฺฏูููโุง ฺฉู ุจู ุขุฏุฑุณ IP ุฏุณุชฺฏุงู ูุญู ุดูุง ฺฉู ุจุฑูุงูู ุชุงุจุน ุฑุง ุงุฌุฑุง ูโฺฉูุฏ ุงุดุงุฑู ฺฉูุฏ.

1. ฺฉ ูุงู ุฌุฏุฏ ุฏุฑ ูพูุดู `src` ุจุง ูุงู `language_understanding.h` ุงุฌุงุฏ ฺฉูุฏ. ุงู ูุงู ุจุฑุง ุชุนุฑู ฺฉูุงุณ ุงุณุชูุงุฏู ูโุดูุฏ ฺฉู ฺฏูุชุงุฑ ุชุดุฎุต ุฏุงุฏูโุดุฏู ุฑุง ุจู ุจุฑูุงูู ุชุงุจุน ุดูุง ุงุฑุณุงู ฺฉูุฏ ุชุง ุชูุณุท LUIS ุจู ุซุงูู ุชุจุฏู ุดูุฏ.

1. ููุงุฑุฏ ุฒุฑ ุฑุง ุจู ุจุงูุง ุงู ูุงู ุงุถุงูู ฺฉูุฏ:

    ```cpp
    #pragma once
    
    #include <Arduino.h>
    #include <ArduinoJson.h>
    #include <HTTPClient.h>
    #include <WiFiClient.h>
    
    #include "config.h"
    ```

    ุงู ฺฉุฏ ุดุงูู ุจุฑุฎ ูุงูโูุง ูุฏุฑ ููุฑุฏูุงุฒ ุงุณุช.

1. ฺฉูุงุณ ุจู ูุงู `LanguageUnderstanding` ุชุนุฑู ฺฉูุฏ ู ฺฉ ููููู ุงุฒ ุงู ฺฉูุงุณ ุงุนูุงู ฺฉูุฏ:

    ```cpp
    class LanguageUnderstanding
    {
    public:
    private:
    };

    LanguageUnderstanding languageUnderstanding;
    ```

1. ุจุฑุง ูุฑุงุฎูุงู ุจุฑูุงูู ุชุงุจุน ุฎูุฏุ ุจุงุฏ ฺฉ WiFi client ุงุนูุงู ฺฉูุฏ. ููุงุฑุฏ ุฒุฑ ุฑุง ุจู ุจุฎุด `private` ฺฉูุงุณ ุงุถุงูู ฺฉูุฏ:

    ```cpp
    WiFiClient _client;
    ```

1. ุฏุฑ ุจุฎุด `public`ุ ฺฉ ูุชุฏ ุจู ูุงู `GetTimerDuration` ุจุฑุง ูุฑุงุฎูุงู ุจุฑูุงูู ุชุงุจุน ุงุนูุงู ฺฉูุฏ:

    ```cpp
    int GetTimerDuration(String text)
    {
    }
    ```

1. ุฏุฑ ูุชุฏ `GetTimerDuration`ุ ฺฉุฏ ุฒุฑ ุฑุง ุจุฑุง ุณุงุฎุช JSON ฺฉู ุจู ุจุฑูุงูู ุชุงุจุน ุงุฑุณุงู ูโุดูุฏ ุงุถุงูู ฺฉูุฏ:

    ```cpp
    DynamicJsonDocument doc(1024);
    doc["text"] = text;

    String body;
    serializeJson(doc, body);
    ```

    ุงู ฺฉุฏ ูุชู ุงุฑุณุงูโุดุฏู ุจู ูุชุฏ `GetTimerDuration` ุฑุง ุจู JSON ุฒุฑ ุชุจุฏู ูโฺฉูุฏ:

    ```json
    {
        "text" : "<text>"
    }
    ```

    ฺฉู ุฏุฑ ุขู `<text>` ูุชู ุงุณุช ฺฉู ุจู ุชุงุจุน ุงุฑุณุงู ุดุฏู ุงุณุช.

1. ุฏุฑ ุฒุฑ ุงู ฺฉุฏุ ฺฉุฏ ุฒุฑ ุฑุง ุจุฑุง ูุฑุงุฎูุงู ุจุฑูุงูู ุชุงุจุน ุงุถุงูู ฺฉูุฏ:

    ```cpp
    HTTPClient httpClient;
    httpClient.begin(_client, TEXT_TO_TIMER_FUNCTION_URL);

    int httpResponseCode = httpClient.POST(body);
    ```

    ุงู ฺฉุฏ ฺฉ ุฏุฑุฎูุงุณุช POST ุจู ุจุฑูุงูู ุชุงุจุน ุงุฑุณุงู ูโฺฉูุฏุ ุจุฏูู JSON ุฑุง ุงุฑุณุงู ฺฉุฑุฏู ู ฺฉุฏ ูพุงุณุฎ ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ.

1. ฺฉุฏ ุฒุฑ ุฑุง ุฏุฑ ุฒุฑ ุงู ุจุฎุด ุงุถุงูู ฺฉูุฏ:

    ```cpp
    int seconds = 0;
    if (httpResponseCode == 200)
    {
        String result = httpClient.getString();
        Serial.println(result);

        DynamicJsonDocument doc(1024);
        deserializeJson(doc, result.c_str());

        JsonObject obj = doc.as<JsonObject>();
        seconds = obj["seconds"].as<int>();
    }
    else
    {
        Serial.print("Failed to understand text - error ");
        Serial.println(httpResponseCode);
    }
    ```

    ุงู ฺฉุฏ ฺฉุฏ ูพุงุณุฎ ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ. ุงฺฏุฑ ฺฉุฏ 200 (ููููุช) ุจุงุดุฏุ ุชุนุฏุงุฏ ุซุงููโูุง ุชุงูุฑ ุงุฒ ุจุฏูู ูพุงุณุฎ ุฏุฑุงูุช ูโุดูุฏ. ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ฺฉ ุฎุทุง ุจู ูุงูุชูุฑ ุณุฑุงู ุงุฑุณุงู ุดุฏู ู ุชุนุฏุงุฏ ุซุงููโูุง ุจู 0 ุชูุธู ูโุดูุฏ.

1. ฺฉุฏ ุฒุฑ ุฑุง ุจู ุงูุชูุง ุงู ูุชุฏ ุงุถุงูู ฺฉูุฏ ุชุง ุงุชุตุงู HTTP ุจุณุชู ุดูุฏ ู ุชุนุฏุงุฏ ุซุงููโูุง ุจุงุฒฺฏุฑุฏุงูุฏู ุดูุฏ:

    ```cpp
    httpClient.end();

    return seconds;
    ```

1. ุฏุฑ ูุงู `main.cpp`ุ ุงู ูุฏุฑ ุฌุฏุฏ ุฑุง ุงุถุงูู ฺฉูุฏ:

    ```cpp
    #include "speech_to_text.h"
    ```

1. ุฏุฑ ุงูุชูุง ุชุงุจุน `processAudio`ุ ูุชุฏ `GetTimerDuration` ุฑุง ุจุฑุง ุฏุฑุงูุช ูุฏุช ุฒูุงู ุชุงูุฑ ูุฑุงุฎูุงู ฺฉูุฏ:

    ```cpp
    int total_seconds = languageUnderstanding.GetTimerDuration(text);
    ```

    ุงู ฺฉุฏ ูุชู ุญุงุตู ุงุฒ ูุฑุงุฎูุงู ฺฉูุงุณ `SpeechToText` ุฑุง ุจู ุชุนุฏุงุฏ ุซุงููโูุง ุชุงูุฑ ุชุจุฏู ูโฺฉูุฏ.

### ูุธูู - ุชูุธู ุชุงูุฑ

ุชุนุฏุงุฏ ุซุงููโูุง ูโุชูุงูุฏ ุจุฑุง ุชูุธู ุชุงูุฑ ุงุณุชูุงุฏู ุดูุฏ.

1. ูุงุจุณุชฺฏ ฺฉุชุงุจุฎุงูู ุฒุฑ ุฑุง ุจู ูุงู `platformio.ini` ุงุถุงูู ฺฉูุฏ ุชุง ฺฉ ฺฉุชุงุจุฎุงูู ุจุฑุง ุชูุธู ุชุงูุฑ ุงุถุงูู ุดูุฏ:

    ```ini
    contrem/arduino-timer @ 2.3.0
    ```

1. ฺฉ ุฏุณุชูุฑ include ุจุฑุง ุงู ฺฉุชุงุจุฎุงูู ุจู ูุงู `main.cpp` ุงุถุงูู ฺฉูุฏ:

    ```cpp
    #include <arduino-timer.h>
    ```

1. ุจุงูุง ุชุงุจุน `processAudio`ุ ฺฉุฏ ุฒุฑ ุฑุง ุงุถุงูู ฺฉูุฏ:

    ```cpp
    auto timer = timer_create_default();
    ```

    ุงู ฺฉุฏ ฺฉ ุชุงูุฑ ุจู ูุงู `timer` ุงุนูุงู ูโฺฉูุฏ.

1. ฺฉุฏ ุฒุฑ ุฑุง ุฏุฑ ุฒุฑ ุงู ุจุฎุด ุงุถุงูู ฺฉูุฏ:

    ```cpp
    void say(String text)
    {
        Serial.print("Saying ");
        Serial.println(text);
    }
    ```

    ุงู ุชุงุจุน `say` ุฏุฑ ููุงุช ูุชู ุฑุง ุจู ฺฏูุชุงุฑ ุชุจุฏู ูโฺฉูุฏุ ุงูุง ุฏุฑ ุญุงู ุญุงุถุฑ ููุท ูุชู ุงุฑุณุงูโุดุฏู ุฑุง ุจู ูุงูุชูุฑ ุณุฑุงู ูโููุณุฏ.

1. ฺฉุฏ ุฒุฑ ุฑุง ุฏุฑ ุฒุฑ ุชุงุจุน `say` ุงุถุงูู ฺฉูุฏ:

    ```cpp
    bool timerExpired(void *announcement)
    {
        say((char *)announcement);
        return false;
    }
    ```

    ุงู ฺฉ ุชุงุจุน callback ุงุณุช ฺฉู ููุช ุชุงูุฑ ูููุถ ูโุดูุฏ ูุฑุงุฎูุงู ูโุดูุฏ. ุงู ุชุงุจุน ูพุงู ุฑุง ฺฉู ุจุงุฏ ููฺฏุงู ุงููุถุง ุชุงูุฑ ฺฏูุชู ุดูุฏ ุฏุฑุงูุช ูโฺฉูุฏ. ุชุงูุฑูุง ูโุชูุงููุฏ ุชฺฉุฑุงุฑ ุดููุฏ ู ุงู ููุถูุน ุจุง ููุฏุงุฑ ุจุงุฒฺฏุดุช ุงู callback ฺฉูุชุฑู ูโุดูุฏ - ุงู ููุฏุงุฑ `false` ุจุงุฒูโฺฏุฑุฏุงูุฏ ุชุง ุจู ุชุงูุฑ ุจฺฏูุฏ ุฏูุจุงุฑู ุงุฌุฑุง ูุดูุฏ.

1. ฺฉุฏ ุฒุฑ ุฑุง ุจู ุงูุชูุง ุชุงุจุน `processAudio` ุงุถุงูู ฺฉูุฏ:

    ```cpp
    if (total_seconds == 0)
    {
        return;
    }

    int minutes = total_seconds / 60;
    int seconds = total_seconds % 60;
    ```

    ุงู ฺฉุฏ ุชุนุฏุงุฏ ฺฉู ุซุงููโูุง ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ ู ุงฺฏุฑ 0 ุจุงุดุฏุ ุงุฒ ูุฑุงุฎูุงู ุชุงุจุน ุจุงุฒูโฺฏุฑุฏุฏ ุชุง ูฺ ุชุงูุฑ ุชูุธู ูุดูุฏ. ุณูพุณ ุชุนุฏุงุฏ ฺฉู ุซุงููโูุง ุฑุง ุจู ุฏููู ู ุซุงูู ุชุจุฏู ูโฺฉูุฏ.

1. ฺฉุฏ ุฒุฑ ุฑุง ุฏุฑ ุฒุฑ ุงู ุจุฎุด ุงุถุงูู ฺฉูุฏ ุชุง ูพุงู ุจุฑุง ุงุนูุงู ุดุฑูุน ุชุงูุฑ ุงุฌุงุฏ ุดูุฏ:

    ```cpp
    String begin_message;
    if (minutes > 0)
    {
        begin_message += minutes;
        begin_message += " minute ";
    }
    if (seconds > 0)
    {
        begin_message += seconds;
        begin_message += " second ";
    }

    begin_message += "timer started.";
    ```

1. ฺฉุฏ ูุดุงุจู ุฑุง ุฏุฑ ุฒุฑ ุงู ุจุฎุด ุงุถุงูู ฺฉูุฏ ุชุง ูพุงู ุจุฑุง ุงุนูุงู ุงููุถุง ุชุงูุฑ ุงุฌุงุฏ ุดูุฏ:

    ```cpp
    String end_message("Times up on your ");
    if (minutes > 0)
    {
        end_message += minutes;
        end_message += " minute ";
    }
    if (seconds > 0)
    {
        end_message += seconds;
        end_message += " second ";
    }

    end_message += "timer.";
    ```

1. ูพุณ ุงุฒ ุงูุ ูพุงู ุดุฑูุน ุชุงูุฑ ุฑุง ุงุนูุงู ฺฉูุฏ:

    ```cpp
    say(begin_message);
    ```

1. ุฏุฑ ุงูุชูุง ุงู ุชุงุจุนุ ุชุงูุฑ ุฑุง ุดุฑูุน ฺฉูุฏ:

    ```cpp
    timer.in(total_seconds * 1000, timerExpired, (void *)(end_message.c_str()));
    ```

    ุงู ฺฉุฏ ุชุงูุฑ ุฑุง ูุนุงู ูโฺฉูุฏ. ุชุงูุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ููโุซุงูู ุชูุธู ูโุดูุฏุ ุจูุงุจุฑุงู ุชุนุฏุงุฏ ฺฉู ุซุงููโูุง ุฏุฑ 1,000 ุถุฑุจ ูโุดูุฏ ุชุง ุจู ููโุซุงูู ุชุจุฏู ุดูุฏ. ุชุงุจุน `timerExpired` ุจู ุนููุงู callback ุงุฑุณุงู ูโุดูุฏ ู `end_message` ุจู ุนููุงู ุขุฑฺฏููุงู ุจุฑุง ุงุฑุณุงู ุจู callback ุงุฑุณุงู ูโุดูุฏ. ุงู callback ููุท ุขุฑฺฏููุงูโูุง `void *` ูโฺฏุฑุฏุ ุจูุงุจุฑุงู ุฑุดุชู ุจู ุทูุฑ ููุงุณุจ ุชุจุฏู ูโุดูุฏ.

1. ุฏุฑ ููุงุชุ ุชุงูุฑ ุจุงุฏ *ุชฺฉ* ุจุฒูุฏ ู ุงู ฺฉุงุฑ ุฏุฑ ุชุงุจุน `loop` ุงูุฌุงู ูโุดูุฏ. ฺฉุฏ ุฒุฑ ุฑุง ุจู ุงูุชูุง ุชุงุจุน `loop` ุงุถุงูู ฺฉูุฏ:

    ```cpp
    timer.tick();
    ```

1. ุงู ฺฉุฏ ุฑุง ุจุณุงุฒุฏุ ุขู ุฑุง ุฑู Wio Terminal ุฎูุฏ ุขูพููุฏ ฺฉูุฏ ู ุงุฒ ุทุฑู ูุงูุชูุฑ ุณุฑุงู ุขู ุฑุง ุขุฒูุงุด ฺฉูุฏ. ููุช `Ready` ุฑุง ุฏุฑ ูุงูุชูุฑ ุณุฑุงู ูุดุงูุฏู ฺฉุฑุฏุฏุ ุฏฺฉูู C (ุฏฺฉูู ุณูุช ฺูพุ ูุฒุฏฺฉ ุจู ฺฉูุฏ ูพุงูุฑ) ุฑุง ูุดุงุฑ ุฏูุฏ ู ุตุญุจุช ฺฉูุฏ. 4 ุซุงูู ุตุฏุง ุถุจุท ูโุดูุฏุ ุจู ูุชู ุชุจุฏู ูโุดูุฏุ ุณูพุณ ุจู ุจุฑูุงูู ุชุงุจุน ุดูุง ุงุฑุณุงู ูโุดูุฏ ู ฺฉ ุชุงูุฑ ุชูุธู ูโุดูุฏ. ูุทูุฆู ุดูุฏ ฺฉู ุจุฑูุงูู ุชุงุจุน ุดูุง ุจู ุตูุฑุช ูุญู ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุช.

    ุดูุง ุฎูุงูุฏ ุฏุฏ ฺฉู ุชุงูุฑ ฺู ุฒูุงู ุดุฑูุน ูโุดูุฏ ู ฺู ุฒูุงู ูพุงุงู ูโุงุจุฏ.

    ```output
    --- Available filters and text transformations: colorize, debug, default, direct, hexlify, log2file, nocontrol, printable, send_on_enter, time
    --- More details at http://bit.ly/pio-monitor-filters
    --- Miniterm on /dev/cu.usbmodem1101  9600,8,N,1 ---
    --- Quit: Ctrl+C | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H ---
    Connecting to WiFi..
    Connected!
    Got access token.
    Ready.
    Starting recording...
    Finished recording
    Sending speech...
    Speech sent!
    {"RecognitionStatus":"Success","DisplayText":"Set a 2 minute and 27 second timer.","Offset":4700000,"Duration":35300000}
    Set a 2 minute and 27 second timer.
    {"seconds": 147}
    2 minute 27 second timer started.
    Times up on your 2 minute 27 second timer.
    ```

> ๐ ูโุชูุงูุฏ ุงู ฺฉุฏ ุฑุง ุฏุฑ ูพูุดู [code-timer/wio-terminal](../../../../../6-consumer/lessons/3-spoken-feedback/code-timer/wio-terminal) ูพุฏุง ฺฉูุฏ.

๐ ุจุฑูุงูู ุชุงูุฑ ุดูุง ููููุชโุขูุฒ ุจูุฏ!

**ุณูุจ ูุณุฆููุช**:  
ุงู ุณูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุณุฑูุณ ุชุฑุฌูู ููุด ูุตููุน [Co-op Translator](https://github.com/Azure/co-op-translator) ุชุฑุฌูู ุดุฏู ุงุณุช. ุฏุฑ ุญุงู ฺฉู ูุง ุชูุงุด ูโฺฉูู ุฏูุช ุฑุง ุญูุธ ฺฉููุ ูุทูุงู ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุชุฑุฌููโูุง ุฎูุฏฺฉุงุฑ ููฺฉู ุงุณุช ุดุงูู ุฎุทุงูุง ุง ูุงุฏุฑุณุชโูุง ุจุงุดูุฏ. ุณูุฏ ุงุตู ุจู ุฒุจุงู ุงุตู ุขู ุจุงุฏ ุจู ุนููุงู ููุจุน ูุนุชุจุฑ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดูุฏ. ุจุฑุง ุงุทูุงุนุงุช ุญุณุงุณุ ุชูุตู ูโุดูุฏ ุงุฒ ุชุฑุฌูู ุงูุณุงู ุญุฑููโุง ุงุณุชูุงุฏู ฺฉูุฏ. ูุง ูุณุฆููุช ุฏุฑ ูุจุงู ุณูุก ุชูุงููโูุง ุง ุชูุณุฑูุง ูุงุฏุฑุณุช ูุงุด ุงุฒ ุงุณุชูุงุฏู ุงุฒ ุงู ุชุฑุฌูู ูุฏุงุฑู.