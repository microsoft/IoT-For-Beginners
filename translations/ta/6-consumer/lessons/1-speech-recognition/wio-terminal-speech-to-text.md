<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "3f92edf2975175577174910caca4a389",
  "translation_date": "2025-10-11T12:18:29+00:00",
  "source_file": "6-consumer/lessons/1-speech-recognition/wio-terminal-speech-to-text.md",
  "language_code": "ta"
}
-->
# рокрпЗроЪрпНроЪрпИ роЙро░рпИропро╛роХ рооро╛ро▒рпНро▒рпБродро▓рпН - Wio Terminal

роЗроирпНрод рокро╛роЯродрпНродро┐ройрпН роЗроирпНрод рокроХрпБродро┐ропро┐ро▓рпН, роирпАроЩрпНроХро│рпН рокрпЗроЪрпНроЪрпИ роЪрпЗроХро░ро┐роХрпНроХрокрпНрокроЯрпНроЯ роЖроЯро┐ропрпЛро╡ро┐ро▓рпН роЗро░рпБроирпНродрпБ роЙро░рпИропро╛роХ рооро╛ро▒рпНро▒рпБро╡родро▒рпНроХро╛рой роХрпБро▒ро┐ропрпАроЯрпНроЯрпИ роОро┤рпБродрпБро╡рпАро░рпНроХро│рпН, рокрпЗроЪрпНроЪрпИ роЪрпЗро╡рпИ роорпВро▓роорпН.

## роЖроЯро┐ропрпЛро╡рпИ рокрпЗроЪрпНроЪрпИ роЪрпЗро╡рпИроХрпНроХрпБ роЕройрпБрокрпНрокрпБродро▓рпН

роЖроЯро┐ропрпЛро╡рпИ REST API роорпВро▓роорпН рокрпЗроЪрпНроЪрпИ роЪрпЗро╡рпИроХрпНроХрпБ роЕройрпБрокрпНрокро▓ро╛роорпН. рокрпЗроЪрпНроЪрпИ роЪрпЗро╡рпИропрпИ рокропройрпНрокроЯрпБродрпНрод, роорпБродро▓ро┐ро▓рпН роирпАроЩрпНроХро│рпН роЕрогрпБроХро▓рпН роЯрпЛроХрпНроХройрпИ роХрпЛро░ ро╡рпЗрогрпНроЯрпБроорпН, рокро┐ройрпНройро░рпН роЕроирпНрод роЯрпЛроХрпНроХройрпИ REST API-ропрпИ роЕрогрпБроХ рокропройрпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН. роЗроирпНрод роЕрогрпБроХро▓рпН роЯрпЛроХрпНроХройрпНроХро│рпН 10 роиро┐рооро┐роЯроЩрпНроХро│рпБроХрпНроХрпБ рокро┐ро▒роХрпБ роХро╛ро▓ро╛ро╡родро┐ропро╛роХро┐ро╡ро┐роЯрпБроорпН, роОройро╡рпЗ роЙроЩрпНроХро│рпН роХрпБро▒ро┐ропрпАроЯрпБ роЕро╡ро▒рпНро▒рпИ роЕроЯро┐роХрпНроХроЯро┐ роХрпЛро░ ро╡рпЗрогрпНроЯрпБроорпН, роЕро╡рпИ роОрокрпНрокрпЛродрпБроорпН рокрпБродрпБрокрпНрокро┐роХрпНроХрокрпНрокроЯрпНроЯродро╛роХ роЗро░рпБроХрпНроХ роЙро▒рпБродро┐рокрпНрокроЯрпБродрпНрод.

### рокрогро┐роХро│рпН - роЕрогрпБроХро▓рпН роЯрпЛроХрпНроХройрпИ рокрпЖро▒рпБродро▓рпН

1. `smart-timer` родро┐роЯрпНроЯродрпНродрпИ родро┐ро▒роХрпНроХро╡рпБроорпН, роЕродрпБ роПро▒рпНроХройро╡рпЗ родро┐ро▒роХрпНроХрокрпНрокроЯро╡ро┐ро▓рпНро▓рпИ роОройрпНро▒ро╛ро▓рпН.

1. WiFi-ропрпИ роЕрогрпБроХро╡рпБроорпН JSON-роР роХрпИропро╛ро│ро╡рпБроорпН `platformio.ini` роХрпЛрокрпНрокро┐ро▓рпН рокро┐ройрпНро╡ро░рпБроорпН роирпВро▓роХ роЪро╛ро░рпНрокрпБроХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```ini
    seeed-studio/Seeed Arduino rpcWiFi @ 1.0.5
    seeed-studio/Seeed Arduino rpcUnified @ 2.1.3
    seeed-studio/Seeed_Arduino_mbedtls @ 3.0.1
    seeed-studio/Seeed Arduino RTC @ 2.0.0
    bblanchon/ArduinoJson @ 6.17.3
    ```

1. `config.h` родро▓рпИрокрпНрокрпБ роХрпЛрокрпНрокро┐ро▓рпН рокро┐ройрпНро╡ро░рпБроорпН роХрпБро▒ро┐ропрпАроЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    const char *SSID = "<SSID>";
    const char *PASSWORD = "<PASSWORD>";
    
    const char *SPEECH_API_KEY = "<API_KEY>";
    const char *SPEECH_LOCATION = "<LOCATION>";
    const char *LANGUAGE = "<LANGUAGE>";

    const char *TOKEN_URL = "https://%s.api.cognitive.microsoft.com/sts/v1.0/issuetoken";
    ```

    `<SSID>` рооро▒рпНро▒рпБроорпН `<PASSWORD>`-роР роЙроЩрпНроХро│рпН WiFi-роХрпНроХрпБ родрпКроЯро░рпНрокрпБроЯрпИроп роородро┐рокрпНрокрпБроХро│рпБроЯройрпН рооро╛ро▒рпНро▒ро╡рпБроорпН.

    `<API_KEY>`-роР роЙроЩрпНроХро│рпН рокрпЗроЪрпНроЪрпИ роЪрпЗро╡рпИ ро╡ро│родрпНродро┐ройрпН API ро╡ро┐роЪрпИропрпБроЯройрпН рооро╛ро▒рпНро▒ро╡рпБроорпН. `<LOCATION>`-роР роирпАроЩрпНроХро│рпН рокрпЗроЪрпНроЪрпИ роЪрпЗро╡рпИ ро╡ро│родрпНродрпИ роЙро░рпБро╡ро╛роХрпНроХро┐роп рокрпЛродрпБ рокропройрпНрокроЯрпБродрпНродро┐роп роЗроЯродрпНродрпБроЯройрпН рооро╛ро▒рпНро▒ро╡рпБроорпН.

    `<LANGUAGE>`-роР роирпАроЩрпНроХро│рпН рокрпЗроЪрпБроорпН роорпКро┤ро┐роХрпНроХро╛рой роЗроЯрокрпНрокрпЖропро░рпБроЯройрпН рооро╛ро▒рпНро▒ро╡рпБроорпН, роЙродро╛ро░рогрооро╛роХ роЖроЩрпНроХро┐ро▓родрпНродро┐ро▒рпНроХро╛рой `en-GB`, роЕро▓рпНро▓родрпБ роХро╛роирпНродрпЛройрпАро╕ро┐ро▒рпНроХро╛рой `zn-HK`. роЖродро░ро┐роХрпНроХрокрпНрокроЯрпБроорпН роорпКро┤ро┐роХро│рпН рооро▒рпНро▒рпБроорпН роЕро╡ро▒рпНро▒ро┐ройрпН роЗроЯрокрпНрокрпЖропро░рпНроХро│рпН рокро▒рпНро▒ро┐роп рокроЯрпНроЯро┐ропро▓рпИ [Microsoft роЖро╡рогроЩрпНроХро│ро┐ро▓рпН роорпКро┤ро┐ рооро▒рпНро▒рпБроорпН роХрпБро░ро▓рпН роЖродро░ро╡рпБ роЖро╡рогродрпНродро┐ро▓рпН](https://docs.microsoft.com/azure/cognitive-services/speech-service/language-support?WT.mc_id=academic-17441-jabenn#speech-to-text) роХро╛рогро▓ро╛роорпН.

    `TOKEN_URL` рооро╛ро▒ро┐ роОройрпНрокродрпБ роЗроЯродрпНродрпИ роЗро▓рпНро▓ро╛рооро▓рпН роЯрпЛроХрпНроХройрпН ро╡ро┤роЩрпНроХрпБроиро░ро┐ройрпН URL роЖроХрпБроорпН. роЗродрпБ рокро┐ройрпНройро░рпН роорпБро┤рпБ URL-роР рокрпЖро▒ роЗроЯродрпНродрпБроЯройрпН роЗрогрпИроХрпНроХрокрпНрокроЯрпБроорпН.

1. Custom Vision-роХрпНроХрпБ роЗрогрпИрокрпНрокродрпБрокрпЛро▓, роЯрпЛроХрпНроХройрпН ро╡ро┤роЩрпНроХрпБроорпН роЪрпЗро╡рпИроХрпНроХрпБ HTTPS роЗрогрпИрокрпНрокрпИрокрпН рокропройрпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН. `config.h`-роЗройрпН роЗро▒рпБродро┐ропро┐ро▓рпН рокро┐ройрпНро╡ро░рпБроорпН роХрпБро▒ро┐ропрпАроЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    const char *TOKEN_CERTIFICATE =
        "-----BEGIN CERTIFICATE-----\r\n"
        "MIIF8zCCBNugAwIBAgIQAueRcfuAIek/4tmDg0xQwDANBgkqhkiG9w0BAQwFADBh\r\n"
        "MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\r\n"
        "d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBH\r\n"
        "MjAeFw0yMDA3MjkxMjMwMDBaFw0yNDA2MjcyMzU5NTlaMFkxCzAJBgNVBAYTAlVT\r\n"
        "MR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKjAoBgNVBAMTIU1pY3Jv\r\n"
        "c29mdCBBenVyZSBUTFMgSXNzdWluZyBDQSAwNjCCAiIwDQYJKoZIhvcNAQEBBQAD\r\n"
        "ggIPADCCAgoCggIBALVGARl56bx3KBUSGuPc4H5uoNFkFH4e7pvTCxRi4j/+z+Xb\r\n"
        "wjEz+5CipDOqjx9/jWjskL5dk7PaQkzItidsAAnDCW1leZBOIi68Lff1bjTeZgMY\r\n"
        "iwdRd3Y39b/lcGpiuP2d23W95YHkMMT8IlWosYIX0f4kYb62rphyfnAjYb/4Od99\r\n"
        "ThnhlAxGtfvSbXcBVIKCYfZgqRvV+5lReUnd1aNjRYVzPOoifgSx2fRyy1+pO1Uz\r\n"
        "aMMNnIOE71bVYW0A1hr19w7kOb0KkJXoALTDDj1ukUEDqQuBfBxReL5mXiu1O7WG\r\n"
        "0vltg0VZ/SZzctBsdBlx1BkmWYBW261KZgBivrql5ELTKKd8qgtHcLQA5fl6JB0Q\r\n"
        "gs5XDaWehN86Gps5JW8ArjGtjcWAIP+X8CQaWfaCnuRm6Bk/03PQWhgdi84qwA0s\r\n"
        "sRfFJwHUPTNSnE8EiGVk2frt0u8PG1pwSQsFuNJfcYIHEv1vOzP7uEOuDydsmCjh\r\n"
        "lxuoK2n5/2aVR3BMTu+p4+gl8alXoBycyLmj3J/PUgqD8SL5fTCUegGsdia/Sa60\r\n"
        "N2oV7vQ17wjMN+LXa2rjj/b4ZlZgXVojDmAjDwIRdDUujQu0RVsJqFLMzSIHpp2C\r\n"
        "Zp7mIoLrySay2YYBu7SiNwL95X6He2kS8eefBBHjzwW/9FxGqry57i71c2cDAgMB\r\n"
        "AAGjggGtMIIBqTAdBgNVHQ4EFgQU1cFnOsKjnfR3UltZEjgp5lVou6UwHwYDVR0j\r\n"
        "BBgwFoAUTiJUIBiV5uNu5g/6+rkS7QYXjzkwDgYDVR0PAQH/BAQDAgGGMB0GA1Ud\r\n"
        "JQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMHYG\r\n"
        "CCsGAQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQu\r\n"
        "Y29tMEAGCCsGAQUFBzAChjRodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGln\r\n"
        "aUNlcnRHbG9iYWxSb290RzIuY3J0MHsGA1UdHwR0MHIwN6A1oDOGMWh0dHA6Ly9j\r\n"
        "cmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RHMi5jcmwwN6A1oDOG\r\n"
        "MWh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RHMi5j\r\n"
        "cmwwHQYDVR0gBBYwFDAIBgZngQwBAgEwCAYGZ4EMAQICMBAGCSsGAQQBgjcVAQQD\r\n"
        "AgEAMA0GCSqGSIb3DQEBDAUAA4IBAQB2oWc93fB8esci/8esixj++N22meiGDjgF\r\n"
        "+rA2LUK5IOQOgcUSTGKSqF9lYfAxPjrqPjDCUPHCURv+26ad5P/BYtXtbmtxJWu+\r\n"
        "cS5BhMDPPeG3oPZwXRHBJFAkY4O4AF7RIAAUW6EzDflUoDHKv83zOiPfYGcpHc9s\r\n"
        "kxAInCedk7QSgXvMARjjOqdakor21DTmNIUotxo8kHv5hwRlGhBJwps6fEVi1Bt0\r\n"
        "trpM/3wYxlr473WSPUFZPgP1j519kLpWOJ8z09wxay+Br29irPcBYv0GMXlHqThy\r\n"
        "8y4m/HyTQeI2IMvMrQnwqPpY+rLIXyviI2vLoI+4xKE4Rn38ZZ8m\r\n"
        "-----END CERTIFICATE-----\r\n";
    ```

    роЗродрпБ Custom Vision-роХрпНроХрпБ роЗрогрпИроХрпНроХрпБроорпН рокрпЛродрпБ роирпАроЩрпНроХро│рпН рокропройрпНрокроЯрпБродрпНродро┐роп роЪро╛ройрпНро▒ро┐родро┤рпЗ.

1. `main.cpp` роХрпЛрокрпНрокро┐ройрпН роорпЗро▓рпН рокроХрпБродро┐ропро┐ро▓рпН WiFi родро▓рпИрокрпНрокрпБ роХрпЛрокрпНрокро┐ро▒рпНроХрпБроорпН config родро▓рпИрокрпНрокрпБ роХрпЛрокрпНрокро┐ро▒рпНроХрпБроорпН роТро░рпБ роЪрпЗро░рпНроХрпНроХрпИропрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    #include <rpcWiFi.h>

    #include "config.h"
    ```

1. `setup` роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ро▒рпНроХрпБ роорпЗро▓рпЗ `main.cpp`-роЗро▓рпН WiFi-роХрпНроХрпБ роЗрогрпИроХрпНроХ роХрпБро▒ро┐ропрпАроЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    void connectWiFi()
    {
        while (WiFi.status() != WL_CONNECTED)
        {
            Serial.println("Connecting to WiFi..");
            WiFi.begin(SSID, PASSWORD);
            delay(500);
        }
    
        Serial.println("Connected!");
    }
    ```

1. роЪрпАро░ро┐ропро▓рпН роЗрогрпИрокрпНрокрпБ роиро┐ро▒рпБро╡рокрпНрокроЯрпНроЯ рокро┐ро▒роХрпБ `setup` роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ро▓рпН роЗроирпНрод роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ роЕро┤рпИроХрпНроХро╡рпБроорпН:

    ```cpp
    connectWiFi();
    ```

1. `src` роХрпЛрокрпНрокроХродрпНродро┐ро▓рпН `speech_to_text.h` роОройрпНро▒ рокрпБродро┐роп родро▓рпИрокрпНрокрпБ роХрпЛрокрпНрокрпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН. роЗроирпНрод родро▓рпИрокрпНрокрпБ роХрпЛрокрпНрокро┐ро▓рпН рокро┐ройрпНро╡ро░рпБроорпН роХрпБро▒ро┐ропрпАроЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    #pragma once
    
    #include <Arduino.h>
    #include <ArduinoJson.h>
    #include <HTTPClient.h>
    #include <WiFiClientSecure.h>
    
    #include "config.h"
    #include "mic.h"
    
    class SpeechToText
    {
    public:

    private:

    };

    SpeechToText speechToText;
    ```

    роЗродрпБ HTTP роЗрогрпИрокрпНрокро┐ро▒рпНроХро╛рой роЪро┐ро▓ родрпЗро╡рпИропро╛рой родро▓рпИрокрпНрокрпБ роХрпЛрокрпНрокрпБроХро│рпИ, роХроЯрпНроЯроорпИрокрпНрокрпИ рооро▒рпНро▒рпБроорпН `mic.h` родро▓рпИрокрпНрокрпБ роХрпЛрокрпНрокрпИ роЪрпЗро░рпНроХрпНроХро┐ро▒родрпБ, роорпЗро▓рпБроорпН `SpeechToText` роОройрпНро▒ ро╡роХрпБрокрпНрокрпИ ро╡ро░рпИропро▒рпБроХрпНроХро┐ро▒родрпБ, рокро┐ройрпНройро░рпН рокро┐ройрпНройро░рпН рокропройрпНрокроЯрпБродрпНродроХрпНроХрпВроЯро┐роп роЕроирпНрод ро╡роХрпБрокрпНрокро┐ройрпН роТро░рпБ роЙродро╛ро░рогродрпНродрпИ роЕро▒ро┐ро╡ро┐роХрпНроХро┐ро▒родрпБ.

1. роЗроирпНрод ро╡роХрпБрокрпНрокро┐ройрпН `private` рокро┐ро░ро┐ро╡ро┐ро▓рпН рокро┐ройрпНро╡ро░рпБроорпН 2 рокрпБро▓роЩрпНроХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    WiFiClientSecure _token_client;
    String _access_token;
    ```

    `_token_client` роОройрпНрокродрпБ HTTPS-роР рокропройрпНрокроЯрпБродрпНродрпБроорпН WiFi Client роЖроХрпБроорпН, роЗродрпБ роЕрогрпБроХро▓рпН роЯрпЛроХрпНроХройрпИрокрпН рокрпЖро▒ рокропройрпНрокроЯрпБродрпНродрокрпНрокроЯрпБроорпН. роЗроирпНрод роЯрпЛроХрпНроХройрпН рокро┐ройрпНройро░рпН `_access_token`-роЗро▓рпН роЪрпЗрооро┐роХрпНроХрокрпНрокроЯрпБроорпН.

1. `private` рокро┐ро░ро┐ро╡ро┐ро▓рпН рокро┐ройрпНро╡ро░рпБроорпН роорпБро▒рпИроЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    String getAccessToken()
    {
        char url[128];
        sprintf(url, TOKEN_URL, SPEECH_LOCATION);
    
        HTTPClient httpClient;
        httpClient.begin(_token_client, url);
    
        httpClient.addHeader("Ocp-Apim-Subscription-Key", SPEECH_API_KEY);
        int httpResultCode = httpClient.POST("{}");
    
        if (httpResultCode != 200)
        {
            Serial.println("Error getting access token, trying again...");
            delay(10000);
            return getAccessToken();
        }
    
        Serial.println("Got access token.");
        String result = httpClient.getString();
    
        httpClient.end();
    
        return result;
    }
    ```

    роЗроирпНрод роХрпБро▒ро┐ропрпАроЯрпБ рокрпЗроЪрпНроЪрпИ ро╡ро│родрпНродро┐ройрпН роЗроЯродрпНродрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роЯрпЛроХрпНроХройрпН ро╡ро┤роЩрпНроХрпБроиро░рпН API-роХрпНроХро╛рой URL-роР роЙро░рпБро╡ро╛роХрпНроХрпБроХро┐ро▒родрпБ. рокро┐ройрпНройро░рпН роТро░рпБ `HTTPClient` роЙро░рпБро╡ро╛роХрпНроХро┐ ро╡ро▓рпИ роХрпЛро░ро┐роХрпНроХрпИропрпИроЪрпН роЪрпЖропрпНроХро┐ро▒родрпБ, WiFi роХро┐ро│рпИропрогрпНроЯрпИ роЯрпЛроХрпНроХройрпН роорпБроЯро┐ро╡рпБроХро│ро┐ройрпН роЪро╛ройрпНро▒ро┐родро┤рпБроЯройрпН роЕроорпИроХрпНроХро┐ро▒родрпБ. API ро╡ро┐роЪрпИропрпИ роЕро┤рпИрокрпНрокрпБроХрпНроХро╛рой родро▓рпИрокрпНрокро╛роХ роЕроорпИроХрпНроХро┐ро▒родрпБ. рокро┐ройрпНройро░рпН роЪро╛ройрпНро▒ро┐родро┤рпИрокрпН рокрпЖро▒ POST роХрпЛро░ро┐роХрпНроХрпИропрпИроЪрпН роЪрпЖропрпНроХро┐ро▒родрпБ, роОроирпНродро╡рпКро░рпБ рокро┐ро┤рпИроХро│рпИропрпБроорпН рокрпЖро▒рпБроорпНрокрпЛродрпБ роорпАрогрпНроЯрпБроорпН роорпБропро▒рпНроЪро┐роХрпНроХро┐ро▒родрпБ. роЗро▒рпБродро┐ропро╛роХ роЕрогрпБроХро▓рпН роЯрпЛроХрпНроХройрпН родро┐ро░рпБрокрпНрокрокрпНрокроЯрпБроХро┐ро▒родрпБ.

1. `public` рокро┐ро░ро┐ро╡ро┐ро▓рпН, роЕрогрпБроХро▓рпН роЯрпЛроХрпНроХройрпИрокрпН рокрпЖро▒ роТро░рпБ роорпБро▒рпИроЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН. роЗродрпБ роЙро░рпИропрпИ рокрпЗроЪрпНроЪро╛роХ рооро╛ро▒рпНро▒рпБро╡родро▒рпНроХро╛рой рокро┐ройрпНройро░рпН рокро╛роЯроЩрпНроХро│ро┐ро▓рпН родрпЗро╡рпИрокрпНрокроЯрпБроорпН.

    ```cpp
    String AccessToken()
    {
        return _access_token;
    }
    ```

1. `public` рокро┐ро░ро┐ро╡ро┐ро▓рпН, роЯрпЛроХрпНроХройрпН роХро┐ро│рпИропрогрпНроЯрпИ роЕроорпИроХрпНроХрпБроорпН роТро░рпБ `init` роорпБро▒рпИроЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    void init()
    {
        _token_client.setCACert(TOKEN_CERTIFICATE);
        _access_token = getAccessToken();
    }
    ```

    роЗродрпБ WiFi роХро┐ро│рпИропрогрпНроЯро┐ро▓рпН роЪро╛ройрпНро▒ро┐родро┤рпИ роЕроорпИроХрпНроХро┐ро▒родрпБ, рокро┐ройрпНройро░рпН роЕрогрпБроХро▓рпН роЯрпЛроХрпНроХройрпИрокрпН рокрпЖро▒рпБроХро┐ро▒родрпБ.

1. `main.cpp`-роЗро▓рпН, роЗроирпНрод рокрпБродро┐роп родро▓рпИрокрпНрокрпБ роХрпЛрокрпНрокрпИ роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    #include "speech_to_text.h"
    ```

1. `setup` роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ройрпН роЗро▒рпБродро┐ропро┐ро▓рпН, `mic.init` роЕро┤рпИрокрпНрокрпБроХрпНроХрпБрокрпН рокро┐ро▒роХрпБ роЖройро╛ро▓рпН роЪрпАро░ро┐ропро▓рпН рооро╛ройро┐роЯрпНроЯро░ро┐ро▓рпН `Ready` роОро┤рпБродрпБро╡родро▒рпНроХрпБ роорпБройрпН `SpeechToText` ро╡роХрпБрокрпНрокрпИ роЖро░роорпНрокро┐роХрпНроХро╡рпБроорпН:

    ```cpp
    speechToText.init();
    ```

### рокрогро┐роХро│рпН - роГрокрпНро│ро╛ро╖рпН роиро┐ройрпИро╡роХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ роЖроЯро┐ропрпЛро╡рпИрокрпН рокроЯро┐роХрпНроХро╡рпБроорпН

1. роЗроирпНрод рокро╛роЯродрпНродро┐ройрпН роорпБроирпНродрпИроп рокроХрпБродро┐ропро┐ро▓рпН, роЖроЯро┐ропрпЛ роГрокрпНро│ро╛ро╖рпН роиро┐ройрпИро╡роХродрпНродро┐ро▓рпН рокродро┐ро╡рпБ роЪрпЖропрпНропрокрпНрокроЯрпНроЯродрпБ. роЗроирпНрод роЖроЯро┐ропрпЛ Speech Services REST API-роХрпНроХрпБ роЕройрпБрокрпНрокрокрпНрокроЯ ро╡рпЗрогрпНроЯрпБроорпН, роОройро╡рпЗ роЗродрпБ роГрокрпНро│ро╛ро╖рпН роиро┐ройрпИро╡роХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ рокроЯро┐роХрпНроХрокрпНрокроЯ ро╡рпЗрогрпНроЯрпБроорпН. роЗродрпБ роиро┐ройрпИро╡роХродрпНродро┐ро▓рпН роЙро│рпНро│ роТро░рпБ роЗроЯрпИроиро┐ро▓рпИ рокроГрокро░ро┐ро▓рпН роПро▒рпНро▒рокрпНрокроЯ роорпБроЯро┐ропро╛родрпБ, роПройрпЖройро┐ро▓рпН роЗродрпБ рооро┐роХро╡рпБроорпН рокрпЖро░ро┐ропродро╛роХ роЗро░рпБроХрпНроХрпБроорпН. REST роЕро┤рпИрокрпНрокрпБроХро│рпИроЪрпН роЪрпЖропрпНропрпБроорпН `HTTPClient` ро╡роХрпБрокрпНрокрпБ роТро░рпБ Arduino Stream-роРрокрпН рокропройрпНрокроЯрпБродрпНродро┐ родро░ро╡рпБроХро│рпИ ро╕рпНроЯрпНро░рпАроорпН роЪрпЖропрпНроп роорпБроЯро┐ропрпБроорпН - роЗродрпБ роЪро┐ро▒ро┐роп родрпБрогрпНроЯрпБроХро│ро┐ро▓рпН родро░ро╡рпБроХро│рпИ роПро▒рпНро▒ роорпБроЯро┐ропрпБроорпН, роХрпЛро░ро┐роХрпНроХрпИропро┐ройрпН роТро░рпБ рокроХрпБродро┐ропро╛роХ роТро╡рпНро╡рпКро░рпБ роорпБро▒рпИропрпБроорпН роТро░рпБ родрпБрогрпНроЯрпИ роЕройрпБрокрпНрокрпБроХро┐ро▒родрпБ. роТро╡рпНро╡рпКро░рпБ роорпБро▒рпИропрпБроорпН роирпАроЩрпНроХро│рпН ро╕рпНроЯрпНро░рпАрооро┐ро▓рпН `read` роЕро┤рпИроХрпНроХрпБроорпНрокрпЛродрпБ, тАЛтАЛроЕроЯрпБродрпНрод родро░ро╡рпБродрпН родрпКроХрпБродро┐ропрпИродрпН родро┐ро░рпБрокрпНрокрпБроХро┐ро▒родрпБ. роГрокрпНро│ро╛ро╖рпН роиро┐ройрпИро╡роХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ рокроЯро┐роХрпНроХ роорпБроЯро┐ропрпБроорпН Arduino ро╕рпНроЯрпНро░рпАроорпН роЙро░рпБро╡ро╛роХрпНроХро▓ро╛роорпН. `src` роХрпЛрокрпНрокроХродрпНродро┐ро▓рпН `flash_stream.h` роОройрпНро▒ рокрпБродро┐роп роХрпЛрокрпНрокрпИ роЙро░рпБро╡ро╛роХрпНроХро┐, роЕродро┐ро▓рпН рокро┐ройрпНро╡ро░рпБроорпН роХрпБро▒ро┐ропрпАроЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    #pragma once
    
    #include <Arduino.h>
    #include <HTTPClient.h>
    #include <sfud.h>

    #include "config.h"
    
    class FlashStream : public Stream
    {
    public:
        virtual size_t write(uint8_t val)
        {    
        }
    
        virtual int available()
        {
        }
    
        virtual int read()
        {
        }
    
        virtual int peek()
        {
        }
    private:
    
    };
    ```

    роЗродрпБ Arduino `Stream` ро╡роХрпБрокрпНрокро┐ро▓ро┐ро░рпБроирпНродрпБ рокрпЖро▒рокрпНрокроЯрпНроЯ `FlashStream` ро╡роХрпБрокрпНрокрпИ роЕро▒ро┐ро╡ро┐роХрпНроХро┐ро▒родрпБ. роЗродрпБ роТро░рпБ роЕрокрпНро╕рпНроЯрпНро░ро╛роХрпНроЯрпН ро╡роХрпБрокрпНрокрпБ - рокрпЖро▒рокрпНрокроЯрпНроЯ ро╡роХрпБрокрпНрокрпБроХро│рпН роЪро┐ро▓ роорпБро▒рпИроХро│рпИ роЪрпЖропро▓рпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН, рокро┐ройрпНройро░рпН ро╡роХрпБрокрпНрокрпИ роЙро░рпБро╡ро╛роХрпНроХ роорпБроЯро┐ропрпБроорпН, роорпЗро▓рпБроорпН роЗроирпНрод роорпБро▒рпИроХро│рпН роЗроирпНрод ро╡роХрпБрокрпНрокро┐ро▓рпН ро╡ро░рпИропро▒рпБроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│рой.

    тЬЕ Arduino ро╕рпНроЯрпНро░рпАроорпНроХро│рпН рокро▒рпНро▒ро┐роп роорпЗро▓рпБроорпН роЕро▒ро┐роп [Arduino Stream роЖро╡рогродрпНродро┐ро▓рпН](https://www.arduino.cc/reference/en/language/functions/communication/stream/)

1. `private` рокро┐ро░ро┐ро╡ро┐ро▓рпН рокро┐ройрпНро╡ро░рпБроорпН рокрпБро▓роЩрпНроХро│рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    size_t _pos;
    size_t _flash_address;
    const sfud_flash *_flash;

    byte _buffer[HTTP_TCP_BUFFER_SIZE];
    ```

    роЗродрпБ роГрокрпНро│ро╛ро╖рпН роиро┐ройрпИро╡роХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ рокроЯро┐роХрпНроХрокрпНрокроЯрпБроорпН родро░ро╡родрпНродрпИ роЪрпЗрооро┐роХрпНроХ родро▒рпНроХро╛ро▓ро┐роХ рокроГрокро░рпИ ро╡ро░рпИропро▒рпБроХрпНроХро┐ро▒родрпБ, рокроГрокро░ро┐ро▓рпН рокроЯро┐роХрпНроХрпБроорпН рокрпЛродрпБ родро▒рпНрокрпЛродрпИроп роиро┐ро▓рпИропрпИ, роГрокрпНро│ро╛ро╖рпН роиро┐ройрпИро╡роХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ рокроЯро┐роХрпНроХ родро▒рпНрокрпЛродрпИроп роорпБроХро╡ро░ро┐ропрпИ рооро▒рпНро▒рпБроорпН роГрокрпНро│ро╛ро╖рпН роиро┐ройрпИро╡роХ роЪро╛родройродрпНродрпИроЪрпН роЪрпЗро░рпНроХрпНроХро┐ро▒родрпБ.

1. `private` рокро┐ро░ро┐ро╡ро┐ро▓рпН рокро┐ройрпНро╡ро░рпБроорпН роорпБро▒рпИроЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    void populateBuffer()
    {
        sfud_read(_flash, _flash_address, HTTP_TCP_BUFFER_SIZE, _buffer);
        _flash_address += HTTP_TCP_BUFFER_SIZE;
        _pos = 0;
    }
    ```

    роЗроирпНрод роХрпБро▒ро┐ропрпАроЯрпБ роГрокрпНро│ро╛ро╖рпН роиро┐ройрпИро╡роХродрпНродро┐ро▓рпН родро▒рпНрокрпЛродрпИроп роорпБроХро╡ро░ро┐ропро┐ро▓рпН роЗро░рпБроирпНродрпБ рокроЯро┐роХрпНроХро┐ро▒родрпБ рооро▒рпНро▒рпБроорпН родро░ро╡рпБроХро│рпИ рокроГрокро░ро┐ро▓рпН роЪрпЗрооро┐роХрпНроХро┐ро▒родрпБ. рокро┐ройрпНройро░рпН роорпБроХро╡ро░ро┐ропрпИ роЕродро┐роХро░ро┐роХрпНроХро┐ро▒родрпБ, роОройро╡рпЗ роЕроЯрпБродрпНрод роЕро┤рпИрокрпНрокрпБ роЮро╛рокроХродрпНродро┐ройрпН роЕроЯрпБродрпНрод родрпКроХрпБродро┐ропрпИ рокроЯро┐роХрпНроХро┐ро▒родрпБ. рокроГрокро░рпН HTTPClient REST API-роХрпНроХрпБ роТро░рпЗ роирпЗро░родрпНродро┐ро▓рпН роЕройрпБрокрпНрокрпБроорпН рооро┐роХрокрпНрокрпЖро░ро┐роп родрпБрогрпНроЯро┐ройрпН роЕро│ро╡рпИ роЕроЯро┐рокрпНрокроЯрпИропро╛роХроХрпН роХрпКрогрпНроЯродрпБ.

    > ЁЯТБ роГрокрпНро│ро╛ро╖рпН роиро┐ройрпИро╡роХродрпНродрпИ роЕро┤ро┐рокрпНрокродрпБ родро╛ройро┐роп роЕро│ро╡рпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роЪрпЖропрпНроп ро╡рпЗрогрпНроЯрпБроорпН, рокроЯро┐роХрпНроХрпБроорпНрокрпЛродрпБ роЕро╡рпНро╡ро╛ро▒рпБ родрпЗро╡рпИропро┐ро▓рпНро▓рпИ.

1. роЗроирпНрод ро╡роХрпБрокрпНрокро┐ройрпН `public` рокро┐ро░ро┐ро╡ро┐ро▓рпН роТро░рпБ роХроЯрпНроЯроорпИрокрпНрокро╛ро│ро░рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    FlashStream()
    {
        _pos = 0;
        _flash_address = 0;
        _flash = sfud_get_device_table() + 0;
        
        populateBuffer();
    }
    ```

    роЗроирпНрод роХроЯрпНроЯроорпИрокрпНрокро╛ро│ро░рпН роГрокрпНро│ро╛ро╖рпН роиро┐ройрпИро╡роХ родрпКроХрпБродро┐ропро┐ройрпН родрпКроЯроХрпНроХродрпНродро┐ро▓рпН роЗро░рпБроирпНродрпБ рокроЯро┐роХрпНроХ родрпКроЯроЩрпНроХ роЕройрпИродрпНродрпБ рокрпБро▓роЩрпНроХро│рпИропрпБроорпН роЕроорпИроХрпНроХро┐ро▒родрпБ, роорпЗро▓рпБроорпН рокроГрокро░ро┐ро▓рпН роорпБродро▓рпН родрпБрогрпНроЯрпБ родро░ро╡рпБроХро│рпИ роПро▒рпНро▒рпБроХро┐ро▒родрпБ.

1. `write` роорпБро▒рпИропрпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродро╡рпБроорпН. роЗроирпНрод ро╕рпНроЯрпНро░рпАроорпН родро░ро╡рпБроХро│рпИ роороЯрпНроЯрпБроорпН рокроЯро┐роХрпНроХрпБроорпН, роОройро╡рпЗ роЗродрпБ роОродрпБро╡рпБроорпН роЪрпЖропрпНропро╛рооро▓рпН 0-роР родро┐ро░рпБрокрпНрокро▓ро╛роорпН:

    ```cpp
    virtual size_t write(uint8_t val)
    {
        return 0;
    }
    ```

1. `peek` роорпБро▒рпИропрпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродро╡рпБроорпН. роЗродрпБ ро╕рпНроЯрпНро░рпАрооро┐ро▓рпН роироХро░ро╛рооро▓рпН родро▒рпНрокрпЛродрпИроп роиро┐ро▓рпИропро┐ройрпН родро░ро╡рпБроХро│рпИ родро┐ро░рпБрокрпНрокрпБроХро┐ро▒родрпБ. ро╕рпНроЯрпНро░рпАрооро┐ро▓рпН роОроирпНродро╡рпКро░рпБ родро░ро╡рпИропрпБроорпН рокроЯро┐роХрпНроХро╛рооро▓рпН `peek` рокро▓роорпБро▒рпИ роЕро┤рпИроХрпНроХрпБроорпНрокрпЛродрпБ, тАЛтАЛроЕродрпЗ родро░ро╡рпБроХро│рпИ родро┐ро░рпБрокрпНрокрпБроорпН.

    ```cpp
    virtual int peek()
    {
        return _buffer[_pos];
    }
    ```

1. `available` роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродро╡рпБроорпН. роЗродрпБ ро╕рпНроЯрпНро░рпАрооро┐ро▓рпН роЗро░рпБроирпНродрпБ роОродрпНродройрпИ рокрпИроЯрпНроХро│рпИ рокроЯро┐роХрпНроХ роорпБроЯро┐ропрпБроорпН роОройрпНрокродрпИ родро┐ро░рпБрокрпНрокрпБроХро┐ро▒родрпБ, роЕро▓рпНро▓родрпБ ро╕рпНроЯрпНро░рпАроорпН роорпБроЯро┐роирпНродро╛ро▓рпН -1 родро┐ро░рпБрокрпНрокрпБроХро┐ро▒родрпБ. роЗроирпНрод ро╡роХрпБрокрпНрокро┐ро▒рпНроХро╛рой роЕродро┐роХрокроЯрпНроЪроорпН HTTPClient-ройрпН родрпБрогрпНроЯрпБ роЕро│ро╡рпИ ро╡ро┐роЯ роЕродро┐роХрооро╛роХ роЗро░рпБроХрпНроХро╛родрпБ. роЗроирпНрод ро╕рпНроЯрпНро░рпАроорпН HTTP роХро┐ро│рпИропрогрпНроЯро┐ро▓рпН рокропройрпНрокроЯрпБродрпНродрокрпНрокроЯрпБроорпН рокрпЛродрпБ, тАЛтАЛроЕродрпБ роОро╡рпНро╡ро│ро╡рпБ родро░ро╡рпБроХро│рпН роХро┐роЯрпИроХрпНроХро┐ройрпНро▒рой роОройрпНрокродрпИрокрпН рокро╛ро░рпНроХрпНроХ роЗроирпНрод роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ роЕро┤рпИроХрпНроХро┐ро▒родрпБ, рокро┐ройрпНройро░рпН REST API-роХрпНроХрпБ роЕройрпБрокрпНрок роЕроирпНрод роЕро│ро╡рпБ родро░ро╡рпБроХро│рпИ роХрпЛро░рпБроХро┐ро▒родрпБ. роТро╡рпНро╡рпКро░рпБ родрпБрогрпНроЯрпБроорпН HTTP роХро┐ро│рпИропрогрпНроЯро┐ройрпН родрпБрогрпНроЯрпБ роЕро│ро╡рпИ ро╡ро┐роЯ роЕродро┐роХрооро╛роХ роЗро░рпБроХрпНроХроХрпНроХрпВроЯро╛родрпБ, роОройро╡рпЗ роЕродро┐роХрооро╛роХ роХро┐роЯрпИроХрпНроХрпБрооро╛ройро╛ро▓рпН, родрпБрогрпНроЯрпБ роЕро│ро╡рпБ родро┐ро░рпБрокрпНрокрокрпНрокроЯрпБроХро┐ро▒родрпБ. роХрпБро▒рпИро╡ро╛роХ роЗро░рпБроирпНродро╛ро▓рпН, роХро┐роЯрпИроХрпНроХроХрпНроХрпВроЯро┐роп роЕро│ро╡рпБ родро┐ро░рпБрокрпНрокрокрпНрокроЯрпБроХро┐ро▒родрпБ. роЕройрпИродрпНродрпБ родро░ро╡рпБроХро│рпБроорпН ро╕рпНроЯрпНро░рпАроорпН роЪрпЖропрпНропрокрпНрокроЯрпНроЯ рокро┐ро▒роХрпБ, -1 родро┐ро░рпБрокрпНрокрокрпНрокроЯрпБроХро┐ро▒родрпБ.

    ```cpp
    virtual int available()
    {
        int remaining = BUFFER_SIZE - ((_flash_address - HTTP_TCP_BUFFER_SIZE) + _pos);
        int bytes_available = min(HTTP_TCP_BUFFER_SIZE, remaining);

        if (bytes_available == 0)
        {
            bytes_available = -1;
        }

        return bytes_available;
    }
    ```

1. рокроГрокро░ро┐ро▓рпН роЗро░рпБроирпНродрпБ роЕроЯрпБродрпНрод рокрпИроЯрпНроЯрпИ родро┐ро░рпБрокрпНрок `read` роорпБро▒рпИропрпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродро╡рпБроорпН, роиро┐ро▓рпИропрпИ роЕродро┐роХро░ро┐роХрпНроХро╡рпБроорпН. роиро┐ро▓рпИ рокроГрокро░ро┐ройрпН роЕро│ро╡рпИ роорпАро▒ро┐ройро╛ро▓рпН, роГрокрпНро│ро╛ро╖рпН роиро┐ройрпИро╡роХродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ роЕроЯрпБродрпНрод родрпКроХрпБродро┐ропрпИ рокроГрокро░ро┐ро▓рпН роиро┐ро░рокрпНрокрпБроХро┐ро▒родрпБ рооро▒рпНро▒рпБроорпН роиро┐ро▓рпИропрпИ роорпАроЯрпНроЯроорпИроХрпНроХро┐ро▒родрпБ.

    ```cpp
    virtual int read()
    {
        int retVal = _buffer[_pos++];

        if (_pos == HTTP_TCP_BUFFER_SIZE)
        {
            populateBuffer();
        }

        return retVal;
    }
    ```

1. `speech_to_text.h` родро▓рпИрокрпНрокрпБ роХрпЛрокрпНрокро┐ро▓рпН, роЗроирпНрод рокрпБродро┐роп родро▓рпИрокрпНрокрпБ роХрпЛрокрпНрокро┐ро▒рпНроХро╛рой роТро░рпБ роЪрпЗро░рпНроХрпНроХрпИропрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    #include "flash_stream.h"
    ```

### рокрогро┐роХро│рпН - рокрпЗроЪрпНроЪрпИ роЙро░рпИропро╛роХ рооро╛ро▒рпНро▒рпБродро▓рпН

1. рокрпЗроЪрпНроЪрпИ REST API роорпВро▓роорпН Speech Service-роХрпНроХрпБ роЕройрпБрокрпНрокрпБро╡родройрпН роорпВро▓роорпН роЙро░рпИропро╛роХ рооро╛ро▒рпНро▒ро▓ро╛роорпН. роЗроирпНрод REST API-роХрпНроХрпБ роЯрпЛроХрпНроХройрпН ро╡ро┤роЩрпНроХрпБроиро░рпБроХрпНроХрпБ рооро╛ро▒рпБрокроЯрпНроЯ роЪро╛ройрпНро▒ро┐родро┤рпН роЙро│рпНро│родрпБ, роОройро╡рпЗ роЗроирпНрод роЪро╛ройрпНро▒ро┐родро┤рпИ ро╡ро░рпИропро▒рпБроХрпНроХ `config.h` родро▓рпИрокрпНрокрпБ роХрпЛрокрпНрокро┐ро▓рпН рокро┐ройрпНро╡ро░рпБроорпН роХрпБро▒ро┐ропрпАроЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    const char *SPEECH_CERTIFICATE =
        "-----BEGIN CERTIFICATE-----\r\n"
        "MIIF8zCCBNugAwIBAgIQCq+mxcpjxFFB6jvh98dTFzANBgkqhkiG9w0BAQwFADBh\r\n"
        "MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\r\n"
        "d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBH\r\n"
        "MjAeFw0yMDA3MjkxMjMwMDBaFw0yNDA2MjcyMzU5NTlaMFkxCzAJBgNVBAYTAlVT\r\n"
        "MR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKjAoBgNVBAMTIU1pY3Jv\r\n"
        "c29mdCBBenVyZSBUTFMgSXNzdWluZyBDQSAwMTCCAiIwDQYJKoZIhvcNAQEBBQAD\r\n"
        "ggIPADCCAgoCggIBAMedcDrkXufP7pxVm1FHLDNA9IjwHaMoaY8arqqZ4Gff4xyr\r\n"
        "RygnavXL7g12MPAx8Q6Dd9hfBzrfWxkF0Br2wIvlvkzW01naNVSkHp+OS3hL3W6n\r\n"
        "l/jYvZnVeJXjtsKYcXIf/6WtspcF5awlQ9LZJcjwaH7KoZuK+THpXCMtzD8XNVdm\r\n"
        "GW/JI0C/7U/E7evXn9XDio8SYkGSM63aLO5BtLCv092+1d4GGBSQYolRq+7Pd1kR\r\n"
        "EkWBPm0ywZ2Vb8GIS5DLrjelEkBnKCyy3B0yQud9dpVsiUeE7F5sY8Me96WVxQcb\r\n"
        "OyYdEY/j/9UpDlOG+vA+YgOvBhkKEjiqygVpP8EZoMMijephzg43b5Qi9r5UrvYo\r\n"
        "o19oR/8pf4HJNDPF0/FJwFVMW8PmCBLGstin3NE1+NeWTkGt0TzpHjgKyfaDP2tO\r\n"
        "4bCk1G7pP2kDFT7SYfc8xbgCkFQ2UCEXsaH/f5YmpLn4YPiNFCeeIida7xnfTvc4\r\n"
        "7IxyVccHHq1FzGygOqemrxEETKh8hvDR6eBdrBwmCHVgZrnAqnn93JtGyPLi6+cj\r\n"
        "WGVGtMZHwzVvX1HvSFG771sskcEjJxiQNQDQRWHEh3NxvNb7kFlAXnVdRkkvhjpR\r\n"
        "GchFhTAzqmwltdWhWDEyCMKC2x/mSZvZtlZGY+g37Y72qHzidwtyW7rBetZJAgMB\r\n"
        "AAGjggGtMIIBqTAdBgNVHQ4EFgQUDyBd16FXlduSzyvQx8J3BM5ygHYwHwYDVR0j\r\n"
        "BBgwFoAUTiJUIBiV5uNu5g/6+rkS7QYXjzkwDgYDVR0PAQH/BAQDAgGGMB0GA1Ud\r\n"
        "JQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMHYG\r\n"
        "CCsGAQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQu\r\n"
        "Y29tMEAGCCsGAQUFBzAChjRodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGln\r\n"
        "aUNlcnRHbG9iYWxSb290RzIuY3J0MHsGA1UdHwR0MHIwN6A1oDOGMWh0dHA6Ly9j\r\n"
        "cmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RHMi5jcmwwN6A1oDOG\r\n"
        "MWh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RHMi5j\r\n"
        "cmwwHQYDVR0gBBYwFDAIBgZngQwBAgEwCAYGZ4EMAQICMBAGCSsGAQQBgjcVAQQD\r\n"
        "AgEAMA0GCSqGSIb3DQEBDAUAA4IBAQAlFvNh7QgXVLAZSsNR2XRmIn9iS8OHFCBA\r\n"
        "WxKJoi8YYQafpMTkMqeuzoL3HWb1pYEipsDkhiMnrpfeYZEA7Lz7yqEEtfgHcEBs\r\n"
        "K9KcStQGGZRfmWU07hPXHnFz+5gTXqzCE2PBMlRgVUYJiA25mJPXfB00gDvGhtYa\r\n"
        "+mENwM9Bq1B9YYLyLjRtUz8cyGsdyTIG/bBM/Q9jcV8JGqMU/UjAdh1pFyTnnHEl\r\n"
        "Y59Npi7F87ZqYYJEHJM2LGD+le8VsHjgeWX2CJQko7klXvcizuZvUEDTjHaQcs2J\r\n"
        "+kPgfyMIOY1DMJ21NxOJ2xPRC/wAh/hzSBRVtoAnyuxtkZ4VjIOh\r\n"
        "-----END CERTIFICATE-----\r\n";
    ```

1. роЗроирпНрод роХрпЛрокрпНрокро┐ро▓рпН роЗроЯродрпНродрпИ роЗро▓рпНро▓ро╛рооро▓рпН рокрпЗроЪрпНроЪрпБ URL-роХрпНроХро╛рой роТро░рпБ рооро╛ро▒ро┐ропрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН. роЗродрпБ роЗроЯродрпНродрпБроЯройрпН роорпКро┤ро┐ропрпИ роЗрогрпИродрпНродрпБ роорпБро┤рпБ URL-роР рокрпЖро▒рокрпНрокроЯрпБроорпН.

    ```cpp
    const char *SPEECH_URL = "https://%s.stt.speech.microsoft.com/speech/recognition/conversation/cognitiveservices/v1?language=%s";
    ```

1. `speech_to_text.h` родро▓рпИрокрпНрокрпБ роХрпЛрокрпНрокро┐ро▓рпН, `SpeechToText` ро╡роХрпБрокрпНрокро┐ройрпН `private` рокро┐ро░ро┐ро╡ро┐ро▓рпН рокрпЗроЪрпНроЪрпБ роЪро╛ройрпНро▒ро┐родро┤рпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБроорпН WiFi Client-роХрпНроХро╛рой роТро░рпБ рокрпБро▓родрпНродрпИ ро╡ро░рпИропро▒рпБроХрпНроХро╡рпБроорпН:

    ```cpp
    WiFiClientSecure _speech_client;
    ```

1. `init` роорпБро▒рпИропро┐ро▓рпН, роЗроирпНрод WiFi Client-ро▓рпН роЪро╛ройрпНро▒ро┐родро┤рпИ роЕроорпИроХрпНроХро╡рпБроорпН:

    ```cpp
    _speech_client.setCACert(SPEECH_CERTIFICATE);
    ```

1. `SpeechToText` ро╡роХрпБрокрпНрокро┐ройрпН `public` рокро┐ро░ро┐ро╡ро┐ро▓рпН рокрпЗроЪрпНроЪрпИ роЙро░рпИропро╛роХ рооро╛ро▒рпНро▒ роТро░рпБ роорпБро▒рпИроЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ ро╡ро░рпИропро▒рпБроХрпНроХ рокро┐ройрпНро╡ро░рпБроорпН роХрпБро▒ро┐ропрпАроЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    String convertSpeechToText()
    {
        
    }
    ```

1. роЗроирпНрод роорпБро▒рпИропро┐ро▓рпН рокро┐ройрпНро╡ро░рпБроорпН роХрпБро▒ро┐ропрпАроЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН, рокрпЗроЪрпНроЪрпБ роЪро╛ройрпНро▒ро┐родро┤рпБроЯройрпН роЙро│рпНро│ WiFi Client-роРрокрпН рокропройрпНрокроЯрпБродрпНродро┐ HTTP роХро┐ро│рпИропрогрпНроЯрпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН, рооро▒рпНро▒рпБроорпН роЗроЯродрпНродрпБроЯройрпН роорпКро┤ро┐ропрпИ роЕроорпИродрпНрод URL-роРрокрпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН:

    ```cpp
    char url[128];
    sprintf(url, SPEECH_URL, SPEECH_LOCATION, LANGUAGE);

    HTTPClient httpClient;
    httpClient.begin(_speech_client, url);
    ```

1. роЗрогрпИрокрпНрокро┐ро▓рпН роЪро┐ро▓ родро▓рпИрокрпНрокрпБроХро│рпИ роЕроорпИроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН:

    ```cpp
    httpClient.addHeader("Authorization", String("Bearer ") + _access_token);
    httpClient.addHeader("Content-Type", String("audio/wav; codecs=audio/pcm; samplerate=") + String(RATE));
    httpClient.addHeader("Accept", "application/json;text/xml");
    ```

    роЗродрпБ роЕрогрпБроХро▓рпН роЯрпЛроХрпНроХройрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роЕроЩрпНроХрпАроХро╛ро░родрпНродро┐ро▒рпНроХро╛рой родро▓рпИрокрпНрокрпБроХро│рпИ роЕроорпИроХрпНроХро┐ро▒родрпБ, роЪро╛роорпНрокро┐ро│рпН ро╡рпАродродрпНродрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роЖроЯро┐ропрпЛ ро╡роЯро┐ро╡родрпНродрпИ роЕроорпИроХрпНроХро┐ро▒родрпБ, рооро▒рпНро▒рпБроорпН роХро┐ро│рпИропрогрпНроЯрпН роорпБроЯро┐ро╡рпИ JSON роЖроХ роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХро┐ро▒родрпБ.

1. роЗродро▒рпНроХрпБрокрпН рокро┐ро▒роХрпБ, REST API роЕро┤рпИрокрпНрокрпИроЪрпН роЪрпЖропрпНроп рокро┐ройрпНро╡ро░рпБроорпН роХрпБро▒ро┐ропрпАроЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    Serial.println("Sending speech...");

    FlashStream stream;
    int httpResponseCode = httpClient.sendRequest("POST", &stream, BUFFER_SIZE);

    Serial.println("Speech sent!");
    ```

    роЗродрпБ роТро░рпБ `FlashStream` роЙро░рпБро╡ро╛роХрпНроХро┐ REST API-роХрпНроХрпБ родро░ро╡рпБроХро│рпИ ро╕рпНроЯрпНро░рпАроорпН роЪрпЖропрпНроп рокропройрпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ.

1. роЗродро▒рпНроХрпБ роХрпАро┤рпЗ рокро┐ройрпНро╡ро░рпБроорпН роХрпБро▒ро┐ропрпАроЯрпНроЯрпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН:

    ```cpp
    String text = "";

    if (httpResponseCode == 200)
    {
        String result = httpClient.getString();
        Serial.println(result);

        DynamicJsonDocument doc(1024);
        deserializeJson(doc, result.c_str());

        JsonObject obj = doc.as<JsonObject>();
        text = obj["DisplayText"].as<String>();
    }
    else if (httpResponseCode == 401)
    {
        Serial.println("Access token expired, trying again with a new token");
        _access_token = getAccessToken();
        return convertSpeechToText();
    }
    else
    {
        Serial.print("Failed to convert text to speech - error ");
        Serial.println(httpResponseCode);
    }
    ```

    роЗроирпНрод роХрпБро▒ро┐ропрпАроЯрпБ рокродро┐ро▓ро│ро┐рокрпНрокрпБ роХрпБро▒ро┐ропрпАроЯрпНроЯрпИроЪрпН роЪро░ро┐рокро╛ро░рпНроХрпНроХро┐ро▒родрпБ.

    роЗродрпБ 200 роОройрпНро▒ ро╡рпЖро▒рпНро▒ро┐роХрпНроХрпБро▒ро┐ропрпАроЯрпБ роЗро░рпБроирпНродро╛ро▓рпН, роорпБроЯро┐ро╡рпБ JSON-роЗро▓рпН роЗро░рпБроирпНродрпБ роорпАроЯрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ, роЯро┐роХрпЛроЯрпН роЪрпЖропрпНропрокрпНрокроЯрпБроХро┐ро▒родрпБ, рооро▒рпНро▒рпБроорпН `DisplayText` роЪрпКродрпНродрпБ `text` рооро╛ро▒ро┐ропро┐ро▓рпН роЕроорпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ. рокрпЗроЪрпНроЪро┐ройрпН роЙро░рпИ рокродро┐рокрпНрокрпБ родро┐ро░рпБрокрпНрокрокрпНрокроЯрпБроорпН роЪрпКродрпНродрпБ роЗродрпБро╡рпЗ.

    рокродро┐ро▓ро│ро┐рокрпНрокрпБ роХрпБро▒ро┐ропрпАроЯрпБ 401 роОройрпНро▒ро╛ро▓рпН, роЕрогрпБроХро▓рпН роЯрпЛроХрпНроХройрпН роХро╛ро▓ро╛ро╡родро┐ропро╛роХро┐ро╡ро┐роЯрпНроЯродрпБ (роЗроирпНрод роЯрпЛроХрпНроХройрпНроХро│рпН 10 роиро┐рооро┐роЯроЩрпНроХро│рпН роороЯрпНроЯрпБроорпЗ роирпАроЯро┐роХрпНроХрпБроорпН). рокрпБродро┐роп роЕрогрпБроХро▓рпН роЯрпЛроХрпНроХройрпН роХрпЛро░рокрпНрокроЯрпБроХро┐ро▒родрпБ, рооро▒рпНро▒рпБроорпН роЕро┤рпИрокрпНрокрпБ роорпАрогрпНроЯрпБроорпН роЪрпЖропрпНропрокрпНрокроЯрпБроХро┐ро▒родрпБ.

    роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН, роТро░рпБ рокро┐ро┤рпИ роЪрпАро░ро┐ропро▓рпН рооро╛ройро┐роЯрпНроЯро░ро┐ро▓рпН роЕройрпБрокрпНрокрокрпНрокроЯрпБроХро┐ро▒родрпБ, рооро▒рпНро▒рпБроорпН `text` ро╡рпЖро▒рпБроорпИропро╛роХ ро╡ро┐роЯрокрпНрокроЯрпБроХро┐ро▒родрпБ.

1. роЗроирпНрод роорпБро▒рпИропро┐ройрпН роЗро▒рпБродро┐ропро┐ро▓рпН HTTP роХро┐ро│рпИропрогрпНроЯрпИ роорпВроЯро╡рпБроорпН рооро▒рпНро▒рпБроорпН роЙро░рпИропрпИ родро┐ро░рпБрокрпНрокро╡рпБроорпН:

    ```cpp
    httpClient.end();

    return text;
    ```

1. `main.cpp`-роЗро▓рпН, роЗроирпНрод рокрпБродро┐роп `convertSpeechToText` роорпБро▒рпИропрпИ `processAudio` роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ро▓рпН роЕро┤рпИроХрпНроХро╡рпБроорпН, рокро┐ройрпНройро░рпН рокрпЗроЪрпНроЪрпИ роЪрпАро░ро┐ропро▓рпН рооро╛ройро┐роЯрпНроЯро░ро┐ро▓рпН рокродро┐ро╡рпБ роЪрпЖропрпНропро╡рпБроорпН:

    ```cpp
    String text = speechToText.convertSpeechToText();
    Serial.println(text);
    ```

1. роЗроирпНрод роХрпБро▒ро┐ропрпАроЯрпНроЯрпИ роЙро░рпБро╡ро╛роХрпНроХро┐, роЕродрпИ роЙроЩрпНроХро│рпН Wio Terminal-роХрпНроХрпБ рокродро┐ро╡рпЗро▒рпНро▒ро╡рпБроорпН, рооро▒рпНро▒рпБроорпН роЪрпАро░ро┐ропро▓рпН рооро╛ройро┐роЯрпНроЯро░рпН роорпВро▓роорпН роЪрпЛродро┐роХрпНроХро╡рпБроорпН. роЪрпАро░ро┐ропро▓рпН рооро╛ройро┐роЯрпНроЯро░ро┐ро▓рпН `Ready` роОройрпНрокродрпИрокрпН рокро╛ро░рпНроХрпНроХрпБроорпН рокрпЛродрпБ, тАЛтАЛC рокрпКродрпНродро╛ройрпИ роЕро┤рпБродрпНродро╡рпБроорпН (роЗродрпБ роЗроЯродрпБ рокроХрпНроХродрпНродро┐ро▓рпН, рооро┐ройрпНроЪро╛ро░ роЪрпБро╡ро┐роЯрпНроЪро┐ро▒рпНроХрпБ роЕро░рпБроХро┐ро▓рпН роЙро│рпНро│родрпБ), рооро▒рпНро▒рпБроорпН рокрпЗроЪро╡рпБроорпН. 4 ро╡ро┐роиро╛роЯро┐роХро│рпН роЖроЯро┐ропрпЛ рокродро┐ро╡рпБ роЪрпЖропрпНропрокрпНрокроЯрпБроорпН, рокро┐ройрпНройро░рпН роЙро░рпИропро╛роХ рооро╛ро▒рпНро▒рокрпНрокроЯрпБроорпН.

    ```output
    --- Available filters and text transformations: colorize, debug, default, direct, hexlify, log2file, nocontrol, printable, send_on_enter, time
    --- More details at http://bit.ly/pio-monitor-filters
    --- Miniterm on /dev/cu.usbmodem1101  9600,8,N,1 ---
    --- Quit: Ctrl+C | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H ---
    Connecting to WiFi..
    Connected!
    Got access token.
    Ready.
    Starting recording...
    Finished recording
    Sending speech...
    Speech sent!
    {"RecognitionStatus":"Success","DisplayText":"Set a 2 minute and 27 second timer.","Offset":4700000,"Duration":35300000}
    Set a 2 minute and 27 second timer.
    ```

> ЁЯТБ роЗроирпНрод роХрпБро▒ро┐ропрпАроЯрпНроЯрпИ [code-speech-to-text/wio-terminal](../../../../../6-consumer/lessons/1-speech-recognition/code-speech-to-text/wio-terminal) роХрпЛрокрпНрокроХродрпНродро┐ро▓рпН роХро╛рогро▓ро╛роорпН.

ЁЯША роЙроЩрпНроХро│рпН рокрпЗроЪрпНроЪрпИ роЙро░рпИропро╛роХ рооро╛ро▒рпНро▒рпБроорпН родро┐роЯрпНроЯроорпН ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роорпБроЯро┐роирпНродродрпБ!

---

**роХрпБро▒ро┐рокрпНрокрпБ**:  
роЗроирпНрод роЖро╡рогроорпН [Co-op Translator](https://github.com/Azure/co-op-translator) роОройрпНро▒ AI роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ роЪрпЗро╡рпИропрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роорпКро┤ро┐рокрпЖропро░рпНроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ. роиро╛роЩрпНроХро│рпН родрпБро▓рпНро▓ро┐ропродрпНродро┐ро▒рпНроХро╛роХ роорпБропро▒рпНроЪро┐роХрпНроХро┐ройрпНро▒рпЛроорпН, роЖройро╛ро▓рпН родро╛ройро┐ропроХрпНроХ роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБроХро│ро┐ро▓рпН рокро┐ро┤рпИроХро│рпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой родроХро╡ро▓рпНроХро│рпН роЗро░рпБроХрпНроХроХрпНроХрпВроЯрпБроорпН роОройрпНрокродрпИ родропро╡рпБроЪрпЖропрпНродрпБ роХро╡ройродрпНродро┐ро▓рпН роХрпКро│рпНро│рпБроЩрпНроХро│рпН. роЕродройрпН родро╛ропрпНроорпКро┤ро┐ропро┐ро▓рпН роЙро│рпНро│ роорпВро▓ роЖро╡рогроорпН роЕродро┐роХро╛ро░рокрпНрокрпВро░рпНро╡ роЖродро╛ро░рооро╛роХ роХро░рпБродрокрпНрокроЯ ро╡рпЗрогрпНроЯрпБроорпН. роорпБроХрпНроХро┐ропрооро╛рой родроХро╡ро▓рпНроХро│рпБроХрпНроХрпБ, родрпКро┤ро┐ро▓рпНроорпБро▒рпИ рооройро┐род роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ рокро░ро┐роирпНродрпБро░рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ. роЗроирпНрод роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родро╛ро▓рпН роПро▒рпНрокроЯрпБроорпН роОроирпНрод родро╡ро▒ро╛рой рокрпБро░ро┐родро▓рпНроХро│рпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой ро╡ро┐ро│роХрпНроХроЩрпНроХро│рпБроХрпНроХрпБ роиро╛роЩрпНроХро│рпН рокрпКро▒рпБрокрпНрокро▓рпНро▓.