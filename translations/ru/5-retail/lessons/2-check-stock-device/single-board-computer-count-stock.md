<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "9c4320311c0f2c1884a6a21265d98a51",
  "translation_date": "2025-08-26T21:34:23+00:00",
  "source_file": "5-retail/lessons/2-check-stock-device/single-board-computer-count-stock.md",
  "language_code": "ru"
}
-->
# –ü–æ–¥—Å—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ —Å –≤–∞—à–µ–≥–æ IoT-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ - –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ IoT-–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∏ Raspberry Pi

–°–æ—á–µ—Ç–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –∏ –∏—Ö –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏.

## –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫

–í –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ–ª–µ–∑–Ω–æ–≥–æ —à–∞–≥–∞ –æ—Ç–ª–∞–¥–∫–∏ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–µ —Ç–æ–ª—å–∫–æ –≤—ã–≤–µ—Å—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª—å, –Ω–æ –∏ –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å –∏—Ö –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ –¥–∏—Å–∫ –ø—Ä–∏ –∑–∞—Ö–≤–∞—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

### –ó–∞–¥–∞—á–∞ - –≤—ã–≤–µ—Å—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç `stock-counter` –æ—Ç–∫—Ä—ã—Ç –≤ VS Code, –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞, –µ—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ IoT-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ.

1. –ò–∑–º–µ–Ω–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä `print` –≤ —Ü–∏–∫–ª–µ `for` –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π, —á—Ç–æ–±—ã –≤—ã–≤–µ—Å—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª—å:

    ```python
    print(f'{prediction.tag_name}:\t{prediction.probability * 100:.2f}%\t{prediction.bounding_box}')
    ```

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∫–∞–º–µ—Ä–æ–π, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –Ω–∞ —Ç–æ–≤–∞—Ä—ã –Ω–∞ –ø–æ–ª–∫–µ. –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏ –±—É–¥—É—Ç –≤—ã–≤–µ–¥–µ–Ω—ã –≤ –∫–æ–Ω—Å–æ–ª—å —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∑–Ω–∞—á–µ–Ω–∏–π left, top, width –∏ height –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ 1.

    ```output
    pi@raspberrypi:~/stock-counter $ python3 app.py 
    tomato paste:   33.42%  {'additional_properties': {}, 'left': 0.3455171, 'top': 0.09916268, 'width': 0.14175442, 'height': 0.29405564}
    tomato paste:   34.41%  {'additional_properties': {}, 'left': 0.48283678, 'top': 0.10242918, 'width': 0.11782813, 'height': 0.27467814}
    tomato paste:   31.25%  {'additional_properties': {}, 'left': 0.4923783, 'top': 0.35007596, 'width': 0.13668466, 'height': 0.28304994}
    tomato paste:   31.05%  {'additional_properties': {}, 'left': 0.36416405, 'top': 0.37494493, 'width': 0.14024884, 'height': 0.26880276}
    ```

### –ó–∞–¥–∞—á–∞ - –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏

1. –ü–∞–∫–µ—Ç Pip [Pillow](https://pypi.org/project/Pillow/) –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥—ã:

    ```sh
    pip3 install pillow
    ```

    –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ IoT-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥—ã.

1. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏–º–ø–æ—Ä—Ç–∞ –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞ `app.py`:

    ```python
    from PIL import Image, ImageDraw, ImageColor
    ```

    –≠—Ç–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–æ–¥, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

1. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ `app.py`:

    ```python
    with Image.open('image.jpg') as im:
        draw = ImageDraw.Draw(im)
    
        for prediction in predictions:
            scale_left = prediction.bounding_box.left
            scale_top = prediction.bounding_box.top
            scale_right = prediction.bounding_box.left + prediction.bounding_box.width
            scale_bottom = prediction.bounding_box.top + prediction.bounding_box.height
            
            left = scale_left * im.width
            top = scale_top * im.height
            right = scale_right * im.width
            bottom = scale_bottom * im.height
    
            draw.rectangle([left, top, right, bottom], outline=ImageColor.getrgb('red'), width=2)
    
        im.save('image.jpg')
    ```

    –≠—Ç–æ—Ç –∫–æ–¥ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ä–∞–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ó–∞—Ç–µ–º –æ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º, –ø–æ–ª—É—á–∞—è –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏, –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–∏–∂–Ω–µ–≥–æ –ø—Ä–∞–≤–æ–≥–æ —É–≥–ª–∞, –∏—Å–ø–æ–ª—å–∑—É—è –∑–Ω–∞—á–µ–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫ –æ—Ç 0 –¥–æ 1. –≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—É—Ç–µ–º —É–º–Ω–æ–∂–µ–Ω–∏—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ left —Ä–∞–≤–Ω–æ 0.5 –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —à–∏—Ä–∏–Ω–æ–π 600 –ø–∏–∫—Å–µ–ª–µ–π, –æ–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ 300 (0.5 x 600 = 300).

    –ö–∞–∂–¥–∞—è –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∞—è —Ä–∞–º–∫–∞ —Ä–∏—Å—É–µ—Ç—Å—è –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —Å –ø–æ–º–æ—â—å—é –∫—Ä–∞—Å–Ω–æ–π –ª–∏–Ω–∏–∏. –í –∫–æ–Ω—Ü–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—è –æ—Ä–∏–≥–∏–Ω–∞–ª.

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∫–∞–º–µ—Ä–æ–π, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –Ω–∞ —Ç–æ–≤–∞—Ä—ã –Ω–∞ –ø–æ–ª–∫–µ. –í—ã —É–≤–∏–¥–∏—Ç–µ —Ñ–∞–π–ª `image.jpg` –≤ –æ–±–æ–∑—Ä–µ–≤–∞—Ç–µ–ª–µ VS Code –∏ —Å–º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –µ–≥–æ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏.

    ![4 –±–∞–Ω–∫–∏ —Ç–æ–º–∞—Ç–Ω–æ–π –ø–∞—Å—Ç—ã —Å –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–º–∏ —Ä–∞–º–∫–∞–º–∏ –≤–æ–∫—Ä—É–≥ –∫–∞–∂–¥–æ–π –±–∞–Ω–∫–∏](../../../../../translated_images/rpi-stock-with-bounding-boxes.b5540e2ecb7cd49f1271828d3be412671d950e87625c5597ea97c90f11e01097.ru.jpg)

## –ü–æ–¥—Å—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤

–ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –≤—ã—à–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏ —Å–ª–µ–≥–∫–∞ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—Ç—Å—è. –ï—Å–ª–∏ –±—ã —ç—Ç–æ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –±—ã–ª–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ, —Ä–∞–º–∫–∏ –º–æ–≥–ª–∏ –±—ã —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç. –ß—Ç–æ–±—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–º–∫–∏ —Å —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º.

### –ó–∞–¥–∞—á–∞ - –ø–æ–¥—Å—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ —Å —É—á–µ—Ç–æ–º –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è

1. –ü–∞–∫–µ—Ç Pip [Shapely](https://pypi.org/project/Shapely/) –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è. –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Raspberry Pi, —Å–Ω–∞—á–∞–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å:

    ```sh
    sudo apt install libgeos-dev
    ```

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç Shapely —á–µ—Ä–µ–∑ Pip:

    ```sh
    pip3 install shapely
    ```

    –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ IoT-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥—ã.

1. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏–º–ø–æ—Ä—Ç–∞ –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞ `app.py`:

    ```python
    from shapely.geometry import Polygon
    ```

    –≠—Ç–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–æ–¥, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª–∏–≥–æ–Ω–æ–≤ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è.

1. –ù–∞–¥ –∫–æ–¥–æ–º, –∫–æ—Ç–æ—Ä—ã–π —Ä–∏—Å—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏, –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

    ```python
    overlap_threshold = 0.20
    ```

    –≠—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è, –¥–æ–ø—É—Å—Ç–∏–º—ã–π –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏ –±—É–¥—É—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–º–∏ –æ–¥–Ω–æ–º—É –æ–±—ä–µ–∫—Ç—É. –ó–Ω–∞—á–µ–Ω–∏–µ 0.20 –∑–∞–¥–∞–µ—Ç 20% –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è.

1. –ß—Ç–æ–±—ã –≤—ã—á–∏—Å–ª–∏—Ç—å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Shapely, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ä–∞–º–∫–∏ –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ –ø–æ–ª–∏–≥–æ–Ω—ã Shapely. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —ç—Ç–æ–≥–æ:

    ```python
    def create_polygon(prediction):
        scale_left = prediction.bounding_box.left
        scale_top = prediction.bounding_box.top
        scale_right = prediction.bounding_box.left + prediction.bounding_box.width
        scale_bottom = prediction.bounding_box.top + prediction.bounding_box.height
    
        return Polygon([(scale_left, scale_top), (scale_right, scale_top), (scale_right, scale_bottom), (scale_left, scale_bottom)])
    ```

    –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª–∏–≥–æ–Ω, –∏—Å–ø–æ–ª—å–∑—É—è –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â—É—é —Ä–∞–º–∫—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.

1. –õ–æ–≥–∏–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏—Ö—Å—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤–∫–ª—é—á–∞–µ—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫. –ï—Å–ª–∏ —É –∫–∞–∫–æ–π-–ª–∏–±–æ –ø–∞—Ä—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Ä–∞–º–∫–∏ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—Ç—Å—è –±–æ–ª—å—à–µ, —á–µ–º –¥–æ–ø—É—Å—Ç–∏–º—ã–π –ø–æ—Ä–æ–≥, –æ–¥–Ω–æ –∏–∑ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —É–¥–∞–ª—è–µ—Ç—Å—è. –ß—Ç–æ–±—ã —Å—Ä–∞–≤–Ω–∏—Ç—å –≤—Å–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è, –≤—ã —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ 1 —Å 2, 3, 4 –∏ —Ç.–¥., –∑–∞—Ç–µ–º 2 —Å 3, 4 –∏ —Ç.–¥. –°–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —ç—Ç–æ:

    ```python
    to_delete = []

    for i in range(0, len(predictions)):
        polygon_1 = create_polygon(predictions[i])
    
        for j in range(i+1, len(predictions)):
            polygon_2 = create_polygon(predictions[j])
            overlap = polygon_1.intersection(polygon_2).area

            smallest_area = min(polygon_1.area, polygon_2.area)
    
            if overlap > (overlap_threshold * smallest_area):
                to_delete.append(predictions[i])
                break
    
    for d in to_delete:
        predictions.remove(d)

    print(f'Counted {len(predictions)} stock items')
    ```

    –ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ Shapely `Polygon.intersection`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–∏–≥–æ–Ω, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ. –ü–ª–æ—â–∞–¥—å —ç—Ç–æ–≥–æ –ø–æ–ª–∏–≥–æ–Ω–∞ –∑–∞—Ç–µ–º –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è. –ü–æ—Ä–æ–≥ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∞–±—Å–æ–ª—é—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º, –∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –æ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–µ–π —Ä–∞–º–∫–∏, –ø–æ—ç—Ç–æ–º—É –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞–∏–º–µ–Ω—å—à–∞—è —Ä–∞–º–∫–∞, –∏ –ø–æ—Ä–æ–≥ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–æ–ø—É—Å—Ç–∏–º–æ–π –ø–ª–æ—â–∞–¥–∏ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è. –ï—Å–ª–∏ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç —ç—Ç–æ—Ç –ø–æ—Ä–æ–≥, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è.

    –ö–∞–∫ —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ–º–µ—á–µ–Ω–æ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è, –µ–≥–æ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, –ø–æ—ç—Ç–æ–º—É –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ü–∏–∫–ª –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ. –ù–µ–ª—å–∑—è —É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ —Å–ø–∏—Å–∫–∞ –≤–æ –≤—Ä–µ–º—è –µ–≥–æ –∏—Ç–µ—Ä–∞—Ü–∏–∏, –ø–æ—ç—Ç–æ–º—É —Ä–∞–º–∫–∏, –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏–µ—Å—è –±–æ–ª—å—à–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ –ø–æ—Ä–æ–≥–∞, –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ —Å–ø–∏—Å–æ–∫ `to_delete`, –∞ –∑–∞—Ç–µ–º —É–¥–∞–ª—è—é—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ.

    –í –∫–æ–Ω—Ü–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ IoT-—Å–µ—Ä–≤–∏—Å –¥–ª—è –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –æ –Ω–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ –∑–∞–ø–∞—Å–æ–≤. –í–µ—Å—å —ç—Ç–æ—Ç –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —Ä–∏—Å–æ–≤–∞–Ω–∏–µ–º –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫, –ø–æ—ç—Ç–æ–º—É –Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –≤—ã —É–≤–∏–¥–∏—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –±–µ–∑ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–π.

    > üíÅ –≠—Ç–æ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± —É–¥–∞–ª–µ–Ω–∏—è –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–π, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —É–¥–∞–ª—è–µ—Ç—Å—è –ø–µ—Ä–≤–æ–µ –∏–∑ –¥–≤—É—Ö –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏—Ö—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π. –î–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –≤—ã –º–æ–≥–ª–∏ –±—ã –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ª–æ–≥–∏–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, —É—á–∏—Ç—ã–≤–∞—Ç—å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ –∏–ª–∏ —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –æ–¥–Ω–∞ —Ä–∞–º–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ –¥—Ä—É–≥–æ–π.

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∫–∞–º–µ—Ä–æ–π, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –Ω–∞ —Ç–æ–≤–∞—Ä—ã –Ω–∞ –ø–æ–ª–∫–µ. –í—ã–≤–æ–¥ –ø–æ–∫–∞–∂–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏—Ö —Ä–∞–º–æ–∫ –±–µ–∑ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–π, –ø—Ä–µ–≤—ã—à–∞—é—â–∏—Ö –ø–æ—Ä–æ–≥. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ `overlap_threshold`, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è.

> üíÅ –≠—Ç–æ—Ç –∫–æ–¥ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –ø–∞–ø–∫–µ [code-count/pi](../../../../../5-retail/lessons/2-check-stock-device/code-count/pi) –∏–ª–∏ [code-count/virtual-iot-device](../../../../../5-retail/lessons/2-check-stock-device/code-count/virtual-iot-device).

üòÄ –í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!

---

**–û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**:  
–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –±—ã–ª –ø–µ—Ä–µ–≤–µ–¥–µ–Ω —Å –ø–æ–º–æ—â—å—é —Å–µ—Ä–≤–∏—Å–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ [Co-op Translator](https://github.com/Azure/co-op-translator). –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–∞—à–∏ —É—Å–∏–ª–∏—è –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ—à–∏–±–∫–∏ –∏–ª–∏ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏. –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ –µ–≥–æ –∏—Å—Ö–æ–¥–Ω–æ–º —è–∑—ã–∫–µ —Å–ª–µ–¥—É–µ—Ç —Å—á–∏—Ç–∞—Ç—å –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ —á–µ–ª–æ–≤–µ–∫–æ–º. –ú—ã –Ω–µ –Ω–µ—Å–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –ª—é–±—ã–µ –Ω–µ–¥–æ—Ä–∞–∑—É–º–µ–Ω–∏—è –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏, –≤–æ–∑–Ω–∏–∫—à–∏–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞.