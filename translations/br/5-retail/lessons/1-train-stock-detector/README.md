<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "8df310a42f902139a01417dacb1ffbef",
  "translation_date": "2025-08-28T03:46:30+00:00",
  "source_file": "5-retail/lessons/1-train-stock-detector/README.md",
  "language_code": "br"
}
-->
# Treine um detector de estoque

![Uma vis√£o geral ilustrada desta li√ß√£o](../../../../../translated_images/lesson-19.cf6973cecadf080c4b526310620dc4d6f5994c80fb0139c6f378cc9ca2d435cd.br.jpg)

> Ilustra√ß√£o por [Nitya Narasimhan](https://github.com/nitya). Clique na imagem para uma vers√£o maior.

Este v√≠deo oferece uma vis√£o geral sobre Detec√ß√£o de Objetos com o servi√ßo Azure Custom Vision, um servi√ßo que ser√° abordado nesta li√ß√£o.

[![Custom Vision 2 - Detec√ß√£o de Objetos Facilitada | The Xamarin Show](https://img.youtube.com/vi/wtTYSyBUpFc/0.jpg)](https://www.youtube.com/watch?v=wtTYSyBUpFc)

> üé• Clique na imagem acima para assistir ao v√≠deo

## Question√°rio pr√©-aula

[Question√°rio pr√©-aula](https://black-meadow-040d15503.1.azurestaticapps.net/quiz/37)

## Introdu√ß√£o

No projeto anterior, voc√™ utilizou IA para treinar um classificador de imagens - um modelo que pode identificar se uma imagem cont√©m algo, como frutas maduras ou n√£o maduras. Outro tipo de modelo de IA que pode ser usado com imagens √© a detec√ß√£o de objetos. Esses modelos n√£o classificam uma imagem por meio de tags; em vez disso, eles s√£o treinados para reconhecer objetos e podem localiz√°-los em imagens, n√£o apenas detectando que o objeto est√° presente, mas tamb√©m onde ele est√° na imagem. Isso permite contar objetos em imagens.

Nesta li√ß√£o, voc√™ aprender√° sobre detec√ß√£o de objetos, incluindo como ela pode ser usada no varejo. Voc√™ tamb√©m aprender√° a treinar um detector de objetos na nuvem.

Nesta li√ß√£o, abordaremos:

* [Detec√ß√£o de objetos](../../../../../5-retail/lessons/1-train-stock-detector)
* [Uso da detec√ß√£o de objetos no varejo](../../../../../5-retail/lessons/1-train-stock-detector)
* [Treinamento de um detector de objetos](../../../../../5-retail/lessons/1-train-stock-detector)
* [Teste do seu detector de objetos](../../../../../5-retail/lessons/1-train-stock-detector)
* [Re-treinamento do seu detector de objetos](../../../../../5-retail/lessons/1-train-stock-detector)

## Detec√ß√£o de objetos

A detec√ß√£o de objetos envolve identificar objetos em imagens usando IA. Diferentemente do classificador de imagens que voc√™ treinou no √∫ltimo projeto, a detec√ß√£o de objetos n√£o se trata de prever a melhor tag para uma imagem como um todo, mas de encontrar um ou mais objetos em uma imagem.

### Detec√ß√£o de objetos vs classifica√ß√£o de imagens

A classifica√ß√£o de imagens consiste em classificar uma imagem como um todo - quais s√£o as probabilidades de que a imagem inteira corresponda a cada tag. Voc√™ recebe de volta as probabilidades para cada tag usada para treinar o modelo.

![Classifica√ß√£o de imagens de castanhas de caju e extrato de tomate](../../../../../translated_images/image-classifier-cashews-tomato.bc2e16ab8f05cf9ac0f59f73e32efc4227f9a5b601b90b2c60f436694547a965.br.png)

No exemplo acima, duas imagens s√£o classificadas usando um modelo treinado para classificar potes de castanhas de caju ou latas de extrato de tomate. A primeira imagem √© um pote de castanhas de caju e apresenta dois resultados do classificador de imagens:

| Tag            | Probabilidade |
| -------------- | ------------: |
| `castanhas de caju` | 98,4%       |
| `extrato de tomate` | 1,6%        |

A segunda imagem √© uma lata de extrato de tomate, e os resultados s√£o:

| Tag            | Probabilidade |
| -------------- | ------------: |
| `castanhas de caju` | 0,7%        |
| `extrato de tomate` | 99,3%       |

Voc√™ poderia usar esses valores com um limite de porcentagem para prever o que est√° na imagem. Mas e se uma imagem contivesse v√°rias latas de extrato de tomate ou tanto castanhas de caju quanto extrato de tomate? Os resultados provavelmente n√£o dariam o que voc√™ deseja. √â aqui que entra a detec√ß√£o de objetos.

A detec√ß√£o de objetos envolve treinar um modelo para reconhecer objetos. Em vez de fornecer imagens contendo o objeto e dizer que cada imagem √© uma tag ou outra, voc√™ destaca a se√ß√£o de uma imagem que cont√©m o objeto espec√≠fico e a marca. Voc√™ pode marcar um √∫nico objeto em uma imagem ou v√°rios. Dessa forma, o modelo aprende como o objeto em si se parece, e n√£o apenas como s√£o as imagens que cont√™m o objeto.

Quando voc√™ o utiliza para prever imagens, em vez de receber uma lista de tags e porcentagens, voc√™ recebe uma lista de objetos detectados, com suas caixas delimitadoras e a probabilidade de que o objeto corresponda √† tag atribu√≠da.

> üéì *Caixas delimitadoras* s√£o as caixas ao redor de um objeto.

![Detec√ß√£o de objetos de castanhas de caju e extrato de tomate](../../../../../translated_images/object-detector-cashews-tomato.1af7c26686b4db0e709754aeb196f4e73271f54e2085db3bcccb70d4a0d84d97.br.png)

A imagem acima cont√©m tanto um pote de castanhas de caju quanto tr√™s latas de extrato de tomate. O detector de objetos detectou as castanhas de caju, retornando a caixa delimitadora que cont√©m as castanhas com a probabilidade de 97,6%. O detector de objetos tamb√©m detectou tr√™s latas de extrato de tomate, fornecendo tr√™s caixas delimitadoras separadas, uma para cada lata detectada, e cada uma com uma probabilidade de que a caixa delimitadora contenha uma lata de extrato de tomate.

‚úÖ Pense em alguns cen√°rios diferentes nos quais voc√™ poderia usar modelos de IA baseados em imagens. Quais deles precisariam de classifica√ß√£o e quais precisariam de detec√ß√£o de objetos?

### Como funciona a detec√ß√£o de objetos

A detec√ß√£o de objetos utiliza modelos de aprendizado de m√°quina complexos. Esses modelos funcionam dividindo a imagem em v√°rias c√©lulas e verificando se o centro da caixa delimitadora corresponde ao centro de uma imagem que combina com uma das imagens usadas para treinar o modelo. Voc√™ pode pensar nisso como uma esp√©cie de execu√ß√£o de um classificador de imagens em diferentes partes da imagem para procurar correspond√™ncias.

> üíÅ Esta √© uma simplifica√ß√£o dr√°stica. Existem muitas t√©cnicas para detec√ß√£o de objetos, e voc√™ pode ler mais sobre elas na [p√°gina de Detec√ß√£o de Objetos na Wikipedia](https://wikipedia.org/wiki/Object_detection).

Existem v√°rios modelos diferentes que podem realizar detec√ß√£o de objetos. Um modelo particularmente famoso √© o [YOLO (You Only Look Once)](https://pjreddie.com/darknet/yolo/), que √© incrivelmente r√°pido e pode detectar 20 classes diferentes de objetos, como pessoas, c√£es, garrafas e carros.

‚úÖ Leia mais sobre o modelo YOLO em [pjreddie.com/darknet/yolo/](https://pjreddie.com/darknet/yolo/)

Os modelos de detec√ß√£o de objetos podem ser re-treinados usando aprendizado por transfer√™ncia para detectar objetos personalizados.

## Uso da detec√ß√£o de objetos no varejo

A detec√ß√£o de objetos tem m√∫ltiplos usos no varejo. Alguns incluem:

* **Verifica√ß√£o e contagem de estoque** - reconhecer quando o estoque est√° baixo nas prateleiras. Se o estoque estiver muito baixo, notifica√ß√µes podem ser enviadas para funcion√°rios ou rob√¥s reabastecerem as prateleiras.
* **Detec√ß√£o de m√°scaras** - em lojas com pol√≠ticas de uso de m√°scaras durante eventos de sa√∫de p√∫blica, a detec√ß√£o de objetos pode reconhecer pessoas com e sem m√°scaras.
* **Cobran√ßa automatizada** - detectar itens retirados das prateleiras em lojas automatizadas e cobrar os clientes de forma apropriada.
* **Detec√ß√£o de perigos** - reconhecer itens quebrados no ch√£o ou l√≠quidos derramados, alertando equipes de limpeza.

‚úÖ Fa√ßa uma pesquisa: Quais s√£o outros casos de uso para detec√ß√£o de objetos no varejo?

## Treinamento de um detector de objetos

Voc√™ pode treinar um detector de objetos usando o Custom Vision, de forma semelhante ao treinamento de um classificador de imagens.

### Tarefa - criar um detector de objetos

1. Crie um Grupo de Recursos para este projeto chamado `stock-detector`.

1. Crie um recurso gratuito de treinamento do Custom Vision e um recurso gratuito de previs√£o do Custom Vision no grupo de recursos `stock-detector`. Nomeie-os como `stock-detector-training` e `stock-detector-prediction`.

    > üíÅ Voc√™ s√≥ pode ter um recurso gratuito de treinamento e previs√£o, ent√£o certifique-se de ter limpado seu projeto das li√ß√µes anteriores.

    > ‚ö†Ô∏è Voc√™ pode consultar [as instru√ß√µes para criar recursos de treinamento e previs√£o do projeto 4, li√ß√£o 1, se necess√°rio](../../../4-manufacturing/lessons/1-train-fruit-detector/README.md#task---create-a-cognitive-services-resource).

1. Acesse o portal do Custom Vision em [CustomVision.ai](https://customvision.ai) e fa√ßa login com a conta Microsoft usada para sua conta Azure.

1. Siga a [se√ß√£o Criar um novo projeto do guia r√°pido de constru√ß√£o de um detector de objetos na documenta√ß√£o da Microsoft](https://docs.microsoft.com/azure/cognitive-services/custom-vision-service/get-started-build-detector?WT.mc_id=academic-17441-jabenn#create-a-new-project) para criar um novo projeto no Custom Vision. A interface pode mudar, e esses documentos s√£o sempre a refer√™ncia mais atualizada.

    Nomeie seu projeto como `stock-detector`.

    Ao criar seu projeto, certifique-se de usar o recurso `stock-detector-training` que voc√™ criou anteriormente. Use o tipo de projeto *Detec√ß√£o de Objetos* e o dom√≠nio *Produtos em Prateleiras*.

    ![As configura√ß√µes do projeto no Custom Vision com o nome definido como fruit-quality-detector, sem descri√ß√£o, o recurso definido como fruit-quality-detector-training, o tipo de projeto definido como classifica√ß√£o, os tipos de classifica√ß√£o definidos como multi-classe e os dom√≠nios definidos como alimentos](../../../../../translated_images/custom-vision-create-object-detector-project.32d4fb9aa8e7e7375f8a799bfce517aca970f2cb65e42d4245c5e635c734ab29.br.png)

    ‚úÖ O dom√≠nio de produtos em prateleiras √© especificamente direcionado para detectar estoque em prateleiras de lojas. Leia mais sobre os diferentes dom√≠nios na [documenta√ß√£o Selecionar um dom√≠nio na Microsoft Docs](https://docs.microsoft.com/azure/cognitive-services/custom-vision-service/select-domain?WT.mc_id=academic-17441-jabenn#object-detection).

‚úÖ Reserve um tempo para explorar a interface do Custom Vision para o seu detector de objetos.

### Tarefa - treinar seu detector de objetos

Para treinar seu modelo, voc√™ precisar√° de um conjunto de imagens contendo os objetos que deseja detectar.

1. Re√∫na imagens que contenham o objeto a ser detectado. Voc√™ precisar√° de pelo menos 15 imagens contendo cada objeto a ser detectado, de uma variedade de √¢ngulos diferentes e em diferentes condi√ß√µes de ilumina√ß√£o, mas quanto mais, melhor. Este detector de objetos usa o dom√≠nio *Produtos em prateleiras*, ent√£o tente organizar os objetos como se estivessem em uma prateleira de loja. Voc√™ tamb√©m precisar√° de algumas imagens para testar o modelo. Se estiver detectando mais de um objeto, ser√° necess√°rio ter algumas imagens de teste que contenham todos os objetos.

    > üíÅ Imagens com v√°rios objetos diferentes contam para o m√≠nimo de 15 imagens para todos os objetos na imagem.

    Suas imagens devem ser em formato png ou jpeg, com menos de 6MB. Se voc√™ as criar com um iPhone, por exemplo, elas podem ser imagens HEIC de alta resolu√ß√£o, ent√£o ser√° necess√°rio convert√™-las e possivelmente reduzi-las. Quanto mais imagens, melhor, e voc√™ deve ter um n√∫mero semelhante de objetos maduros e n√£o maduros.

    O modelo √© projetado para produtos em prateleiras, ent√£o tente tirar as fotos dos objetos em prateleiras.

    Voc√™ pode encontrar algumas imagens de exemplo que podem ser usadas na pasta [images](../../../../../5-retail/lessons/1-train-stock-detector/images) de castanhas de caju e extrato de tomate.

1. Siga a [se√ß√£o Fazer upload e marcar imagens do guia r√°pido de constru√ß√£o de um detector de objetos na documenta√ß√£o da Microsoft](https://docs.microsoft.com/azure/cognitive-services/custom-vision-service/get-started-build-detector?WT.mc_id=academic-17441-jabenn#upload-and-tag-images) para fazer upload de suas imagens de treinamento. Crie tags relevantes dependendo dos tipos de objetos que deseja detectar.

    ![Os di√°logos de upload mostrando o upload de imagens de bananas maduras e n√£o maduras](../../../../../translated_images/image-upload-object-detector.77c7892c3093cb59b79018edecd678749a75d71a099bc8a2d2f2f76320f88a5b.br.png)

    Ao desenhar caixas delimitadoras para os objetos, mantenha-as bem ajustadas ao redor do objeto. Pode levar algum tempo para marcar todas as imagens, mas a ferramenta detectar√° o que acredita serem as caixas delimitadoras, tornando o processo mais r√°pido.

    ![Marcando um extrato de tomate](../../../../../translated_images/object-detector-tag-tomato-paste.f47c362fb0f0eb582f3bc68cf3855fb43a805106395358d41896a269c210b7b4.br.png)

    > üíÅ Se voc√™ tiver mais de 15 imagens para cada objeto, pode treinar ap√≥s 15 e usar o recurso **Tags sugeridas**. Isso usar√° o modelo treinado para detectar os objetos na imagem n√£o marcada. Voc√™ pode ent√£o confirmar os objetos detectados ou rejeitar e redesenhar as caixas delimitadoras. Isso pode economizar *muito* tempo.

1. Siga a [se√ß√£o Treinar o detector do guia r√°pido de constru√ß√£o de um detector de objetos na documenta√ß√£o da Microsoft](https://docs.microsoft.com/azure/cognitive-services/custom-vision-service/get-started-build-detector?WT.mc_id=academic-17441-jabenn#train-the-detector) para treinar o detector de objetos com suas imagens marcadas.

    Voc√™ ter√° a op√ß√£o de escolher o tipo de treinamento. Selecione **Treinamento R√°pido**.

O detector de objetos ser√° treinado. O treinamento levar√° alguns minutos para ser conclu√≠do.

## Teste do seu detector de objetos

Depois que seu detector de objetos for treinado, voc√™ poder√° test√°-lo fornecendo novas imagens para detectar objetos.

### Tarefa - testar seu detector de objetos

1. Use o bot√£o **Teste R√°pido** para fazer upload de imagens de teste e verificar se os objetos s√£o detectados. Use as imagens de teste que voc√™ criou anteriormente, n√£o as imagens usadas para treinamento.

    ![3 latas de extrato de tomate detectadas com probabilidades de 38%, 35,5% e 34,6%](../../../../../translated_images/object-detector-detected-tomato-paste.52656fe87af4c37b4ee540526d63e73ed075da2e54a9a060aa528e0c562fb1b6.br.png)

1. Teste todas as imagens de teste que voc√™ tiver e observe as probabilidades.

## Re-treinamento do seu detector de objetos

Quando voc√™ testa seu detector de objetos, ele pode n√£o fornecer os resultados esperados, assim como os classificadores de imagens no projeto anterior. Voc√™ pode melhorar seu detector de objetos re-treinando-o com imagens que ele errou.

Sempre que voc√™ faz uma previs√£o usando a op√ß√£o de teste r√°pido, a imagem e os resultados s√£o armazenados. Voc√™ pode usar essas imagens para re-treinar seu modelo.

1. Use a aba **Previs√µes** para localizar as imagens que voc√™ usou para teste.

1. Confirme quaisquer detec√ß√µes precisas, exclua as incorretas e adicione quaisquer objetos ausentes.

1. Re-treine e re-teste o modelo.

---

## üöÄ Desafio

O que aconteceria se voc√™ usasse o detector de objetos com itens de apar√™ncia semelhante, como latas da mesma marca de extrato de tomate e tomates picados?

Se voc√™ tiver itens de apar√™ncia semelhante, teste adicionando imagens deles ao seu detector de objetos.

## Question√°rio p√≥s-aula
[Quiz p√≥s-aula](https://black-meadow-040d15503.1.azurestaticapps.net/quiz/38)

## Revis√£o e Autoestudo

* Quando voc√™ treinou seu detector de objetos, deve ter visto valores como *Precis√£o*, *Recall* e *mAP* que avaliam o modelo criado. Leia sobre o que esses valores significam usando [a se√ß√£o Avaliar o detector do guia r√°pido de Construir um detector de objetos nos documentos da Microsoft](https://docs.microsoft.com/azure/cognitive-services/custom-vision-service/get-started-build-detector?WT.mc_id=academic-17441-jabenn#evaluate-the-detector)
* Leia mais sobre detec√ß√£o de objetos na [p√°gina de Detec√ß√£o de objetos na Wikipedia](https://wikipedia.org/wiki/Object_detection)

## Tarefa

[Comparar dom√≠nios](assignment.md)

---

**Aviso Legal**:  
Este documento foi traduzido utilizando o servi√ßo de tradu√ß√£o por IA [Co-op Translator](https://github.com/Azure/co-op-translator). Embora nos esforcemos para garantir a precis√£o, esteja ciente de que tradu√ß√µes automatizadas podem conter erros ou imprecis√µes. O documento original em seu idioma nativo deve ser considerado a fonte autoritativa. Para informa√ß√µes cr√≠ticas, recomenda-se a tradu√ß√£o profissional realizada por humanos. N√£o nos responsabilizamos por quaisquer mal-entendidos ou interpreta√ß√µes equivocadas decorrentes do uso desta tradu√ß√£o.