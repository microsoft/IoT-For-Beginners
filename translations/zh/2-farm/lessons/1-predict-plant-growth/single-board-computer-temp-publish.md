<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "4efc74299e19f5d08f2f3f34451a11ba",
  "translation_date": "2025-08-24T22:02:03+00:00",
  "source_file": "2-farm/lessons/1-predict-plant-growth/single-board-computer-temp-publish.md",
  "language_code": "zh"
}
-->
# å‘å¸ƒæ¸©åº¦ - è™šæ‹Ÿç‰©è”ç½‘ç¡¬ä»¶å’Œæ ‘è“æ´¾

åœ¨æœ¬è¯¾çš„è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæ‚¨å°†é€šè¿‡ MQTT å‘å¸ƒæ ‘è“æ´¾æˆ–è™šæ‹Ÿç‰©è”ç½‘è®¾å¤‡æ£€æµ‹åˆ°çš„æ¸©åº¦å€¼ï¼Œä»¥ä¾¿ç¨åç”¨äºè®¡ç®— GDDã€‚

## å‘å¸ƒæ¸©åº¦

ä¸€æ—¦è¯»å–äº†æ¸©åº¦å€¼ï¼Œå°±å¯ä»¥é€šè¿‡ MQTT å‘å¸ƒåˆ°æŸäº›â€œæœåŠ¡å™¨â€ä»£ç ï¼Œè¿™äº›ä»£ç å°†è¯»å–è¿™äº›å€¼å¹¶å­˜å‚¨èµ·æ¥ï¼Œä»¥ä¾¿ç”¨äº GDD è®¡ç®—ã€‚

### ä»»åŠ¡ - å‘å¸ƒæ¸©åº¦

ç¼–ç¨‹è®¾å¤‡ä»¥å‘å¸ƒæ¸©åº¦æ•°æ®ã€‚

1. å¦‚æœå°šæœªæ‰“å¼€ï¼Œè¯·æ‰“å¼€ `temperature-sensor` åº”ç”¨é¡¹ç›®ã€‚

1. é‡å¤æ‚¨åœ¨ç¬¬ 4 è¯¾ä¸­å®Œæˆçš„æ­¥éª¤ä»¥è¿æ¥åˆ° MQTT å¹¶å‘é€é¥æµ‹æ•°æ®ï¼Œæ‚¨å°†ä½¿ç”¨ç›¸åŒçš„å…¬å…± Mosquitto brokerã€‚

    è¿™äº›æ­¥éª¤åŒ…æ‹¬ï¼š

    - æ·»åŠ  MQTT pip åŒ…
    - æ·»åŠ è¿æ¥åˆ° MQTT broker çš„ä»£ç 
    - æ·»åŠ å‘å¸ƒé¥æµ‹æ•°æ®çš„ä»£ç 

    > âš ï¸ å¦‚æœéœ€è¦ï¼Œè¯·å‚è€ƒç¬¬ 4 è¯¾ä¸­çš„[è¿æ¥åˆ° MQTT çš„è¯´æ˜](../../../1-getting-started/lessons/4-connect-internet/single-board-computer-mqtt.md)å’Œ[å‘é€é¥æµ‹æ•°æ®çš„è¯´æ˜](../../../1-getting-started/lessons/4-connect-internet/single-board-computer-telemetry.md)ã€‚

1. ç¡®ä¿ `client_name` åæ˜ æ­¤é¡¹ç›®çš„åç§°ï¼š

    ```python
    client_name = id + 'temperature_sensor_client'
    ```

1. å¯¹äºé¥æµ‹æ•°æ®ï¼Œä¸å†å‘é€å…‰ç…§å€¼ï¼Œè€Œæ˜¯å‘é€ä» DHT ä¼ æ„Ÿå™¨è¯»å–çš„æ¸©åº¦å€¼ï¼Œå¹¶å°†å…¶ä½œä¸º JSON æ–‡æ¡£ä¸­çš„ `temperature` å±æ€§ï¼š

    ```python
    _, temp = sensor.read()
    telemetry = json.dumps({'temperature' : temp})
    ```

1. æ¸©åº¦å€¼ä¸éœ€è¦é¢‘ç¹è¯»å–â€”â€”åœ¨çŸ­æ—¶é—´å†…ä¸ä¼šæœ‰å¤ªå¤§å˜åŒ–ï¼Œå› æ­¤å°† `time.sleep` è®¾ç½®ä¸º 10 åˆ†é’Ÿï¼š

    ```cpp
    time.sleep(10 * 60);
    ```

    > ğŸ’ `sleep` å‡½æ•°ä»¥ç§’ä¸ºå•ä½æ¥æ”¶æ—¶é—´ï¼Œä¸ºäº†æ›´å®¹æ˜“ç†è§£ï¼Œæ—¶é—´å€¼æ˜¯é€šè¿‡è®¡ç®—å¾—å‡ºçš„ã€‚1 åˆ†é’Ÿæœ‰ 60 ç§’ï¼Œå› æ­¤ 10 x (1 åˆ†é’Ÿçš„ 60 ç§’) å¾—åˆ° 10 åˆ†é’Ÿçš„å»¶è¿Ÿã€‚

1. ä»¥ä¸ä¹‹å‰ä»»åŠ¡ä»£ç ç›¸åŒçš„æ–¹å¼è¿è¡Œä»£ç ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯è™šæ‹Ÿç‰©è”ç½‘è®¾å¤‡ï¼Œè¯·ç¡®ä¿ CounterFit åº”ç”¨æ­£åœ¨è¿è¡Œï¼Œå¹¶ä¸”æ¹¿åº¦å’Œæ¸©åº¦ä¼ æ„Ÿå™¨å·²åœ¨æ­£ç¡®çš„å¼•è„šä¸Šåˆ›å»ºã€‚

    ```output
    pi@raspberrypi:~/temperature-sensor $ python3 app.py
    MQTT connected!
    Sending telemetry  {"temperature": 25}
    Sending telemetry  {"temperature": 25}
    ```

> ğŸ’ æ‚¨å¯ä»¥åœ¨ [code-publish-temperature/virtual-device](../../../../../2-farm/lessons/1-predict-plant-growth/code-publish-temperature/virtual-device) æ–‡ä»¶å¤¹æˆ– [code-publish-temperature/pi](../../../../../2-farm/lessons/1-predict-plant-growth/code-publish-temperature/pi) æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°æ­¤ä»£ç ã€‚

ğŸ˜€ æ‚¨å·²æˆåŠŸå°†è®¾å¤‡çš„æ¸©åº¦ä½œä¸ºé¥æµ‹æ•°æ®å‘å¸ƒã€‚

**å…è´£å£°æ˜**ï¼š  
æœ¬æ–‡æ¡£ä½¿ç”¨AIç¿»è¯‘æœåŠ¡ [Co-op Translator](https://github.com/Azure/co-op-translator) è¿›è¡Œç¿»è¯‘ã€‚å°½ç®¡æˆ‘ä»¬åŠªåŠ›ç¡®ä¿ç¿»è¯‘çš„å‡†ç¡®æ€§ï¼Œä½†è¯·æ³¨æ„ï¼Œè‡ªåŠ¨ç¿»è¯‘å¯èƒ½åŒ…å«é”™è¯¯æˆ–ä¸å‡†ç¡®ä¹‹å¤„ã€‚åº”ä»¥åŸå§‹è¯­è¨€çš„æ–‡æ¡£ä½œä¸ºæƒå¨æ¥æºã€‚å¯¹äºå…³é”®ä¿¡æ¯ï¼Œå»ºè®®ä½¿ç”¨ä¸“ä¸šäººå·¥ç¿»è¯‘ã€‚å› ä½¿ç”¨æœ¬ç¿»è¯‘è€Œå¼•èµ·çš„ä»»ä½•è¯¯è§£æˆ–è¯¯è¯»ï¼Œæˆ‘ä»¬æ¦‚ä¸è´Ÿè´£ã€‚