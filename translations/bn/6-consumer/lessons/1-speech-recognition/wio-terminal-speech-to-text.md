<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "3f92edf2975175577174910caca4a389",
  "translation_date": "2025-08-27T14:16:06+00:00",
  "source_file": "6-consumer/lessons/1-speech-recognition/wio-terminal-speech-to-text.md",
  "language_code": "bn"
}
-->
# рж╕рзНржкрж┐ржЪ ржЯрзБ ржЯрзЗржХрзНрж╕ржЯ - Wio Terminal

ржПржЗ ржкрж╛ржарзЗрж░ ржПржЗ ржЕржВрж╢рзЗ, ржЖржкржирж┐ ржХрзЛржб рж▓рж┐ржЦржмрзЗржи ржпрж╛ ржХрзНржпрж╛ржкржЪрж╛рж░ ржХрж░рж╛ ржЕржбрж┐ржУрж░ рж╕рзНржкрж┐ржЪржХрзЗ ржЯрзЗржХрзНрж╕ржЯрзЗ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░ржмрзЗ рж╕рзНржкрж┐ржЪ рж╕рж╛рж░рзНржнрж┐рж╕ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред

## ржЕржбрж┐ржУ рж╕рзНржкрж┐ржЪ рж╕рж╛рж░рзНржнрж┐рж╕рзЗ ржкрж╛ржарж╛ржирзЛ

ржЕржбрж┐ржУ рж╕рзНржкрж┐ржЪ рж╕рж╛рж░рзНржнрж┐рж╕рзЗ REST API ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржкрж╛ржарж╛ржирзЛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред рж╕рзНржкрж┐ржЪ рж╕рж╛рж░рзНржнрж┐рж╕ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣рж▓рзЗ ржкрзНрж░ржержорзЗ ржПржХржЯрж┐ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЯрзЛржХрзЗржи ржЕржирзБрж░рзЛржз ржХрж░рждрзЗ рж╣ржмрзЗ, рждрж╛рж░ржкрж░ рж╕рзЗржЗ ржЯрзЛржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ REST API-рждрзЗ ржкрзНрж░ржмрзЗрж╢ ржХрж░рждрзЗ рж╣ржмрзЗред ржПржЗ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЯрзЛржХрзЗржи рззрзж ржорж┐ржирж┐ржЯрзЗрж░ ржЬржирзНржп ржмрзИржз ржерж╛ржХрзЗ, рждрж╛ржЗ ржЖржкржирж╛рж░ ржХрзЛржбржЯрж┐ ржирж┐ржпрж╝ржорж┐рждржнрж╛ржмрзЗ ржЯрзЛржХрзЗржи ржЕржирзБрж░рзЛржз ржХрж░ржмрзЗ ржпрж╛рждрзЗ ржПржЯрж┐ рж╕рж░рзНржмржжрж╛ ржЖржкржбрзЗржЯ ржерж╛ржХрзЗред

### ржЯрж╛рж╕рзНржХ - ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЯрзЛржХрзЗржи ржкрж╛ржУржпрж╝рж╛

1. ржпржжрж┐ `smart-timer` ржкрзНрж░ржЬрзЗржХрзНржЯржЯрж┐ ржПржЦржиржУ ржЦрзЛрж▓рж╛ ржирж╛ ржерж╛ржХрзЗ, рждрж╛рж╣рж▓рзЗ ржПржЯрж┐ ржЦрзБрж▓рзБржиред

1. `platformio.ini` ржлрж╛ржЗрж▓рзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржбрж┐ржкрзЗржиржбрзЗржирзНрж╕рж┐ ржпрзЛржЧ ржХрж░рзБржи ржпрж╛рждрзЗ WiFi ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржПржмржВ JSON ржкрж░рж┐ржЪрж╛рж▓ржирж╛ ржХрж░рж╛ ржпрж╛ржпрж╝:

    ```ini
    seeed-studio/Seeed Arduino rpcWiFi @ 1.0.5
    seeed-studio/Seeed Arduino rpcUnified @ 2.1.3
    seeed-studio/Seeed_Arduino_mbedtls @ 3.0.1
    seeed-studio/Seeed Arduino RTC @ 2.0.0
    bblanchon/ArduinoJson @ 6.17.3
    ```

1. `config.h` рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓рзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    const char *SSID = "<SSID>";
    const char *PASSWORD = "<PASSWORD>";
    
    const char *SPEECH_API_KEY = "<API_KEY>";
    const char *SPEECH_LOCATION = "<LOCATION>";
    const char *LANGUAGE = "<LANGUAGE>";

    const char *TOKEN_URL = "https://%s.api.cognitive.microsoft.com/sts/v1.0/issuetoken";
    ```

    `<SSID>` ржПржмржВ `<PASSWORD>` ржЖржкржирж╛рж░ WiFi-ржПрж░ ржкрзНрж░рж╛рж╕ржЩрзНржЧрж┐ржХ ржорж╛ржи ржжрж┐ржпрж╝рзЗ ржкрзНрж░рждрж┐рж╕рзНржерж╛ржкржи ржХрж░рзБржиред

    `<API_KEY>`-ржХрзЗ ржЖржкржирж╛рж░ рж╕рзНржкрж┐ржЪ рж╕рж╛рж░рзНржнрж┐рж╕ рж░рж┐рж╕рзЛрж░рзНрж╕рзЗрж░ API ржХрзА ржжрж┐ржпрж╝рзЗ ржкрзНрж░рждрж┐рж╕рзНржерж╛ржкржи ржХрж░рзБржиред `<LOCATION>`-ржХрзЗ рж╕рзЗржЗ ржЕржмрж╕рзНржерж╛ржи ржжрж┐ржпрж╝рзЗ ржкрзНрж░рждрж┐рж╕рзНржерж╛ржкржи ржХрж░рзБржи ржпрж╛ ржЖржкржирж┐ рж╕рзНржкрж┐ржЪ рж╕рж╛рж░рзНржнрж┐рж╕ рж░рж┐рж╕рзЛрж░рзНрж╕ рждрзИрж░рж┐ ржХрж░рж╛рж░ рж╕ржоржпрж╝ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗржЫрж┐рж▓рзЗржиред

    `<LANGUAGE>`-ржХрзЗ рж╕рзЗржЗ ржнрж╛рж╖рж╛рж░ рж▓рзЛржХрж╛рж▓ ржирж╛ржо ржжрж┐ржпрж╝рзЗ ржкрзНрж░рждрж┐рж╕рзНржерж╛ржкржи ржХрж░рзБржи ржпрж╛ ржЖржкржирж┐ ржХржерж╛ ржмрж▓ржмрзЗржи, ржпрзЗржоржи `en-GB` ржЗржВрж░рзЗржЬрж┐рж░ ржЬржирзНржп ржмрж╛ `zn-HK` ржХрзНржпрж╛ржирзНржЯрзЛржирж┐ржЬрзЗрж░ ржЬржирзНржпред Microsoft ржбржХрзНрж╕рзЗ [Language and voice support documentation](https://docs.microsoft.com/azure/cognitive-services/speech-service/language-support?WT.mc_id=academic-17441-jabenn#speech-to-text) ржП рж╕ржорж░рзНржерж┐ржд ржнрж╛рж╖рж╛ ржПржмржВ рждрж╛ржжрзЗрж░ рж▓рзЛржХрж╛рж▓ ржирж╛ржорзЗрж░ рждрж╛рж▓рж┐ржХрж╛ ржЦрзБржБржЬрзЗ ржкрзЗрждрзЗ ржкрж╛рж░рзЗржиред

    `TOKEN_URL` ржХржирж╕рзНржЯрзНржпрж╛ржирзНржЯржЯрж┐ ржЯрзЛржХрзЗржи ржЗрж╕рзНржпрзБ ржХрж░рж╛рж░ URL ржпрж╛ ржЕржмрж╕рзНржерж╛ржи ржЫрж╛ржбрж╝рж╛ред ржПржЯрж┐ ржкрж░рзЗ ржЕржмрж╕рзНржерж╛ржирзЗрж░ рж╕рж╛ржерзЗ ржорж┐рж▓рж┐ржд рж╣ржпрж╝рзЗ рж╕ржорзНржкрзВрж░рзНржг URL рждрзИрж░рж┐ ржХрж░ржмрзЗред

1. Custom Vision-ржП рж╕ржВржпрзЛржЧ ржХрж░рж╛рж░ ржорждрзЛ, ржЖржкржирж╛ржХрзЗ ржЯрзЛржХрзЗржи ржЗрж╕рзНржпрзБ ржХрж░рж╛рж░ рж╕рж╛рж░рзНржнрж┐рж╕рзЗ рж╕ржВржпрзЛржЧ ржХрж░рждрзЗ HTTPS рж╕ржВржпрзЛржЧ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣ржмрзЗред `config.h`-ржПрж░ рж╢рзЗрж╖рзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    const char *TOKEN_CERTIFICATE =
        "-----BEGIN CERTIFICATE-----\r\n"
        "MIIF8zCCBNugAwIBAgIQAueRcfuAIek/4tmDg0xQwDANBgkqhkiG9w0BAQwFADBh\r\n"
        "MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\r\n"
        "d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBH\r\n"
        "MjAeFw0yMDA3MjkxMjMwMDBaFw0yNDA2MjcyMzU5NTlaMFkxCzAJBgNVBAYTAlVT\r\n"
        "MR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKjAoBgNVBAMTIU1pY3Jv\r\n"
        "c29mdCBBenVyZSBUTFMgSXNzdWluZyBDQSAwNjCCAiIwDQYJKoZIhvcNAQEBBQAD\r\n"
        "ggIPADCCAgoCggIBALVGARl56bx3KBUSGuPc4H5uoNFkFH4e7pvTCxRi4j/+z+Xb\r\n"
        "wjEz+5CipDOqjx9/jWjskL5dk7PaQkzItidsAAnDCW1leZBOIi68Lff1bjTeZgMY\r\n"
        "iwdRd3Y39b/lcGpiuP2d23W95YHkMMT8IlWosYIX0f4kYb62rphyfnAjYb/4Od99\r\n"
        "ThnhlAxGtfvSbXcBVIKCYfZgqRvV+5lReUnd1aNjRYVzPOoifgSx2fRyy1+pO1Uz\r\n"
        "aMMNnIOE71bVYW0A1hr19w7kOb0KkJXoALTDDj1ukUEDqQuBfBxReL5mXiu1O7WG\r\n"
        "0vltg0VZ/SZzctBsdBlx1BkmWYBW261KZgBivrql5ELTKKd8qgtHcLQA5fl6JB0Q\r\n"
        "gs5XDaWehN86Gps5JW8ArjGtjcWAIP+X8CQaWfaCnuRm6Bk/03PQWhgdi84qwA0s\r\n"
        "sRfFJwHUPTNSnE8EiGVk2frt0u8PG1pwSQsFuNJfcYIHEv1vOzP7uEOuDydsmCjh\r\n"
        "lxuoK2n5/2aVR3BMTu+p4+gl8alXoBycyLmj3J/PUgqD8SL5fTCUegGsdia/Sa60\r\n"
        "N2oV7vQ17wjMN+LXa2rjj/b4ZlZgXVojDmAjDwIRdDUujQu0RVsJqFLMzSIHpp2C\r\n"
        "Zp7mIoLrySay2YYBu7SiNwL95X6He2kS8eefBBHjzwW/9FxGqry57i71c2cDAgMB\r\n"
        "AAGjggGtMIIBqTAdBgNVHQ4EFgQU1cFnOsKjnfR3UltZEjgp5lVou6UwHwYDVR0j\r\n"
        "BBgwFoAUTiJUIBiV5uNu5g/6+rkS7QYXjzkwDgYDVR0PAQH/BAQDAgGGMB0GA1Ud\r\n"
        "JQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMHYG\r\n"
        "CCsGAQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQu\r\n"
        "Y29tMEAGCCsGAQUFBzAChjRodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGln\r\n"
        "aUNlcnRHbG9iYWxSb290RzIuY3J0MHsGA1UdHwR0MHIwN6A1oDOGMWh0dHA6Ly9j\r\n"
        "cmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RHMi5jcmwwN6A1oDOG\r\n"
        "MWh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RHMi5j\r\n"
        "cmwwHQYDVR0gBBYwFDAIBgZngQwBAgEwCAYGZ4EMAQICMBAGCSsGAQQBgjcVAQQD\r\n"
        "AgEAMA0GCSqGSIb3DQEBDAUAA4IBAQB2oWc93fB8esci/8esixj++N22meiGDjgF\r\n"
        "+rA2LUK5IOQOgcUSTGKSqF9lYfAxPjrqPjDCUPHCURv+26ad5P/BYtXtbmtxJWu+\r\n"
        "cS5BhMDPPeG3oPZwXRHBJFAkY4O4AF7RIAAUW6EzDflUoDHKv83zOiPfYGcpHc9s\r\n"
        "kxAInCedk7QSgXvMARjjOqdakor21DTmNIUotxo8kHv5hwRlGhBJwps6fEVi1Bt0\r\n"
        "trpM/3wYxlr473WSPUFZPgP1j519kLpWOJ8z09wxay+Br29irPcBYv0GMXlHqThy\r\n"
        "8y4m/HyTQeI2IMvMrQnwqPpY+rLIXyviI2vLoI+4xKE4Rn38ZZ8m\r\n"
        "-----END CERTIFICATE-----\r\n";
    ```

    ржПржЯрж┐ рж╕рзЗржЗ ржПржХржЗ рж╕рж╛рж░рзНржЯрж┐ржлрж┐ржХрзЗржЯ ржпрж╛ ржЖржкржирж┐ Custom Vision-ржП рж╕ржВржпрзЛржЧ ржХрж░рж╛рж░ рж╕ржоржпрж╝ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗржЫрж┐рж▓рзЗржиред

1. `main.cpp` ржлрж╛ржЗрж▓рзЗрж░ рж╢рзАрж░рзНрж╖рзЗ WiFi рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓ ржПржмржВ config рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓рзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ ржЗржиржХрзНрж▓рзБржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    #include <rpcWiFi.h>

    #include "config.h"
    ```

1. `setup` ржлрж╛ржВрж╢ржирзЗрж░ ржЙржкрж░рзЗ `main.cpp`-ржП WiFi-рждрзЗ рж╕ржВржпрзЛржЧ ржХрж░рж╛рж░ ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    void connectWiFi()
    {
        while (WiFi.status() != WL_CONNECTED)
        {
            Serial.println("Connecting to WiFi..");
            WiFi.begin(SSID, PASSWORD);
            delay(500);
        }
    
        Serial.println("Connected!");
    }
    ```

1. рж╕рж┐рж░рж┐ржпрж╝рж╛рж▓ рж╕ржВржпрзЛржЧ рж╕рзНржерж╛ржкржирзЗрж░ ржкрж░рзЗ `setup` ржлрж╛ржВрж╢ржи ржерзЗржХрзЗ ржПржЗ ржлрж╛ржВрж╢ржиржЯрж┐ ржХрж▓ ржХрж░рзБржи:

    ```cpp
    connectWiFi();
    ```

1. `src` ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржПржХржЯрж┐ ржирждрзБржи рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓ рждрзИрж░рж┐ ржХрж░рзБржи ржпрж╛рж░ ржирж╛ржо `speech_to_text.h`ред ржПржЗ рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓рзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    #pragma once
    
    #include <Arduino.h>
    #include <ArduinoJson.h>
    #include <HTTPClient.h>
    #include <WiFiClientSecure.h>
    
    #include "config.h"
    #include "mic.h"
    
    class SpeechToText
    {
    public:

    private:

    };

    SpeechToText speechToText;
    ```

    ржПржЯрж┐ HTTP рж╕ржВржпрзЛржЧ, ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи ржПржмржВ `mic.h` рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓рзЗрж░ ржЬржирзНржп ржХрж┐ржЫрзБ ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржХрж░рзЗ ржПржмржВ `SpeechToText` ржирж╛ржорзЗ ржПржХржЯрж┐ ржХрзНрж▓рж╛рж╕ рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рзЗ, ржкрж░рзЗ ржПржЗ ржХрзНрж▓рж╛рж╕рзЗрж░ ржПржХржЯрж┐ ржЗржирж╕рзНржЯрзНржпрж╛ржирзНрж╕ ржШрзЛрж╖ржгрж╛ ржХрж░рзЗ ржпрж╛ ржкрж░рзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред

1. ржПржЗ ржХрзНрж▓рж╛рж╕рзЗрж░ `private` рж╕рзЗржХрж╢ржирзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд рзиржЯрж┐ ржлрж┐рж▓рзНржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    WiFiClientSecure _token_client;
    String _access_token;
    ```

    `_token_client` ржПржХржЯрж┐ WiFi ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ ржпрж╛ HTTPS ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржмржВ ржПржЯрж┐ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЯрзЛржХрзЗржи ржкрзЗрждрзЗ ржмрзНржпржмрж╣рзГржд рж╣ржмрзЗред ржПржЗ ржЯрзЛржХрзЗржиржЯрж┐ ржкрж░рзЗ `_access_token`-ржП рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рж╛ рж╣ржмрзЗред

1. `private` рж╕рзЗржХрж╢ржирзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржорзЗржержб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    String getAccessToken()
    {
        char url[128];
        sprintf(url, TOKEN_URL, SPEECH_LOCATION);
    
        HTTPClient httpClient;
        httpClient.begin(_token_client, url);
    
        httpClient.addHeader("Ocp-Apim-Subscription-Key", SPEECH_API_KEY);
        int httpResultCode = httpClient.POST("{}");
    
        if (httpResultCode != 200)
        {
            Serial.println("Error getting access token, trying again...");
            delay(10000);
            return getAccessToken();
        }
    
        Serial.println("Got access token.");
        String result = httpClient.getString();
    
        httpClient.end();
    
        return result;
    }
    ```

    ржПржЗ ржХрзЛржбржЯрж┐ рж╕рзНржкрж┐ржЪ рж░рж┐рж╕рзЛрж░рзНрж╕рзЗрж░ ржЕржмрж╕рзНржерж╛ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЯрзЛржХрзЗржи ржЗрж╕рзНржпрзБ ржХрж░рж╛рж░ API-ржПрж░ URL рждрзИрж░рж┐ ржХрж░рзЗред рждрж╛рж░ржкрж░ ржПржЯрж┐ ржПржХржЯрж┐ `HTTPClient` рждрзИрж░рж┐ ржХрж░рзЗ ржУржпрж╝рзЗржм ржЕржирзБрж░рзЛржз ржХрж░рж╛рж░ ржЬржирзНржп, ржПржЯрж┐ ржЯрзЛржХрзЗржи ржПржирзНржбржкржпрж╝рзЗржирзНржЯрзЗрж░ рж╕рж╛рж░рзНржЯрж┐ржлрж┐ржХрзЗржЯ ржжрж┐ржпрж╝рзЗ ржХржиржлрж┐ржЧрж╛рж░ ржХрж░рж╛ WiFi ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ рж╕рзЗржЯ ржЖржк ржХрж░рзЗред ржПржЯрж┐ API ржХрзАржХрзЗ ржХрж▓рзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ рж╣рзЗржбрж╛рж░ рж╣рж┐рж╕рзЗржмрзЗ рж╕рзЗржЯ ржХрж░рзЗред рждрж╛рж░ржкрж░ ржПржЯрж┐ рж╕рж╛рж░рзНржЯрж┐ржлрж┐ржХрзЗржЯ ржкрзЗрждрзЗ ржПржХржЯрж┐ POST ржЕржирзБрж░рзЛржз ржХрж░рзЗ, ржХрзЛржирзЛ рждрзНрж░рзБржЯрж┐ ржкрзЗрж▓рзЗ ржкрзБржирж░рж╛ржпрж╝ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзЗред ржЕржмрж╢рзЗрж╖рзЗ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЯрзЛржХрзЗржиржЯрж┐ ржлрзЗрж░ржд ржжрзЗржпрж╝ред

1. `public` рж╕рзЗржХрж╢ржирзЗ ржПржХржЯрж┐ ржорзЗржержб ржпрзЛржЧ ржХрж░рзБржи ржпрж╛ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЯрзЛржХрзЗржи ржкрзЗрждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░ржмрзЗред ржПржЯрж┐ ржкрж░ржмрж░рзНрждрзА ржкрж╛ржарзЗ ржЯрзЗржХрзНрж╕ржЯржХрзЗ рж╕рзНржкрж┐ржЪрзЗ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рждрзЗ ржкрзНрж░ржпрж╝рзЛржЬржи рж╣ржмрзЗред

    ```cpp
    String AccessToken()
    {
        return _access_token;
    }
    ```

1. `public` рж╕рзЗржХрж╢ржирзЗ ржПржХржЯрж┐ `init` ржорзЗржержб ржпрзЛржЧ ржХрж░рзБржи ржпрж╛ ржЯрзЛржХрзЗржи ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ рж╕рзЗржЯ ржЖржк ржХрж░рзЗ:

    ```cpp
    void init()
    {
        _token_client.setCACert(TOKEN_CERTIFICATE);
        _access_token = getAccessToken();
    }
    ```

    ржПржЯрж┐ WiFi ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯрзЗ рж╕рж╛рж░рзНржЯрж┐ржлрж┐ржХрзЗржЯ рж╕рзЗржЯ ржХрж░рзЗ, рждрж╛рж░ржкрж░ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЯрзЛржХрзЗржи ржкрж╛ржпрж╝ред

1. `main.cpp`-ржП ржПржЗ ржирждрзБржи рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓ржЯрж┐ ржЗржиржХрзНрж▓рзБржб ржбрж┐рж░рзЗржХрзНржЯрж┐ржнрзЗ ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    #include "speech_to_text.h"
    ```

1. `setup` ржлрж╛ржВрж╢ржирзЗрж░ рж╢рзЗрж╖рзЗ `mic.init` ржХрж▓ ржХрж░рж╛рж░ ржкрж░рзЗ ржХрж┐ржирзНрждрзБ рж╕рж┐рж░рж┐ржпрж╝рж╛рж▓ ржоржирж┐ржЯрж░рзЗ `Ready` рж▓рзЗржЦрж╛рж░ ржЖржЧрзЗ `SpeechToText` ржХрзНрж▓рж╛рж╕ржЯрж┐ ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬ ржХрж░рзБржи:

    ```cpp
    speechToText.init();
    ```

### ржЯрж╛рж╕рзНржХ - ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорж░рж┐ ржерзЗржХрзЗ ржЕржбрж┐ржУ ржкржбрж╝рж╛

1. ржкрж╛ржарзЗрж░ ржЖржЧрзЗрж░ ржЕржВрж╢рзЗ, ржЕржбрж┐ржУржЯрж┐ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорж░рж┐рждрзЗ рж░рзЗржХрж░рзНржб ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрж┐рж▓ред ржПржЗ ржЕржбрж┐ржУржЯрж┐ Speech Services REST API-рждрзЗ ржкрж╛ржарж╛ржирзЛ рж╣ржмрзЗ, рждрж╛ржЗ ржПржЯрж┐ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорж░рж┐ ржерзЗржХрзЗ ржкржбрж╝рждрзЗ рж╣ржмрзЗред ржПржЯрж┐ ржЗржи-ржорзЗржорж░рж┐ ржмрж╛ржлрж╛рж░рзЗ рж▓рзЛржб ржХрж░рж╛ ржпрж╛ржмрзЗ ржирж╛ ржХрж╛рж░ржг ржПржЯрж┐ ржЦрзБржм ржмржбрж╝ рж╣ржмрзЗред `HTTPClient` ржХрзНрж▓рж╛рж╕ржЯрж┐ REST ржХрж▓ ржХрж░рждрзЗ ржПржХржЯрж┐ Arduino Stream ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржбрзЗржЯрж╛ рж╕рзНржЯрзНрж░рж┐ржо ржХрж░рждрзЗ ржкрж╛рж░рзЗ - ржПржХржЯрж┐ ржХрзНрж▓рж╛рж╕ ржпрж╛ ржЫрзЛржЯ ржЫрзЛржЯ ржЕржВрж╢рзЗ ржбрзЗржЯрж╛ рж▓рзЛржб ржХрж░рждрзЗ ржкрж╛рж░рзЗ, ржПржХржмрж╛рж░рзЗ ржПржХржЯрж┐ ржЕржВрж╢ ржкрж╛ржарж╛рждрзЗ ржкрж╛рж░рзЗред ржЖржкржирж┐ ржпржЦржиржЗ ржПржХржЯрж┐ рж╕рзНржЯрзНрж░рж┐ржорзЗ `read` ржХрж▓ ржХрж░ржмрзЗржи ржПржЯрж┐ ржкрж░ржмрж░рзНрждрзА ржмрзНрж▓ржХржЯрж┐ ржлрзЗрж░ржд ржжрзЗржпрж╝ред ржПржХржЯрж┐ Arduino рж╕рзНржЯрзНрж░рж┐ржо рждрзИрж░рж┐ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ ржпрж╛ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорж░рж┐ ржерзЗржХрзЗ ржкржбрж╝рждрзЗ ржкрж╛рж░рзЗред `src` ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржПржХржЯрж┐ ржирждрзБржи ржлрж╛ржЗрж▓ рждрзИрж░рж┐ ржХрж░рзБржи ржпрж╛рж░ ржирж╛ржо `flash_stream.h`, ржПржмржВ ржПрждрзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    #pragma once
    
    #include <Arduino.h>
    #include <HTTPClient.h>
    #include <sfud.h>

    #include "config.h"
    
    class FlashStream : public Stream
    {
    public:
        virtual size_t write(uint8_t val)
        {    
        }
    
        virtual int available()
        {
        }
    
        virtual int read()
        {
        }
    
        virtual int peek()
        {
        }
    private:
    
    };
    ```

    ржПржЯрж┐ `FlashStream` ржХрзНрж▓рж╛рж╕ ржШрзЛрж╖ржгрж╛ ржХрж░рзЗ, Arduino `Stream` ржХрзНрж▓рж╛рж╕ ржерзЗржХрзЗ ржбрзЗрж░рж╛ржЗржн ржХрж░рзЗред ржПржЯрж┐ ржПржХржЯрж┐ ржЕрзНржпрж╛ржмрж╕рзНржЯрзНрж░рж╛ржХрзНржЯ ржХрзНрж▓рж╛рж╕ - ржбрзЗрж░рж╛ржЗржн ржХрж░рж╛ ржХрзНрж▓рж╛рж╕ржЧрзБрж▓рж┐ржХрзЗ ржХржпрж╝рзЗржХржЯрж┐ ржорзЗржержб ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржи ржХрж░рждрзЗ рж╣ржмрзЗ ржХрзНрж▓рж╛рж╕ржЯрж┐ ржЗржирж╕рзНржЯрзНржпрж╛ржирж╢рж┐ржпрж╝рзЗржЯ ржХрж░рж╛рж░ ржЖржЧрзЗ, ржПржмржВ ржПржЗ ржорзЗржержбржЧрзБрж▓рж┐ ржПржЗ ржХрзНрж▓рж╛рж╕рзЗ рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред

    тЬЕ Arduino Streams рж╕ржорзНржкрж░рзНржХрзЗ ржЖрж░ржУ ржкржбрж╝рзБржи [Arduino Stream documentation](https://www.arduino.cc/reference/en/language/functions/communication/stream/) ржПред

1. `private` рж╕рзЗржХрж╢ржирзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржлрж┐рж▓рзНржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    size_t _pos;
    size_t _flash_address;
    const sfud_flash *_flash;

    byte _buffer[HTTP_TCP_BUFFER_SIZE];
    ```

    ржПржЯрж┐ ржПржХржЯрж┐ ржЕрж╕рзНржерж╛ржпрж╝рзА ржмрж╛ржлрж╛рж░ рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рзЗ ржпрж╛ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорж░рж┐ ржерзЗржХрзЗ ржкржбрж╝рж╛ ржбрзЗржЯрж╛ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзЗ, ржмрж░рзНрждржорж╛ржи ржЕржмрж╕рзНржерж╛ржи, ржмрж░рзНрждржорж╛ржи ржарж┐ржХрж╛ржирж╛ ржПржмржВ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорж░рж┐ ржбрж┐ржнрж╛ржЗрж╕ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзЗред

1. `private` рж╕рзЗржХрж╢ржирзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржорзЗржержб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    void populateBuffer()
    {
        sfud_read(_flash, _flash_address, HTTP_TCP_BUFFER_SIZE, _buffer);
        _flash_address += HTTP_TCP_BUFFER_SIZE;
        _pos = 0;
    }
    ```

    ржПржЗ ржХрзЛржбржЯрж┐ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорж░рж┐ ржерзЗржХрзЗ ржмрж░рзНрждржорж╛ржи ржарж┐ржХрж╛ржирж╛ржпрж╝ ржкржбрж╝рзЗ ржПржмржВ ржбрзЗржЯрж╛ ржПржХржЯрж┐ ржмрж╛ржлрж╛рж░рзЗ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзЗред рждрж╛рж░ржкрж░ ржПржЯрж┐ ржарж┐ржХрж╛ржирж╛ржЯрж┐ ржмрзГржжрзНржзрж┐ ржХрж░рзЗ, ржпрж╛рждрзЗ ржкрж░ржмрж░рзНрждрзА ржХрж▓ ржкрж░ржмрж░рзНрждрзА ржмрзНрж▓ржХржЯрж┐ ржкржбрж╝рзЗред ржмрж╛ржлрж╛рж░ржЯрж┐ HTTPClient-ржПрж░ рж╕рж░рзНржмрзЛржЪрзНржЪ ржЪрж╛ржЩрзНржХ рж╕рж╛ржЗржЬрзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ рждрзИрж░рж┐ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ ржпрж╛ REST API-рждрзЗ ржПржХржмрж╛рж░рзЗ ржкрж╛ржарж╛ржирзЛ рж╣ржмрзЗред

    > ЁЯТБ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорж░рж┐ ржорзБржЫрждрзЗ ржЧрзНрж░рзЗржЗржи рж╕рж╛ржЗржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣ржпрж╝, рждржмрзЗ ржкржбрж╝рж╛рж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ рждрж╛ ржкрзНрж░ржпрж╝рзЛржЬржи рж╣ржпрж╝ ржирж╛ред

1. ржПржЗ ржХрзНрж▓рж╛рж╕рзЗрж░ `public` рж╕рзЗржХрж╢ржирзЗ ржПржХржЯрж┐ ржХржирж╕рзНржЯрзНрж░рж╛ржХрзНржЯрж░ ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    FlashStream()
    {
        _pos = 0;
        _flash_address = 0;
        _flash = sfud_get_device_table() + 0;
        
        populateBuffer();
    }
    ```

    ржПржЗ ржХржирж╕рзНржЯрзНрж░рж╛ржХрзНржЯрж░ржЯрж┐ рж╕ржорж╕рзНржд ржлрж┐рж▓рзНржб рж╕рзЗржЯ ржЖржк ржХрж░рзЗ ржпрж╛рждрзЗ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорж░рж┐ ржмрзНрж▓ржХрзЗрж░ рж╢рзБрж░рзБ ржерзЗржХрзЗ ржкржбрж╝рж╛ рж╢рзБрж░рзБ рж╣ржпрж╝ ржПржмржВ ржкрзНрж░ржержо ржЪрж╛ржЩрзНржХржЯрж┐ ржмрж╛ржлрж╛рж░рзЗ рж▓рзЛржб ржХрж░рзЗред

1. `write` ржорзЗржержбржЯрж┐ ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржи ржХрж░рзБржиред ржПржЗ рж╕рзНржЯрзНрж░рж┐ржоржЯрж┐ рж╢рзБржзрзБржорж╛рждрзНрж░ ржбрзЗржЯрж╛ ржкржбрж╝ржмрзЗ, рждрж╛ржЗ ржПржЯрж┐ ржХрж┐ржЫрзБржЗ ржХрж░ржмрзЗ ржирж╛ ржПржмржВ рзж ржлрзЗрж░ржд ржжрзЗржмрзЗ:

    ```cpp
    virtual size_t write(uint8_t val)
    {
        return 0;
    }
    ```

1. `peek` ржорзЗржержбржЯрж┐ ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржи ржХрж░рзБржиред ржПржЯрж┐ ржмрж░рзНрждржорж╛ржи ржЕржмрж╕рзНржерж╛ржирзЗ ржбрзЗржЯрж╛ ржлрзЗрж░ржд ржжрзЗржпрж╝ рж╕рзНржЯрзНрж░рж┐ржоржЯрж┐ ржирж╛ рж╕рж░рж┐ржпрж╝рзЗред ржПржХрж╛ржзрж┐ржХржмрж╛рж░ `peek` ржХрж▓ ржХрж░рж▓рзЗ ржПржХржЗ ржбрзЗржЯрж╛ ржлрзЗрж░ржд ржжрзЗржпрж╝ ржпрждржХрзНрж╖ржг ржирж╛ рж╕рзНржЯрзНрж░рж┐ржо ржерзЗржХрзЗ ржХрзЛржирзЛ ржбрзЗржЯрж╛ ржкржбрж╝рж╛ рж╣ржпрж╝ред

    ```cpp
    virtual int peek()
    {
        return _buffer[_pos];
    }
    ```

1. `available` ржлрж╛ржВрж╢ржиржЯрж┐ ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржи ржХрж░рзБржиред ржПржЯрж┐ рж╕рзНржЯрзНрж░рж┐ржо ржерзЗржХрзЗ ржХрждржЧрзБрж▓рзЛ ржмрж╛ржЗржЯ ржкржбрж╝рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ рждрж╛ ржлрзЗрж░ржд ржжрзЗржпрж╝, ржЕржержмрж╛ -рзз ржпржжрж┐ рж╕рзНржЯрзНрж░рж┐ржо рж╕ржорзНржкрзВрж░рзНржг рж╣ржпрж╝ред ржПржЗ ржХрзНрж▓рж╛рж╕рзЗрж░ ржЬржирзНржп, рж╕рж░рзНржмрж╛ржзрж┐ржХ ржЙржкрж▓ржмрзНржз HTTPClient-ржПрж░ ржЪрж╛ржЩрзНржХ рж╕рж╛ржЗржЬрзЗрж░ ржмрзЗрж╢рж┐ рж╣ржмрзЗ ржирж╛ред ржпржЦржи ржПржЗ рж╕рзНржЯрзНрж░рж┐ржоржЯрж┐ HTTP ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝ ржПржЯрж┐ ржПржЗ ржлрж╛ржВрж╢ржиржЯрж┐ ржХрж▓ ржХрж░рзЗ ржжрзЗржЦрждрзЗ ржХрждржЯрж╛ ржбрзЗржЯрж╛ ржЙржкрж▓ржмрзНржз, рждрж╛рж░ржкрж░ REST API-рждрзЗ ржкрж╛ржарж╛ржирзЛрж░ ржЬржирзНржп рж╕рзЗржЗ ржкрж░рж┐ржорж╛ржг ржбрзЗржЯрж╛ ржЕржирзБрж░рзЛржз ржХрж░рзЗред ржЖржорж░рж╛ ржЪрж╛ржЗ ржирж╛ ржкрзНрж░рждрж┐ржЯрж┐ ржЪрж╛ржЩрзНржХ HTTP ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯрзЗрж░ ржЪрж╛ржЩрзНржХ рж╕рж╛ржЗржЬрзЗрж░ ржмрзЗрж╢рж┐ рж╣рзЛржХ, рждрж╛ржЗ ржпржжрж┐ ржмрзЗрж╢рж┐ ржЙржкрж▓ржмрзНржз ржерж╛ржХрзЗ рждрж╛рж╣рж▓рзЗ ржЪрж╛ржЩрзНржХ рж╕рж╛ржЗржЬ ржлрзЗрж░ржд ржжрзЗржпрж╝ред ржпржжрж┐ ржХржо ржерж╛ржХрзЗ, рждрж╛рж╣рж▓рзЗ ржпрждржЯрж╛ ржЙржкрж▓ржмрзНржз рждрж╛ ржлрзЗрж░ржд ржжрзЗржпрж╝ред ржПржХржмрж╛рж░ рж╕ржорж╕рзНржд ржбрзЗржЯрж╛ рж╕рзНржЯрзНрж░рж┐ржо рж╣ржпрж╝рзЗ ржЧрзЗрж▓рзЗ, -рзз ржлрзЗрж░ржд ржжрзЗржпрж╝ред

    ```cpp
    virtual int available()
    {
        int remaining = BUFFER_SIZE - ((_flash_address - HTTP_TCP_BUFFER_SIZE) + _pos);
        int bytes_available = min(HTTP_TCP_BUFFER_SIZE, remaining);

        if (bytes_available == 0)
        {
            bytes_available = -1;
        }

        return bytes_available;
    }
    ```

1. `read` ржорзЗржержбржЯрж┐ ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржи ржХрж░рзБржи ржпрж╛рждрзЗ ржмрж╛ржлрж╛рж░ ржерзЗржХрзЗ ржкрж░ржмрж░рзНрждрзА ржмрж╛ржЗржЯ ржлрзЗрж░ржд ржжрзЗржпрж╝, ржЕржмрж╕рзНржерж╛ржи ржмрзГржжрзНржзрж┐ ржХрж░рзЗред ржпржжрж┐ ржЕржмрж╕рзНржерж╛ржи ржмрж╛ржлрж╛рж░рзЗрж░ рж╕рж╛ржЗржЬ ржЕрждрж┐ржХрзНрж░ржо ржХрж░рзЗ, ржПржЯрж┐ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорж░рж┐ ржерзЗржХрзЗ ржкрж░ржмрж░рзНрждрзА ржмрзНрж▓ржХ ржжрж┐ржпрж╝рзЗ ржмрж╛ржлрж╛рж░ржЯрж┐ ржкрзВрж░ржг ржХрж░рзЗ ржПржмржВ ржЕржмрж╕рзНржерж╛ржиржЯрж┐ рж░рж┐рж╕рзЗржЯ ржХрж░рзЗред

    ```cpp
    virtual int read()
    {
        int retVal = _buffer[_pos++];

        if (_pos == HTTP_TCP_BUFFER_SIZE)
        {
            populateBuffer();
        }

        return retVal;
    }
    ```

1. `speech_to_text.h` рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓рзЗ ржПржЗ ржирждрзБржи рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓рзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ ржЗржиржХрзНрж▓рзБржб ржбрж┐рж░рзЗржХрзНржЯрж┐ржн ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    #include "flash_stream.h"
    ```

### ржЯрж╛рж╕рзНржХ - рж╕рзНржкрж┐ржЪржХрзЗ ржЯрзЗржХрзНрж╕ржЯрзЗ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рж╛

1. рж╕рзНржкрж┐ржЪржХрзЗ ржЯрзЗржХрзНрж╕ржЯрзЗ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ ржЕржбрж┐ржУржЯрж┐ Speech Service-ржПрж░ REST API-рждрзЗ ржкрж╛ржарж┐ржпрж╝рзЗред ржПржЗ REST API-ржПрж░ ржЯрзЛржХрзЗржи ржЗрж╕рзНржпрзБ ржХрж░рж╛рж░ рж╕рж╛рж░рзНржЯрж┐ржлрж┐ржХрзЗржЯрзЗрж░ ржерзЗржХрзЗ ржЖрж▓рж╛ржжрж╛ рж╕рж╛рж░рзНржЯрж┐ржлрж┐ржХрзЗржЯ рж░ржпрж╝рзЗржЫрзЗ, рждрж╛ржЗ `config.h` рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓рзЗ ржПржЗ рж╕рж╛рж░рзНржЯрж┐ржлрж┐ржХрзЗржЯ рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рждрзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    const char *SPEECH_CERTIFICATE =
        "-----BEGIN CERTIFICATE-----\r\n"
        "MIIF8zCCBNugAwIBAgIQCq+mxcpjxFFB6jvh98dTFzANBgkqhkiG9w0BAQwFADBh\r\n"
        "MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\r\n"
        "d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBH\r\n"
        "MjAeFw0yMDA3MjkxMjMwMDBaFw0yNDA2MjcyMzU5NTlaMFkxCzAJBgNVBAYTAlVT\r\n"
        "MR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKjAoBgNVBAMTIU1pY3Jv\r\n"
        "c29mdCBBenVyZSBUTFMgSXNzdWluZyBDQSAwMTCCAiIwDQYJKoZIhvcNAQEBBQAD\r\n"
        "ggIPADCCAgoCggIBAMedcDrkXufP7pxVm1FHLDNA9IjwHaMoaY8arqqZ4Gff4xyr\r\n"
        "RygnavXL7g12MPAx8Q6Dd9hfBzrfWxkF0Br2wIvlvkzW01naNVSkHp+OS3hL3W6n\r\n"
        "l/jYvZnVeJXjtsKYcXIf/6WtspcF5awlQ9LZJcjwaH7KoZuK+THpXCMtzD8XNVdm\r\n"
        "GW/JI0C/7U/E7evXn9XDio8SYkGSM63aLO5BtLCv092+1d4GGBSQYolRq+7Pd1kR\r\n"
        "EkWBPm0ywZ2Vb8GIS5DLrjelEkBnKCyy3B0yQud9dpVsiUeE7F5sY8Me96WVxQcb\r\n"
        "OyYdEY/j/9UpDlOG+vA+YgOvBhkKEjiqygVpP8EZoMMijephzg43b5Qi9r5UrvYo\r\n"
        "o19oR/8pf4HJNDPF0/FJwFVMW8PmCBLGstin3NE1+NeWTkGt0TzpHjgKyfaDP2tO\r\n"
        "4bCk1G7pP2kDFT7SYfc8xbgCkFQ2UCEXsaH/f5YmpLn4YPiNFCeeIida7xnfTvc4\r\n"
        "7IxyVccHHq1FzGygOqemrxEETKh8hvDR6eBdrBwmCHVgZrnAqnn93JtGyPLi6+cj\r\n"
        "WGVGtMZHwzVvX1HvSFG771sskcEjJxiQNQDQRWHEh3NxvNb7kFlAXnVdRkkvhjpR\r\n"
        "GchFhTAzqmwltdWhWDEyCMKC2x/mSZvZtlZGY+g37Y72qHzidwtyW7rBetZJAgMB\r\n"
        "AAGjggGtMIIBqTAdBgNVHQ4EFgQUDyBd16FXlduSzyvQx8J3BM5ygHYwHwYDVR0j\r\n"
        "BBgwFoAUTiJUIBiV5uNu5g/6+rkS7QYXjzkwDgYDVR0PAQH/BAQDAgGGMB0GA1Ud\r\n"
        "JQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMHYG\r\n"
        "CCsGAQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQu\r\n"
        "Y29tMEAGCCsGAQUFBzAChjRodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGln\r\n"
        "aUNlcnRHbG9iYWxSb290RzIuY3J0MHsGA1UdHwR0MHIwN6A1oDOGMWh0dHA6Ly9j\r\n"
        "cmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RHMi5jcmwwN6A1oDOG\r\n"
        "MWh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RHMi5j\r\n"
        "cmwwHQYDVR0gBBYwFDAIBgZngQwBAgEwCAYGZ4EMAQICMBAGCSsGAQQBgjcVAQQD\r\n"
        "AgEAMA0GCSqGSIb3DQEBDAUAA4IBAQAlFvNh7QgXVLAZSsNR2XRmIn9iS8OHFCBA\r\n"
        "WxKJoi8YYQafpMTkMqeuzoL3HWb1pYEipsDkhiMnrpfeYZEA7Lz7yqEEtfgHcEBs\r\n"
        "K9KcStQGGZRfmWU07hPXHnFz+5gTXqzCE2PBMlRgVUYJiA25mJPXfB00gDvGhtYa\r\n"
        "+mENwM9Bq1B9YYLyLjRtUz8cyGsdyTIG/bBM/Q9jcV8JGqMU/UjAdh1pFyTnnHEl\r\n"
        "Y59Npi7F87ZqYYJEHJM2LGD+le8VsHjgeWX2CJQko7klXvcizuZvUEDTjHaQcs2J\r\n"
        "+kPgfyMIOY1DMJ21NxOJ2xPRC/wAh/hzSBRVtoAnyuxtkZ4VjIOh\r\n"
        "-----END CERTIFICATE-----\r\n";
    ```

1. ржПржЗ ржлрж╛ржЗрж▓рзЗ ржЕржмрж╕рзНржерж╛ржи ржЫрж╛ржбрж╝рж╛ рж╕рзНржкрж┐ржЪ URL-ржПрж░ ржЬржирзНржп ржПржХржЯрж┐ ржХржирж╕рзНржЯрзНржпрж╛ржирзНржЯ ржпрзЛржЧ ржХрж░рзБржиред ржПржЯрж┐ ржкрж░рзЗ ржЕржмрж╕рзНржерж╛ржи ржПржмржВ ржнрж╛рж╖рж╛рж░ рж╕рж╛ржерзЗ ржорж┐рж▓рж┐ржд рж╣ржпрж╝рзЗ рж╕ржорзНржкрзВрж░рзНржг URL рждрзИрж░рж┐ ржХрж░ржмрзЗред

    ```cpp
    const char *SPEECH_URL = "https://%s.stt.speech.microsoft.com/speech/recognition/conversation/cognitiveservices/v1?language=%s";
    ```

1. `speech_to_text.h` рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓рзЗ `SpeechToText` ржХрзНрж▓рж╛рж╕рзЗрж░ `private` рж╕рзЗржХрж╢ржирзЗ ржПржХржЯрж┐ WiFi ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рзБржи ржпрж╛ рж╕рзНржкрж┐ржЪ рж╕рж╛рж░рзНржЯрж┐ржлрж┐ржХрзЗржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ:

    ```cpp
    WiFiClientSecure _speech_client;
    ```

1. `init` ржорзЗржержбрзЗ ржПржЗ WiFi ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯрзЗ рж╕рж╛рж░рзНржЯрж┐ржлрж┐ржХрзЗржЯ рж╕рзЗржЯ ржХрж░рзБржи:

    ```cpp
    _speech_client.setCACert(SPEECH_CERTIFICATE);
    ```

1. `SpeechToText` ржХрзНрж▓рж╛рж╕рзЗрж░ `public` рж╕рзЗржХрж╢ржирзЗ рж╕рзНржкрж┐ржЪржХрзЗ ржЯрзЗржХрзНрж╕ржЯрзЗ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рж╛рж░ ржЬржирзНржп ржПржХржЯрж┐ ржорзЗржержб рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рзБржи:

    ```cpp
    String convertSpeechToText()
    {
        
    }
    ```

1. ржПржЗ ржорзЗржержбрзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи ржпрж╛рждрзЗ рж╕рзНржкрж┐ржЪ рж╕рж╛рж░рзНржЯрж┐ржлрж┐ржХрзЗржЯ ржжрж┐ржпрж╝рзЗ ржХржиржлрж┐ржЧрж╛рж░ ржХрж░рж╛ WiFi ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржХржЯрж┐ HTTP ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ рждрзИрж░рж┐ ржХрж░рж╛ ржпрж╛ржпрж╝ ржПржмржВ ржЕржмрж╕рзНржерж╛ржи ржПржмржВ ржнрж╛рж╖рж╛ рж╕рзЗржЯ ржХрж░рж╛ рж╕рзНржкрж┐ржЪ URL ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛ржпрж╝:

    ```cpp
    char url[128];
    sprintf(url, SPEECH_URL, SPEECH_LOCATION, LANGUAGE);

    HTTPClient httpClient;
    httpClient.begin(_speech_client, url);
    ```

1. рж╕ржВржпрзЛржЧрзЗ ржХрж┐ржЫрзБ рж╣рзЗржбрж╛рж░ рж╕рзЗржЯ ржХрж░рждрзЗ рж╣ржмрзЗ:

    ```cpp
    httpClient.addHeader("Authorization", String("Bearer ") + _access_token);
    httpClient.addHeader("Content-Type", String("audio/wav; codecs=audio/pcm; samplerate=") + String(RATE));
    httpClient.addHeader("Accept", "application/json;text/xml");
    ```

    ржПржЯрж┐ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЯрзЛржХрзЗржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЕржерж░рж╛ржЗржЬрзЗрж╢ржирзЗрж░ ржЬржирзНржп рж╣рзЗржбрж╛рж░ рж╕рзЗржЯ ржХрж░рзЗ, ржЕржбрж┐ржУ ржлрж░ржорзНржпрж╛ржЯрзЗрж░ ржЬржирзНржп рж╕рзНржпрж╛ржорзНржкрж▓ рж░рзЗржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржмржВ ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ JSON рж╣рж┐рж╕рзЗржмрзЗ ржлрж▓рж╛ржлрж▓ ржкрзНрж░рждрзНржпрж╛рж╢рж╛ ржХрж░рзЗ рж╕рзЗржЯ ржХрж░рзЗред

1. ржПрж░ ржкрж░рзЗ, REST API ржХрж▓ ржХрж░рж╛рж░ ржЬржирзНржп ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    Serial.println("Sending speech...");

    FlashStream stream;
    int httpResponseCode = httpClient.sendRequest("POST", &stream, BUFFER_SIZE);

    Serial.println("Speech sent!");
    ```

    ржПржЯрж┐ ржПржХржЯрж┐ `FlashStream` рждрзИрж░рж┐ ржХрж░рзЗ ржПржмржВ REST API-рждрзЗ ржбрзЗржЯрж╛ рж╕рзНржЯрзНрж░рж┐ржо ржХрж░рждрзЗ ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред

1. ржПрж░ ржирж┐ржЪрзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    String text = "";

    if (httpResponseCode == 200)
    {
        String result = httpClient.getString();
        Serial.println(result);

        DynamicJsonDocument doc(1024);
        deserializeJson(doc, result.c_str());

        JsonObject obj = doc.as<JsonObject>();
        text = obj["DisplayText"].as<String>();
    }
    else if (httpResponseCode == 401)
    {
        Serial.println("Access token expired, trying again with a new token");
        _access_token = getAccessToken();
        return convertSpeechToText();
    }
    else
    {
        Serial.print("Failed to convert text to speech - error ");
        Serial.println(httpResponseCode);
    }
    ```

    ржПржЗ ржХрзЛржбржЯрж┐ рж░рзЗрж╕ржкржирзНрж╕ ржХрзЛржб ржЪрзЗржХ ржХрж░рзЗред

    ржпржжрж┐ ржПржЯрж┐ рзирзжрзж рж╣ржпрж╝, рж╕ржлрж▓рждрж╛рж░ ржХрзЛржб, рждрж╛рж╣рж▓рзЗ ржлрж▓рж╛ржлрж▓ржЯрж┐ ржкрзБржирж░рзБржжрзНржзрж╛рж░ ржХрж░рж╛ рж╣ржпрж╝, JSON ржерзЗржХрзЗ ржбрж┐ржХрзЛржб ржХрж░рж╛ рж╣ржпрж╝, ржПржмржВ `DisplayText` ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ `text` ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓рзЗ рж╕рзЗржЯ ржХрж░рж╛ рж╣ржпрж╝ред ржПржЗ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ рж╕рзНржкрж┐ржЪрзЗрж░ ржЯрзЗржХрзНрж╕ржЯ ржнрж╛рж░рзНрж╕ржиржЯрж┐ ржлрзЗрж░ржд ржжрзЗржпрж╝ред

    ржпржжрж┐ рж░рзЗрж╕ржкржирзНрж╕ ржХрзЛржб рзкрзжрзз рж╣ржпрж╝, рждрж╛рж╣рж▓рзЗ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЯрзЛржХрзЗржиржЯрж┐ ржорзЗржпрж╝рж╛ржжрзЛрждрзНрждрзАрж░рзНржг рж╣ржпрж╝рзЗржЫрзЗ (ржПржЗ ржЯрзЛржХрзЗржиржЧрзБрж▓рж┐ рж╢рзБржзрзБржорж╛рждрзНрж░ рззрзж ржорж┐ржирж┐ржЯрзЗрж░ ржЬржирзНржп ржмрзИржз ржерж╛ржХрзЗ)ред ржПржХржЯрж┐ ржирждрзБржи ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЯрзЛржХрзЗржи ржЕржирзБрж░рзЛржз ржХрж░рж╛ рж╣ржпрж╝, ржПржмржВ ржХрж▓ржЯрж┐ ржЖржмрж╛рж░ ржХрж░рж╛ рж╣ржпрж╝ред

    ржЕржирзНржпржерж╛ржпрж╝, ржПржХржЯрж┐ рждрзНрж░рзБржЯрж┐ рж╕рж┐рж░рж┐ржпрж╝рж╛рж▓ ржоржирж┐ржЯрж░рзЗ ржкрж╛ржарж╛ржирзЛ рж╣ржпрж╝, ржПржмржВ `text` ржлрж╛ржБржХрж╛ рж░рж╛ржЦрж╛ рж╣ржпрж╝ред

1. ржПржЗ ржорзЗржержбрзЗрж░ рж╢рзЗрж╖рзЗ HTTP ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ ржмржирзНржз ржХрж░рждрзЗ ржПржмржВ ржЯрзЗржХрзНрж╕ржЯ ржлрзЗрж░ржд ржжрж┐рждрзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    httpClient.end();

    return text;
    ```

1. `main.cpp`-ржП ржПржЗ ржирждрзБржи `convertSpeechToText` ржорзЗржержбржЯрж┐ `processAudio` ржлрж╛ржВрж╢ржирзЗ ржХрж▓ ржХрж░рзБржи, рждрж╛рж░ржкрж░ рж╕рзНржкрж┐ржЪржЯрж┐ рж╕рж┐рж░рж┐ржпрж╝рж╛рж▓ ржоржирж┐ржЯрж░рзЗ рж▓ржЧ ржХрж░рзБржи:

    ```cpp
    String text = speechToText.convertSpeechToText();
    Serial.println(text);
    ```

1. ржПржЗ ржХрзЛржбржЯрж┐ рждрзИрж░рж┐ ржХрж░рзБржи, ржПржЯрж┐ ржЖржкржирж╛рж░ Wio Terminal-ржП ржЖржкрж▓рзЛржб ржХрж░рзБржи ржПржмржВ рж╕рж┐рж░рж┐ржпрж╝рж╛рж▓ ржоржирж┐ржЯрж░рзЗрж░ ржорж╛ржзрзНржпржорзЗ ржПржЯрж┐ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржиред ржПржХржмрж╛рж░ ржЖржкржирж┐ рж╕рж┐рж░рж┐ржпрж╝рж╛рж▓ ржоржирж┐ржЯрж░рзЗ `Ready` ржжрзЗржЦрждрзЗ ржкрж╛ржи, C ржмрзЛрждрж╛ржоржЯрж┐ ржЪрж╛ржкрзБржи (ржмрж╛ржо ржжрж┐ржХрзЗ, ржкрж╛ржУржпрж╝рж╛рж░ рж╕рзБржЗржЪрзЗрж░ рж╕ржмржЪрзЗржпрж╝рзЗ ржХрж╛ржЫрж╛ржХрж╛ржЫрж┐), ржПржмржВ ржХржерж╛ ржмрж▓рзБржиред рзк рж╕рзЗржХрзЗржирзНржбрзЗрж░ ржЕржбрж┐ржУ ржХрзНржпрж╛ржкржЪрж╛рж░ ржХрж░рж╛ рж╣ржмрзЗ, рждрж╛рж░ржкрж░ ржЯрзЗржХрзНрж╕ржЯрзЗ рж░рзВржкрж╛ржирзНрждрж░рж┐ржд рж╣ржмрзЗред

    ```output
    --- Available filters and text transformations: colorize, debug, default, direct, hexlify, log2file, nocontrol, printable, send_on_enter, time
    --- More details at http://bit.ly/pio-monitor-filters
    --- Miniterm on /dev/cu.usbmodem1101  9600,8,N,1 ---
    --- Quit: Ctrl+C | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H ---
    Connecting to WiFi..
    Connected!
    Got access token.
    Ready.
    Starting recording...
    Finished recording
    Sending speech...
    Speech sent!
    {"RecognitionStatus":"Success","DisplayText":"Set a 2 minute and 27 second timer.","Offset":4700000,"Duration":35300000}
    Set a 2 minute and 27 second timer.
    ```

> ЁЯТБ ржЖржкржирж┐ ржПржЗ ржХрзЛржбржЯрж┐ [code-speech-to-text/wio-terminal](../../../../../6-consumer/lessons/1-speech-recognition/code-speech-to-text/wio-terminal) ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржЦрзБржБржЬрзЗ ржкрзЗрждрзЗ ржкрж╛рж░рзЗржиред

ЁЯША ржЖржкржирж╛рж░ рж╕рзНржкрж┐ржЪ ржЯрзБ ржЯрзЗржХрзНрж╕ржЯ ржкрзНрж░рзЛржЧрзНрж░рж╛ржо рж╕ржлрж▓ рж╣ржпрж╝рзЗржЫрзЗ!

---

**ржЕрж╕рзНржмрзАржХрзГрждрж┐**:  
ржПржЗ ржиржерж┐ржЯрж┐ AI ржЕржирзБржмрж╛ржж ржкрж░рж┐рж╖рзЗржмрж╛ [Co-op Translator](https://github.com/Azure/co-op-translator) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЕржирзБржмрж╛ржж ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред ржЖржорж░рж╛ ржпржерж╛рж╕ржорзНржнржм рж╕ржарж┐ржХрждрж╛рж░ ржЬржирзНржп ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рж┐, рждржмрзЗ ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржоржирзЗ рж░рж╛ржЦржмрзЗржи ржпрзЗ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ ржЕржирзБржмрж╛ржжрзЗ рждрзНрж░рзБржЯрж┐ ржмрж╛ ржЕрж╕ржЩрзНржЧрждрж┐ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗред ржорзВрж▓ ржнрж╛рж╖рж╛ржпрж╝ ржерж╛ржХрж╛ ржиржерж┐ржЯрж┐ржХрзЗ ржкрзНрж░рж╛ржорж╛ржгрж┐ржХ ржЙрзОрж╕ рж╣рж┐рж╕рзЗржмрзЗ ржмрж┐ржмрзЗржЪржирж╛ ржХрж░рж╛ ржЙржЪрж┐рждред ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг рждржерзНржпрзЗрж░ ржЬржирзНржп, ржкрзЗрж╢рж╛ржжрж╛рж░ ржорж╛ржиржм ржЕржирзБржмрж╛ржж рж╕рзБржкрж╛рж░рж┐рж╢ ржХрж░рж╛ рж╣ржпрж╝ред ржПржЗ ржЕржирзБржмрж╛ржж ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржлрж▓рзЗ ржХрзЛржирзЛ ржнрзБрж▓ ржмрзЛржЭрж╛ржмрзБржЭрж┐ ржмрж╛ ржнрзБрж▓ ржмрзНржпрж╛ржЦрзНржпрж╛ рж╣рж▓рзЗ ржЖржорж░рж╛ ржжрж╛ржпрж╝ржмржжрзНржз ржерж╛ржХржм ржирж╛ред