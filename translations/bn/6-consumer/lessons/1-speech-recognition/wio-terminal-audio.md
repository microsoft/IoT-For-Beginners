<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "2f336726b9410e97c3aaed76cc89b0d8",
  "translation_date": "2025-08-27T14:11:20+00:00",
  "source_file": "6-consumer/lessons/1-speech-recognition/wio-terminal-audio.md",
  "language_code": "bn"
}
-->
# ржЕржбрж┐ржУ ржзрж╛рж░ржг - Wio Terminal

ржПржЗ ржкрж╛ржарзЗрж░ ржПржЗ ржЕржВрж╢рзЗ, ржЖржкржирж┐ Wio Terminal-ржП ржЕржбрж┐ржУ ржзрж╛рж░ржг ржХрж░рж╛рж░ ржЬржирзНржп ржХрзЛржб рж▓рж┐ржЦржмрзЗржиред ржЕржбрж┐ржУ ржзрж╛рж░ржг Wio Terminal-ржПрж░ ржЙржкрж░рзЗрж░ ржПржХржЯрж┐ ржмрзЛрждрж╛ржорзЗрж░ ржорж╛ржзрзНржпржорзЗ ржирж┐ржпрж╝ржирзНрждрзНрж░рж┐ржд рж╣ржмрзЗред

## ржбрж┐ржнрж╛ржЗрж╕ржЯрж┐ ржЕржбрж┐ржУ ржзрж╛рж░ржгрзЗрж░ ржЬржирзНржп ржкрзНрж░рзЛржЧрзНрж░рж╛ржо ржХрж░рзБржи

ржЖржкржирж┐ ржорж╛ржЗржХрзНрж░рзЛржлрзЛржи ржерзЗржХрзЗ ржЕржбрж┐ржУ ржзрж╛рж░ржг ржХрж░рждрзЗ C++ ржХрзЛржб ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред Wio Terminal-ржП ржорж╛рждрзНрж░ рззрзпрзиKB RAM рж░ржпрж╝рзЗржЫрзЗ, ржпрж╛ ржХржпрж╝рзЗржХ рж╕рзЗржХрзЗржирзНржбрзЗрж░ ржмрзЗрж╢рж┐ ржЕржбрж┐ржУ ржзрж╛рж░ржг ржХрж░рж╛рж░ ржЬржирзНржп ржпржерзЗрж╖рзНржЯ ржиржпрж╝ред рждржмрзЗ ржПрждрзЗ рзкMB ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ рж░ржпрж╝рзЗржЫрзЗ, ржпрж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ, ржзрж╛рж░ржгржХрзГржд ржЕржбрж┐ржУ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рждрзЗ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рж╛рж░ ржЬржирзНржпред

ржмрж┐рж▓рзНржЯ-ржЗржи ржорж╛ржЗржХрзНрж░рзЛржлрзЛржи ржПржХржЯрж┐ ржЕрзНржпрж╛ржирж╛рж▓ржЧ рж╕рж┐ржЧржирзНржпрж╛рж▓ ржзрж╛рж░ржг ржХрж░рзЗ, ржпрж╛ ржбрж┐ржЬрж┐ржЯрж╛рж▓ рж╕рж┐ржЧржирзНржпрж╛рж▓-ржП рж░рзВржкрж╛ржирзНрждрж░рж┐ржд рж╣ржпрж╝ ржпрж╛ Wio Terminal ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗред ржЕржбрж┐ржУ ржзрж╛рж░ржг ржХрж░рж╛рж░ рж╕ржоржпрж╝, ржбрзЗржЯрж╛ рж╕ржарж┐ржХ рж╕ржоржпрж╝рзЗ ржзрж╛рж░ржг ржХрж░рждрзЗ рж╣ржмрзЗ - ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, рззрзмKHz-ржП ржЕржбрж┐ржУ ржзрж╛рж░ржг ржХрж░рждрзЗ рж╣рж▓рзЗ, ржкрзНрж░рждрж┐ рж╕рзЗржХрзЗржирзНржбрзЗ ржарж┐ржХ рззрзм,рзжрзжрзж ржмрж╛рж░ рж╕ржорж╛ржи ржмрзНржпржмржзрж╛ржирзЗ ржЕржбрж┐ржУ ржзрж╛рж░ржг ржХрж░рждрзЗ рж╣ржмрзЗред ржЖржкржирж╛рж░ ржХрзЛржб ржмрзНржпржмрж╣рж╛рж░ ржирж╛ ржХрж░рзЗ ржПржЯрж┐ ржХрж░рж╛рж░ ржЬржирзНржп, ржЖржкржирж┐ ржбрж╛ржЗрж░рзЗржХрзНржЯ ржорзЗржорзЛрж░рж┐ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХржирзНржЯрзНрж░рзЛрж▓рж╛рж░ (DMAC) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред ржПржЯрж┐ ржПржоржи ржПржХржЯрж┐ рж╕рж╛рж░рзНржХрж┐ржЯ ржпрж╛ ржкрзНрж░рж╕рзЗрж╕рж░рзЗ ржЖржкржирж╛рж░ ржХрзЛржбрзЗ ржмрж╛ржзрж╛ ржирж╛ ржжрж┐ржпрж╝рзЗ ржХрзЛржерж╛ржУ ржерзЗржХрзЗ рж╕рж┐ржЧржирзНржпрж╛рж▓ ржзрж╛рж░ржг ржХрж░рзЗ ржПржмржВ ржорзЗржорзЛрж░рж┐рждрзЗ рж▓рж┐ржЦрждрзЗ ржкрж╛рж░рзЗред

тЬЕ [ржбрж╛ржЗрж░рзЗржХрзНржЯ ржорзЗржорзЛрж░рж┐ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ рж╕ржорзНржкрж░рзНржХрж┐ржд ржЙржЗржХрж┐ржкрж┐ржбрж┐ржпрж╝рж╛ ржкрзГрж╖рзНржарж╛ржпрж╝](https://wikipedia.org/wiki/Direct_memory_access) ржЖрж░ржУ ржкржбрж╝рзБржиред

![ржорж╛ржЗржХрзНрж░рзЛржлрзЛржи ржерзЗржХрзЗ ржЕржбрж┐ржУ ADC-рждрзЗ ржпрж╛ржпрж╝, рждрж╛рж░ржкрж░ DMAC-ржПред ржПржЯрж┐ ржПржХржЯрж┐ ржмрж╛ржлрж╛рж░рзЗ рж▓рзЗржЦрзЗред ржпржЦржи ржПржЗ ржмрж╛ржлрж╛рж░ ржкрзВрж░рзНржг рж╣ржпрж╝, ржПржЯрж┐ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржг ржХрж░рж╛ рж╣ржпрж╝ ржПржмржВ DMAC ржжрзНржмрж┐рждрзАржпрж╝ ржмрж╛ржлрж╛рж░рзЗ рж▓рзЗржЦрзЗ](../../../../../translated_images/dmac-adc-buffers.4509aee49145c90bc2e1be472b8ed2ddfcb2b6a81ad3e559114aca55f5fff759.bn.png)

DMAC ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржмрзНржпржмржзрж╛ржирзЗ ADC ржерзЗржХрзЗ ржЕржбрж┐ржУ ржзрж╛рж░ржг ржХрж░рждрзЗ ржкрж╛рж░рзЗ, ржпрзЗржоржи рззрзмKHz ржЕржбрж┐ржУрж░ ржЬржирзНржп ржкрзНрж░рждрж┐ рж╕рзЗржХрзЗржирзНржбрзЗ рззрзм,рзжрзжрзж ржмрж╛рж░ред ржПржЯрж┐ ржзрж╛рж░ржгржХрзГржд ржбрзЗржЯрж╛ ржПржХржЯрж┐ ржкрзВрж░рзНржмржирж┐рж░рзНржзрж╛рж░рж┐ржд ржорзЗржорзЛрж░рж┐ ржмрж╛ржлрж╛рж░рзЗ рж▓рж┐ржЦрждрзЗ ржкрж╛рж░рзЗ, ржПржмржВ ржпржЦржи ржПржЯрж┐ ржкрзВрж░рзНржг рж╣ржпрж╝, рждржЦржи ржПржЯрж┐ ржЖржкржирж╛рж░ ржХрзЛржбрзЗ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржгрзЗрж░ ржЬржирзНржп ржЙржкрж▓ржмрзНржз ржХрж░рзЗред ржПржЗ ржорзЗржорзЛрж░рж┐ ржмрзНржпржмрж╣рж╛рж░ ржЕржбрж┐ржУ ржзрж╛рж░ржгрзЗ ржмрж┐рж▓ржорзНржм ржШржЯрж╛рждрзЗ ржкрж╛рж░рзЗ, рждржмрзЗ ржЖржкржирж┐ ржПржХрж╛ржзрж┐ржХ ржмрж╛ржлрж╛рж░ рж╕рзЗржЯ ржЖржк ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред DMAC ржмрж╛ржлрж╛рж░ рзз-ржП рж▓рзЗржЦрзЗ, рждрж╛рж░ржкрж░ ржпржЦржи ржПржЯрж┐ ржкрзВрж░рзНржг рж╣ржпрж╝, ржЖржкржирж╛рж░ ржХрзЛржбржХрзЗ ржмрж╛ржлрж╛рж░ рзз ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржг ржХрж░рждрзЗ ржЬрж╛ржирж╛ржпрж╝, ржПржмржВ DMAC ржмрж╛ржлрж╛рж░ рзи-ржП рж▓рзЗржЦрзЗред ржпржЦржи ржмрж╛ржлрж╛рж░ рзи ржкрзВрж░рзНржг рж╣ржпрж╝, ржПржЯрж┐ ржЖржкржирж╛рж░ ржХрзЛржбржХрзЗ ржЬрж╛ржирж╛ржпрж╝ ржПржмржВ ржЖржмрж╛рж░ ржмрж╛ржлрж╛рж░ рзз-ржП рж▓рзЗржЦрзЗред ржПржнрж╛ржмрзЗ, ржпрждржХрзНрж╖ржг ржЖржкржирж┐ ржкрзНрж░рждрж┐ржЯрж┐ ржмрж╛ржлрж╛рж░ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржг ржХрж░рждрзЗ ржмрж╛ржлрж╛рж░ ржкрзВрж░рзНржг рж╣ржУржпрж╝рж╛рж░ рж╕ржоржпрж╝рзЗрж░ ржЪрзЗржпрж╝рзЗ ржХржо рж╕ржоржпрж╝ ржирзЗржи, рждрждржХрзНрж╖ржг ржЖржкржирж┐ ржХрзЛржирзЛ ржбрзЗржЯрж╛ рж╣рж╛рж░рж╛ржмрзЗржи ржирж╛ред

ржкрзНрж░рждрж┐ржЯрж┐ ржмрж╛ржлрж╛рж░ ржзрж╛рж░ржг ржХрж░рж╛рж░ ржкрж░рзЗ, ржПржЯрж┐ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рждрзЗ рж▓рзЗржЦрж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ ржирж┐рж░рзНржзрж╛рж░рж┐ржд ржарж┐ржХрж╛ржирж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ рж▓рж┐ржЦрждрзЗ рж╣ржпрж╝, ржХрзЛржерж╛ржпрж╝ рж▓рж┐ржЦрждрзЗ рж╣ржмрзЗ ржПржмржВ ржХржд ржмржбрж╝ рж▓рж┐ржЦрждрзЗ рж╣ржмрзЗ рждрж╛ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж░рзЗ, ржпрж╛ ржорзЗржорзЛрж░рж┐рждрзЗ ржПржХржЯрж┐ ржмрж╛ржЗржЯрзЗрж░ ржЕрзНржпрж╛рж░рзЗ ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржорждрзЛред ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ ржЧрзНрж░рж╛ржирзБрж▓рж╛рж░рж┐ржЯрж┐ рж░ржпрж╝рзЗржЫрзЗ, ржпрж╛рж░ ржорж╛ржирзЗ ржорзБржЫрзЗ ржлрзЗрж▓рж╛ ржПржмржВ рж▓рзЗржЦрж╛рж░ ржЕржкрж╛рж░рзЗрж╢ржиржЧрзБрж▓рж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЖржХрж╛рж░рзЗрж░ рж╣рждрзЗ рж╣ржмрзЗ ржПржмржВ рж╕рзЗржЗ ржЖржХрж╛рж░рзЗрж░ рж╕рж╛ржерзЗ рж╕рж╛ржоржЮрзНржЬрж╕рзНржпржкрзВрж░рзНржг рж╣рждрзЗ рж╣ржмрзЗред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржпржжрж┐ ржЧрзНрж░рж╛ржирзБрж▓рж╛рж░рж┐ржЯрж┐ рзкрзжрзпрзм ржмрж╛ржЗржЯ рж╣ржпрж╝ ржПржмржВ ржЖржкржирж┐ ржарж┐ржХрж╛ржирж╛ рзкрзирзжрзж-ржП ржПржХржЯрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рж╛рж░ ржЕржирзБрж░рзЛржз ржХрж░рзЗржи, ржПржЯрж┐ ржарж┐ржХрж╛ржирж╛ рзкрзжрзпрзм ржерзЗржХрзЗ рзорззрзпрзи ржкрж░рзНржпржирзНржд рж╕ржорж╕рзНржд ржбрзЗржЯрж╛ ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗ ржкрж╛рж░рзЗред ржПрж░ ржорж╛ржирзЗ рж╣рж▓ ржпржЦржи ржЖржкржирж┐ ржЕржбрж┐ржУ ржбрзЗржЯрж╛ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рждрзЗ рж▓рж┐ржЦржмрзЗржи, ржПржЯрж┐ рж╕ржарж┐ржХ ржЖржХрж╛рж░рзЗрж░ ржЯрзБржХрж░рзЛрждрзЗ рж╣рждрзЗ рж╣ржмрзЗред

### ржХрж╛ржЬ - ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ ржХржиржлрж┐ржЧрж╛рж░ ржХрж░рзБржи

рзз. PlatformIO ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржХржЯрж┐ ржирждрзБржи Wio Terminal ржкрзНрж░ржХрж▓рзНржк рждрзИрж░рж┐ ржХрж░рзБржиред ржПржЗ ржкрзНрж░ржХрж▓рзНржкржЯрж┐рж░ ржирж╛ржо ржжрж┐ржи `smart-timer`ред `setup` ржлрж╛ржВрж╢ржирзЗ рж╕рж┐рж░рж┐ржпрж╝рж╛рж▓ ржкрзЛрж░рзНржЯ ржХржиржлрж┐ржЧрж╛рж░ ржХрж░рж╛рж░ ржЬржирзНржп ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржиред

рзз. ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рж╛рж░ ржЬржирзНржп `platformio.ini` ржлрж╛ржЗрж▓рзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржирж┐рж░рзНржнрж░рждрж╛ ржпрзЛржЧ ржХрж░рзБржи:

    ```ini
    lib_deps =
        seeed-studio/Seeed Arduino FS @ 2.1.1
        seeed-studio/Seeed Arduino SFUD @ 2.0.2
    ```

рзз. `main.cpp` ржлрж╛ржЗрж▓ржЯрж┐ ржЦрзБрж▓рзБржи ржПржмржВ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐рж░ ржЬржирзНржп рж╢рзАрж░рзНрж╖рзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржЗржиржХрзНрж▓рзБржб ржбрж┐рж░рзЗржХрзНржЯрж┐ржн ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    #include <sfud.h>
    #include <SPI.h>
    ```

    > ЁЯОУ SFUD ржПрж░ ржкрзВрж░рзНржгрж░рзВржк рж╣рж▓ Serial Flash Universal Driver, ржПржмржВ ржПржЯрж┐ ржПржоржи ржПржХржЯрж┐ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржпрж╛ рж╕ржорж╕рзНржд ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ ржЪрж┐ржкрзЗрж░ рж╕рж╛ржерзЗ ржХрж╛ржЬ ржХрж░рж╛рж░ ржЬржирзНржп ржбрж┐ржЬрж╛ржЗржи ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред

рзз. `setup` ржлрж╛ржВрж╢ржирзЗ, ржлрзНрж▓рзНржпрж╛рж╢ рж╕рзНржЯрзЛрж░рзЗржЬ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ рж╕рзЗржЯ ржЖржк ржХрж░рж╛рж░ ржЬржирзНржп ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    while (!(sfud_init() == SFUD_SUCCESS))
        ;

    sfud_qspi_fast_read_enable(sfud_get_device(SFUD_W25Q32_DEVICE_INDEX), 2);
    ```

    ржПржЯрж┐ SFUD рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬ ржирж╛ рж╣ржУржпрж╝рж╛ ржкрж░рзНржпржирзНржд рж▓рзБржк ржХрж░рзЗ, рждрж╛рж░ржкрж░ ржжрзНрж░рзБржд ржкржбрж╝рж╛рж░ ржлрж╛ржВрж╢ржи ржЪрж╛рж▓рзБ ржХрж░рзЗред ржмрж┐рж▓рзНржЯ-ржЗржи ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ Queued Serial Peripheral Interface (QSPI) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ, ржпрж╛ ржПржХржЯрж┐ ржзрж░ржирзЗрж░ SPI ржХржирзНржЯрзНрж░рзЛрж▓рж╛рж░ ржпрж╛ ржкрзНрж░рж╕рзЗрж╕рж░рзЗрж░ ржХржо ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржХржЯрж┐ ржХрж┐ржЙ-ржПрж░ ржорж╛ржзрзНржпржорзЗ ржХрзНрж░ржорж╛ржЧржд ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕рзЗрж░ ржЕржирзБржорждрж┐ ржжрзЗржпрж╝ред ржПржЯрж┐ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ ржкржбрж╝рж╛ ржПржмржВ рж▓рзЗржЦрж╛рж░ ржЧрждрж┐ ржмрж╛ржбрж╝рж╛ржпрж╝ред

рзз. `src` ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржПржХржЯрж┐ ржирждрзБржи ржлрж╛ржЗрж▓ рждрзИрж░рж┐ ржХрж░рзБржи ржпрж╛рж░ ржирж╛ржо ржжрж┐ржи `flash_writer.h`ред

рзз. ржПржЗ ржлрж╛ржЗрж▓рзЗрж░ рж╢рзАрж░рзНрж╖рзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    #pragma once

    #include <Arduino.h>
    #include <sfud.h>
    ```

    ржПржЯрж┐ ржХрж┐ржЫрзБ ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржХрж░рзЗ, ржпрж╛рж░ ржоржзрзНржпрзЗ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ ржЗржирзНржЯрж╛рж░ржЕрзНржпрж╛ржХрзНржЯ ржХрж░рж╛рж░ ржЬржирзНржп SFUD рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐рж░ рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓ рж░ржпрж╝рзЗржЫрзЗред

рзз. ржПржЗ ржирждрзБржи рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓рзЗ `FlashWriter` ржирж╛ржорзЗ ржПржХржЯрж┐ ржХрзНрж▓рж╛рж╕ рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рзБржи:

    ```cpp
    class FlashWriter
    {
    public:
    
    private:
    };
    ```

рзз. `private` рж╕рзЗржХрж╢ржирзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    byte *_sfudBuffer;
    size_t _sfudBufferSize;
    size_t _sfudBufferPos;
    size_t _sfudBufferWritePos;

    const sfud_flash *_flash;
    ```

    ржПржЯрж┐ ржбрзЗржЯрж╛ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рждрзЗ рж▓рзЗржЦрж╛рж░ ржЖржЧрзЗ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд ржмрж╛ржлрж╛рж░рзЗрж░ ржЬржирзНржп ржХрж┐ржЫрзБ ржлрж┐рж▓рзНржб рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рзЗред `_sfudBuffer` ржирж╛ржорзЗ ржПржХржЯрж┐ ржмрж╛ржЗржЯ ржЕрзНржпрж╛рж░рзЗ рж░ржпрж╝рзЗржЫрзЗ ржпрзЗржЦрж╛ржирзЗ ржбрзЗржЯрж╛ рж▓рзЗржЦрж╛ рж╣ржпрж╝, ржПржмржВ ржпржЦржи ржПржЯрж┐ ржкрзВрж░рзНржг рж╣ржпрж╝, ржбрзЗржЯрж╛ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рждрзЗ рж▓рзЗржЦрж╛ рж╣ржпрж╝ред `_sfudBufferPos` ржлрж┐рж▓рзНржбржЯрж┐ ржПржЗ ржмрж╛ржлрж╛рж░рзЗ рж▓рзЗржЦрж╛рж░ ржмрж░рзНрждржорж╛ржи ржЕржмрж╕рзНржерж╛ржи рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзЗ, ржПржмржВ `_sfudBufferWritePos` ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рждрзЗ рж▓рзЗржЦрж╛рж░ ржЕржмрж╕рзНржерж╛ржи рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзЗред `_flash` рж╣рж▓ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ рж▓рзЗржЦрж╛рж░ ржЬржирзНржп ржПржХржЯрж┐ ржкржпрж╝рзЗржирзНржЯрж╛рж░ - ржХрж┐ржЫрзБ ржорж╛ржЗржХрзНрж░рзЛржХржирзНржЯрзНрж░рзЛрж▓рж╛рж░рзЗ ржПржХрж╛ржзрж┐ржХ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ ржЪрж┐ржк ржерж╛ржХрзЗред

рзз. ржПржЗ ржХрзНрж▓рж╛рж╕рзЗрж░ `public` рж╕рзЗржХрж╢ржирзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржорзЗржержб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    void init()
    {
        _flash = sfud_get_device_table() + 0;
        _sfudBufferSize = _flash->chip.erase_gran;
        _sfudBuffer = new byte[_sfudBufferSize];
        _sfudBufferPos = 0;
        _sfudBufferWritePos = 0;
    }
    ```

    ржПржЯрж┐ Wio Terminal-ржП ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ рж▓рзЗржЦрж╛рж░ ржЬржирзНржп ржХржиржлрж┐ржЧрж╛рж░ ржХрж░рзЗ ржПржмржВ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рж░ ржЧрзНрж░рзЗржи рж╕рж╛ржЗржЬрзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржмрж╛ржлрж╛рж░ рж╕рзЗржЯ ржЖржк ржХрж░рзЗред ржПржЯрж┐ ржПржХржЯрж┐ `init` ржорзЗржержбрзЗ рж░ржпрж╝рзЗржЫрзЗ, ржХрж╛рж░ржг ржПржЯрж┐ `setup` ржлрж╛ржВрж╢ржирзЗ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ рж╕рзЗржЯ ржЖржк ржХрж░рж╛рж░ ржкрж░рзЗ ржХрж▓ ржХрж░рждрзЗ рж╣ржмрзЗред

рзз. `public` рж╕рзЗржХрж╢ржирзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    void writeSfudBuffer(byte b)
    {
        _sfudBuffer[_sfudBufferPos++] = b;
        if (_sfudBufferPos == _sfudBufferSize)
        {
            sfud_erase_write(_flash, _sfudBufferWritePos, _sfudBufferSize, _sfudBuffer);
            _sfudBufferWritePos += _sfudBufferSize;
            _sfudBufferPos = 0;
        }
    }

    void writeSfudBuffer(byte *b, size_t len)
    {
        for (size_t i = 0; i < len; ++i)
        {
            writeSfudBuffer(b[i]);
        }
    }

    void flushSfudBuffer()
    {
        if (_sfudBufferPos > 0)
        {
            sfud_erase_write(_flash, _sfudBufferWritePos, _sfudBufferSize, _sfudBuffer);
            _sfudBufferWritePos += _sfudBufferSize;
            _sfudBufferPos = 0;
        }
    }
    ```

    ржПржЗ ржХрзЛржбржЯрж┐ ржлрзНрж▓рзНржпрж╛рж╢ рж╕рзНржЯрзЛрж░рзЗржЬ рж╕рж┐рж╕рзНржЯрзЗржорзЗ ржмрж╛ржЗржЯ рж▓рзЗржЦрж╛рж░ ржорзЗржержб рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рзЗред ржПржЯрж┐ ржПржХржЯрж┐ ржЗржи-ржорзЗржорзЛрж░рж┐ ржмрж╛ржлрж╛рж░рзЗ рж▓рзЗржЦрж╛рж░ ржорж╛ржзрзНржпржорзЗ ржХрж╛ржЬ ржХрж░рзЗ ржпрж╛ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рж░ рж╕ржарж┐ржХ ржЖржХрж╛рж░рзЗрж░ ржЬржирзНржп ржЙржкржпрзБржХрзНржд, ржПржмржВ ржпржЦржи ржПржЯрж┐ ржкрзВрж░рзНржг рж╣ржпрж╝, ржПржЯрж┐ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рждрзЗ рж▓рзЗржЦрж╛ рж╣ржпрж╝, рж╕рзЗржЗ ржЕржмрж╕рзНржерж╛ржирзЗ ржмрж┐ржжрзНржпржорж╛ржи ржбрзЗржЯрж╛ ржорзБржЫрзЗ ржлрзЗрж▓рзЗред ржПржЫрж╛ржбрж╝рж╛ржУ ржПржХржЯрж┐ `flushSfudBuffer` рж░ржпрж╝рзЗржЫрзЗ ржпрж╛ ржЕрж╕ржорзНржкрзВрж░рзНржг ржмрж╛ржлрж╛рж░ рж▓рзЗржЦрж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣ржпрж╝, ржХрж╛рж░ржг ржзрж╛рж░ржгржХрзГржд ржбрзЗржЯрж╛ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рж░ ржЧрзНрж░рзЗржи рж╕рж╛ржЗржЬрзЗрж░ рж╕ржарж┐ржХ ржЧрзБржгрж┐рждржХ ржирж╛ржУ рж╣рждрзЗ ржкрж╛рж░рзЗ, рждрж╛ржЗ ржбрзЗржЯрж╛рж░ рж╢рзЗрж╖ ржЕржВрж╢ржЯрж┐ рж▓рж┐ржЦрждрзЗ рж╣ржмрзЗред

    > ЁЯТБ ржбрзЗржЯрж╛рж░ рж╢рзЗрж╖ ржЕржВрж╢ржЯрж┐ ржЕрждрж┐рж░рж┐ржХрзНржд ржЕржмрж╛ржЮрзНржЫрж┐ржд ржбрзЗржЯрж╛ рж▓рж┐ржЦржмрзЗ, рждржмрзЗ ржПржЯрж┐ ржарж┐ржХ ржЖржЫрзЗ ржХрж╛рж░ржг рж╢рзБржзрзБржорж╛рждрзНрж░ ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржбрзЗржЯрж╛ржЗ ржкржбрж╝рж╛ рж╣ржмрзЗред

### ржХрж╛ржЬ - ржЕржбрж┐ржУ ржзрж╛рж░ржг рж╕рзЗржЯ ржЖржк ржХрж░рзБржи

рзз. `src` ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржПржХржЯрж┐ ржирждрзБржи ржлрж╛ржЗрж▓ рждрзИрж░рж┐ ржХрж░рзБржи ржпрж╛рж░ ржирж╛ржо ржжрж┐ржи `config.h`ред

рзз. ржПржЗ ржлрж╛ржЗрж▓рзЗрж░ рж╢рзАрж░рзНрж╖рзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    #pragma once

    #define RATE 16000
    #define SAMPLE_LENGTH_SECONDS 4
    #define SAMPLES RATE * SAMPLE_LENGTH_SECONDS
    #define BUFFER_SIZE (SAMPLES * 2) + 44
    #define ADC_BUF_LEN 1600
    ```

    ржПржЗ ржХрзЛржбржЯрж┐ ржЕржбрж┐ржУ ржзрж╛рж░ржгрзЗрж░ ржЬржирзНржп ржХрж┐ржЫрзБ ржХржирж╕рзНржЯрзНржпрж╛ржирзНржЯ рж╕рзЗржЯ ржЖржк ржХрж░рзЗред

    | ржХржирж╕рзНржЯрзНржпрж╛ржирзНржЯ              | ржорж╛ржи    | ржмрж┐ржмрж░ржг |
    | --------------------- | -----: | - |
    | RATE                  | рззрзмрзжрзжрзж  | ржЕржбрж┐ржУрж░ рж╕рзНржпрж╛ржорзНржкрж▓ рж░рзЗржЯред рззрзм,рзжрзжрзж ржорж╛ржирзЗ рззрзмKHz |
    | SAMPLE_LENGTH_SECONDS | рзк      | ржзрж╛рж░ржг ржХрж░рж╛рж░ ржЕржбрж┐ржУрж░ ржжрзИрж░рзНржШрзНржпред ржПржЯрж┐ рзк рж╕рзЗржХрзЗржирзНржбрзЗ рж╕рзЗржЯ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред ржжрзАрж░рзНржШ ржЕржбрж┐ржУ рж░рзЗржХрж░рзНржб ржХрж░рждрзЗ ржЪрж╛ржЗрж▓рзЗ ржПржЯрж┐ ржмрж╛ржбрж╝рж╛ржиред |
    | SAMPLES               | рзмрзкрзжрзжрзж  | ржзрж╛рж░ржгржХрзГржд ржЕржбрж┐ржУ рж╕рзНржпрж╛ржорзНржкрж▓рзЗрж░ ржорзЛржЯ рж╕ржВржЦрзНржпрж╛ред рж╕рзНржпрж╛ржорзНржкрж▓ рж░рзЗржЯ * рж╕рзЗржХрзЗржирзНржбрзЗрж░ рж╕ржВржЦрзНржпрж╛ |
    | BUFFER_SIZE           | рззрзирзорзжрзкрзк | ржЕржбрж┐ржУ ржзрж╛рж░ржгрзЗрж░ ржЬржирзНржп ржмрж╛ржлрж╛рж░рзЗрж░ ржЖржХрж╛рж░ред ржЕржбрж┐ржУ ржПржХржЯрж┐ WAV ржлрж╛ржЗрж▓ рж╣рж┐рж╕рж╛ржмрзЗ ржзрж╛рж░ржг ржХрж░рж╛ рж╣ржмрзЗ, ржпрж╛ рзкрзк ржмрж╛ржЗржЯрзЗрж░ рж╣рзЗржбрж╛рж░, рждрж╛рж░ржкрж░ рззрзирзо,рзжрзжрзж ржмрж╛ржЗржЯрзЗрж░ ржЕржбрж┐ржУ ржбрзЗржЯрж╛ (ржкрзНрж░рждрж┐ржЯрж┐ рж╕рзНржпрж╛ржорзНржкрж▓ рзи ржмрж╛ржЗржЯ) |
    | ADC_BUF_LEN           | рззрзмрзжрзж   | DMAC ржерзЗржХрзЗ ржЕржбрж┐ржУ ржзрж╛рж░ржгрзЗрж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд ржмрж╛ржлрж╛рж░рзЗрж░ ржЖржХрж╛рж░ |

    > ЁЯТБ ржпржжрж┐ ржЖржкржирж┐ ржоржирзЗ ржХрж░рзЗржи рзк рж╕рзЗржХрзЗржирзНржб ржЯрж╛ржЗржорж╛рж░ ржЕржирзБрж░рзЛржз ржХрж░рж╛рж░ ржЬржирзНржп ржЦрзБржм ржХржо, рждржмрзЗ ржЖржкржирж┐ `SAMPLE_LENGTH_SECONDS` ржорж╛ржи ржмрж╛ржбрж╝рж╛рждрзЗ ржкрж╛рж░рзЗржи, ржПржмржВ ржЕржирзНржпрж╛ржирзНржп ржорж╛ржиржЧрзБрж▓рж┐ ржкрзБржирж░рж╛ржпрж╝ ржЧржгржирж╛ рж╣ржмрзЗред

рзз. `src` ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржПржХржЯрж┐ ржирждрзБржи ржлрж╛ржЗрж▓ рждрзИрж░рж┐ ржХрж░рзБржи ржпрж╛рж░ ржирж╛ржо ржжрж┐ржи `mic.h`ред

рзз. ржПржЗ ржлрж╛ржЗрж▓рзЗрж░ рж╢рзАрж░рзНрж╖рзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    #pragma once

    #include <Arduino.h>

    #include "config.h"
    #include "flash_writer.h"
    ```

    ржПржЯрж┐ ржХрж┐ржЫрзБ ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржХрж░рзЗ, ржпрж╛рж░ ржоржзрзНржпрзЗ `config.h` ржПржмржВ `FlashWriter` рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓ рж░ржпрж╝рзЗржЫрзЗред

рзз. ржПржХржЯрж┐ `Mic` ржХрзНрж▓рж╛рж╕ рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рждрзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржпрзЛржЧ ржХрж░рзБржи ржпрж╛ ржорж╛ржЗржХрзНрж░рзЛржлрзЛржи ржерзЗржХрзЗ ржзрж╛рж░ржг ржХрж░рждрзЗ ржкрж╛рж░рзЗ:

    ```cpp
    class Mic
    {
    public:
        Mic()
        {
            _isRecording = false;
            _isRecordingReady = false;
        }
    
        void startRecording()
        {
            _isRecording = true;
            _isRecordingReady = false;
        }
    
        bool isRecording()
        {
            return _isRecording;
        }
    
        bool isRecordingReady()
        {
            return _isRecordingReady;
        }
    
    private:
        volatile bool _isRecording;
        volatile bool _isRecordingReady;
        FlashWriter _writer;
    };
    
    Mic mic;
    ```

    ржПржЗ ржХрзНрж▓рж╛рж╕рзЗ ржмрж░рзНрждржорж╛ржирзЗ ржХржпрж╝рзЗржХржЯрж┐ ржлрж┐рж▓рзНржб рж░ржпрж╝рзЗржЫрзЗ ржпрж╛ рж░рзЗржХрж░рзНржбрж┐ржВ рж╢рзБрж░рзБ рж╣ржпрж╝рзЗржЫрзЗ ржХрж┐ржирж╛ ржПржмржВ ржПржХржЯрж┐ рж░рзЗржХрж░рзНржбрж┐ржВ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржЬржирзНржп ржкрзНрж░рж╕рзНрждрзБржд ржХрж┐ржирж╛ рждрж╛ ржЯрзНрж░рзНржпрж╛ржХ ржХрж░рзЗред DMAC рж╕рзЗржЯ ржЖржк рж╣рж▓рзЗ, ржПржЯрж┐ ржХрзНрж░ржорж╛ржЧржд ржорзЗржорзЛрж░рж┐ ржмрж╛ржлрж╛рж░рзЗ рж▓рзЗржЦрзЗ, рждрж╛ржЗ `_isRecording` ржлрзНрж▓рзНржпрж╛ржЧржЯрж┐ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗ ржпрзЗ ржПржЧрзБрж▓рж┐ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржг ржХрж░рж╛ ржЙржЪрж┐ржд ржХрж┐ржирж╛ред `_isRecordingReady` ржлрзНрж▓рзНржпрж╛ржЧржЯрж┐ рж╕рзЗржЯ рж╣ржмрзЗ ржпржЦржи ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ рзк рж╕рзЗржХрзЗржирзНржбрзЗрж░ ржЕржбрж┐ржУ ржзрж╛рж░ржг ржХрж░рж╛ рж╣ржмрзЗред `_writer` ржлрж┐рж▓рзНржбржЯрж┐ ржЕржбрж┐ржУ ржбрзЗржЯрж╛ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рждрзЗ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣ржпрж╝ред

    ржПржХржЯрж┐ ржЧрзНрж▓рзЛржмрж╛рж▓ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ рждрж╛рж░ржкрж░ `Mic` ржХрзНрж▓рж╛рж╕рзЗрж░ ржПржХржЯрж┐ ржЗржирж╕рзНржЯрзНржпрж╛ржирзНрж╕рзЗрж░ ржЬржирзНржп ржШрзЛрж╖ржгрж╛ ржХрж░рж╛ рж╣ржпрж╝ред

рзз. `Mic` ржХрзНрж▓рж╛рж╕рзЗрж░ `private` рж╕рзЗржХрж╢ржирзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    typedef struct
    {
        uint16_t btctrl;
        uint16_t btcnt;
        uint32_t srcaddr;
        uint32_t dstaddr;
        uint32_t descaddr;
    } dmacdescriptor;

    // Globals - DMA and ADC
    volatile dmacdescriptor _wrb[DMAC_CH_NUM] __attribute__((aligned(16)));
    dmacdescriptor _descriptor_section[DMAC_CH_NUM] __attribute__((aligned(16)));
    dmacdescriptor _descriptor __attribute__((aligned(16)));

    void configureDmaAdc()
    {
        // Configure DMA to sample from ADC at a regular interval (triggered by timer/counter)
        DMAC->BASEADDR.reg = (uint32_t)_descriptor_section;                    // Specify the location of the descriptors
        DMAC->WRBADDR.reg = (uint32_t)_wrb;                                    // Specify the location of the write back descriptors
        DMAC->CTRL.reg = DMAC_CTRL_DMAENABLE | DMAC_CTRL_LVLEN(0xf);           // Enable the DMAC peripheral
        DMAC->Channel[1].CHCTRLA.reg = DMAC_CHCTRLA_TRIGSRC(TC5_DMAC_ID_OVF) | // Set DMAC to trigger on TC5 timer overflow
                                        DMAC_CHCTRLA_TRIGACT_BURST;             // DMAC burst transfer

        _descriptor.descaddr = (uint32_t)&_descriptor_section[1];                    // Set up a circular descriptor
        _descriptor.srcaddr = (uint32_t)&ADC1->RESULT.reg;                           // Take the result from the ADC0 RESULT register
        _descriptor.dstaddr = (uint32_t)_adc_buf_0 + sizeof(uint16_t) * ADC_BUF_LEN; // Place it in the adc_buf_0 array
        _descriptor.btcnt = ADC_BUF_LEN;                                             // Beat count
        _descriptor.btctrl = DMAC_BTCTRL_BEATSIZE_HWORD |                            // Beat size is HWORD (16-bits)
                                DMAC_BTCTRL_DSTINC |                                    // Increment the destination address
                                DMAC_BTCTRL_VALID |                                     // Descriptor is valid
                                DMAC_BTCTRL_BLOCKACT_SUSPEND;                           // Suspend DMAC channel 0 after block transfer
        memcpy(&_descriptor_section[0], &_descriptor, sizeof(_descriptor));          // Copy the descriptor to the descriptor section

        _descriptor.descaddr = (uint32_t)&_descriptor_section[0];                    // Set up a circular descriptor
        _descriptor.srcaddr = (uint32_t)&ADC1->RESULT.reg;                           // Take the result from the ADC0 RESULT register
        _descriptor.dstaddr = (uint32_t)_adc_buf_1 + sizeof(uint16_t) * ADC_BUF_LEN; // Place it in the adc_buf_1 array
        _descriptor.btcnt = ADC_BUF_LEN;                                             // Beat count
        _descriptor.btctrl = DMAC_BTCTRL_BEATSIZE_HWORD |                            // Beat size is HWORD (16-bits)
                                DMAC_BTCTRL_DSTINC |                                    // Increment the destination address
                                DMAC_BTCTRL_VALID |                                     // Descriptor is valid
                                DMAC_BTCTRL_BLOCKACT_SUSPEND;                           // Suspend DMAC channel 0 after block transfer
        memcpy(&_descriptor_section[1], &_descriptor, sizeof(_descriptor));          // Copy the descriptor to the descriptor section

        // Configure NVIC
        NVIC_SetPriority(DMAC_1_IRQn, 0); // Set the Nested Vector Interrupt Controller (NVIC) priority for DMAC1 to 0 (highest)
        NVIC_EnableIRQ(DMAC_1_IRQn);      // Connect DMAC1 to Nested Vector Interrupt Controller (NVIC)

        // Activate the suspend (SUSP) interrupt on DMAC channel 1
        DMAC->Channel[1].CHINTENSET.reg = DMAC_CHINTENSET_SUSP;

        // Configure ADC
        ADC1->INPUTCTRL.bit.MUXPOS = ADC_INPUTCTRL_MUXPOS_AIN12_Val; // Set the analog input to ADC0/AIN2 (PB08 - A4 on Metro M4)
        while (ADC1->SYNCBUSY.bit.INPUTCTRL)
            ;                              // Wait for synchronization
        ADC1->SAMPCTRL.bit.SAMPLEN = 0x00; // Set max Sampling Time Length to half divided ADC clock pulse (2.66us)
        while (ADC1->SYNCBUSY.bit.SAMPCTRL)
            ;                                         // Wait for synchronization
        ADC1->CTRLA.reg = ADC_CTRLA_PRESCALER_DIV128; // Divide Clock ADC GCLK by 128 (48MHz/128 = 375kHz)
        ADC1->CTRLB.reg = ADC_CTRLB_RESSEL_12BIT |    // Set ADC resolution to 12 bits
                            ADC_CTRLB_FREERUN;          // Set ADC to free run mode
        while (ADC1->SYNCBUSY.bit.CTRLB)
            ;                       // Wait for synchronization
        ADC1->CTRLA.bit.ENABLE = 1; // Enable the ADC
        while (ADC1->SYNCBUSY.bit.ENABLE)
            ;                       // Wait for synchronization
        ADC1->SWTRIG.bit.START = 1; // Initiate a software trigger to start an ADC conversion
        while (ADC1->SYNCBUSY.bit.SWTRIG)
            ; // Wait for synchronization

        // Enable DMA channel 1
        DMAC->Channel[1].CHCTRLA.bit.ENABLE = 1;

        // Configure Timer/Counter 5
        GCLK->PCHCTRL[TC5_GCLK_ID].reg = GCLK_PCHCTRL_CHEN |     // Enable peripheral channel for TC5
                                            GCLK_PCHCTRL_GEN_GCLK1; // Connect generic clock 0 at 48MHz

        TC5->COUNT16.WAVE.reg = TC_WAVE_WAVEGEN_MFRQ; // Set TC5 to Match Frequency (MFRQ) mode
        TC5->COUNT16.CC[0].reg = 3000 - 1;            // Set the trigger to 16 kHz: (4Mhz / 16000) - 1
        while (TC5->COUNT16.SYNCBUSY.bit.CC0)
            ; // Wait for synchronization

        // Start Timer/Counter 5
        TC5->COUNT16.CTRLA.bit.ENABLE = 1; // Enable the TC5 timer
        while (TC5->COUNT16.SYNCBUSY.bit.ENABLE)
            ; // Wait for synchronization
    }

    uint16_t _adc_buf_0[ADC_BUF_LEN];
    uint16_t _adc_buf_1[ADC_BUF_LEN];
    ```

    ржПржЗ ржХрзЛржбржЯрж┐ ржПржХржЯрж┐ `configureDmaAdc` ржорзЗржержб рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рзЗ ржпрж╛ DMAC ржХржиржлрж┐ржЧрж╛рж░ ржХрж░рзЗ, ржПржЯрж┐ржХрзЗ ADC-ржПрж░ рж╕рж╛ржерзЗ рж╕ржВржпрзБржХрзНржд ржХрж░рзЗ ржПржмржВ ржПржЯрж┐ ржжрзБржЯрж┐ ржнрж┐ржирзНржи ржмрж┐ржХрж▓рзНржк ржмрж╛ржлрж╛рж░ `_adc_buf_0` ржПржмржВ `_adc_buf_1` ржкрзВрж░ржг ржХрж░рждрзЗ рж╕рзЗржЯ ржХрж░рзЗред

    > ЁЯТБ ржорж╛ржЗржХрзНрж░рзЛржХржирзНржЯрзНрж░рзЛрж▓рж╛рж░ ржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯрзЗрж░ ржПржХржЯрж┐ ржЕрж╕рзБржмрж┐ржзрж╛ рж╣рж▓ рж╣рж╛рж░рзНржбржУржпрж╝рзНржпрж╛рж░рзЗрж░ рж╕рж╛ржерзЗ ржЗржирзНржЯрж╛рж░ржЕрзНржпрж╛ржХрзНржЯ ржХрж░рж╛рж░ ржЬржирзНржп ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржХрзЛржбрзЗрж░ ржЬржЯрж┐рж▓рждрж╛, ржХрж╛рж░ржг ржЖржкржирж╛рж░ ржХрзЛржб ржЦрзБржм ржирж┐ржорзНржи рж╕рзНрждрж░рзЗ рж╣рж╛рж░рзНржбржУржпрж╝рзНржпрж╛рж░рзЗрж░ рж╕рж╛ржерзЗ рж╕рж░рж╛рж╕рж░рж┐ ржЗржирзНржЯрж╛рж░ржЕрзНржпрж╛ржХрзНржЯ ржХрж░рзЗред ржПржЗ ржХрзЛржбржЯрж┐ ржПржХржЯрж┐ рж╕рж┐ржЩрзНржЧрзЗрж▓-ржмрзЛрж░рзНржб ржХржорзНржкрж┐ржЙржЯрж╛рж░ ржмрж╛ ржбрзЗрж╕рзНржХржЯржк ржХржорзНржкрж┐ржЙржЯрж╛рж░рзЗрж░ ржЬржирзНржп ржЖржкржирж┐ ржпрж╛ рж▓рж┐ржЦржмрзЗржи рждрж╛рж░ ржЪрзЗржпрж╝рзЗ ржмрзЗрж╢рж┐ ржЬржЯрж┐рж▓ ржХрж╛рж░ржг ржПржЦрж╛ржирзЗ ржХрзЛржирзЛ ржЕржкрж╛рж░рзЗржЯрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржо рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рждрзЗ ржирзЗржЗред ржХрж┐ржЫрзБ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржЙржкрж▓ржмрзНржз рж░ржпрж╝рзЗржЫрзЗ ржпрж╛ ржПржЯрж┐ рж╕рж╣ржЬ ржХрж░рждрзЗ ржкрж╛рж░рзЗ, рждржмрзЗ ржПржЦржиржУ ржЕржирзЗржХ ржЬржЯрж┐рж▓рждрж╛ рж░ржпрж╝рзЗржЫрзЗред

рзз. ржПрж░ ржирж┐ржЪрзЗ, ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    // WAV files have a header. This struct defines that header
    struct wavFileHeader
    {
        char riff[4];         /* "RIFF"                                  */
        long flength;         /* file length in bytes                    */
        char wave[4];         /* "WAVE"                                  */
        char fmt[4];          /* "fmt "                                  */
        long chunk_size;      /* size of FMT chunk in bytes (usually 16) */
        short format_tag;     /* 1=PCM, 257=Mu-Law, 258=A-Law, 259=ADPCM */
        short num_chans;      /* 1=mono, 2=stereo                        */
        long srate;           /* Sampling rate in samples per second     */
        long bytes_per_sec;   /* bytes per second = srate*bytes_per_samp */
        short bytes_per_samp; /* 2=16-bit mono, 4=16-bit stereo          */
        short bits_per_samp;  /* Number of bits per sample               */
        char data[4];         /* "data"                                  */
        long dlength;         /* data length in bytes (filelength - 44)  */
    };

    void initBufferHeader()
    {
        wavFileHeader wavh;

        strncpy(wavh.riff, "RIFF", 4);
        strncpy(wavh.wave, "WAVE", 4);
        strncpy(wavh.fmt, "fmt ", 4);
        strncpy(wavh.data, "data", 4);

        wavh.chunk_size = 16;
        wavh.format_tag = 1; // PCM
        wavh.num_chans = 1;  // mono
        wavh.srate = RATE;
        wavh.bytes_per_sec = (RATE * 1 * 16 * 1) / 8;
        wavh.bytes_per_samp = 2;
        wavh.bits_per_samp = 16;
        wavh.dlength = RATE * 2 * 1 * 16 / 2;
        wavh.flength = wavh.dlength + 44;

        _writer.writeSfudBuffer((byte *)&wavh, 44);
    }
    ```

    ржПржЗ ржХрзЛржбржЯрж┐ WAV рж╣рзЗржбрж╛рж░ржХрзЗ ржПржХржЯрж┐ рж╕рзНржЯрзНрж░рж╛ржХрзНржЯ рж╣рж┐рж╕рж╛ржмрзЗ рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рзЗ ржпрж╛ рзкрзк ржмрж╛ржЗржЯ ржорзЗржорзЛрж░рж┐ ржирзЗржпрж╝ред ржПржЯрж┐ ржЕржбрж┐ржУ ржлрж╛ржЗрж▓рзЗрж░ рж░рзЗржЯ, ржЖржХрж╛рж░ ржПржмржВ ржЪрзНржпрж╛ржирзЗрж▓рзЗрж░ рж╕ржВржЦрзНржпрж╛ рж╕ржорзНржкрж░рзНржХрзЗ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд рж▓рж┐ржЦрзЗред ржПржЗ рж╣рзЗржбрж╛рж░ржЯрж┐ рждрж╛рж░ржкрж░ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рждрзЗ рж▓рзЗржЦрж╛ рж╣ржпрж╝ред

рзз. ржПржЗ ржХрзЛржбрзЗрж░ ржирж┐ржЪрзЗ, ржЕржбрж┐ржУ ржмрж╛ржлрж╛рж░ ржкрзНрж░рж╕рзНрждрзБржд рж╣рж▓рзЗ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржгрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ ржорзЗржержб ржШрзЛрж╖ржгрж╛ ржХрж░рждрзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    void audioCallback(uint16_t *buf, uint32_t buf_len)
    {
        static uint32_t idx = 44;

        if (_isRecording)
        {
            for (uint32_t i = 0; i < buf_len; i++)
            {
                int16_t audio_value = ((int16_t)buf[i] - 2048) * 16;

                _writer.writeSfudBuffer(audio_value & 0xFF);
                _writer.writeSfudBuffer((audio_value >> 8) & 0xFF);
            }

            idx += buf_len;
                
            if (idx >= BUFFER_SIZE)
            {
                _writer.flushSfudBuffer();
                idx = 44;
                _isRecording = false;
                _isRecordingReady = true;
            }
        }
    }
    ```

    ржЕржбрж┐ржУ ржмрж╛ржлрж╛рж░ржЧрзБрж▓рж┐ рззрзм-ржмрж┐ржЯ ржкрзВрж░рзНржгрж╕ржВржЦрзНржпрж╛рж░ ржЕрзНржпрж╛рж░рзЗ ржпрж╛ ADC ржерзЗржХрзЗ ржЕржбрж┐ржУ ржзрж╛рж░ржг ржХрж░рзЗред ADC рззрзи-ржмрж┐ржЯ ржЖржирж╕рж╛ржЗржиржб ржорж╛ржи (рзж-рззрзжрзирзй) ржкрзНрж░ржжрж╛ржи ржХрж░рзЗ, рждрж╛ржЗ ржПржЧрзБрж▓рж┐ рззрзм-ржмрж┐ржЯ рж╕рж╛ржЗржиржб ржорж╛ржирзЗ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рждрзЗ рж╣ржмрзЗ, ржПржмржВ рждрж╛рж░ржкрж░ ржХрж╛ржБржЪрж╛ ржмрж╛ржЗржирж╛рж░рж┐ ржбрзЗржЯрж╛ рж╣рж┐рж╕рж╛ржмрзЗ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рж╛рж░ ржЬржирзНржп рзи ржмрж╛ржЗржЯрзЗ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рждрзЗ рж╣ржмрзЗред

    ржПржЗ ржмрж╛ржЗржЯржЧрзБрж▓рж┐ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ ржмрж╛ржлрж╛рж░рзЗ рж▓рзЗржЦрж╛ рж╣ржпрж╝ред рж▓рзЗржЦрж╛ржЯрж┐ рзкрзк ржиржорзНржмрж░ ржЗржиржбрзЗржХрзНрж╕ ржерзЗржХрзЗ рж╢рзБрж░рзБ рж╣ржпрж╝ - ржПржЯрж┐ WAV ржлрж╛ржЗрж▓ рж╣рзЗржбрж╛рж░ рж╣рж┐рж╕рж╛ржмрзЗ рж▓рзЗржЦрж╛ рзкрзк ржмрж╛ржЗржЯрзЗрж░ ржЕржлрж╕рзЗржЯред ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржЕржбрж┐ржУ ржжрзИрж░рзНржШрзНржпрзЗрж░ ржЬржирзНржп ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ рж╕ржорж╕рзНржд ржмрж╛ржЗржЯ ржзрж╛рж░ржг ржХрж░рж╛рж░ ржкрж░рзЗ, ржЕржмрж╢рж┐рж╖рзНржЯ ржбрзЗржЯрж╛ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐рждрзЗ рж▓рзЗржЦрж╛ рж╣ржпрж╝ред

рзз. `Mic` ржХрзНрж▓рж╛рж╕рзЗрж░ `public` рж╕рзЗржХрж╢ржирзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    void dmaHandler()
    {
        static uint8_t count = 0;

        if (DMAC->Channel[1].CHINTFLAG.bit.SUSP)
        {
            DMAC->Channel[1].CHCTRLB.reg = DMAC_CHCTRLB_CMD_RESUME;
            DMAC->Channel[1].CHINTFLAG.bit.SUSP = 1;

            if (count)
            {
                audioCallback(_adc_buf_0, ADC_BUF_LEN);
            }
            else
            {
                audioCallback(_adc_buf_1, ADC_BUF_LEN);
            }

            count = (count + 1) % 2;
        }
    }
    ```

    ржПржЗ ржХрзЛржбржЯрж┐ DMAC ржжрзНржмрж╛рж░рж╛ ржХрж▓ ржХрж░рж╛ рж╣ржмрзЗ ржЖржкржирж╛рж░ ржХрзЛржбржХрзЗ ржмрж╛ржлрж╛рж░ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржг ржХрж░рждрзЗ ржмрж▓рж╛рж░ ржЬржирзНржпред ржПржЯрж┐ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзЗ ржпрзЗ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржгрзЗрж░ ржЬржирзНржп ржбрзЗржЯрж╛ ржЖржЫрзЗ ржХрж┐ржирж╛, ржПржмржВ ржкрзНрж░рж╛рж╕ржЩрзНржЧрж┐ржХ ржмрж╛ржлрж╛рж░ рж╕рж╣ `audioCallback` ржорзЗржержб ржХрж▓ ржХрж░рзЗред

рзз. ржХрзНрж▓рж╛рж╕рзЗрж░ ржмрж╛ржЗрж░рзЗ, `Mic mic;` ржШрзЛрж╖ржгрж╛рж░ ржкрж░рзЗ, ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    void DMAC_1_Handler()
    {
        mic.dmaHandler();
    }
    ```

    `DMAC_1_Handler` DMAC ржжрзНржмрж╛рж░рж╛ ржХрж▓ ржХрж░рж╛ рж╣ржмрзЗ ржпржЦржи ржмрж╛ржлрж╛рж░ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржгрзЗрж░ ржЬржирзНржп ржкрзНрж░рж╕рзНрждрзБржд ржерж╛ржХржмрзЗред ржПржЗ ржлрж╛ржВрж╢ржиржЯрж┐ ржирж╛ржо ржжрзНржмрж╛рж░рж╛ ржкрж╛ржУржпрж╝рж╛ ржпрж╛ржпрж╝, рждрж╛ржЗ ржПржЯрж┐ ржХрзЗржмрж▓ ржмрж┐ржжрзНржпржорж╛ржи ржерж╛ржХрж▓рзЗржЗ ржХрж▓ ржХрж░рж╛ рж╣ржмрзЗред

рзз. `Mic` ржХрзНрж▓рж╛рж╕рзЗрж░ `public` рж╕рзЗржХрж╢ржирзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржжрзБржЯрж┐ ржорзЗржержб ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    void init()
    {
        analogReference(AR_INTERNAL2V23);

        _writer.init();

        initBufferHeader();
        configureDmaAdc();
    }

    void reset()
    {
        _isRecordingReady = false;
        _isRecording = false;

        _writer.reset();

        initBufferHeader();
    }
    ```

    `init` ржорзЗржержбрзЗ `Mic` ржХрзНрж▓рж╛рж╕ ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬ ржХрж░рж╛рж░ ржЬржирзНржп ржХрзЛржб рж░ржпрж╝рзЗржЫрзЗред ржПржЗ ржорзЗржержбржЯрж┐ ржорж╛ржЗржХрзНрж░рзЛржлрзЛржи ржкрж┐ржирзЗрж░ ржЬржирзНржп рж╕ржарж┐ржХ ржнрзЛрж▓рзНржЯрзЗржЬ рж╕рзЗржЯ ржХрж░рзЗ, ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ рж░рж╛ржЗржЯрж╛рж░ рж╕рзЗржЯ ржЖржк ржХрж░рзЗ, WAV ржлрж╛ржЗрж▓ рж╣рзЗржбрж╛рж░ рж▓рзЗржЦрзЗ, ржПржмржВ DMAC ржХржиржлрж┐ржЧрж╛рж░ ржХрж░рзЗред `reset` ржорзЗржержбржЯрж┐ ржЕржбрж┐ржУ ржзрж╛рж░ржг ржПржмржВ ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржкрж░рзЗ ржлрзНрж▓рзНржпрж╛рж╢ ржорзЗржорзЛрж░рж┐ рж░рж┐рж╕рзЗржЯ ржХрж░рзЗ ржПржмржВ рж╣рзЗржбрж╛рж░ржЯрж┐ ржкрзБржирж░рж╛ржпрж╝ рж▓рзЗржЦрзЗред

### ржХрж╛ржЬ - ржЕржбрж┐ржУ ржзрж╛рж░ржг ржХрж░рзБржи

рзз. `main.cpp` ржлрж╛ржЗрж▓рзЗ, `mic.h` рж╣рзЗржбрж╛рж░ ржлрж╛ржЗрж▓рзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ ржЗржиржХрзНрж▓рзБржб ржбрж┐рж░рзЗржХрзНржЯрж┐ржн ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    #include "mic.h"
    ```

рзз. `setup` ржлрж╛ржВрж╢ржирзЗ, C ржмрзЛрждрж╛ржоржЯрж┐ ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬ ржХрж░рзБржиред ржПржЗ ржмрзЛрждрж╛ржоржЯрж┐ ржЪрж╛ржкрж▓рзЗ ржЕржбрж┐ржУ ржзрж╛рж░ржг рж╢рзБрж░рзБ рж╣ржмрзЗ ржПржмржВ рзк рж╕рзЗржХрзЗржирзНржб ржзрж░рзЗ ржЪрж▓ржмрзЗ:

    ```cpp
    pinMode(WIO_KEY_C, INPUT_PULLUP);
    ```

рзз. ржПрж░ ржирж┐ржЪрзЗ, ржорж╛ржЗржХрзНрж░рзЛржлрзЛржи ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬ ржХрж░рзБржи, рждрж╛рж░ржкрж░ ржХржирж╕рзЛрж▓рзЗ ржкрзНрж░рж┐ржирзНржЯ ржХрж░рзБржи ржпрзЗ ржЕржбрж┐ржУ ржзрж╛рж░ржгрзЗрж░ ржЬржирзНржп ржкрзНрж░рж╕рзНрждрзБржд:

    ```cpp
    mic.init();

    Serial.println("Ready.");
    ```

рзз. `loop` ржлрж╛ржВрж╢ржирзЗрж░ ржЙржкрж░рзЗ, ржзрж╛рж░ржгржХрзГржд ржЕржбрж┐ржУ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржгрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ ржлрж╛ржВрж╢ржи рж╕ржВржЬрзНржЮрж╛ржпрж╝рж┐ржд ржХрж░рзБржиред ржЖржкрж╛рждржд ржПржЯрж┐ ржХрж┐ржЫрзБ ржХрж░ржмрзЗ ржирж╛, рждржмрзЗ ржПржЗ ржкрж╛ржарзЗрж░ ржкрж░рзЗ ржПржЯрж┐ ржмржХрзНрждрзГрждрж╛ржХрзЗ ржЯрзЗржХрзНрж╕ржЯрзЗ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рж╛рж░ ржЬржирзНржп ржкрж╛ржарж╛ржмрзЗ:

    ```cpp
    void processAudio()
    {
    
    }
    ```

рзз. `loop` ржлрж╛ржВрж╢ржирзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржпрзЛржЧ ржХрж░рзБржи:

    ```cpp
    void loop()
    {
        if (digitalRead(WIO_KEY_C) == LOW && !mic.isRecording())
        {
            Serial.println("Starting recording...");
            mic.startRecording();
        }
    
        if (!mic.isRecording() && mic.isRecordingReady())
        {
            Serial.println("Finished recording");
    
            processAudio();
    
            mic.reset();
        }
    }
    ```

    ржПржЗ ржХрзЛржбржЯрж┐ C ржмрзЛрждрж╛ржоржЯрж┐ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзЗ, ржПржмржВ ржпржжрж┐ ржПржЯрж┐ ржЪрж╛ржкрж╛ рж╣ржпрж╝ ржПржмржВ рж░рзЗржХрж░рзНржбрж┐ржВ рж╢рзБрж░рзБ ржирж╛ рж╣ржпрж╝, рждржмрзЗ `Mic` ржХрзНрж▓рж╛рж╕рзЗрж░ `_isRecording` ржлрж┐рж▓рзНржбржЯрж┐ `true` рж╕рзЗржЯ ржХрж░рж╛ рж╣ржпрж╝ред ржПржЯрж┐ `Mic` ржХрзНрж▓рж╛рж╕рзЗрж░ `audioCallback` ржорзЗржержбржХрзЗ рзк рж╕рзЗржХрзЗржирзНржбрзЗрж░ ржЕржбрж┐ржУ ржзрж╛рж░ржг ржирж╛ рж╣ржУржпрж╝рж╛ ржкрж░рзНржпржирзНржд ржЕржбрж┐ржУ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рждрзЗ ржмрж╛ржзрзНржп ржХрж░ржмрзЗред ржПржХржмрж╛рж░ рзк рж╕рзЗржХрзЗржирзНржбрзЗрж░ ржЕржбрж┐ржУ ржзрж╛рж░ржг ржХрж░рж╛ рж╣рж▓рзЗ, `_isRecording` ржлрж┐рж▓рзНржбржЯрж┐ `false` рж╕рзЗржЯ ржХрж░рж╛ рж╣ржпрж╝, ржПржмржВ `_isRecordingReady` ржлрж┐рж▓рзНржбржЯрж┐ `true` рж╕рзЗржЯ ржХрж░рж╛ рж╣ржпрж╝ред ржПржЯрж┐ рждрж╛рж░ржкрж░ `loop` ржлрж╛ржВрж╢ржирзЗ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛ рж╣ржпрж╝, ржПржмржВ ржпржЦржи ржПржЯрж┐ `true` рж╣ржпрж╝, рждржЦржи `processAudio` ржлрж╛ржВрж╢ржи ржХрж▓ ржХрж░рж╛ рж╣ржпрж╝, рждрж╛рж░ржкрж░ `mic` ржХрзНрж▓рж╛рж╕ржЯрж┐ рж░рж┐рж╕рзЗржЯ ржХрж░рж╛ рж╣ржпрж╝ред

рзз. ржПржЗ ржХрзЛржбржЯрж┐ рждрзИрж░рж┐ ржХрж░рзБржи, ржПржЯрж┐ ржЖржкржирж╛рж░ Wio Terminal-ржП ржЖржкрж▓рзЛржб ржХрж░рзБржи ржПржмржВ рж╕рж┐рж░рж┐ржпрж╝рж╛рж▓ ржоржирж┐ржЯрж░рзЗрж░ ржорж╛ржзрзНржпржорзЗ ржПржЯрж┐ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржиред C ржмрзЛрждрж╛ржоржЯрж┐ ржЪрж╛ржкрзБржи (ржмрж╛ржо ржжрж┐ржХрзЗ, ржкрж╛ржУржпрж╝рж╛рж░ рж╕рзБржЗржЪрзЗрж░ рж╕ржмржЪ
ЁЯТБ ржЖржкржирж┐ ржПржЗ ржХрзЛржбржЯрж┐ [code-record/wio-terminal](../../../../../6-consumer/lessons/1-speech-recognition/code-record/wio-terminal) ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржЦрзБржБржЬрзЗ ржкрзЗрждрзЗ ржкрж╛рж░рзЗржиред
ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржирж┐рзЯржорж╛ржмрж▓рзА:  
1. '''markdown ржмрж╛ ржЕржирзНржп ржХрзЛржирзЛ ржЯрзНржпрж╛ржЧ ржЕржирзБржмрж╛ржжрзЗрж░ ржЪрж╛рж░ржкрж╛рж╢рзЗ ржпрзЛржЧ ржХрж░ржмрзЗржи ржирж╛  
2. ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржи ржпрзЗ ржЕржирзБржмрж╛ржжржЯрж┐ ржЦрзБржм ржмрзЗрж╢рж┐ ржЖржХрзНрж╖рж░рж┐ржХ рж╢рзЛржирж╛ржЪрзНржЫрзЗ ржирж╛  
3. ржоржирзНрждржмрзНржпржЧрзБрж▓рж┐ржУ ржЕржирзБржмрж╛ржж ржХрж░рзБржи  
4. ржПржЗ ржлрж╛ржЗрж▓ржЯрж┐ Markdown ржлрж░ржорзНржпрж╛ржЯрзЗ рж▓рзЗржЦрж╛ - ржПржЯрж┐ржХрзЗ XML ржмрж╛ HTML рж╣рж┐рж╕рзЗржмрзЗ ржмрж┐ржмрзЗржЪржирж╛ ржХрж░ржмрзЗржи ржирж╛  
5. ржЕржирзБржмрж╛ржж ржХрж░ржмрзЗржи ржирж╛:  
   - [!NOTE], [!WARNING], [!TIP], [!IMPORTANT], [!CAUTION]  
   - ржнрзЗрж░рж┐рзЯрзЗржмрж▓ ржирж╛ржо, ржлрж╛ржВрж╢ржи ржирж╛ржо, ржХрзНрж▓рж╛рж╕ ржирж╛ржо  
   - @@INLINE_CODE_x@@ ржмрж╛ @@CODE_BLOCK_x@@ ржПрж░ ржорждрзЛ ржкрзНрж▓рзЗрж╕рж╣рзЛрж▓рзНржбрж╛рж░  
   - URL ржмрж╛ ржкрж╛рже  
6. рж╕ржорж╕рзНржд ржорзВрж▓ Markdown ржлрж░ржорзНржпрж╛ржЯрж┐ржВ ржЕржХрзНрж╖ржд рж░рж╛ржЦрзБржи  
7. ржХрзЗржмрж▓ржорж╛рждрзНрж░ ржЕржирзБржмрж╛ржжрж┐ржд ржмрж┐рж╖рзЯржмрж╕рзНрждрзБ ржлрзЗрж░ржд ржжрж┐ржи, ржХрзЛржирзЛ ржЕрждрж┐рж░рж┐ржХрзНржд ржЯрзНржпрж╛ржЧ ржмрж╛ ржорж╛рж░рзНржХржЖржк ржЫрж╛рзЬрж╛ржЗ  

ЁЯША ржЖржкржирж╛рж░ ржЕржбрж┐ржУ рж░рзЗржХрж░рзНржбрж┐ржВ ржкрзНрж░рзЛржЧрзНрж░рж╛ржоржЯрж┐ рж╕ржлрж▓ рж╣рзЯрзЗржЫрзЗ!  

---

**ржЕрж╕рзНржмрзАржХрзГрждрж┐**:  
ржПржЗ ржиржерж┐ржЯрж┐ AI ржЕржирзБржмрж╛ржж ржкрж░рж┐рж╖рзЗржмрж╛ [Co-op Translator](https://github.com/Azure/co-op-translator) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЕржирзБржмрж╛ржж ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред ржЖржорж░рж╛ ржпржерж╛рж╕ржорзНржнржм рж╕ржарж┐ржХ ржЕржирзБржмрж╛ржжрзЗрж░ ржЬржирзНржп ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рж┐, рждржмрзЗ ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржоржирзЗ рж░рж╛ржЦржмрзЗржи ржпрзЗ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ ржЕржирзБржмрж╛ржжрзЗ рждрзНрж░рзБржЯрж┐ ржмрж╛ ржЕрж╕ржЩрзНржЧрждрж┐ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗред ржиржерж┐ржЯрж┐рж░ ржорзВрж▓ ржнрж╛рж╖рж╛ржпрж╝ ржерж╛ржХрж╛ рж╕ржВрж╕рзНржХрж░ржгржЯрж┐ржХрзЗржЗ ржкрзНрж░рж╛ржорж╛ржгрж┐ржХ ржЙрзОрж╕ рж╣рж┐рж╕рзЗржмрзЗ ржмрж┐ржмрзЗржЪржирж╛ ржХрж░рж╛ ржЙржЪрж┐рждред ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг рждржерзНржпрзЗрж░ ржЬржирзНржп, ржкрзЗрж╢рж╛ржжрж╛рж░ ржорж╛ржиржм ржЕржирзБржмрж╛ржж ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛рж░ ржкрж░рж╛ржорж░рзНрж╢ ржжрзЗржУржпрж╝рж╛ рж╣ржЪрзНржЫрзЗред ржПржЗ ржЕржирзБржмрж╛ржж ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржлрж▓рзЗ рж╕рзГрж╖рзНржЯ ржХрзЛржирзЛ ржнрзБрж▓ ржмрзЛржЭрж╛ржмрзБржЭрж┐ ржмрж╛ ржнрзБрж▓ ржмрзНржпрж╛ржЦрзНржпрж╛рж░ ржЬржирзНржп ржЖржорж░рж╛ ржжрж╛ржпрж╝рзА ржиржЗред