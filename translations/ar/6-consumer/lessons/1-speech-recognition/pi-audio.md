<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "0ac0afcfb40cb5970ef4cb74f01c32e9",
  "translation_date": "2025-08-27T00:18:16+00:00",
  "source_file": "6-consumer/lessons/1-speech-recognition/pi-audio.md",
  "language_code": "ar"
}
-->
# ุงูุชูุงุท ุงูุตูุช - Raspberry Pi

ูู ูุฐุง ุงูุฌุฒุก ูู ุงูุฏุฑุณุ ุณุชูุชุจ ููุฏูุง ูุงูุชูุงุท ุงูุตูุช ุจุงุณุชุฎุฏุงู Raspberry Pi. ุณูุชู ุงูุชุญูู ูู ุนูููุฉ ุงูุชูุงุท ุงูุตูุช ุจูุงุณุทุฉ ุฒุฑ.

## ุงูุฃุฌูุฒุฉ

ูุญุชุงุฌ Raspberry Pi ุฅูู ุฒุฑ ููุชุญูู ูู ุงูุชูุงุท ุงูุตูุช.

ุงูุฒุฑ ุงูุฐู ุณุชุณุชุฎุฏูู ูู ุฒุฑ Grove. ูุฐุง ุงูุฒุฑ ูู ูุณุชุดุนุฑ ุฑููู ูููู ุจุชุดุบูู ุฃู ุฅููุงู ุงูุฅุดุงุฑุฉ. ูููู ุชูููู ูุฐู ุงูุฃุฒุฑุงุฑ ูุฅุฑุณุงู ุฅุดุงุฑุฉ ุนุงููุฉ ุนูุฏ ุงูุถุบุท ุนูู ุงูุฒุฑุ ูุฅุดุงุฑุฉ ููุฎูุถุฉ ุนูุฏ ุนุฏู ุงูุถุบุทุ ุฃู ุงูุนูุณ.

ุฅุฐุง ููุช ุชุณุชุฎุฏู ูููุฑูููู ReSpeaker 2-Mics Pi HATุ ููุง ุญุงุฌุฉ ูุชูุตูู ุฒุฑ ุฅุถุงููุ ุญูุซ ูุญุชูู ูุฐุง ุงูููุญู ุนูู ุฒุฑ ูุฏูุฌ. ุงูุชูู ุฅูู ุงููุณู ุงูุชุงูู.

### ุชูุตูู ุงูุฒุฑ

ูููู ุชูุตูู ุงูุฒุฑ ุจูุงุนุฏุฉ Grove Base Hat.

#### ุงููููุฉ - ุชูุตูู ุงูุฒุฑ

![ุฒุฑ Grove](../../../../../translated_images/grove-button.a70cfbb809a8563681003250cf5b06d68cdcc68624f9e2f493d5a534ae2da1e5.ar.png)

1. ุฃุฏุฎู ุฃุญุฏ ุทุฑูู ูุงุจู Grove ูู ุงูููุจุณ ุงูููุฌูุฏ ุนูู ูุญุฏุฉ ุงูุฒุฑ. ูู ูุฏุฎู ุฅูุง ูู ุงุชุฌุงู ูุงุญุฏ.

1. ูุน ุฅููุงู ุชุดุบูู Raspberry Piุ ูู ุจุชูุตูู ุงูุทุฑู ุงูุขุฎุฑ ูู ูุงุจู Grove ุจุงูููุจุณ ุงูุฑููู ุงููุณูู **D5** ุนูู ูุงุนุฏุฉ Grove Base Hat ุงููุซุจุชุฉ ุนูู Pi. ูุฐุง ุงูููุจุณ ูู ุงูุซุงูู ูู ุงููุณุงุฑ ูู ุตู ุงูููุงุจุณ ุจุฌุงูุจ ุฏุจุงุจูุณ GPIO.

![ุฒุฑ Grove ูุชุตู ุจุงูููุจุณ D5](../../../../../translated_images/pi-button.c7a1a4f55943341ce1baf1057658e9a205804d4131d258e820c93f951df0abf3.ar.png)

## ุงูุชูุงุท ุงูุตูุช

ููููู ุงูุชูุงุท ุงูุตูุช ูู ุงููููุฑูููู ุจุงุณุชุฎุฏุงู ููุฏ Python.

### ุงููููุฉ - ุงูุชูุงุท ุงูุตูุช

1. ูู ุจุชุดุบูู Raspberry Pi ูุงูุชุธุฑ ุญุชู ูุชู ุงูุฅููุงุน.

1. ุงูุชุญ VS Codeุ ุฅูุง ูุจุงุดุฑุฉ ุนูู Raspberry Piุ ุฃู ุนุจุฑ ุงูุงุชุตุงู ุจุงุณุชุฎุฏุงู ุงูุชุฏุงุฏ Remote SSH.

1. ุชุญุชูู ุญุฒูุฉ PyAudio Pip ุนูู ูุธุงุฆู ูุชุณุฌูู ูุชุดุบูู ุงูุตูุช. ุชุนุชูุฏ ูุฐู ุงูุญุฒูุฉ ุนูู ุจุนุถ ููุชุจุงุช ุงูุตูุช ุงูุชู ุชุญุชุงุฌ ุฅูู ุชุซุจูุชูุง ุฃููุงู. ูู ุจุชุดุบูู ุงูุฃูุงูุฑ ุงูุชุงููุฉ ูู ุงูุทุฑููุฉ ูุชุซุจูุชูุง:

    ```sh
    sudo apt update
    sudo apt install libportaudio0 libportaudio2 libportaudiocpp0 portaudio19-dev libasound2-plugins --yes 
    ```

1. ูู ุจุชุซุจูุช ุญุฒูุฉ PyAudio Pip.

    ```sh
    pip3 install pyaudio
    ```

1. ุฃูุดุฆ ูุฌูุฏูุง ุฌุฏูุฏูุง ุจุงุณู `smart-timer` ูุฃุถู ููููุง ุจุงุณู `app.py` ุฅูู ูุฐุง ุงููุฌูุฏ.

1. ุฃุถู ุงููุงุฑุฏุงุช ุงูุชุงููุฉ ุฅูู ุฃุนูู ูุฐุง ุงูููู:

    ```python
    import io
    import pyaudio
    import time
    import wave
    
    from grove.factory import Factory
    ```

    ูุฐุง ูุณุชูุฑุฏ ูุญุฏุฉ `pyaudio`ุ ูุจุนุถ ุงููุญุฏุงุช ุงูููุงุณูุฉ ูู Python ููุชุนุงูู ูุน ูููุงุช ุงูุตูุชุ ููุญุฏุฉ `grove.factory` ูุงุณุชูุฑุงุฏ `Factory` ูุฅูุดุงุก ูุฆุฉ ุงูุฒุฑ.

1. ุจุนุฏ ุฐููุ ุฃุถู ููุฏูุง ูุฅูุดุงุก ุฒุฑ Grove.

    ุฅุฐุง ููุช ุชุณุชุฎุฏู ูููุฑูููู ReSpeaker 2-Mics Pi HATุ ุงุณุชุฎุฏู ุงูููุฏ ุงูุชุงูู:

    ```python
    # The button on the ReSpeaker 2-Mics Pi HAT
    button = Factory.getButton("GPIO-LOW", 17)
    ```

    ูุฐุง ููุดุฆ ุฒุฑูุง ุนูู ุงููููุฐ **D17**ุ ููู ุงููููุฐ ุงูุฐู ูุชุตู ุจู ุงูุฒุฑ ุนูู ReSpeaker 2-Mics Pi HAT. ูุชู ุถุจุท ูุฐุง ุงูุฒุฑ ูุฅุฑุณุงู ุฅุดุงุฑุฉ ููุฎูุถุฉ ุนูุฏ ุงูุถุบุท ุนููู.

    ุฅุฐุง ููุช ูุง ุชุณุชุฎุฏู ReSpeaker 2-Mics Pi HATุ ูุชุณุชุฎุฏู ุฒุฑ Grove ูุชุตููุง ุจูุงุนุฏุฉ Grove Base Hatุ ุงุณุชุฎุฏู ูุฐุง ุงูููุฏ:

    ```python
    button = Factory.getButton("GPIO-HIGH", 5)
    ```

    ูุฐุง ููุดุฆ ุฒุฑูุง ุนูู ุงููููุฐ **D5** ูุชู ุถุจุทู ูุฅุฑุณุงู ุฅุดุงุฑุฉ ุนุงููุฉ ุนูุฏ ุงูุถุบุท ุนููู.

1. ุจุนุฏ ุฐููุ ุฃูุดุฆ ูุซูููุง ููุฆุฉ PyAudio ููุชุนุงูู ูุน ุงูุตูุช:

    ```python
    audio = pyaudio.PyAudio()
    ```

1. ูู ุจุชุญุฏูุฏ ุฑูู ุจุทุงูุฉ ุงูุฃุฌูุฒุฉ ูููููุฑูููู ูููุจุฑ ุงูุตูุช. ุณูููู ูุฐุง ุงูุฑูู ูู ุงูุฑูู ุงูุฐู ูุฌุฏุชู ุนูุฏ ุชุดุบูู ุงูุฃูุฑูู `arecord -l` ู`aplay -l` ูู ููุช ุณุงุจู ูู ูุฐุง ุงูุฏุฑุณ.

    ```python
    microphone_card_number = <microphone card number>
    speaker_card_number = <speaker card number>
    ```

    ุงุณุชุจุฏู `<microphone card number>` ุจุฑูู ุจุทุงูุฉ ุงููููุฑูููู ุงูุฎุงุตุฉ ุจู.

    ุงุณุชุจุฏู `<speaker card number>` ุจุฑูู ุจุทุงูุฉ ููุจุฑ ุงูุตูุช ุงูุฎุงุตุฉ ุจูุ ููู ููุณ ุงูุฑูู ุงูุฐู ููุช ุจุชุนูููู ูู ููู `alsa.conf`.

1. ุจุนุฏ ุฐููุ ูู ุจุชุญุฏูุฏ ูุนุฏู ุงูุนููุฉ ุงููุณุชุฎุฏู ูุงูุชูุงุท ูุชุดุบูู ุงูุตูุช. ูุฏ ุชุญุชุงุฌ ุฅูู ุชุบููุฑ ูุฐุง ุจูุงุกู ุนูู ุงูุฃุฌูุฒุฉ ุงูุชู ุชุณุชุฎุฏููุง.

    ```python
    rate = 48000 #48KHz
    ```

    ุฅุฐุง ูุงุฌูุช ุฃุฎุทุงุก ูู ูุนุฏู ุงูุนููุฉ ุนูุฏ ุชุดุบูู ุงูููุฏ ูุงุญููุงุ ูู ุจุชุบููุฑ ูุฐู ุงููููุฉ ุฅูู `44100` ุฃู `16000`. ูููุง ุฒุงุฏุช ุงููููุฉุ ุฒุงุฏุช ุฌูุฏุฉ ุงูุตูุช.

1. ุจุนุฏ ุฐููุ ุฃูุดุฆ ุฏุงูุฉ ุฌุฏูุฏุฉ ุจุงุณู `capture_audio`. ุณูุชู ุงุณุชุฏุนุงุก ูุฐู ุงูุฏุงูุฉ ูุงูุชูุงุท ุงูุตูุช ูู ุงููููุฑูููู:

    ```python
    def capture_audio():
    ```

1. ุฏุงุฎู ูุฐู ุงูุฏุงูุฉุ ุฃุถู ุงูููุฏ ุงูุชุงูู ูุงูุชูุงุท ุงูุตูุช:

    ```python
    stream = audio.open(format = pyaudio.paInt16,
                        rate = rate,
                        channels = 1, 
                        input_device_index = microphone_card_number,
                        input = True,
                        frames_per_buffer = 4096)

    frames = []

    while button.is_pressed():
        frames.append(stream.read(4096))

    stream.stop_stream()
    stream.close()
    ```

    ูููู ูุฐุง ุงูููุฏ ุจูุชุญ ุชุฏูู ุฅุฏุฎุงู ุตูุชู ุจุงุณุชุฎุฏุงู ูุงุฆู PyAudio. ูููู ูุฐุง ุงูุชุฏูู ุจุงูุชูุงุท ุงูุตูุช ูู ุงููููุฑูููู ุจูุนุฏู 16 ูููููุฑุชุฒุ ููููู ุจุงูุชูุงุทู ูู ูุฎุงุฒู ุจุญุฌู 4096 ุจุงูุช.

    ุซู ูููู ุงูููุฏ ุจุงูุชูุฑุงุฑ ุฃุซูุงุก ุงูุถุบุท ุนูู ุฒุฑ Groveุ ุญูุซ ููุฑุฃ ูุฐู ุงููุฎุงุฒู ุจุญุฌู 4096 ุจุงูุช ูู ูู ูุฑุฉ.

    > ๐ ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุนู ุงูุฎูุงุฑุงุช ุงูููุฑุฑุฉ ุฅูู ุทุฑููุฉ `open` ูู [ุชูุซูู PyAudio](https://people.csail.mit.edu/hubert/pyaudio/docs/).

    ุจูุฌุฑุฏ ุชุญุฑูุฑ ุงูุฒุฑุ ูุชู ุฅููุงู ุงูุชุฏูู ูุฅุบูุงูู.

1. ุฃุถู ุงูููุฏ ุงูุชุงูู ุฅูู ููุงูุฉ ูุฐู ุงูุฏุงูุฉ:

    ```python
    wav_buffer = io.BytesIO()
    with wave.open(wav_buffer, 'wb') as wavefile:
        wavefile.setnchannels(1)
        wavefile.setsampwidth(audio.get_sample_size(pyaudio.paInt16))
        wavefile.setframerate(rate)
        wavefile.writeframes(b''.join(frames))
        wav_buffer.seek(0)

    return wav_buffer
    ```

    ูููู ูุฐุง ุงูููุฏ ุจุฅูุดุงุก ูุฎุฒู ุซูุงุฆูุ ูููุชุจ ุฌููุน ุงูุตูุช ุงูููุชูุท ููู ูููู [WAV](https://wikipedia.org/wiki/WAV). ูุฐุง ูู ุงูุทุฑููุฉ ุงูููุงุณูุฉ ููุชุงุจุฉ ุงูุตูุช ุบูุฑ ุงููุถุบูุท ุฅูู ููู. ูุชู ุจุนุฏ ุฐูู ุฅุฑุฌุงุน ูุฐุง ุงููุฎุฒู.

1. ุฃุถู ุฏุงูุฉ `play_audio` ุงูุชุงููุฉ ูุชุดุบูู ูุฎุฒู ุงูุตูุช:

    ```python
    def play_audio(buffer):
        stream = audio.open(format = pyaudio.paInt16,
                            rate = rate,
                            channels = 1,
                            output_device_index = speaker_card_number,
                            output = True)
    
        with wave.open(buffer, 'rb') as wf:
            data = wf.readframes(4096)
    
            while len(data) > 0:
                stream.write(data)
                data = wf.readframes(4096)
    
            stream.close()
    ```

    ุชููู ูุฐู ุงูุฏุงูุฉ ุจูุชุญ ุชุฏูู ุตูุชู ุขุฎุฑุ ูุฐู ุงููุฑุฉ ููุฅุฎุฑุงุฌ - ูุชุดุบูู ุงูุตูุช. ุชุณุชุฎุฏู ููุณ ุงูุฅุนุฏุงุฏุงุช ูุซู ุชุฏูู ุงูุฅุฏุฎุงู. ูุชู ูุชุญ ุงููุฎุฒู ูููู ุตูุชู ููุชู ูุชุงุจุชู ุฅูู ุชุฏูู ุงูุฅุฎุฑุงุฌ ูู ุฃุฌุฒุงุก ุจุญุฌู 4096 ุจุงูุชุ ููุง ูุคุฏู ุฅูู ุชุดุบูู ุงูุตูุช. ุซู ูุชู ุฅุบูุงู ุงูุชุฏูู.

1. ุฃุถู ุงูููุฏ ุงูุชุงูู ุฃุณูู ุฏุงูุฉ `capture_audio` ููุชูุฑุงุฑ ุญุชู ูุชู ุงูุถุบุท ุนูู ุงูุฒุฑ. ุจูุฌุฑุฏ ุงูุถุบุท ุนูู ุงูุฒุฑุ ูุชู ุงูุชูุงุท ุงูุตูุช ุซู ุชุดุบููู.

    ```python
    while True:
        while not button.is_pressed():
            time.sleep(.1)
        
        buffer = capture_audio()
        play_audio(buffer)
    ```

1. ูู ุจุชุดุบูู ุงูููุฏ. ุงุถุบุท ุนูู ุงูุฒุฑ ูุชุญุฏุซ ูู ุงููููุฑูููู. ุญุฑุฑ ุงูุฒุฑ ุนูุฏ ุงูุงูุชูุงุกุ ูุณุชุณูุน ุงูุชุณุฌูู.

    ูุฏ ุชูุงุฌู ุจุนุถ ุฃุฎุทุงุก ALSA ุนูุฏ ุฅูุดุงุก ูุซูู PyAudio. ูุฑุฌุน ุฐูู ุฅูู ุชูููู Raspberry Pi ูุฃุฌูุฒุฉ ุตูุชูุฉ ูุง ุชูุชูููุง. ููููู ุชุฌุงูู ูุฐู ุงูุฃุฎุทุงุก.

    ```output
    pi@raspberrypi:~/smart-timer $ python3 app.py 
    ALSA lib pcm.c:2565:(snd_pcm_open_noupdate) Unknown PCM cards.pcm.front
    ALSA lib pcm.c:2565:(snd_pcm_open_noupdate) Unknown PCM cards.pcm.rear
    ALSA lib pcm.c:2565:(snd_pcm_open_noupdate) Unknown PCM cards.pcm.center_lfe
    ALSA lib pcm.c:2565:(snd_pcm_open_noupdate) Unknown PCM cards.pcm.side
    ```

    ุฅุฐุง ูุงุฌูุช ุงูุฎุทุฃ ุงูุชุงูู:

    ```output
    OSError: [Errno -9997] Invalid sample rate
    ```

    ูู ุจุชุบููุฑ `rate` ุฅูู 44100 ุฃู 16000.

> ๐ ููููู ุงูุนุซูุฑ ุนูู ูุฐุง ุงูููุฏ ูู ุงููุฌูุฏ [code-record/pi](../../../../../6-consumer/lessons/1-speech-recognition/code-record/pi).

๐ ููุฏ ูุฌุญุช ูู ุฅูุดุงุก ุจุฑูุงูุฌ ุชุณุฌูู ุงูุตูุช!

---

**ุฅุฎูุงุก ุงููุณุคูููุฉ**:  
ุชู ุชุฑุฌูุฉ ูุฐุง ุงููุณุชูุฏ ุจุงุณุชุฎุฏุงู ุฎุฏูุฉ ุงูุชุฑุฌูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู [Co-op Translator](https://github.com/Azure/co-op-translator). ุจูููุง ูุณุนู ูุชุญููู ุงูุฏูุฉุ ูุฑุฌู ุงูุนูู ุฃู ุงูุชุฑุฌูุงุช ุงูุขููุฉ ูุฏ ุชุญุชูู ุนูู ุฃุฎุทุงุก ุฃู ูุนูููุงุช ุบูุฑ ุฏูููุฉ. ูุฌุจ ุงุนุชุจุงุฑ ุงููุณุชูุฏ ุงูุฃุตูู ุจูุบุชู ุงูุฃุตููุฉ ุงููุตุฏุฑ ุงูุฑุณูู. ููุญุตูู ุนูู ูุนูููุงุช ุญุงุณูุฉุ ูููุตู ุจุงูุงุณุชุนุงูุฉ ุจุชุฑุฌูุฉ ุจุดุฑูุฉ ุงุญุชุฑุงููุฉ. ูุญู ุบูุฑ ูุณุคูููู ุนู ุฃู ุณูุก ููู ุฃู ุชูุณูุฑุงุช ุฎุงุทุฆุฉ ูุงุชุฌุฉ ุนู ุงุณุชุฎุฏุงู ูุฐู ุงูุชุฑุฌูุฉ.