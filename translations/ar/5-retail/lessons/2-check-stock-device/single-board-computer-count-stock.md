<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "9c4320311c0f2c1884a6a21265d98a51",
  "translation_date": "2025-08-26T21:34:41+00:00",
  "source_file": "5-retail/lessons/2-check-stock-device/single-board-computer-count-stock.md",
  "language_code": "ar"
}
-->
# ุนุฏ ุงููุฎุฒูู ุจุงุณุชุฎุฏุงู ุฌูุงุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก - ุงูุฃุฌูุฒุฉ ุงูุงูุชุฑุงุถูุฉ ูุฅูุชุฑูุช ุงูุฃุดูุงุก ูRaspberry Pi

ูููู ุงุณุชุฎุฏุงู ูุฒูุฌ ูู ุงูุชููุนุงุช ูุฅุทุงุฑุงุชูุง ุงููุญูุทุฉ ูุนุฏ ุงููุฎุฒูู ูู ุตูุฑุฉ.

## ุนุฑุถ ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉ

ูุฎุทูุฉ ุชุตุญูุญ ูููุฏุฉุ ููููู ููุณ ููุท ุทุจุงุนุฉ ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉุ ูููู ุฃูุถูุง ุฑุณููุง ุนูู ุงูุตูุฑุฉ ุงูุชู ุชู ุญูุธูุง ุนูู ุงููุฑุต ุนูุฏ ุงูุชูุงุท ุตูุฑุฉ.

### ุงููููุฉ - ุทุจุงุนุฉ ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉ

1. ุชุฃูุฏ ูู ุฃู ูุดุฑูุน `stock-counter` ููุชูุญ ูู VS Codeุ ูุฃู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ููุนูุฉ ุฅุฐุง ููุช ุชุณุชุฎุฏู ุฌูุงุฒ ุฅูุชุฑูุช ุฃุดูุงุก ุงูุชุฑุงุถู.

1. ูู ุจุชุบููุฑ ุนุจุงุฑุฉ `print` ูู ุญููุฉ `for` ุฅูู ูุง ููู ูุทุจุงุนุฉ ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉ ุฅูู ูุญุฏุฉ ุงูุชุญูู:

    ```python
    print(f'{prediction.tag_name}:\t{prediction.probability * 100:.2f}%\t{prediction.bounding_box}')
    ```

1. ูู ุจุชุดุบูู ุงูุชุทุจูู ูุน ุชูุฌูู ุงููุงููุฑุง ูุญู ุจุนุถ ุงููุฎุฒูู ุนูู ุฑู. ุณูุชู ุทุจุงุนุฉ ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉ ุฅูู ูุญุฏุฉ ุงูุชุญููุ ูุน ููู ุงููุณุงุฑุ ุงูุฃุนููุ ุงูุนุฑุถ ูุงูุงุฑุชูุงุน ูู 0-1.

    ```output
    pi@raspberrypi:~/stock-counter $ python3 app.py 
    tomato paste:   33.42%  {'additional_properties': {}, 'left': 0.3455171, 'top': 0.09916268, 'width': 0.14175442, 'height': 0.29405564}
    tomato paste:   34.41%  {'additional_properties': {}, 'left': 0.48283678, 'top': 0.10242918, 'width': 0.11782813, 'height': 0.27467814}
    tomato paste:   31.25%  {'additional_properties': {}, 'left': 0.4923783, 'top': 0.35007596, 'width': 0.13668466, 'height': 0.28304994}
    tomato paste:   31.05%  {'additional_properties': {}, 'left': 0.36416405, 'top': 0.37494493, 'width': 0.14024884, 'height': 0.26880276}
    ```

### ุงููููุฉ - ุฑุณู ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉ ุนูู ุงูุตูุฑุฉ

1. ูููู ุงุณุชุฎุฏุงู ุญุฒูุฉ Pip [Pillow](https://pypi.org/project/Pillow/) ููุฑุณู ุนูู ุงูุตูุฑ. ูู ุจุชุซุจูุชูุง ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ ุงูุชุงูู:

    ```sh
    pip3 install pillow
    ```

    ุฅุฐุง ููุช ุชุณุชุฎุฏู ุฌูุงุฒ ุฅูุชุฑูุช ุฃุดูุงุก ุงูุชุฑุงุถูุ ุชุฃูุฏ ูู ุชุดุบูู ูุฐุง ุงูุฃูุฑ ุฏุงุฎู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ุงูููุนูุฉ.

1. ุฃุถู ุนุจุงุฑุฉ ุงูุงุณุชูุฑุงุฏ ุงูุชุงููุฉ ุฅูู ุฃุนูู ููู `app.py`:

    ```python
    from PIL import Image, ImageDraw, ImageColor
    ```

    ูุฐุง ูุณุชูุฑุฏ ุงูููุฏ ุงููุงุฒู ูุชุญุฑูุฑ ุงูุตูุฑุฉ.

1. ุฃุถู ุงูููุฏ ุงูุชุงูู ุฅูู ููุงูุฉ ููู `app.py`:

    ```python
    with Image.open('image.jpg') as im:
        draw = ImageDraw.Draw(im)
    
        for prediction in predictions:
            scale_left = prediction.bounding_box.left
            scale_top = prediction.bounding_box.top
            scale_right = prediction.bounding_box.left + prediction.bounding_box.width
            scale_bottom = prediction.bounding_box.top + prediction.bounding_box.height
            
            left = scale_left * im.width
            top = scale_top * im.height
            right = scale_right * im.width
            bottom = scale_bottom * im.height
    
            draw.rectangle([left, top, right, bottom], outline=ImageColor.getrgb('red'), width=2)
    
        im.save('image.jpg')
    ```

    ููุชุญ ูุฐุง ุงูููุฏ ุงูุตูุฑุฉ ุงูุชู ุชู ุญูุธูุง ุณุงุจููุง ูุชุญุฑูุฑูุง. ุซู ูููู ุจุงูุชูุฑุงุฑ ุนุจุฑ ุงูุชููุนุงุช ููุญุตูู ุนูู ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉุ ููุญุณุจ ุงูุฅุญุฏุงุซูุงุช ุงูุณูููุฉ ุงููููู ุจุงุณุชุฎุฏุงู ููู ุงูุฅุทุงุฑ ุงููุญูุท ูู 0-1. ูุชู ุชุญููู ูุฐู ุงูููู ุฅูู ุฅุญุฏุงุซูุงุช ุงูุตูุฑุฉ ุจุถุฑุจูุง ูู ุงูุจุนุฏ ุงูููุงุณุจ ููุตูุฑุฉ. ุนูู ุณุจูู ุงููุซุงูุ ุฅุฐุง ูุงูุช ูููุฉ ุงููุณุงุฑ 0.5 ูู ุตูุฑุฉ ุนุฑุถูุง 600 ุจูุณูุ ูุณูุชู ุชุญููููุง ุฅูู 300 (0.5 ร 600 = 300).

    ูุชู ุฑุณู ูู ุฅุทุงุฑ ูุญูุท ุนูู ุงูุตูุฑุฉ ุจุงุณุชุฎุฏุงู ุฎุท ุฃุญูุฑ. ูุฃุฎูุฑูุงุ ูุชู ุญูุธ ุงูุตูุฑุฉ ุงููุนุฏูุฉุ ููุง ูุคุฏู ุฅูู ุงููุชุงุจุฉ ููู ุงูุตูุฑุฉ ุงูุฃุตููุฉ.

1. ูู ุจุชุดุบูู ุงูุชุทุจูู ูุน ุชูุฌูู ุงููุงููุฑุง ูุญู ุจุนุถ ุงููุฎุฒูู ุนูู ุฑู. ุณุชุฑู ููู `image.jpg` ูู ูุณุชูุดู VS Codeุ ูุณุชุชููู ูู ุชุญุฏูุฏู ูุฑุคูุฉ ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉ.

    ![4 ุนูุจ ูู ูุนุฌูู ุงูุทูุงุทู ูุน ุฅุทุงุฑุงุช ูุญูุทุฉ ุญูู ูู ุนูุจุฉ](../../../../../translated_images/rpi-stock-with-bounding-boxes.b5540e2ecb7cd49f1271828d3be412671d950e87625c5597ea97c90f11e01097.ar.jpg)

## ุนุฏ ุงููุฎุฒูู

ูู ุงูุตูุฑุฉ ุงูููุถุญุฉ ุฃุนูุงูุ ููุงู ุชุฏุงุฎู ุจุณูุท ุจูู ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉ. ุฅุฐุง ูุงู ูุฐุง ุงูุชุฏุงุฎู ุฃูุจุฑ ุจูุซูุฑุ ููุฏ ุชุดูุฑ ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉ ุฅูู ููุณ ุงููุงุฆู. ูุนุฏ ุงููุงุฆูุงุช ุจุดูู ุตุญูุญุ ุชุญุชุงุฌ ุฅูู ุชุฌุงูู ุงูุฅุทุงุฑุงุช ุฐุงุช ุงูุชุฏุงุฎู ุงููุจูุฑ.

### ุงููููุฉ - ุนุฏ ุงููุฎุฒูู ูุน ุชุฌุงูู ุงูุชุฏุงุฎู

1. ูููู ุงุณุชุฎุฏุงู ุญุฒูุฉ Pip [Shapely](https://pypi.org/project/Shapely/) ูุญุณุงุจ ุงูุชูุงุทุน. ุฅุฐุง ููุช ุชุณุชุฎุฏู Raspberry Piุ ุณุชุญุชุงุฌ ุฅูู ุชุซุจูุช ููุชุจุฉ ุชุงุจุนุฉ ุฃููุงู:

    ```sh
    sudo apt install libgeos-dev
    ```

1. ูู ุจุชุซุจูุช ุญุฒูุฉ Shapely ุจุงุณุชุฎุฏุงู Pip:

    ```sh
    pip3 install shapely
    ```

    ุฅุฐุง ููุช ุชุณุชุฎุฏู ุฌูุงุฒ ุฅูุชุฑูุช ุฃุดูุงุก ุงูุชุฑุงุถูุ ุชุฃูุฏ ูู ุชุดุบูู ูุฐุง ุงูุฃูุฑ ุฏุงุฎู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ุงูููุนูุฉ.

1. ุฃุถู ุนุจุงุฑุฉ ุงูุงุณุชูุฑุงุฏ ุงูุชุงููุฉ ุฅูู ุฃุนูู ููู `app.py`:

    ```python
    from shapely.geometry import Polygon
    ```

    ูุฐุง ูุณุชูุฑุฏ ุงูููุฏ ุงููุงุฒู ูุฅูุดุงุก ูุถูุนุงุช ูุญุณุงุจ ุงูุชุฏุงุฎู.

1. ููู ุงูููุฏ ุงูุฐู ูุฑุณู ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉุ ุฃุถู ุงูููุฏ ุงูุชุงูู:

    ```python
    overlap_threshold = 0.20
    ```

    ูุฐุง ูุญุฏุฏ ูุณุจุฉ ุงูุชุฏุงุฎู ุงููุณููุญ ุจูุง ูุจู ุงุนุชุจุงุฑ ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉ ูููุณ ุงููุงุฆู. ุงููููุฉ 0.20 ุชุนูู ุชุฏุงุฎู ุจูุณุจุฉ 20%.

1. ูุญุณุงุจ ุงูุชุฏุงุฎู ุจุงุณุชุฎุฏุงู Shapelyุ ูุฌุจ ุชุญููู ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉ ุฅูู ูุถูุนุงุช Shapely. ุฃุถู ุงููุธููุฉ ุงูุชุงููุฉ ููููุงู ุจุฐูู:

    ```python
    def create_polygon(prediction):
        scale_left = prediction.bounding_box.left
        scale_top = prediction.bounding_box.top
        scale_right = prediction.bounding_box.left + prediction.bounding_box.width
        scale_bottom = prediction.bounding_box.top + prediction.bounding_box.height
    
        return Polygon([(scale_left, scale_top), (scale_right, scale_top), (scale_right, scale_bottom), (scale_left, scale_bottom)])
    ```

    ุชููู ูุฐู ุงููุธููุฉ ุจุฅูุดุงุก ูุถูุน ุจุงุณุชุฎุฏุงู ุงูุฅุทุงุฑ ุงููุญูุท ูุชููุน ูุนูู.

1. ุชุชุถูู ููุทู ุฅุฒุงูุฉ ุงููุงุฆูุงุช ุงููุชุฏุงุฎูุฉ ููุงุฑูุฉ ุฌููุน ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉุ ูุฅุฐุง ูุงู ุฃู ุฒูุฌ ูู ุงูุชููุนุงุช ูุญุชูู ุนูู ุฅุทุงุฑุงุช ูุญูุทุฉ ุชุชุฏุงุฎู ุฃูุซุฑ ูู ุงูุญุฏ ุงููุณููุญ ุจูุ ูุชู ุญุฐู ุฃุญุฏ ุงูุชููุนุงุช. ูููุงุฑูุฉ ุฌููุน ุงูุชููุนุงุชุ ูุชู ููุงุฑูุฉ ุงูุชููุน 1 ูุน 2ุ 3ุ 4ุ ูููุฐุงุ ุซู 2 ูุน 3ุ 4ุ ูููุฐุง. ุงูููุฏ ุงูุชุงูู ูููู ุจุฐูู:

    ```python
    to_delete = []

    for i in range(0, len(predictions)):
        polygon_1 = create_polygon(predictions[i])
    
        for j in range(i+1, len(predictions)):
            polygon_2 = create_polygon(predictions[j])
            overlap = polygon_1.intersection(polygon_2).area

            smallest_area = min(polygon_1.area, polygon_2.area)
    
            if overlap > (overlap_threshold * smallest_area):
                to_delete.append(predictions[i])
                break
    
    for d in to_delete:
        predictions.remove(d)

    print(f'Counted {len(predictions)} stock items')
    ```

    ูุชู ุญุณุงุจ ุงูุชุฏุงุฎู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ `Polygon.intersection` ูู Shapely ุงูุชู ุชุนูุฏ ูุถูุนูุง ููุซู ุงูุชุฏุงุฎู. ูุชู ุจุนุฏ ุฐูู ุญุณุงุจ ุงููุณุงุญุฉ ูู ูุฐุง ุงููุถูุน. ูุฐุง ุงูุญุฏ ููุชุฏุงุฎู ููุณ ูููุฉ ูุทููุฉุ ููููู ูุญุชุงุฌ ุฅูู ุฃู ูููู ูุณุจุฉ ูุฆููุฉ ูู ุงูุฅุทุงุฑ ุงููุญูุทุ ูุฐูู ูุชู ุงูุนุซูุฑ ุนูู ุฃุตุบุฑ ุฅุทุงุฑ ูุญูุทุ ููุชู ุงุณุชุฎุฏุงู ุญุฏ ุงูุชุฏุงุฎู ูุญุณุงุจ ุงููุณุงุญุฉ ุงูุชู ูููู ุฃู ูููู ุนูููุง ุงูุชุฏุงุฎู ุฏูู ุชุฌุงูุฒ ูุณุจุฉ ุงูุชุฏุงุฎู ุงููุณููุญ ุจูุง ููุฅุทุงุฑ ุงููุญูุท ุงูุฃุตุบุฑ. ุฅุฐุง ุชุฌุงูุฒ ุงูุชุฏุงุฎู ูุฐุง ุงูุญุฏุ ูุชู ูุถุน ุนูุงูุฉ ุนูู ุงูุชููุน ููุญุฐู.

    ุจูุฌุฑุฏ ูุถุน ุนูุงูุฉ ุนูู ุงูุชููุน ููุญุฐูุ ูุง ูุญุชุงุฌ ุฅูู ุงูุชุญูู ูุฑุฉ ุฃุฎุฑูุ ูุฐูู ูุชู ูุณุฑ ุงูุญููุฉ ุงูุฏุงุฎููุฉ ููุชุญูู ูู ุงูุชููุน ุงูุชุงูู. ูุง ููููู ุญุฐู ุนูุงุตุฑ ูู ูุงุฆูุฉ ุฃุซูุงุก ุงูุชูุฑุงุฑ ุนูููุงุ ูุฐูู ูุชู ุฅุถุงูุฉ ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉ ุงูุชู ุชุชุฏุงุฎู ุฃูุซุฑ ูู ุงูุญุฏ ุงููุณููุญ ุจู ุฅูู ูุงุฆูุฉ `to_delete`ุ ุซู ูุชู ุญุฐููุง ูู ุงูููุงูุฉ.

    ุฃุฎูุฑูุงุ ูุชู ุทุจุงุนุฉ ุนุฏุฏ ุงููุฎุฒูู ุฅูู ูุญุฏุฉ ุงูุชุญูู. ูููู ุจุนุฏ ุฐูู ุฅุฑุณุงู ูุฐุง ุงูุนุฏุฏ ุฅูู ุฎุฏูุฉ ุฅูุชุฑูุช ุงูุฃุดูุงุก ูุชูุจูู ุฅุฐุง ูุงูุช ูุณุชููุงุช ุงููุฎุฒูู ููุฎูุถุฉ. ูู ูุฐุง ุงูููุฏ ูุชู ูุจู ุฑุณู ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉุ ูุฐูู ุณุชุฑู ุชููุนุงุช ุงููุฎุฒูู ุจุฏูู ุชุฏุงุฎูุงุช ุนูู ุงูุตูุฑ ุงููููุฏุฉ.

    > ๐ ูุฐู ุทุฑููุฉ ุจุณูุทุฉ ุฌุฏูุง ูุฅุฒุงูุฉ ุงูุชุฏุงุฎูุงุชุ ุญูุซ ูุชู ููุท ุฅุฒุงูุฉ ุงูุฃูู ูู ุฒูุฌ ูุชุฏุงุฎู. ุจุงููุณุจุฉ ูููุฏ ุงูุฅูุชุงุฌุ ูุฏ ุชุฑุบุจ ูู ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงูููุทู ููุงุ ูุซู ุงููุธุฑ ูู ุงูุชุฏุงุฎูุงุช ุจูู ูุงุฆูุงุช ูุชุนุฏุฏุฉุ ุฃู ุฅุฐุง ูุงู ุฅุทุงุฑ ูุญูุท ูุงุญุฏ ูุญุชูู ุนูู ุขุฎุฑ.

1. ูู ุจุชุดุบูู ุงูุชุทุจูู ูุน ุชูุฌูู ุงููุงููุฑุง ูุญู ุจุนุถ ุงููุฎุฒูู ุนูู ุฑู. ุณุชุดูุฑ ุงููุชูุฌุฉ ุฅูู ุนุฏุฏ ุงูุฅุทุงุฑุงุช ุงููุญูุทุฉ ุจุฏูู ุชุฏุงุฎูุงุช ุชุชุฌุงูุฒ ุงูุญุฏ ุงููุณููุญ ุจู. ุฌุฑุจ ุชุนุฏูู ูููุฉ `overlap_threshold` ูุฑุคูุฉ ุงูุชููุนุงุช ุงูุชู ูุชู ุชุฌุงูููุง.

> ๐ ููููู ุงูุนุซูุฑ ุนูู ูุฐุง ุงูููุฏ ูู ูุฌูุฏ [code-count/pi](../../../../../5-retail/lessons/2-check-stock-device/code-count/pi) ุฃู [code-count/virtual-iot-device](../../../../../5-retail/lessons/2-check-stock-device/code-count/virtual-iot-device).

๐ ููุฏ ูุงู ุจุฑูุงูุฌ ุนุฏ ุงููุฎุฒูู ุงูุฎุงุต ุจู ูุฌุงุญูุง!

---

**ุฅุฎูุงุก ุงููุณุคูููุฉ**:  
ุชู ุชุฑุฌูุฉ ูุฐุง ุงููุณุชูุฏ ุจุงุณุชุฎุฏุงู ุฎุฏูุฉ ุงูุชุฑุฌูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู [Co-op Translator](https://github.com/Azure/co-op-translator). ุจูููุง ูุณุนู ูุชุญููู ุงูุฏูุฉุ ูุฑุฌู ุงูุนูู ุฃู ุงูุชุฑุฌูุงุช ุงูุขููุฉ ูุฏ ุชุญุชูู ุนูู ุฃุฎุทุงุก ุฃู ูุนูููุงุช ุบูุฑ ุฏูููุฉ. ูุฌุจ ุงุนุชุจุงุฑ ุงููุณุชูุฏ ุงูุฃุตูู ุจูุบุชู ุงูุฃุตููุฉ ุงููุตุฏุฑ ุงูุฑุณูู. ููุญุตูู ุนูู ูุนูููุงุช ุญุงุณูุฉุ ูููุตู ุจุงูุงุณุชุนุงูุฉ ุจุชุฑุฌูุฉ ุจุดุฑูุฉ ุงุญุชุฑุงููุฉ. ูุญู ุบูุฑ ูุณุคูููู ุนู ุฃู ุณูุก ููู ุฃู ุชูุณูุฑุงุช ุฎุงุทุฆุฉ ูุงุชุฌุฉ ุนู ุงุณุชุฎุฏุงู ูุฐู ุงูุชุฑุฌูุฉ.