<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "5f2d2f4a5a023c93ab34a0cc5b47c0c4",
  "translation_date": "2025-08-26T22:34:47+00:00",
  "source_file": "2-farm/lessons/5-migrate-application-to-the-cloud/README.md",
  "language_code": "ar"
}
-->
# ููู ููุทู ุชุทุจููู ุฅูู ุงูุณุญุงุจุฉ

![ุฑุณู ุชูุถูุญู ููุฐู ุงูุฏุฑุณ](../../../../../translated_images/lesson-9.dfe99c8e891f48e179724520da9f5794392cf9a625079281ccdcbf09bd85e1b6.ar.jpg)

> ุฑุณู ุชูุถูุญู ูู [ููุชูุง ูุงุฑุงุณูููุงู](https://github.com/nitya). ุงููุฑ ุนูู ุงูุตูุฑุฉ ูุนุฑุถ ูุณุฎุฉ ุฃูุจุฑ.

ุชู ุชูุฏูู ูุฐุง ุงูุฏุฑุณ ูุฌุฒุก ูู [ูุดุฑูุน ุฅูุชุฑูุช ุงูุฃุดูุงุก ูููุจุชุฏุฆูู - ุณูุณูุฉ ุงูุฒุฑุงุนุฉ ุงูุฑูููุฉ](https://youtube.com/playlist?list=PLmsFUfdnGr3yCutmcVg6eAUEfsGiFXgcx) ูู [Microsoft Reactor](https://developer.microsoft.com/reactor/?WT.mc_id=academic-17441-jabenn).

[![ุชุญูู ูู ุฌูุงุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุงูุฎุงุต ุจู ุจุงุณุชุฎุฏุงู ููุฏ ุจุฏูู ุฎุงุฏู](https://img.youtube.com/vi/VVZDcs5u1_I/0.jpg)](https://youtu.be/VVZDcs5u1_I)

## ุงุฎุชุจุงุฑ ูุง ูุจู ุงููุญุงุถุฑุฉ

[ุงุฎุชุจุงุฑ ูุง ูุจู ุงููุญุงุถุฑุฉ](https://black-meadow-040d15503.1.azurestaticapps.net/quiz/17)

## ุงูููุฏูุฉ

ูู ุงูุฏุฑุณ ุงูุณุงุจูุ ุชุนููุช ููููุฉ ุชูุตูู ุฌูุงุฒ ูุฑุงูุจุฉ ุฑุทูุจุฉ ุงูุชุฑุจุฉ ุงูุฎุงุต ุจุงููุจุงุชุงุช ูุงูุชุญูู ูู ุงููุฑุญู ุจุฎุฏูุฉ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุงููุณุชูุฏุฉ ุฅูู ุงูุณุญุงุจุฉ. ุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ููู ุงูููุฏ ุงูุฎุงุฏูู ุงูุฐู ูุชุญูู ูู ุชูููุช ุงููุฑุญู ุฅูู ุงูุณุญุงุจุฉ. ูู ูุฐุง ุงูุฏุฑุณุ ุณุชุชุนูู ููููุฉ ุงูููุงู ุจุฐูู ุจุงุณุชุฎุฏุงู ุงููุธุงุฆู ุจุฏูู ุฎุงุฏู.

ูู ูุฐุง ุงูุฏุฑุณ ุณูุชูุงูู:

* [ูุง ูู ุงููุธุงุฆู ุจุฏูู ุฎุงุฏูุ](../../../../../2-farm/lessons/5-migrate-application-to-the-cloud)
* [ุฅูุดุงุก ุชุทุจูู ุจุฏูู ุฎุงุฏู](../../../../../2-farm/lessons/5-migrate-application-to-the-cloud)
* [ุฅูุดุงุก ูุดุบู ุญุฏุซ IoT Hub](../../../../../2-farm/lessons/5-migrate-application-to-the-cloud)
* [ุฅุฑุณุงู ุทูุจุงุช ุงูุทุฑู ุงููุจุงุดุฑุฉ ูู ุงูููุฏ ุจุฏูู ุฎุงุฏู](../../../../../2-farm/lessons/5-migrate-application-to-the-cloud)
* [ูุดุฑ ุงูููุฏ ุจุฏูู ุฎุงุฏู ุฅูู ุงูุณุญุงุจุฉ](../../../../../2-farm/lessons/5-migrate-application-to-the-cloud)

## ูุง ูู ุงููุธุงุฆู ุจุฏูู ุฎุงุฏูุ

ุงููุธุงุฆู ุจุฏูู ุฎุงุฏูุ ุฃู ุงูุญูุณุจุฉ ุจุฏูู ุฎุงุฏูุ ุชุชุถูู ุฅูุดุงุก ูุชู ุตุบูุฑุฉ ูู ุงูููุฏ ูุชู ุชุดุบูููุง ูู ุงูุณุญุงุจุฉ ุงุณุชุฌุงุจุฉ ูุฃููุงุน ูุฎุชููุฉ ูู ุงูุฃุญุฏุงุซ. ุนูุฏูุง ูุญุฏุซ ุงูุญุฏุซุ ูุชู ุชุดุบูู ุงูููุฏ ุงูุฎุงุต ุจู ููุชู ุชูุฑูุฑ ุจูุงูุงุช ุญูู ุงูุญุฏุซ ุฅููู. ูููู ุฃู ุชุฃุชู ูุฐู ุงูุฃุญุฏุงุซ ูู ุฃุดูุงุก ูุชุนุฏุฏุฉุ ุจูุง ูู ุฐูู ุทูุจุงุช ุงูููุจุ ุงูุฑุณุงุฆู ุงูููุถูุนุฉ ูู ูุงุฆูุฉ ุงูุชุธุงุฑุ ุชุบููุฑุงุช ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุจูุงูุงุชุ ุฃู ุงูุฑุณุงุฆู ุงููุฑุณูุฉ ุฅูู ุฎุฏูุฉ ุฅูุชุฑูุช ุงูุฃุดูุงุก ูู ุฃุฌูุฒุฉ ุฅูุชุฑูุช ุงูุฃุดูุงุก.

![ุงูุฃุญุฏุงุซ ุงููุฑุณูุฉ ูู ุฎุฏูุฉ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุฅูู ุฎุฏูุฉ ุจุฏูู ุฎุงุฏูุ ุชุชู ูุนุงูุฌุชูุง ุฌููุนูุง ูู ููุณ ุงูููุช ุจูุงุณุทุฉ ูุธุงุฆู ูุชุนุฏุฏุฉ](../../../../../translated_images/iot-messages-to-serverless.0194da1cc0732bb7d0f823aed3fce54735c6b1ad3bf36089804d8aaefc0a774f.ar.png)

> ๐ ุฅุฐุง ููุช ูุฏ ุงุณุชุฎุฏูุช ูุดุบูุงุช ููุงุนุฏ ุงูุจูุงูุงุช ูู ูุจูุ ููููู ุงูุชูููุฑ ูู ูุฐุง ุนูู ุฃูู ููุณ ุงูุดูุกุ ุญูุซ ูุชู ุชุดุบูู ุงูููุฏ ุจูุงุณุทุฉ ุญุฏุซ ูุซู ุฅุฏุฎุงู ุตู.

![ุนูุฏูุง ูุชู ุฅุฑุณุงู ุงูุนุฏูุฏ ูู ุงูุฃุญุฏุงุซ ูู ููุณ ุงูููุชุ ุชููู ุงูุฎุฏูุฉ ุจุฏูู ุฎุงุฏู ุจุงูุชูุณุน ูุชุดุบูููุง ุฌููุนูุง ูู ููุณ ุงูููุช](../../../../../translated_images/serverless-scaling.f8c769adf0413fd17be1af4f07ff63016b347e2ff869be6c4abb211f9e93909d.ar.png)

ูุชู ุชุดุบูู ุงูููุฏ ุงูุฎุงุต ุจู ููุท ุนูุฏูุง ูุญุฏุซ ุงูุญุฏุซุ ููุง ูุชู ุงูุงุญุชูุงุธ ุจุงูููุฏ ุงูุฎุงุต ุจู ููุฏ ุงูุชุดุบูู ูู ุฃููุงุช ุฃุฎุฑู. ุนูุฏูุง ูุญุฏุซ ุงูุญุฏุซุ ูุชู ุชุญููู ุงูููุฏ ุงูุฎุงุต ุจู ูุชุดุบููู. ูุฐุง ูุฌุนู ุงููุธุงุฆู ุจุฏูู ุฎุงุฏู ูุงุจูุฉ ููุชูุณุน ุจุดูู ูุจูุฑ - ุฅุฐุง ุญุฏุซุช ุงูุนุฏูุฏ ูู ุงูุฃุญุฏุงุซ ูู ููุณ ุงูููุชุ ูููู ููููุฑ ุงูุณุญุงุจุฉ ุชุดุบูู ุงููุธููุฉ ุงูุฎุงุตุฉ ุจู ุจูุฏุฑ ูุง ุชุญุชุงุฌ ูู ููุณ ุงูููุช ุนุจุฑ ุฃู ุฎูุงุฏู ูุชุงุญุฉ ูุฏููู. ุงูุฌุงูุจ ุงูุณูุจู ููุฐุง ูู ุฃูู ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ูุดุงุฑูุฉ ุงููุนูููุงุช ุจูู ุงูุฃุญุฏุงุซุ ูุฌุจ ุนููู ุญูุธูุง ูู ููุงู ูุง ูุซู ูุงุนุฏุฉ ุจูุงูุงุช ุจุฏูุงู ูู ุชุฎุฒูููุง ูู ุงูุฐุงูุฑุฉ.

ูุชู ูุชุงุจุฉ ุงูููุฏ ุงูุฎุงุต ุจู ูุฏุงูุฉ ุชุฃุฎุฐ ุชูุงุตูู ุญูู ุงูุญุฏุซ ููุนุงูู. ููููู ุงุณุชุฎุฏุงู ูุฌููุนุฉ ูุงุณุนุฉ ูู ูุบุงุช ุงูุจุฑูุฌุฉ ููุชุงุจุฉ ูุฐู ุงููุธุงุฆู ุจุฏูู ุฎุงุฏู.

> ๐ ุชูุนุฑู ุงููุธุงุฆู ุจุฏูู ุฎุงุฏู ุฃูุถูุง ุจุงุณู "ุงููุธุงุฆู ูุฎุฏูุฉ" (FaaS) ุญูุซ ูุชู ุชูููุฐ ูู ูุดุบู ุญุฏุซ ูุฏุงูุฉ ูู ุงูููุฏ.

ุนูู ุงูุฑุบู ูู ุงูุงุณูุ ูุฅู ุงููุธุงุฆู ุจุฏูู ุฎุงุฏู ุชุณุชุฎุฏู ุจุงููุนู ุฎูุงุฏู. ุงูุชุณููุฉ ุชุนูู ุฃูู ููุทูุฑ ูุง ุชูุชู ุจุงูุฎูุงุฏู ุงููุงุฒูุฉ ูุชุดุบูู ุงูููุฏ ุงูุฎุงุต ุจูุ ูู ูุง ุชูุชู ุจู ูู ุฃู ุงูููุฏ ุงูุฎุงุต ุจู ูุชู ุชุดุบููู ุงุณุชุฌุงุจุฉ ูุญุฏุซ. ูููุฑ ูููุฑ ุงูุณุญุงุจุฉ *ุจูุฆุฉ ุชุดุบูู ุจุฏูู ุฎุงุฏู* ุชุฏูุฑ ุชุฎุตูุต ุงูุฎูุงุฏูุ ุงูุดุจูุงุชุ ุงูุชุฎุฒููุ ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉุ ุงูุฐุงูุฑุฉ ููู ุดูุก ุขุฎุฑ ูุทููุจ ูุชุดุบูู ุงูููุฏ ุงูุฎุงุต ุจู. ูุฐุง ุงููููุฐุฌ ูุนูู ุฃูู ูุง ุชุฏูุน ููู ุฎุงุฏู ููุฎุฏูุฉุ ุญูุซ ูุง ููุฌุฏ ุฎุงุฏู. ุจุฏูุงู ูู ุฐููุ ุชุฏูุน ููุงุจู ุงูููุช ุงูุฐู ูุชู ููู ุชุดุบูู ุงูููุฏ ุงูุฎุงุต ุจูุ ููููุฉ ุงูุฐุงูุฑุฉ ุงููุณุชุฎุฏูุฉ.

> ๐ฐ ุงููุธุงุฆู ุจุฏูู ุฎุงุฏู ูู ูุงุญุฏุฉ ูู ุฃุฑุฎุต ุงูุทุฑู ูุชุดุบูู ุงูููุฏ ูู ุงูุณุญุงุจุฉ. ุนูู ุณุจูู ุงููุซุงูุ ูู ููุช ูุชุงุจุฉ ูุฐุง ุงููุตุ ูุณูุญ ุฃุญุฏ ูููุฑู ุงูุณุญุงุจุฉ ูุฌููุน ุงููุธุงุฆู ุจุฏูู ุฎุงุฏู ุงูุฎุงุตุฉ ุจู ุจุงูุชูููุฐ ููููู ูุฑุฉ ุดูุฑููุง ูุจู ุฃู ูุจุฏุฃูุง ูู ูุฑุถ ุฑุณูู ุนูููุ ูุจุนุฏ ุฐูู ููุฑุถูู 0.20 ุฏููุงุฑ ุฃูุฑููู ููู ููููู ุชูููุฐ. ุนูุฏูุง ูุง ูุชู ุชุดุบูู ุงูููุฏ ุงูุฎุงุต ุจูุ ูุง ุชุฏูุน ุดูุฆูุง.

ููุทูุฑ ุฅูุชุฑูุช ุงูุฃุดูุงุกุ ูุฅู ูููุฐุฌ ุงููุธุงุฆู ุจุฏูู ุฎุงุฏู ูุซุงูู. ููููู ูุชุงุจุฉ ุฏุงูุฉ ูุชู ุงุณุชุฏุนุงุคูุง ุงุณุชุฌุงุจุฉ ููุฑุณุงุฆู ุงููุฑุณูุฉ ูู ุฃู ุฌูุงุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก ูุชุตู ุจุฎุฏูุฉ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุงููุณุชุถุงูุฉ ูู ุงูุณุญุงุจุฉ. ุงูููุฏ ุงูุฎุงุต ุจู ุณูุชุนุงูู ูุน ุฌููุน ุงูุฑุณุงุฆู ุงููุฑุณูุฉุ ููููู ุณูุนูู ููุท ุนูุฏ ุงูุญุงุฌุฉ.

โ ุฃููู ูุธุฑุฉ ุนูู ุงูููุฏ ุงูุฐู ูุชุจุชู ูููุฏ ุฎุงุฏูู ูุณุชูุน ููุฑุณุงุฆู ุนุจุฑ MQTT. ููู ูููู ุฃู ูุนูู ูุฐุง ูู ุงูุณุญุงุจุฉ ุจุงุณุชุฎุฏุงู ุงููุธุงุฆู ุจุฏูู ุฎุงุฏูุ ููู ุชุนุชูุฏ ุฃู ุงูููุฏ ูุฏ ูุญุชุงุฌ ุฅูู ุงูุชุบููุฑ ูุฏุนู ุงูุญูุณุจุฉ ุจุฏูู ุฎุงุฏูุ

> ๐ ูููุฐุฌ ุงููุธุงุฆู ุจุฏูู ุฎุงุฏู ููุชูู ุฅูู ุฎุฏูุงุช ุณุญุงุจูุฉ ุฃุฎุฑู ุจุงูุฅุถุงูุฉ ุฅูู ุชุดุบูู ุงูููุฏ. ุนูู ุณุจูู ุงููุซุงูุ ููุงุนุฏ ุงูุจูุงูุงุช ุจุฏูู ุฎุงุฏู ูุชููุฑุฉ ูู ุงูุณุญุงุจุฉ ุจุงุณุชุฎุฏุงู ูููุฐุฌ ุชุณุนูุฑ ุจุฏูู ุฎุงุฏู ุญูุซ ุชุฏูุน ููู ุทูุจ ูุชู ุฅุฌุฑุงุคู ุถุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ูุซู ุงุณุชุนูุงู ุฃู ุฅุฏุฎุงูุ ุนุงุฏุฉู ุจุงุณุชุฎุฏุงู ุชุณุนูุฑ ูุนุชูุฏ ุนูู ููุฏุงุฑ ุงูุนูู ุงููุทููุจ ูุฎุฏูุฉ ุงูุทูุจ. ุนูู ุณุจูู ุงููุซุงูุ ุงุณุชุนูุงู ุจุณูุท ุนู ุตู ูุงุญุฏ ุจุงุณุชุฎุฏุงู ููุชุงุญ ุฃุณุงุณู ุณูููู ุฃูู ูู ุนูููุฉ ูุนูุฏุฉ ุชูุถู ุฅูู ุงูุนุฏูุฏ ูู ุงูุฌุฏุงูู ูุชุนูุฏ ุขูุงู ุงูุตููู.

## ุฅูุดุงุก ุชุทุจูู ุจุฏูู ุฎุงุฏู

ุฎุฏูุฉ ุงูุญูุณุจุฉ ุจุฏูู ุฎุงุฏู ูู ูุงููุฑูุณููุช ุชูุนุฑู ุจุงุณู Azure Functions.

![ุดุนุงุฑ Azure Functions](../../../../../translated_images/azure-functions-logo.1cfc8e3204c9c44aaf80fcf406fc8544d80d7f00f8d3e8ed6fed764563e17564.ar.png)

ุงูููุฏูู ุงููุตูุฑ ุฃุฏูุงู ููุฏู ูุธุฑุฉ ุนุงูุฉ ุนูู Azure Functions:

[![ููุฏูู ูุธุฑุฉ ุนุงูุฉ ุนูู Azure Functions](https://img.youtube.com/vi/8-jz5f_JyEQ/0.jpg)](https://www.youtube.com/watch?v=8-jz5f_JyEQ)

> ๐ฅ ุงููุฑ ุนูู ุงูุตูุฑุฉ ุฃุนูุงู ููุดุงูุฏุฉ ุงูููุฏูู

โ ุฎุฐ ูุญุธุฉ ููุจุญุซ ููุฑุงุกุฉ ูุธุฑุฉ ุนุงูุฉ ุนูู Azure Functions ูู [ูุซุงุฆู Microsoft Azure Functions](https://docs.microsoft.com/azure/azure-functions/functions-overview?WT.mc_id=academic-17441-jabenn).

ูุฅูุดุงุก Azure Functionsุ ุชุจุฏุฃ ุจุชุทุจูู Azure Functions ุจูุบุฉ ุงูุจุฑูุฌุฉ ุงูุชู ุชุฎุชุงุฑูุง. ูุฏุนู Azure Functions ุจุดูู ุงูุชุฑุงุถู Pythonุ JavaScriptุ TypeScriptุ C#ุ F#ุ Javaุ ูPowerShell. ูู ูุฐุง ุงูุฏุฑุณุ ุณุชุชุนูู ููููุฉ ูุชุงุจุฉ ุชุทุจูู Azure Functions ุจุงุณุชุฎุฏุงู Python.

> ๐ ูุฏุนู Azure Functions ุฃูุถูุง ูุนุงูุฌุงุช ูุฎุตุตุฉ ุจุญูุซ ููููู ูุชุงุจุฉ ุงููุธุงุฆู ุจุฃู ูุบุฉ ุชุฏุนู ุทูุจุงุช HTTPุ ุจูุง ูู ุฐูู ุงููุบุงุช ุงููุฏููุฉ ูุซู COBOL.

ุชุชููู ุชุทุจููุงุช ุงููุธุงุฆู ูู ูุงุญุฏ ุฃู ุฃูุซุฑ ูู *ุงููุดุบูุงุช* - ููู ูุธุงุฆู ุชุณุชุฌูุจ ููุฃุญุฏุงุซ. ููููู ุฃู ุชุญุชูู ุนูู ูุดุบูุงุช ูุชุนุฏุฏุฉ ุฏุงุฎู ุชุทุจูู ุงููุธุงุฆู ุงููุงุญุฏุ ุชุดุชุฑู ุฌููุนูุง ูู ููุณ ุงูุฅุนุฏุงุฏุงุช. ุนูู ุณุจูู ุงููุซุงูุ ูู ููู ุงูุฅุนุฏุงุฏุงุช ุงูุฎุงุต ุจุชุทุจูู ุงููุธุงุฆูุ ููููู ูุถุน ุชูุงุตูู ุงูุงุชุตุงู ุจู IoT Hub ุงูุฎุงุต ุจูุ ููููู ูุฌููุน ุงููุธุงุฆู ูู ุงูุชุทุจูู ุงุณุชุฎุฏุงู ูุฐุง ุงูุงุชุตุงู ููุงุณุชูุงุน ุฅูู ุงูุฃุญุฏุงุซ.

### ุงููููุฉ - ุชุซุจูุช ุฃุฏูุงุช Azure Functions

> ูู ููุช ูุชุงุจุฉ ูุฐุง ุงููุตุ ุฃุฏูุงุช ููุฏ Azure Functions ููุณุช ูุฏุนููุฉ ุจุงููุงูู ุนูู ุฃุฌูุฒุฉ Apple Silicon ูุน ูุดุงุฑูุน Python. ุณุชุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ุฌูุงุฒ Mac ุจูุนุงูุฌ Intelุ ุฃู ุฌูุงุฒ ููุจููุชุฑ ูุนูู ุจูุธุงู Windowsุ ุฃู ุฌูุงุฒ ููุจููุชุฑ ูุนูู ุจูุธุงู Linux ุจุฏูุงู ูู ุฐูู.

ุฅุญุฏู ุงูููุฒุงุช ุงูุฑุงุฆุนุฉ ูู Azure Functions ูู ุฃูู ููููู ุชุดุบูููุง ูุญูููุง. ููุณ ุจูุฆุฉ ุงูุชุดุบูู ุงููุณุชุฎุฏูุฉ ูู ุงูุณุญุงุจุฉ ูููู ุชุดุบูููุง ุนูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจูุ ููุง ูุณูุญ ูู ุจูุชุงุจุฉ ููุฏ ูุณุชุฌูุจ ูุฑุณุงุฆู ุฅูุชุฑูุช ุงูุฃุดูุงุก ูุชุดุบููู ูุญูููุง. ููููู ุญุชู ุชุตุญูุญ ุงูููุฏ ุงูุฎุงุต ุจู ุฃุซูุงุก ูุนุงูุฌุฉ ุงูุฃุญุฏุงุซ. ุจูุฌุฑุฏ ุฃู ุชููู ุฑุงุถููุง ุนู ุงูููุฏ ุงูุฎุงุต ุจูุ ูููู ูุดุฑู ุฅูู ุงูุณุญุงุจุฉ.

ุฃุฏูุงุช Azure Functions ูุชููุฑุฉ ููุงุฌูุฉ ุณุทุฑ ุฃูุงูุฑ (CLI)ุ ุชูุนุฑู ุจุงุณู Azure Functions Core Tools.

1. ูู ุจุชุซุจูุช ุฃุฏูุงุช Azure Functions Core Tools ุจุงุชุจุงุน ุงูุชุนูููุงุช ุงูููุฌูุฏุฉ ูู [ูุซุงุฆู Azure Functions Core Tools](https://docs.microsoft.com/azure/azure-functions/functions-run-local?WT.mc_id=academic-17441-jabenn).

2. ูู ุจุชุซุจูุช ุฅุถุงูุฉ Azure Functions ูู VS Code. ุชููุฑ ูุฐู ุงูุฅุถุงูุฉ ุฏุนููุง ูุฅูุดุงุก ูุชุตุญูุญ ููุดุฑ ูุธุงุฆู Azure. ุฑุงุฌุน [ูุซุงุฆู ุฅุถุงูุฉ Azure Functions](https://marketplace.visualstudio.com/items?WT.mc_id=academic-17441-jabenn&itemName=ms-azuretools.vscode-azurefunctions) ููุญุตูู ุนูู ุชุนูููุงุช ุญูู ุชุซุจูุช ูุฐู ุงูุฅุถุงูุฉ ูู VS Code.

ุนูุฏูุง ุชููู ุจูุดุฑ ุชุทุจูู Azure Functions ุงูุฎุงุต ุจู ุฅูู ุงูุณุญุงุจุฉุ ูุฅูู ูุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ูููุฉ ุตุบูุฑุฉ ูู ุงูุชุฎุฒูู ุงูุณุญุงุจู ูุชุฎุฒูู ุฃุดูุงุก ูุซู ูููุงุช ุงูุชุทุจูู ููููุงุช ุงูุณุฌู. ุนูุฏูุง ุชููู ุจุชุดุบูู ุชุทุจูู ุงููุธุงุฆู ุงูุฎุงุต ุจู ูุญูููุงุ ูุง ูุฒุงู ูุชุนูู ุนููู ุงูุงุชุตุงู ุจุงูุชุฎุฒูู ุงูุณุญุงุจูุ ูููู ุจุฏูุงู ูู ุงุณุชุฎุฏุงู ุงูุชุฎุฒูู ุงูุณุญุงุจู ุงููุนููุ ููููู ุงุณุชุฎุฏุงู ูุญุงูู ุชุฎุฒูู ูุณูู [Azurite](https://github.com/Azure/Azurite). ูุนูู ูุฐุง ุงููุญุงูู ูุญูููุง ููููู ูุชุตุฑู ูุซู ุงูุชุฎุฒูู ุงูุณุญุงุจู.

> ๐ ูู Azureุ ุงูุชุฎุฒูู ุงูุฐู ุชุณุชุฎุฏูู Azure Functions ูู ุญุณุงุจ ุชุฎุฒูู Azure. ูููู ููุฐู ุงูุญุณุงุจุงุช ุชุฎุฒูู ุงููููุงุชุ ุงููุชูุ ุงูุจูุงูุงุช ูู ุงูุฌุฏุงูู ุฃู ุงูุจูุงูุงุช ูู ููุงุฆู ุงูุงูุชุธุงุฑ. ููููู ูุดุงุฑูุฉ ุญุณุงุจ ุชุฎุฒูู ูุงุญุฏ ุจูู ุงูุนุฏูุฏ ูู ุงูุชุทุจููุงุชุ ูุซู ุชุทุจูู ูุธุงุฆู ูุชุทุจูู ููุจ.

1. Azurite ูู ุชุทุจูู Node.jsุ ูุฐุง ุณุชุญุชุงุฌ ุฅูู ุชุซุจูุช Node.js. ููููู ุงูุนุซูุฑ ุนูู ุชุนูููุงุช ุงูุชูุฒูู ูุงูุชุซุจูุช ุนูู [ูููุน Node.js](https://nodejs.org/). ุฅุฐุง ููุช ุชุณุชุฎุฏู ุฌูุงุฒ Macุ ููููู ุฃูุถูุง ุชุซุจูุชู ูู [Homebrew](https://formulae.brew.sh/formula/node).

2. ูู ุจุชุซุจูุช Azurite ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ ุงูุชุงูู (`npm` ูู ุฃุฏุงุฉ ูุชู ุชุซุจูุชูุง ุนูุฏ ุชุซุจูุช Node.js):

    ```sh
    npm install -g azurite
    ```

3. ูู ุจุฅูุดุงุก ูุฌูุฏ ูุณูู `azurite` ููุณุชุฎุฏูู Azurite ูุชุฎุฒูู ุงูุจูุงูุงุช:

    ```sh
    mkdir azurite
    ```

4. ูู ุจุชุดุบูู Azuriteุ ูุน ุชูุฑูุฑ ูุฐุง ุงููุฌูุฏ ุงูุฌุฏูุฏ:

    ```sh
    azurite --location azurite
    ```

    ุณูุจุฏุฃ ูุญุงูู ุงูุชุฎุฒูู Azurite ูุณูููู ุฌุงูุฒูุง ูุงุชุตุงู ุจูุฆุฉ ุงูุชุดุบูู ุงููุญููุฉ ูููุธุงุฆู.

    ```output
    โ  ~ azurite --location azurite  
    Azurite Blob service is starting at http://127.0.0.1:10000
    Azurite Blob service is successfully listening at http://127.0.0.1:10000
    Azurite Queue service is starting at http://127.0.0.1:10001
    Azurite Queue service is successfully listening at http://127.0.0.1:10001
    Azurite Table service is starting at http://127.0.0.1:10002
    Azurite Table service is successfully listening at http://127.0.0.1:10002
    ```

### ุงููููุฉ - ุฅูุดุงุก ูุดุฑูุน Azure Functions

ูููู ุงุณุชุฎุฏุงู CLI ุงูุฎุงุต ุจู Azure Functions ูุฅูุดุงุก ุชุทุจูู ูุธุงุฆู ุฌุฏูุฏ.

1. ูู ุจุฅูุดุงุก ูุฌูุฏ ูุชุทุจูู ุงููุธุงุฆู ุงูุฎุงุต ุจู ูุงูุชูู ุฅููู. ูู ุจุชุณููุชู `soil-moisture-trigger`:

    ```sh
    mkdir soil-moisture-trigger
    cd soil-moisture-trigger
    ```

2. ูู ุจุฅูุดุงุก ุจูุฆุฉ ุงูุชุฑุงุถูุฉ ูู Python ุฏุงุฎู ูุฐุง ุงููุฌูุฏ:

    ```sh
    python3 -m venv .venv
    ```

3. ูู ุจุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ:

    * ุนูู Windows:
        * ุฅุฐุง ููุช ุชุณุชุฎุฏู Command Promptุ ุฃู Command Prompt ูู ุฎูุงู Windows Terminalุ ูู ุจุชุดุบูู:

            ```cmd
            .venv\Scripts\activate.bat
            ```

        * ุฅุฐุง ููุช ุชุณุชุฎุฏู PowerShellุ ูู ุจุชุดุบูู:

            ```powershell
            .\.venv\Scripts\Activate.ps1
            ```

    * ุนูู macOS ุฃู Linuxุ ูู ุจุชุดุบูู:

        ```cmd
        source ./.venv/bin/activate
        ```

    > ๐ ูุฌุจ ุชุดุบูู ูุฐู ุงูุฃูุงูุฑ ูู ููุณ ุงููููุน ุงูุฐู ููุช ููู ุจุชุดุบูู ุงูุฃูุฑ ูุฅูุดุงุก ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ. ูู ุชุญุชุงุฌ ุฃุจุฏูุง ุฅูู ุงูุงูุชูุงู ุฅูู ูุฌูุฏ `.venv`ุ ูุฌุจ ุนููู ุฏุงุฆููุง ุชุดุบูู ุฃูุฑ ุงูุชูุนูู ูุฃู ุฃูุงูุฑ ูุชุซุจูุช ุงูุญุฒู ุฃู ุชุดุบูู ุงูููุฏ ูู ุงููุฌูุฏ ุงูุฐู ููุช ููู ุนูุฏ ุฅูุดุงุก ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ.

4. ูู ุจุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู ูุฅูุดุงุก ุชุทุจูู ูุธุงุฆู ุฏุงุฎู ูุฐุง ุงููุฌูุฏ:

    ```sh
    func init --worker-runtime python soil-moisture-trigger
    ```

    ุณูุคุฏู ูุฐุง ุฅูู ุฅูุดุงุก ุซูุงุซุฉ ูููุงุช ุฏุงุฎู ุงููุฌูุฏ ุงูุญุงูู:

    * `host.json` - ูุฐุง ุงููุณุชูุฏ JSON ูุญุชูู ุนูู ุฅุนุฏุงุฏุงุช ุชุทุจูู ุงููุธุงุฆู ุงูุฎุงุต ุจู. ูู ุชุญุชุงุฌ ุฅูู ุชุนุฏูู ูุฐู ุงูุฅุนุฏุงุฏุงุช.
    * `local.settings.json` - ูุฐุง ุงููุณุชูุฏ JSON ูุญุชูู ุนูู ุงูุฅุนุฏุงุฏุงุช ุงูุชู ุณูุณุชุฎุฏููุง ุงูุชุทุจูู ุนูุฏ ุงูุชุดุบูู ูุญูููุงุ ูุซู ุณูุงุณู ุงูุงุชุตุงู ุจู IoT Hub. ูุฐู ุงูุฅุนุฏุงุฏุงุช ูุญููุฉ ููุทุ ููุง ููุจุบู ุฅุถุงูุชูุง ุฅูู ุงูุชุญูู ูู ุงูุดููุฑุฉ ุงููุตุฏุฑูุฉ. ุนูุฏูุง ุชููู ุจูุดุฑ ุงูุชุทุจูู ุฅูู ุงูุณุญุงุจุฉุ ูู ูุชู ูุดุฑ ูุฐู ุงูุฅุนุฏุงุฏุงุชุ ุจุฏูุงู ูู ุฐูู ุณูุชู ุชุญููู ุงูุฅุนุฏุงุฏุงุช ุงูุฎุงุตุฉ ุจู ูู ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู. ุณูุชู ุชุบุทูุฉ ูุฐุง ูุงุญููุง ูู ูุฐุง ุงูุฏุฑุณ.
    * `requirements.txt` - ูุฐุง ูู [ููู ูุชุทูุจุงุช Pip](https://pip.p
> โ๏ธ ุฅุฐุง ุธูุฑุช ูู ุฅุดุนุงุฑ ุฌุฏุงุฑ ุงูุญูุงูุฉุ ุงููุญ ุงููุตูู ูุฃู ุชุทุจูู `func` ูุญุชุงุฌ ุฅูู ุงููุฏุฑุฉ ุนูู ุงููุฑุงุกุฉ ูุงููุชุงุจุฉ ุนูู ุดุจูุชู.
> โ๏ธ ุฅุฐุง ููุช ุชุณุชุฎุฏู macOSุ ูุฏ ุชุธูุฑ ุชุญุฐูุฑุงุช ูู ุงููุฎุฑุฌุงุช:
>
> ```output
    > (.venv) โ  soil-moisture-trigger func start
    > Found Python version 3.9.1 (python3).
    >
    > Azure Functions Core Tools
    > Core Tools Version:       3.0.3442 Commit hash: 6bfab24b2743f8421475d996402c398d2fe4a9e0  (64-bit)
    > Function Runtime Version: 3.0.15417.0
    >
    > [2021-06-16T08:18:28.315Z] Cannot create directory for shared memory usage: /dev/shm/AzureFunctions
    > [2021-06-16T08:18:28.316Z] System.IO.FileSystem: Access to the path '/dev/shm/AzureFunctions' is denied. Operation not permitted.
    > [2021-06-16T08:18:30.361Z] No job functions found.
    > ```
>
> ููููู ุชุฌุงูู ูุฐู ุงูุชุญุฐูุฑุงุช ุทุงููุง ุฃู ุชุทุจูู Functions ูุนูู ุจุดูู ุตุญูุญ ููุนุฑุถ ุงููุธุงุฆู ุงูุฌุงุฑูุฉ. ููุง ูู ูุฐููุฑ ูู [ูุฐุง ุงูุณุคุงู ุนูู Microsoft Docs Q&A](https://docs.microsoft.com/answers/questions/396617/azure-functions-core-tools-error-osx-devshmazurefu.html?WT.mc_id=academic-17441-jabenn)ุ ูููู ุชุฌุงูููุง.

1. ุฃููู ุชุดุบูู ุชุทุจูู Functions ุจุงูุถุบุท ุนูู `ctrl+c`.

1. ุงูุชุญ ุงููุฌูุฏ ุงูุญุงูู ูู VS Codeุ ุฅูุง ุนู ุทุฑูู ูุชุญ VS Code ุซู ูุชุญ ูุฐุง ุงููุฌูุฏุ ุฃู ุนู ุทุฑูู ุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู:

    ```sh
    code .
    ```

    ุณููุชุดู VS Code ูุดุฑูุน Functions ุงูุฎุงุต ุจู ููุนุฑุถ ุฅุดุนุงุฑูุง ูููู:

    ```output
    Detected an Azure Functions Project in folder "soil-moisture-trigger" that may have been created outside of
    VS Code. Initialize for optimal use with VS Code?
    ```

    ![ุงูุฅุดุนุงุฑ](../../../../../translated_images/vscode-azure-functions-init-notification.bd19b49229963edb5311fb3a79445ea469424759d2917ee2f2eb6f92d65d5086.ar.png)

    ุงุฎุชุฑ **Yes** ูู ูุฐุง ุงูุฅุดุนุงุฑ.

1. ุชุฃูุฏ ูู ุฃู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ูู Python ุชุนูู ูู ุงูุทุฑููุฉ ุฏุงุฎู VS Code. ูู ุจุฅููุงุฆูุง ูุฃุนุฏ ุชุดุบูููุง ุฅุฐุง ูุฒู ุงูุฃูุฑ.

## ุฅูุดุงุก ูุดุบู ุญุฏุซ IoT Hub

ุชุทุจูู Functions ูู ุงูุฅุทุงุฑ ุงูุฎุงุฑุฌู ูููุฏู ุงูุฎุงูู ูู ุงูุฎูุงุฏู. ููุฑุฏ ุนูู ุฃุญุฏุงุซ IoT Hubุ ููููู ุฅุถุงูุฉ ูุดุบู IoT Hub ุฅูู ูุฐุง ุงูุชุทุจูู. ูุญุชุงุฌ ูุฐุง ุงููุดุบู ุฅูู ุงูุงุชุตุงู ุจุชุฏูู ุงูุฑุณุงุฆู ุงููุฑุณูุฉ ุฅูู IoT Hub ูุงูุฑุฏ ุนูููุง. ููุญุตูู ุนูู ูุฐุง ุงูุชุฏูู ูู ุงูุฑุณุงุฆูุ ูุฌุจ ุฃู ูุชุตู ุงููุดุบู ุจููุทุฉ ุงูููุงูุฉ ุงููุชูุงููุฉ ูุน Event Hub ุงูุฎุงุตุฉ ุจู IoT Hub.

ูุนุชูุฏ IoT Hub ุนูู ุฎุฏูุฉ Azure ุฃุฎุฑู ุชูุณูู Azure Event Hubs. Event Hubs ูู ุฎุฏูุฉ ุชุชูุญ ุฅุฑุณุงู ูุงุณุชูุจุงู ุงูุฑุณุงุฆูุ ุจูููุง ูุถูู IoT Hub ููุฒุงุช ุฅุถุงููุฉ ููุฃุฌูุฒุฉ ุงููุชุตูุฉ ุจุงูุฅูุชุฑูุช. ุทุฑููุฉ ุงูุงุชุตุงู ููุฑุงุกุฉ ุงูุฑุณุงุฆู ูู IoT Hub ูู ููุณูุง ููุง ูู ููุช ุชุณุชุฎุฏู Event Hubs.

โ ูู ุจุจุนุถ ุงูุจุญุซ: ุงูุฑุฃ ูุธุฑุฉ ุนุงูุฉ ุนูู Event Hubs ูู [ูุซุงุฆู Azure Event Hubs](https://docs.microsoft.com/azure/event-hubs/event-hubs-about?WT.mc_id=academic-17441-jabenn). ููู ุชูุงุฑู ุงูููุฒุงุช ุงูุฃุณุงุณูุฉ ูุน IoT Hubุ

ููู ูุชุตู ุฌูุงุฒ IoT ุจู IoT Hubุ ูุฌุจ ุฃู ูุณุชุฎุฏู ููุชุงุญูุง ุณุฑููุง ูุถูู ุฃู ุงูุฃุฌูุฒุฉ ุงููุตุฑุญ ููุง ููุท ูููููุง ุงูุงุชุตุงู. ููุทุจู ููุณ ุงูุฃูุฑ ุนูุฏ ุงูุงุชุตุงู ููุฑุงุกุฉ ุงูุฑุณุงุฆูุ ุญูุซ ุณูุญุชุงุฌ ููุฏู ุฅูู ุณูุณูุฉ ุงุชุตุงู ุชุญุชูู ุนูู ููุชุงุญ ุณุฑูุ ุจุงูุฅุถุงูุฉ ุฅูู ุชูุงุตูู IoT Hub.

> ๐ ุณูุณูุฉ ุงูุงุชุตุงู ุงูุงูุชุฑุงุถูุฉ ุงูุชู ุชุญุตู ุนูููุง ุชุญุชูู ุนูู ุฃุฐููุงุช **iothubowner**ุ ููุง ูููุญ ุฃู ููุฏ ูุณุชุฎุฏููุง ุฃุฐููุงุช ูุงููุฉ ุนูู IoT Hub. ูู ุงูุฃูุถู ุฃู ุชุชุตู ุจุฃูู ูุณุชูู ูู ุงูุฃุฐููุงุช ุงููุทููุจุฉ. ุณูุชู ุชุบุทูุฉ ูุฐุง ูู ุงูุฏุฑุณ ุงูุชุงูู.

ุจูุฌุฑุฏ ุฃู ูุชุตู ุงููุดุบูุ ุณูุชู ุงุณุชุฏุนุงุก ุงูููุฏ ุฏุงุฎู ุงููุธููุฉ ููู ุฑุณุงูุฉ ูุชู ุฅุฑุณุงููุง ุฅูู IoT Hubุ ุจุบุถ ุงููุธุฑ ุนู ุงูุฌูุงุฒ ุงูุฐู ุฃุฑุณููุง. ุณูุชู ุชูุฑูุฑ ุงูุฑุณุงูุฉ ุฅูู ุงููุดุบู ููุนุงูู.

### ุงููููุฉ - ุงูุญุตูู ุนูู ุณูุณูุฉ ุงุชุตุงู ููุทุฉ ุงูููุงูุฉ ุงููุชูุงููุฉ ูุน Event Hub

1. ูู ุงูุทุฑููุฉ ูู VS Codeุ ูู ุจุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู ููุญุตูู ุนูู ุณูุณูุฉ ุงูุงุชุตุงู ูููุทุฉ ุงูููุงูุฉ ุงููุชูุงููุฉ ูุน Event Hub ุงูุฎุงุตุฉ ุจู IoT Hub:

    ```sh
    az iot hub connection-string show --default-eventhub \
                                      --output table \
                                      --hub-name <hub_name>
    ```

    ุงุณุชุจุฏู `<hub_name>` ุจุงุณู IoT Hub ุงูุฐู ุงุณุชุฎุฏูุชู.

1. ูู VS Codeุ ุงูุชุญ ููู `local.settings.json`. ุฃุถู ุงููููุฉ ุงูุฅุถุงููุฉ ุงูุชุงููุฉ ุฏุงุฎู ูุณู `Values`:

    ```json
    "IOT_HUB_CONNECTION_STRING": "<connection string>"
    ```

    ุงุณุชุจุฏู `<connection string>` ุจุงููููุฉ ูู ุงูุฎุทูุฉ ุงูุณุงุจูุฉ. ุณุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ูุงุตูุฉ ุจุนุฏ ุงูุณุทุฑ ุงูุณุงุจู ูุฌุนู ูุฐุง JSON ุตุงูุญูุง.

### ุงููููุฉ - ุฅูุดุงุก ูุดุบู ุญุฏุซ

ุฃูุช ุงูุขู ุฌุงูุฒ ูุฅูุดุงุก ูุดุบู ุงูุญุฏุซ.

1. ูู ุงูุทุฑููุฉ ูู VS Codeุ ูู ุจุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู ูู ุฏุงุฎู ูุฌูุฏ `soil-moisture-trigger`:

    ```sh
    func new --name iot-hub-trigger --template "Azure Event Hub trigger"
    ```

    ุณูุคุฏู ูุฐุง ุฅูู ุฅูุดุงุก ูุธููุฉ ุฌุฏูุฏุฉ ุชูุณูู `iot-hub-trigger`. ุณูุชุตู ุงููุดุบู ุจููุทุฉ ุงูููุงูุฉ ุงููุชูุงููุฉ ูุน Event Hub ุนูู IoT Hubุ ูุฐุง ููููู ุงุณุชุฎุฏุงู ูุดุบู Event Hub. ูุง ููุฌุฏ ูุดุบู ูุญุฏุฏ ูู IoT Hub.

ุณูุชู ุฅูุดุงุก ูุฌูุฏ ุฏุงุฎู ูุฌูุฏ `soil-moisture-trigger` ููุณูู `iot-hub-trigger` ูุญุชูู ุนูู ูุฐู ุงููุธููุฉ. ุณูุญุชูู ูุฐุง ุงููุฌูุฏ ุนูู ุงููููุงุช ุงูุชุงููุฉ:

* `__init__.py` - ูุฐุง ูู ููู ููุฏ Python ุงูุฐู ูุญุชูู ุนูู ุงููุดุบูุ ุจุงุณุชุฎุฏุงู ุชุณููุฉ ูููุงุช Python ุงูููุงุณูุฉ ูุชุญููู ูุฐุง ุงููุฌูุฏ ุฅูู ูุญุฏุฉ Python.

    ุณูุญุชูู ูุฐุง ุงูููู ุนูู ุงูููุฏ ุงูุชุงูู:

    ```python
    import logging

    import azure.functions as func


    def main(event: func.EventHubEvent):
        logging.info('Python EventHub trigger processed an event: %s',
                    event.get_body().decode('utf-8'))
    ```

    ุฌููุฑ ุงููุดุบู ูู ูุธููุฉ `main`. ูุชู ุงุณุชุฏุนุงุก ูุฐู ุงููุธููุฉ ูุน ุงูุฃุญุฏุงุซ ูู IoT Hub. ุชุญุชูู ูุฐู ุงููุธููุฉ ุนูู ูุนุงูู ููุณูู `event` ูุญุชูู ุนูู `EventHubEvent`. ูู ูู ูุฑุฉ ูุชู ูููุง ุฅุฑุณุงู ุฑุณุงูุฉ ุฅูู IoT Hubุ ูุชู ุงุณุชุฏุนุงุก ูุฐู ุงููุธููุฉ ูุชูุฑูุฑ ุชูู ุงูุฑุณุงูุฉ ูู `event`ุ ุฅูู ุฌุงูุจ ุงูุฎุตุงุฆุต ุงูุชู ุชุดุจู ุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ ุงูุชู ุฑุฃูุชูุง ูู ุงูุฏุฑุณ ุงูุณุงุจู.

    ุฌููุฑ ูุฐู ุงููุธููุฉ ูููู ุจุชุณุฌูู ุงูุญุฏุซ.

* `function.json` - ูุญุชูู ูุฐุง ุงูููู ุนูู ุชูููู ุงููุดุบู. ุงูุชูููู ุงูุฑุฆูุณู ููุฌูุฏ ูู ูุณู ููุณูู `bindings`. ุงูุฑุจุท ูู ุงููุตุทูุญ ุงููุณุชุฎุฏู ููุตู ุงูุงุชุตุงู ุจูู Azure Functions ูุงูุฎุฏูุงุช ุงูุฃุฎุฑู ูู Azure. ุชุญุชูู ูุฐู ุงููุธููุฉ ุนูู ุฑุจุท ุฅุฏุฎุงู ุฅูู Event Hub - ุญูุซ ุชุชุตู ุจู Event Hub ูุชุชููู ุงูุจูุงูุงุช.

    > ๐ ููููู ุฃูุถูุง ุงูุญุตูู ุนูู ุฑูุงุจุท ุฅุฎุฑุงุฌ ุจุญูุซ ูุชู ุฅุฑุณุงู ูุฎุฑุฌุงุช ุงููุธููุฉ ุฅูู ุฎุฏูุฉ ุฃุฎุฑู. ุนูู ุณุจูู ุงููุซุงูุ ููููู ุฅุถุงูุฉ ุฑุจุท ุฅุฎุฑุงุฌ ุฅูู ูุงุนุฏุฉ ุจูุงูุงุช ูุฅุฑุฌุงุน ุญุฏุซ IoT Hub ูู ุงููุธููุฉุ ูุณูุชู ุฅุฏุฎุงูู ุชููุงุฆููุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.

    โ ูู ุจุจุนุถ ุงูุจุญุซ: ุงูุฑุฃ ุนู ุงูุฑูุงุจุท ูู [ูุซุงุฆู ููุงููู ุงููุดุบูุงุช ูุงูุฑูุงุจุท ูู Azure Functions](https://docs.microsoft.com/azure/azure-functions/functions-triggers-bindings?WT.mc_id=academic-17441-jabenn&tabs=python).

    ูุชุถูู ูุณู `bindings` ุชูููู ุงูุฑุจุท. ุงูููู ุฐุงุช ุงูุฃูููุฉ ูู:

  * `"type": "eventHubTrigger"` - ูุดูุฑ ูุฐุง ุฅูู ุฃู ุงููุธููุฉ ุชุญุชุงุฌ ุฅูู ุงูุงุณุชูุงุน ุฅูู ุงูุฃุญุฏุงุซ ูู Event Hub
  * `"name": "events"` - ูุฐุง ูู ุงุณู ุงููุนุงูู ุงููุณุชุฎุฏู ูุฃุญุฏุงุซ Event Hub. ูุชุทุงุจู ูุฐุง ูุน ุงุณู ุงููุนุงูู ูู ูุธููุฉ `main` ูู ููุฏ Python.
  * `"direction": "in"` - ูุฐุง ูู ุฑุจุท ุฅุฏุฎุงูุ ุญูุซ ุชุฃุชู ุงูุจูุงูุงุช ูู Event Hub ุฅูู ุงููุธููุฉ
  * `"connection": ""` - ูุญุฏุฏ ูุฐุง ุงุณู ุงูุฅุนุฏุงุฏ ููุฑุงุกุฉ ุณูุณูุฉ ุงูุงุชุตุงู ููู. ุนูุฏ ุงูุชุดุบูู ูุญูููุงุ ุณููุฑุฃ ูุฐุง ุงูุฅุนุฏุงุฏ ูู ููู `local.settings.json`.

    > ๐ ูุง ูููู ุชุฎุฒูู ุณูุณูุฉ ุงูุงุชุตุงู ูู ููู `function.json`ุ ุจู ูุฌุจ ูุฑุงุกุชูุง ูู ุงูุฅุนุฏุงุฏุงุช. ูุฐุง ูููุนู ูู ูุดู ุณูุณูุฉ ุงูุงุชุตุงู ุนู ุทุฑูู ุงูุฎุทุฃ.

1. ุจุณุจุจ [ุฎุทุฃ ูู ูุงูุจ Azure Functions](https://github.com/Azure/azure-functions-templates/issues/1250)ุ ูุญุชูู ููู `function.json` ุนูู ูููุฉ ุบูุฑ ุตุญูุญุฉ ูุญูู `cardinality`. ูู ุจุชุญุฏูุซ ูุฐุง ุงูุญูู ูู `many` ุฅูู `one`:

    ```json
    "cardinality": "one",
    ```

1. ูู ุจุชุญุฏูุซ ูููุฉ `"connection"` ูู ููู `function.json` ููุฅุดุงุฑุฉ ุฅูู ุงููููุฉ ุงูุฌุฏูุฏุฉ ุงูุชู ุฃุถูุชูุง ุฅูู ููู `local.settings.json`:

    ```json
    "connection": "IOT_HUB_CONNECTION_STRING",
    ```

    > ๐ ุชุฐูุฑ - ูุฌุจ ุฃู ุชุดูุฑ ูุฐู ุงููููุฉ ุฅูู ุงูุฅุนุฏุงุฏุ ูููุณ ุฃู ุชุญุชูู ุนูู ุณูุณูุฉ ุงูุงุชุตุงู ุงููุนููุฉ.

1. ุชุญุชูู ุณูุณูุฉ ุงูุงุชุตุงู ุนูู ูููุฉ `eventHubName`ุ ูุฐุง ูุฌุจ ูุณุญ ุงููููุฉ ุงูุฎุงุตุฉ ุจูุง ูู ููู `function.json`. ูู ุจุชุญุฏูุซ ูุฐู ุงููููุฉ ุฅูู ุณูุณูุฉ ูุงุฑุบุฉ:

    ```json
    "eventHubName": "",
    ```

### ุงููููุฉ - ุชุดุบูู ูุดุบู ุงูุญุฏุซ

1. ุชุฃูุฏ ูู ุฃูู ูุง ุชููู ุจุชุดุบูู ูุฑุงูุจ ุฃุญุฏุงุซ IoT Hub. ุฅุฐุง ูุงู ูุฐุง ูุนูู ูู ููุณ ุงูููุช ูุน ุชุทุจูู Functionsุ ููู ูุชููู ุชุทุจูู Functions ูู ุงูุงุชุตุงู ูุงุณุชููุงู ุงูุฃุญุฏุงุซ.

    > ๐ ูููู ูุชุทุจููุงุช ูุชุนุฏุฏุฉ ุงูุงุชุตุงู ุจููุงุท ููุงูุฉ IoT Hub ุจุงุณุชุฎุฏุงู *ูุฌููุนุงุช ูุณุชููููู* ูุฎุชููุฉ. ุณูุชู ุชุบุทูุฉ ูุฐู ูู ุฏุฑุณ ูุงุญู.

1. ูุชุดุบูู ุชุทุจูู Functionsุ ูู ุจุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู ูู ุงูุทุฑููุฉ ูู VS Code:

    ```sh
    func start
    ```

    ุณูุจุฏุฃ ุชุทุจูู Functionsุ ูุณููุชุดู ูุธููุฉ `iot-hub-trigger`. ุจุนุฏ ุฐููุ ุณูุนุงูุฌ ุฃู ุฃุญุฏุงุซ ุชู ุฅุฑุณุงููุง ุจุงููุนู ุฅูู IoT Hub ุฎูุงู ุงูููู ุงููุงุถู.

    ```output
    (.venv) โ  soil-moisture-trigger func start
    Found Python version 3.9.1 (python3).
    
    Azure Functions Core Tools
    Core Tools Version:       3.0.3442 Commit hash: 6bfab24b2743f8421475d996402c398d2fe4a9e0  (64-bit)
    Function Runtime Version: 3.0.15417.0
    
    Functions:
    
            iot-hub-trigger: eventHubTrigger
    
    For detailed output, run func with --verbose flag.
    [2021-05-05T02:44:07.517Z] Worker process started and initialized.
    [2021-05-05T02:44:09.202Z] Executing 'Functions.iot-hub-trigger' (Reason='(null)', Id=802803a5-eae9-4401-a1f4-176631456ce4)
    [2021-05-05T02:44:09.205Z] Trigger Details: PartitionId: 0, Offset: 1011240-1011632, EnqueueTimeUtc: 2021-05-04T19:04:04.2030000Z-2021-05-04T19:04:04.3900000Z, SequenceNumber: 2546-2547, Count: 2
    [2021-05-05T02:44:09.352Z] Python EventHub trigger processed an event: {"soil_moisture":628}
    [2021-05-05T02:44:09.354Z] Python EventHub trigger processed an event: {"soil_moisture":624}
    [2021-05-05T02:44:09.395Z] Executed 'Functions.iot-hub-trigger' (Succeeded, Id=802803a5-eae9-4401-a1f4-176631456ce4, Duration=245ms)
    ```

    ุณูุชู ุฅุญุงุทุฉ ูู ุงุณุชุฏุนุงุก ูููุธููุฉ ุจูุชูุฉ `Executing 'Functions.iot-hub-trigger'`/`Executed 'Functions.iot-hub-trigger'` ูู ุงููุฎุฑุฌุงุชุ ุจุญูุซ ููููู ูุนุฑูุฉ ุนุฏุฏ ุงูุฑุณุงุฆู ุงูุชู ุชูุช ูุนุงูุฌุชูุง ูู ูู ุงุณุชุฏุนุงุก ูููุธููุฉ.

1. ุชุฃูุฏ ูู ุฃู ุฌูุงุฒ IoT ุงูุฎุงุต ุจู ูุนูู. ุณุชุฑู ุฑุณุงุฆู ุฌุฏูุฏุฉ ุนู ุฑุทูุจุฉ ุงูุชุฑุจุฉ ุชุธูุฑ ูู ุชุทุจูู Functions.

1. ุฃููู ูุฃุนุฏ ุชุดุบูู ุชุทุจูู Functions. ุณุชุฑู ุฃูู ูู ูุนุงูุฌ ุงูุฑุณุงุฆู ุงูุณุงุจูุฉ ูุฑุฉ ุฃุฎุฑูุ ุจู ุณูุนุงูุฌ ุงูุฑุณุงุฆู ุงูุฌุฏูุฏุฉ ููุท.

> ๐ ูุฏุนู VS Code ุฃูุถูุง ุชุตุญูุญ ุงูุฃุฎุทุงุก ูู ูุธุงุฆูู. ููููู ุชุนููู ููุงุท ุชููู ุจุงูููุฑ ุนูู ุงูุญุงูุฉ ุจุฌุงูุจ ุจุฏุงูุฉ ูู ุณุทุฑ ูู ุงูููุฏุ ุฃู ูุถุน ุงููุคุดุฑ ุนูู ุณุทุฑ ุงูููุฏ ูุงุฎุชูุงุฑ *Run -> Toggle breakpoint*ุ ุฃู ุงูุถุบุท ุนูู `F9`. ููููู ุชุดุบูู ุงููุตุญุญ ุจุงุฎุชูุงุฑ *Run -> Start debugging*ุ ุฃู ุงูุถุบุท ุนูู `F5`ุ ุฃู ุงุฎุชูุงุฑ ููุญุฉ *Run and debug* ูุงุฎุชูุงุฑ ุฒุฑ **Start debugging**. ูู ุฎูุงู ุงูููุงู ุจุฐููุ ููููู ุฑุคูุฉ ุชูุงุตูู ุงูุฃุญุฏุงุซ ุงูุชู ุชุชู ูุนุงูุฌุชูุง.

#### ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง

* ุฅุฐุง ุญุตูุช ุนูู ุงูุฎุทุฃ ุงูุชุงูู:

    ```output
    The listener for function 'Functions.iot-hub-trigger' was unable to start. Microsoft.WindowsAzure.Storage: Connection refused. System.Net.Http: Connection refused. System.Private.CoreLib: Connection refused.
    ```

    ุชุญูู ูู ุฃู Azurite ูุนูู ูุฃูู ููุช ุจุชุนููู `AzureWebJobsStorage` ูู ููู `local.settings.json` ุฅูู `UseDevelopmentStorage=true`.

* ุฅุฐุง ุญุตูุช ุนูู ุงูุฎุทุฃ ุงูุชุงูู:

    ```output
    System.Private.CoreLib: Exception while executing function: Functions.iot-hub-trigger. System.Private.CoreLib: Result: Failure Exception: AttributeError: 'list' object has no attribute 'get_body'
    ```

    ุชุญูู ูู ุฃูู ููุช ุจุชุนููู `cardinality` ูู ููู `function.json` ุฅูู `one`.

* ุฅุฐุง ุญุตูุช ุนูู ุงูุฎุทุฃ ุงูุชุงูู:

    ```output
    Azure.Messaging.EventHubs: The path to an Event Hub may be specified as part of the connection string or as a separate value, but not both.  Please verify that your connection string does not have the `EntityPath` token if you are passing an explicit Event Hub name. (Parameter 'connectionString').
    ```

    ุชุญูู ูู ุฃูู ููุช ุจุชุนููู `eventHubName` ูู ููู `function.json` ุฅูู ุณูุณูุฉ ูุงุฑุบุฉ.

## ุฅุฑุณุงู ุทูุจุงุช ุทุฑููุฉ ูุจุงุดุฑุฉ ูู ุงูููุฏ ุงูุฎุงูู ูู ุงูุฎูุงุฏู

ุญุชู ุงูุขูุ ูุณุชูุน ุชุทุจูู Functions ุงูุฎุงุต ุจู ุฅูู ุงูุฑุณุงุฆู ูู IoT Hub ุจุงุณุชุฎุฏุงู ููุทุฉ ุงูููุงูุฉ ุงููุชูุงููุฉ ูุน Event Hub. ุงูุขู ุชุญุชุงุฌ ุฅูู ุฅุฑุณุงู ุฃูุงูุฑ ุฅูู ุฌูุงุฒ IoT. ูุชู ุฐูู ุจุงุณุชุฎุฏุงู ุงุชุตุงู ูุฎุชูู ุจู IoT Hub ุนุจุฑ *ูุฏูุฑ ุงูุณุฌู*. ูุฏูุฑ ุงูุณุฌู ูู ุฃุฏุงุฉ ุชุชูุญ ูู ุฑุคูุฉ ุงูุฃุฌูุฒุฉ ุงููุณุฌูุฉ ูุน IoT Hubุ ูุงูุชูุงุตู ูุน ุชูู ุงูุฃุฌูุฒุฉ ุนู ุทุฑูู ุฅุฑุณุงู ุฑุณุงุฆู ูู ุงูุณุญุงุจุฉ ุฅูู ุงูุฌูุงุฒุ ุฃู ุทูุจุงุช ุทุฑููุฉ ูุจุงุดุฑุฉุ ุฃู ุชุญุฏูุซ ุงูุชูุฃู ุงูุฑููู ููุฌูุงุฒ. ููููู ุฃูุถูุง ุงุณุชุฎุฏุงูู ูุชุณุฌูู ุฃู ุชุญุฏูุซ ุฃู ุญุฐู ุฃุฌูุฒุฉ IoT ูู IoT Hub.

ููุงุชุตุงู ุจูุฏูุฑ ุงูุณุฌูุ ุชุญุชุงุฌ ุฅูู ุณูุณูุฉ ุงุชุตุงู.

### ุงููููุฉ - ุงูุญุตูู ุนูู ุณูุณูุฉ ุงุชุตุงู ูุฏูุฑ ุงูุณุฌู

1. ููุญุตูู ุนูู ุณูุณูุฉ ุงูุงุชุตุงูุ ูู ุจุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู:

    ```sh
    az iot hub connection-string show --policy-name service \
                                      --output table \
                                      --hub-name <hub_name>
    ```

    ุงุณุชุจุฏู `<hub_name>` ุจุงุณู IoT Hub ุงูุฐู ุงุณุชุฎุฏูุชู.

    ูุชู ุทูุจ ุณูุณูุฉ ุงูุงุชุตุงู ูุณูุงุณุฉ *ServiceConnect* ุจุงุณุชุฎุฏุงู ุงููุนุงูู `--policy-name service`. ุนูุฏ ุทูุจ ุณูุณูุฉ ุงุชุตุงูุ ููููู ุชุญุฏูุฏ ุงูุฃุฐููุงุช ุงูุชู ุณุชุณูุญ ุจูุง ุณูุณูุฉ ุงูุงุชุตุงู ูุฐู. ุณูุงุณุฉ ServiceConnect ุชุณูุญ ูููุฏู ุจุงูุงุชุตุงู ูุฅุฑุณุงู ุงูุฑุณุงุฆู ุฅูู ุฃุฌูุฒุฉ IoT.

    โ ูู ุจุจุนุถ ุงูุจุญุซ: ุงูุฑุฃ ุนู ุงูุณูุงุณุงุช ุงููุฎุชููุฉ ูู [ูุซุงุฆู ุฃุฐููุงุช IoT Hub](https://docs.microsoft.com/azure/iot-hub/iot-hub-devguide-security#iot-hub-permissions?WT.mc_id=academic-17441-jabenn)

1. ูู VS Codeุ ุงูุชุญ ููู `local.settings.json`. ุฃุถู ุงููููุฉ ุงูุฅุถุงููุฉ ุงูุชุงููุฉ ุฏุงุฎู ูุณู `Values`:

    ```json
    "REGISTRY_MANAGER_CONNECTION_STRING": "<connection string>"
    ```

    ุงุณุชุจุฏู `<connection string>` ุจุงููููุฉ ูู ุงูุฎุทูุฉ ุงูุณุงุจูุฉ. ุณุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ูุงุตูุฉ ุจุนุฏ ุงูุณุทุฑ ุงูุณุงุจู ูุฌุนู ูุฐุง JSON ุตุงูุญูุง.

### ุงููููุฉ - ุฅุฑุณุงู ุทูุจ ุทุฑููุฉ ูุจุงุดุฑุฉ ุฅูู ุฌูุงุฒ

1. ูุชููุฑ SDK ุงูุฎุงุต ุจูุฏูุฑ ุงูุณุฌู ุนุจุฑ ุญุฒูุฉ Pip. ุฃุถู ุงูุณุทุฑ ุงูุชุงูู ุฅูู ููู `requirements.txt` ูุฅุถุงูุฉ ุงูุงุนุชูุงุฏ ุนูู ูุฐู ุงูุญุฒูุฉ:

    ```sh
    azure-iot-hub
    ```

1. ุชุฃูุฏ ูู ุฃู ุงูุทุฑููุฉ ูู VS Code ุชุญุชูู ุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ููุนููุฉุ ููู ุจุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู ูุชุซุจูุช ุญุฒู Pip:

    ```sh
    pip install -r requirements.txt
    ```

1. ุฃุถู ุงููุงุฑุฏุงุช ุงูุชุงููุฉ ุฅูู ููู `__init__.py`:

    ```python
    import json
    import os
    from azure.iot.hub import IoTHubRegistryManager
    from azure.iot.hub.models import CloudToDeviceMethod
    ```

    ูุฐุง ูุณุชูุฑุฏ ุจุนุถ ููุชุจุงุช ุงููุธุงูุ ุจุงูุฅุถุงูุฉ ุฅูู ุงูููุชุจุงุช ููุชูุงุนู ูุน ูุฏูุฑ ุงูุณุฌู ูุฅุฑุณุงู ุทูุจุงุช ุงูุทุฑููุฉ ุงููุจุงุดุฑุฉ.

1. ูู ุจุฅุฒุงูุฉ ุงูููุฏ ูู ุฏุงุฎู ุทุฑููุฉ `main`ุ ูููู ุงุญุชูุธ ุจุงูุทุฑููุฉ ููุณูุง.

1. ูู ุทุฑููุฉ `main`ุ ุฃุถู ุงูููุฏ ุงูุชุงูู:

    ```python
    body = json.loads(event.get_body().decode('utf-8'))
    device_id = event.iothub_metadata['connection-device-id']

    logging.info(f'Received message: {body} from {device_id}')
    ```

    ูููู ูุฐุง ุงูููุฏ ุจุงุณุชุฎุฑุงุฌ ูุญุชูู ุงูุญุฏุซ ุงูุฐู ูุญุชูู ุนูู ุฑุณุงูุฉ JSON ุงููุฑุณูุฉ ุจูุงุณุทุฉ ุฌูุงุฒ IoT.

    ุซู ูุญุตู ุนูู ูุนุฑู ุงูุฌูุงุฒ ูู ุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ ุงููุฑุณูุฉ ูุน ุงูุฑุณุงูุฉ. ูุญุชูู ูุญุชูู ุงูุญุฏุซ ุนูู ุงูุฑุณุงูุฉ ุงููุฑุณูุฉ ูุชูููุชุฑุ ุจูููุง ูุญุชูู ุงููุงููุณ `iothub_metadata` ุนูู ุงูุฎุตุงุฆุต ุงูุชู ูุญุฏุฏูุง IoT Hub ูุซู ูุนุฑู ุงูุฌูุงุฒ ุงููุฑุณูุ ูููุช ุฅุฑุณุงู ุงูุฑุณุงูุฉ.

    ูุชู ุจุนุฏ ุฐูู ุชุณุฌูู ูุฐู ุงููุนูููุงุช. ุณุชุฑู ูุฐุง ุงูุชุณุฌูู ูู ุงูุทุฑููุฉ ุนูุฏ ุชุดุบูู ุชุทุจูู Functions ูุญูููุง.

1. ุฃุณูู ูุฐุงุ ุฃุถู ุงูููุฏ ุงูุชุงูู:

    ```python
    soil_moisture = body['soil_moisture']

    if soil_moisture > 450:
        direct_method = CloudToDeviceMethod(method_name='relay_on', payload='{}')
    else:
        direct_method = CloudToDeviceMethod(method_name='relay_off', payload='{}')
    ```

    ูููู ูุฐุง ุงูููุฏ ุจุงูุญุตูู ุนูู ูุณุชูู ุฑุทูุจุฉ ุงูุชุฑุจุฉ ูู ุงูุฑุณุงูุฉ. ุซู ูุชุญูู ูู ูุณุชูู ุงูุฑุทูุจุฉุ ูุจูุงุกู ุนูู ุงููููุฉุ ููุดุฆ ูุฆุฉ ูุณุงุนุฏุฉ ูุทูุจ ุงูุทุฑููุฉ ุงููุจุงุดุฑุฉ ูุทุฑููุฉ `relay_on` ุฃู `relay_off`. ูุง ูุญุชุงุฌ ุทูุจ ุงูุทุฑููุฉ ุฅูู ุญูููุฉุ ูุฐุง ูุชู ุฅุฑุณุงู ูุณุชูุฏ JSON ูุงุฑุบ.

1. ุฃุณูู ูุฐุง ุฃุถู ุงูููุฏ ุงูุชุงูู:

    ```python
    logging.info(f'Sending direct method request for {direct_method.method_name} for device {device_id}')

    registry_manager_connection_string = os.environ['REGISTRY_MANAGER_CONNECTION_STRING']
    registry_manager = IoTHubRegistryManager(registry_manager_connection_string)
    ```
ูุชู ุชุญููู `REGISTRY_MANAGER_CONNECTION_STRING` ูู ููู `local.settings.json`. ุงูููู ุงูููุฌูุฏุฉ ูู ูุฐุง ุงูููู ุชุตุจุญ ูุชุงุญุฉ ููุชุบูุฑุงุช ุจูุฆูุฉุ ููููู ูุฑุงุกุชูุง ุจุงุณุชุฎุฏุงู ูุธููุฉ `os.environ`ุ ููู ูุธููุฉ ุชูุฑุฌุน ูุงููุณูุง ูุญุชูู ุนูู ุฌููุน ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ.

> ๐ ุนูุฏูุง ูุชู ูุดุฑ ูุฐุง ุงูููุฏ ุฅูู ุงูุณุญุงุจุฉุ ุณูุชู ุชุนููู ุงูููู ุงูููุฌูุฏุฉ ูู ููู `local.settings.json` ูุฅุนุฏุงุฏุงุช ููุชุทุจูู (*Application Settings*)ุ ููููู ูุฑุงุกุชูุง ูู ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ.

ุจุนุฏ ุฐููุ ูููู ุงูููุฏ ุจุฅูุดุงุก ูุณุฎุฉ ูู ูุฆุฉ ุงููุณุงุนุฏ Registry Manager ุจุงุณุชุฎุฏุงู ุณูุณูุฉ ุงูุงุชุตุงู.

1. ุฃุถู ุงูููุฏ ุงูุชุงูู:

    ```python
    registry_manager.invoke_device_method(device_id, direct_method)

    logging.info('Direct method request sent!')
    ```

    ูุฎุจุฑ ูุฐุง ุงูููุฏ ูุฏูุฑ ุงูุณุฌู ุจุฅุฑุณุงู ุทูุจ ุงูุทุฑููุฉ ุงููุจุงุดุฑุฉ ุฅูู ุงูุฌูุงุฒ ุงูุฐู ุฃุฑุณู ุงูุจูุงูุงุช.

    > ๐ ูู ุงูุฅุตุฏุงุฑุงุช ุงูุณุงุจูุฉ ูู ุงูุชุทุจูู ุงูุชู ุฃูุดุฃุชูุง ูู ุงูุฏุฑูุณ ุงูุณุงุจูุฉ ุจุงุณุชุฎุฏุงู MQTTุ ูุงูุช ุฃูุงูุฑ ุงูุชุญูู ูู ุงูุชุฑุญูู ุชูุฑุณู ุฅูู ุฌููุน ุงูุฃุฌูุฒุฉ. ูุงู ุงูููุฏ ููุชุฑุถ ุฃู ูุฏูู ุฌูุงุฒูุง ูุงุญุฏูุง ููุท. ูุฐุง ุงูุฅุตุฏุงุฑ ูู ุงูููุฏ ูุฑุณู ุทูุจ ุงูุทุฑููุฉ ุฅูู ุฌูุงุฒ ูุงุญุฏ ููุทุ ูุฐุง ุณูุนูู ุฅุฐุง ูุงู ูุฏูู ุฅุนุฏุงุฏุงุช ูุชุนุฏุฏุฉ ูุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ุงูุฑุทูุจุฉ ูุงูุชุฑุญููุ ุญูุซ ูุชู ุฅุฑุณุงู ุทูุจ ุงูุทุฑููุฉ ุงููุจุงุดุฑุฉ ุฅูู ุงูุฌูุงุฒ ุงูุตุญูุญ.

1. ูู ุจุชุดุบูู ุชุทุจูู Functionsุ ูุชุฃูุฏ ูู ุฃู ุฌูุงุฒ IoT ุงูุฎุงุต ุจู ูุฑุณู ุงูุจูุงูุงุช. ุณุชุฑู ุงูุฑุณุงุฆู ูุชู ูุนุงูุฌุชูุง ูุทูุจุงุช ุงูุทุฑููุฉ ุงููุจุงุดุฑุฉ ูุชู ุฅุฑุณุงููุง. ูู ุจุชุญุฑูู ูุณุชุดุนุฑ ุฑุทูุจุฉ ุงูุชุฑุจุฉ ุฏุงุฎู ูุฎุงุฑุฌ ุงูุชุฑุจุฉ ูุชุฑู ุงูููู ุชุชุบูุฑ ูุงูุชุฑุญูู ูุนูู ููุชููู.

> ๐ ููููู ุงูุนุซูุฑ ุนูู ูุฐุง ุงูููุฏ ูู ูุฌูุฏ [code/functions](../../../../../2-farm/lessons/5-migrate-application-to-the-cloud/code/functions).

## ูุดุฑ ุงูููุฏ ุจุฏูู ุฎุงุฏู ุฅูู ุงูุณุญุงุจุฉ

ุงูููุฏ ูุนูู ุงูุขู ูุญูููุงุ ูุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ูุดุฑ ุชุทุจูู Functions ุฅูู ุงูุณุญุงุจุฉ.

### ุงููููุฉ - ุฅูุดุงุก ููุงุฑุฏ ุงูุณุญุงุจุฉ

ูุญุชุงุฌ ุชุทุจูู Functions ุงูุฎุงุต ุจู ุฅูู ุฃู ูุชู ูุดุฑู ุฅูู ููุฑุฏ Functions App ูู Azureุ ุฏุงุฎู ูุฌููุนุฉ ุงูููุงุฑุฏ ุงูุชู ุฃูุดุฃุชูุง ูู IoT Hub. ุณุชุญุชุงุฌ ุฃูุถูุง ุฅูู ุฅูุดุงุก ุญุณุงุจ ุชุฎุฒูู ูู Azure ููุญู ูุญู ุงููุญุงูู ุงูุฐู ูุนูู ูุญูููุง.

1. ูู ุจุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู ูุฅูุดุงุก ุญุณุงุจ ุชุฎุฒูู:

    ```sh
    az storage account create --resource-group soil-moisture-sensor \
                              --sku Standard_LRS \
                              --name <storage_name> 
    ```

    ุงุณุชุจุฏู `<storage_name>` ุจุงุณู ูุญุณุงุจ ุงูุชุฎุฒูู ุงูุฎุงุต ุจู. ูุฌุจ ุฃู ูููู ูุฐุง ุงูุงุณู ูุฑูุฏูุง ุนุงููููุง ูุฃูู ูุดูู ุฌุฒุกูุง ูู ุนููุงู URL ุงููุณุชุฎุฏู ูููุตูู ุฅูู ุญุณุงุจ ุงูุชุฎุฒูู. ููููู ุงุณุชุฎุฏุงู ุงูุฃุญุฑู ุงูุตุบูุฑุฉ ูุงูุฃุฑูุงู ููุท ููุฐุง ุงูุงุณูุ ููุง ููุณูุญ ุจุฃู ุฃุญุฑู ุฃุฎุฑูุ ููู ูุญุฏูุฏ ุจู 24 ุญุฑููุง. ุงุณุชุฎุฏู ุดูุฆูุง ูุซู `sms` ูุฃุถู ูุนุฑููุง ูุฑูุฏูุง ูู ุงูููุงูุฉุ ูุซู ุจุนุถ ุงููููุงุช ุงูุนุดูุงุฆูุฉ ุฃู ุงุณูู.

    ุงูุฎูุงุฑ `--sku Standard_LRS` ูุญุฏุฏ ูุฆุฉ ุงูุชุณุนูุฑุ ุญูุซ ูุชู ุงุฎุชูุงุฑ ุฃูู ุชูููุฉ ูุญุณุงุจ ุนุงู. ูุง ุชูุฌุฏ ูุฆุฉ ูุฌุงููุฉ ููุชุฎุฒููุ ูุชุฏูุน ููุงุจู ูุง ุชุณุชุฎุฏูู. ุงูุชูุงููู ููุฎูุถุฉ ูุณุจููุงุ ุญูุซ ุฃู ุฃุบูู ุชุฎุฒูู ุฃูู ูู 0.05 ุฏููุงุฑ ุฃูุฑููู ุดูุฑููุง ููู ุฌูุฌุงุจุงูุช ูุฎุฒู.

    โ ุงูุฑุฃ ุงููุฒูุฏ ุนู ุงูุชุณุนูุฑ ุนูู [ุตูุญุฉ ุชุณุนูุฑ ุญุณุงุจ ุชุฎุฒูู Azure](https://azure.microsoft.com/pricing/details/storage/?WT.mc_id=academic-17441-jabenn)

1. ูู ุจุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู ูุฅูุดุงุก ุชุทุจูู Functions:

    ```sh
    az functionapp create --resource-group soil-moisture-sensor \
                          --runtime python \
                          --functions-version 3 \
                          --os-type Linux \
                          --consumption-plan-location <location> \
                          --storage-account <storage_name> \
                          --name <functions_app_name>
    ```

    ุงุณุชุจุฏู `<location>` ุจุงููููุน ุงูุฐู ุงุณุชุฎุฏูุชู ุนูุฏ ุฅูุดุงุก ูุฌููุนุฉ ุงูููุงุฑุฏ ูู ุงูุฏุฑุณ ุงูุณุงุจู.

    ุงุณุชุจุฏู `<storage_name>` ุจุงุณู ุญุณุงุจ ุงูุชุฎุฒูู ุงูุฐู ุฃูุดุฃุชู ูู ุงูุฎุทูุฉ ุงูุณุงุจูุฉ.

    ุงุณุชุจุฏู `<functions_app_name>` ุจุงุณู ูุฑูุฏ ูุชุทุจูู Functions ุงูุฎุงุต ุจู. ูุฌุจ ุฃู ูููู ูุฐุง ุงูุงุณู ูุฑูุฏูุง ุนุงููููุง ูุฃูู ูุดูู ุฌุฒุกูุง ูู ุนููุงู URL ุงูุฐู ูููู ุงุณุชุฎุฏุงูู ูููุตูู ุฅูู ุชุทุจูู Functions. ุงุณุชุฎุฏู ุดูุฆูุง ูุซู `soil-moisture-sensor-` ูุฃุถู ูุนุฑููุง ูุฑูุฏูุง ูู ุงูููุงูุฉุ ูุซู ุจุนุถ ุงููููุงุช ุงูุนุดูุงุฆูุฉ ุฃู ุงุณูู.

    ุงูุฎูุงุฑ `--functions-version 3` ูุญุฏุฏ ุฅุตุฏุงุฑ Azure Functions ุงูุฐู ุณูุชู ุงุณุชุฎุฏุงูู. ุงูุฅุตุฏุงุฑ 3 ูู ุฃุญุฏุซ ุฅุตุฏุงุฑ.

    ุงูุฎูุงุฑ `--os-type Linux` ูุฎุจุฑ ุจูุฆุฉ ุชุดุบูู Functions ุจุงุณุชุฎุฏุงู Linux ููุธุงู ุชุดุบูู ูุงุณุชุถุงูุฉ ูุฐู ุงููุธุงุฆู. ูููู ุงุณุชุถุงูุฉ ุงููุธุงุฆู ุนูู Linux ุฃู Windowsุ ุงุนุชูุงุฏูุง ุนูู ูุบุฉ ุงูุจุฑูุฌุฉ ุงููุณุชุฎุฏูุฉ. ุชุทุจููุงุช Python ูุฏุนููุฉ ููุท ุนูู Linux.

### ุงููููุฉ - ุชุญููู ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู

ุนูุฏูุง ููุช ุจุชุทููุฑ ุชุทุจูู Functions ุงูุฎุงุต ุจูุ ููุช ุจุชุฎุฒูู ุจุนุถ ุงูุฅุนุฏุงุฏุงุช ูู ููู `local.settings.json` ูุณูุงุณู ุงูุงุชุตุงู ุงูุฎุงุตุฉ ุจู IoT Hub. ูุฌุจ ูุชุงุจุฉ ูุฐู ุงูุฅุนุฏุงุฏุงุช ุฅูู ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู ูู ุชุทุจูู Functions ูู Azure ุญุชู ูุชููู ุงูููุฏ ูู ุงุณุชุฎุฏุงููุง.

> ๐ ููู `local.settings.json` ูุฎุตุต ูุฅุนุฏุงุฏุงุช ุงูุชุทููุฑ ุงููุญูู ููุทุ ููุง ูุฌุจ ุฃู ูุชู ุฅุฏุฎุงูู ูู ุงูุชุญูู ูู ูุตุฏุฑ ุงูููุฏุ ูุซู GitHub. ุนูุฏ ุงููุดุฑ ุฅูู ุงูุณุญุงุจุฉุ ูุชู ุงุณุชุฎุฏุงู ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู. ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู ูู ุฃุฒูุงุฌ ููุชุงุญ/ูููุฉ ูุณุชุถุงูุฉ ูู ุงูุณุญุงุจุฉ ููุชู ูุฑุงุกุชูุง ูู ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ ุฅูุง ูู ุงูููุฏ ุงูุฎุงุต ุจู ุฃู ุจูุงุณุทุฉ ุจูุฆุฉ ุงูุชุดุบูู ุนูุฏ ุชูุตูู ุงูููุฏ ุจู IoT Hub.

1. ูู ุจุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู ูุชุนููู ุฅุนุฏุงุฏ `IOT_HUB_CONNECTION_STRING` ูู ุฅุนุฏุงุฏุงุช ุชุทุจูู Functions:

    ```sh
    az functionapp config appsettings set --resource-group soil-moisture-sensor \
                                          --name <functions_app_name> \
                                          --settings "IOT_HUB_CONNECTION_STRING=<connection string>"
    ```

    ุงุณุชุจุฏู `<functions_app_name>` ุจุงูุงุณู ุงูุฐู ุงุณุชุฎุฏูุชู ูุชุทุจูู Functions ุงูุฎุงุต ุจู.

    ุงุณุชุจุฏู `<connection string>` ุจุงููููุฉ ุงูุฎุงุตุฉ ุจู `IOT_HUB_CONNECTION_STRING` ูู ููู `local.settings.json` ุงูุฎุงุต ุจู.

1. ูุฑุฑ ุงูุฎุทูุฉ ุฃุนูุงูุ ูููู ูู ุจุชุนููู ูููุฉ `REGISTRY_MANAGER_CONNECTION_STRING` ุฅูู ุงููููุฉ ุงูููุงุจูุฉ ูู ููู `local.settings.json` ุงูุฎุงุต ุจู.

ุนูุฏ ุชุดุบูู ูุฐู ุงูุฃูุงูุฑุ ุณุชุธูุฑ ูุงุฆูุฉ ุจุฌููุน ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู ูุชุทุจูู ุงููุธุงุฆู. ููููู ุงุณุชุฎุฏุงู ูุฐู ุงููุงุฆูุฉ ููุชุญูู ูู ุฃู ุงูููู ุชู ุชุนููููุง ุจุดูู ุตุญูุญ.

> ๐ ุณุชุฑู ูููุฉ ุชู ุชุนููููุง ุจุงููุนู ูู `AzureWebJobsStorage`. ูู ููู `local.settings.json` ุงูุฎุงุต ุจูุ ุชู ุชุนููู ูุฐู ุงููููุฉ ูุงุณุชุฎุฏุงู ูุญุงูู ุงูุชุฎุฒูู ุงููุญูู. ุนูุฏ ุฅูุดุงุก ุชุทุจูู Functionsุ ูุชู ุชูุฑูุฑ ุญุณุงุจ ุงูุชุฎุฒูู ููุนุงููุ ููุชู ุชุนูููู ุชููุงุฆููุง ูู ูุฐุง ุงูุฅุนุฏุงุฏ.

### ุงููููุฉ - ูุดุฑ ุชุทุจูู Functions ุงูุฎุงุต ุจู ุฅูู ุงูุณุญุงุจุฉ

ุงูุขู ุจุนุฏ ุฃู ุฃุตุจุญ ุชุทุจูู Functions ุฌุงูุฒูุงุ ูููู ูุดุฑ ุงูููุฏ ุงูุฎุงุต ุจู.

1. ูู ุจุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู ูู ูุงูุฐุฉ VS Code ููุดุฑ ุชุทุจูู Functions ุงูุฎุงุต ุจู:

    ```sh
    func azure functionapp publish <functions_app_name>
    ```

    ุงุณุชุจุฏู `<functions_app_name>` ุจุงูุงุณู ุงูุฐู ุงุณุชุฎุฏูุชู ูุชุทุจูู Functions ุงูุฎุงุต ุจู.

ุณูุชู ุชุฌููุน ุงูููุฏ ูุฅุฑุณุงูู ุฅูู ุชุทุจูู Functionsุ ุญูุซ ุณูุชู ูุดุฑู ูุชุดุบููู. ุณูููู ููุงู ุงููุซูุฑ ูู ุงููุฎุฑุฌุงุช ูู ูุญุฏุฉ ุงูุชุญููุ ุชูุชูู ุจุชุฃููุฏ ุงููุดุฑ ููุงุฆูุฉ ุงููุธุงุฆู ุงูููุดูุฑุฉ. ูู ูุฐู ุงูุญุงูุฉุ ุณุชุญุชูู ุงููุงุฆูุฉ ููุท ุนูู ุงููุดุบู.

```output
Deployment successful.
Remote build succeeded!
Syncing triggers...
Functions in soil-moisture-sensor:
    iot-hub-trigger - [eventHubTrigger]
```

ุชุฃูุฏ ูู ุฃู ุฌูุงุฒ IoT ุงูุฎุงุต ุจู ูุนูู. ูู ุจุชุบููุฑ ูุณุชููุงุช ุงูุฑุทูุจุฉ ุนู ุทุฑูู ุถุจุท ุฑุทูุจุฉ ุงูุชุฑุจุฉ ุฃู ุชุญุฑูู ุงููุณุชุดุนุฑ ุฏุงุฎู ูุฎุงุฑุฌ ุงูุชุฑุจุฉ. ุณุชุฑู ุงูุชุฑุญูู ูุนูู ููุชููู ูุน ุชุบูุฑ ุฑุทูุจุฉ ุงูุชุฑุจุฉ.

---

## ๐ ุงูุชุญุฏู

ูู ุงูุฏุฑุณ ุงูุณุงุจูุ ููุช ุจุฅุฏุงุฑุฉ ุชูููุช ุงูุชุฑุญูู ุนู ุทุฑูู ุฅูุบุงุก ุงูุงุดุชุฑุงู ูู ุฑุณุงุฆู MQTT ุฃุซูุงุก ุชุดุบูู ุงูุชุฑุญููุ ูููุฏุฉ ูุตูุฑุฉ ุจุนุฏ ุฅููุงูู. ูุง ููููู ุงุณุชุฎุฏุงู ูุฐู ุงูุทุฑููุฉ ููุง - ูุง ููููู ุฅูุบุงุก ุงูุงุดุชุฑุงู ูู ูุดุบู IoT Hub ุงูุฎุงุต ุจู.

ููุฑ ูู ุทุฑู ูุฎุชููุฉ ููููู ุงุณุชุฎุฏุงููุง ููุชุนุงูู ูุน ูุฐุง ูู ุชุทุจูู Functions ุงูุฎุงุต ุจู.

## ุงุฎุชุจุงุฑ ูุง ุจุนุฏ ุงููุญุงุถุฑุฉ

[ุงุฎุชุจุงุฑ ูุง ุจุนุฏ ุงููุญุงุถุฑุฉ](https://black-meadow-040d15503.1.azurestaticapps.net/quiz/18)

## ุงููุฑุงุฌุนุฉ ูุงูุฏุฑุงุณุฉ ุงูุฐุงุชูุฉ

* ุงูุฑุฃ ุนู ุงูุญูุณุจุฉ ุจุฏูู ุฎุงุฏู ุนูู [ุตูุญุฉ ุงูุญูุณุจุฉ ุจุฏูู ุฎุงุฏู ุนูู ููููุจูุฏูุง](https://wikipedia.org/wiki/Serverless_computing)
* ุงูุฑุฃ ุนู ุงุณุชุฎุฏุงู ุงูุญูุณุจุฉ ุจุฏูู ุฎุงุฏู ูู Azure ุจูุง ูู ุฐูู ุงููุฒูุฏ ูู ุงูุฃูุซูุฉ ูู [ูุฏููุฉ Azure: ุงูุญูุณุจุฉ ุจุฏูู ุฎุงุฏู ูุงุญุชูุงุฌุงุช IoT ุงูุฎุงุตุฉ ุจู](https://azure.microsoft.com/blog/go-serverless-for-your-iot-needs/?WT.mc_id=academic-17441-jabenn)
* ุชุนูู ุงููุฒูุฏ ุนู Azure Functions ุนูู [ููุงุฉ Azure Functions ุนูู YouTube](https://www.youtube.com/c/AzureFunctions)

## ุงููุงุฌุจ

[ุฅุถุงูุฉ ุงูุชุญูู ุงููุฏูู ูู ุงูุชุฑุญูู](assignment.md)

---

**ุฅุฎูุงุก ุงููุณุคูููุฉ**:  
ุชู ุชุฑุฌูุฉ ูุฐุง ุงููุณุชูุฏ ุจุงุณุชุฎุฏุงู ุฎุฏูุฉ ุงูุชุฑุฌูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู [Co-op Translator](https://github.com/Azure/co-op-translator). ุจูููุง ูุณุนู ูุชุญููู ุงูุฏูุฉุ ูุฑุฌู ุงูุนูู ุฃู ุงูุชุฑุฌูุงุช ุงูุขููุฉ ูุฏ ุชุญุชูู ุนูู ุฃุฎุทุงุก ุฃู ุนุฏู ุฏูุฉ. ูุฌุจ ุงุนุชุจุงุฑ ุงููุณุชูุฏ ุงูุฃุตูู ุจูุบุชู ุงูุฃุตููุฉ ุงููุตุฏุฑ ุงูุฑุณูู. ููุญุตูู ุนูู ูุนูููุงุช ุญุงุณูุฉุ ูููุตู ุจุงูุงุณุชุนุงูุฉ ุจุชุฑุฌูุฉ ุจุดุฑูุฉ ุงุญุชุฑุงููุฉ. ูุญู ุบูุฑ ูุณุคูููู ุนู ุฃู ุณูุก ููู ุฃู ุชูุณูุฑุงุช ุฎุงุทุฆุฉ ุชูุดุฃ ุนู ุงุณุชุฎุฏุงู ูุฐู ุงูุชุฑุฌูุฉ.