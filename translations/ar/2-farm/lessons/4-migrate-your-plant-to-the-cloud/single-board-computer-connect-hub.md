<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "3ac42e284a7222c0e83d2d43231a364f",
  "translation_date": "2025-08-26T22:59:37+00:00",
  "source_file": "2-farm/lessons/4-migrate-your-plant-to-the-cloud/single-board-computer-connect-hub.md",
  "language_code": "ar"
}
-->
# ุฑุจุท ุฌูุงุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุจุงูุณุญุงุจุฉ - ุฌูุงุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุงูุงูุชุฑุงุถู ู Raspberry Pi

ูู ูุฐุง ุงูุฌุฒุก ูู ุงูุฏุฑุณุ ุณุชููู ุจุฑุจุท ุฌูุงุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุงูุงูุชุฑุงุถู ุงูุฎุงุต ุจู ุฃู Raspberry Pi ุจูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุงูุฎุงุต ุจูุ ูุฅุฑุณุงู ุงูุจูุงูุงุช ูุงุณุชูุจุงู ุงูุฃูุงูุฑ.

## ุฑุจุท ุฌูุงุฒู ุจูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก

ุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ุฑุจุท ุฌูุงุฒู ุจูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก.

### ุงููููุฉ - ุงูุฑุจุท ุจูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก

1. ุงูุชุญ ูุฌูุฏ `soil-moisture-sensor` ูู VS Code. ุชุฃูุฏ ูู ุชุดุบูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ูู ุงูุทุฑููุฉ ุฅุฐุง ููุช ุชุณุชุฎุฏู ุฌูุงุฒ ุฅูุชุฑูุช ุฃุดูุงุก ุงูุชุฑุงุถู.

1. ูู ุจุชุซุจูุช ุจุนุถ ุญุฒู Pip ุงูุฅุถุงููุฉ:

    ```sh
    pip3 install azure-iot-device
    ```

    ููุชุจุฉ `azure-iot-device` ุชูุณุชุฎุฏู ููุชูุงุตู ูุน ูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุงูุฎุงุต ุจู.

1. ุฃุถู ุงููุงุฑุฏุงุช ุงูุชุงููุฉ ุฅูู ุฃุนูู ููู `app.py`ุ ุฃุณูู ุงููุงุฑุฏุงุช ุงูููุฌูุฏุฉ:

    ```python
    from azure.iot.device import IoTHubDeviceClient, Message, MethodResponse
    ```

    ูุฐุง ุงูููุฏ ูุณุชูุฑุฏ SDK ููุชูุงุตู ูุน ูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุงูุฎุงุต ุจู.

1. ูู ุจุฅุฒุงูุฉ ุงูุณุทุฑ `import paho.mqtt.client as mqtt` ุญูุซ ูู ุชุนุฏ ูุฐู ุงูููุชุจุฉ ูุทููุจุฉ. ูู ุจุฅุฒุงูุฉ ูู ููุฏ MQTT ุจูุง ูู ุฐูู ุฃุณูุงุก ุงูููุงุถูุนุ ููู ุงูููุฏ ุงูุฐู ูุณุชุฎุฏู `mqtt_client` ู `handle_command`. ุงุญุชูุธ ุจุญููุฉ `while True:`ุ ููุท ุงุญุฐู ุณุทุฑ `mqtt_client.publish` ูู ูุฐู ุงูุญููุฉ.

1. ุฃุถู ุงูููุฏ ุงูุชุงูู ุฃุณูู ุนุจุงุฑุงุช ุงููุงุฑุฏุงุช:

    ```python
    connection_string = "<connection string>"
    ```

    ุงุณุชุจุฏู `<connection string>` ุจุณูุณูุฉ ุงูุงุชุตุงู ุงูุชู ุงุณุชุฑุฌุนุชูุง ููุฌูุงุฒ ูู ููุช ุณุงุจู ูู ูุฐุง ุงูุฏุฑุณ.

    > ๐ ูุฐุง ููุณ ุฃูุถู ููุงุฑุณุฉ. ูุง ูุฌุจ ุฃุจุฏูุง ุชุฎุฒูู ุณูุงุณู ุงูุงุชุตุงู ูู ููุฏ ุงููุตุฏุฑุ ุญูุซ ูููู ุฃู ูุชู ุฅุฏุฎุงููุง ูู ูุธุงู ุงูุชุญูู ูู ุงูููุฏ ูุงูุนุซูุฑ ุนูููุง ูู ูุจู ุฃู ุดุฎุต. ูุญู ููุนู ุฐูู ููุง ูู ุฃุฌู ุงูุชุจุณูุท. ูู ุงูุฃูุถู ุงุณุชุฎุฏุงู ุดูุก ูุซู ูุชุบูุฑ ุจูุฆุฉ ูุฃุฏุงุฉ ูุซู [`python-dotenv`](https://pypi.org/project/python-dotenv/). ุณุชุชุนูู ุงููุฒูุฏ ุนู ูุฐุง ูู ุฏุฑุณ ูุงุฏู.

1. ุฃุณูู ูุฐุง ุงูููุฏุ ุฃุถู ุงูุชุงูู ูุฅูุดุงุก ูุงุฆู ุนููู ุฌูุงุฒ ููููู ุงูุชูุงุตู ูุน ูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุกุ ูุฑุจุทู:

    ```python
    device_client = IoTHubDeviceClient.create_from_connection_string(connection_string)

    print('Connecting')
    device_client.connect()
    print('Connected')
    ```

1. ูู ุจุชุดุบูู ูุฐุง ุงูููุฏ. ุณุชุฑู ุฌูุงุฒู ูุชุตู.

    ```output
    pi@raspberrypi:~/soil-moisture-sensor $ python3 app.py 
    Connecting
    Connected
    Soil moisture: 379
    ```

## ุฅุฑุณุงู ุงูุจูุงูุงุช

ุงูุขู ุจุนุฏ ุฃู ุชู ุฑุจุท ุฌูุงุฒูุ ููููู ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู ูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุจุฏูุงู ูู ูุณูุท MQTT.

### ุงููููุฉ - ุฅุฑุณุงู ุงูุจูุงูุงุช

1. ุฃุถู ุงูููุฏ ุงูุชุงูู ุฏุงุฎู ุญููุฉ `while True`ุ ูุจู ุงูุณุทุฑ ุงูุฎุงุต ุจุงูููู:

    ```python
    message = Message(json.dumps({ 'soil_moisture': soil_moisture }))
    device_client.send_message(message)
    ```

    ูุฐุง ุงูููุฏ ููุดุฆ ุฑุณุงูุฉ `Message` ููุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุชุญุชูู ุนูู ูุฑุงุกุฉ ุฑุทูุจุฉ ุงูุชุฑุจุฉ ูู JSONุ ุซู ูุฑุณููุง ุฅูู ูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก ูุฑุณุงูุฉ ูู ุงูุฌูุงุฒ ุฅูู ุงูุณุญุงุจุฉ.

## ุงูุชุนุงูู ูุน ุงูุฃูุงูุฑ

ูุญุชุงุฌ ุฌูุงุฒู ุฅูู ุงูุชุนุงูู ูุน ุฃูุฑ ูู ููุฏ ุงูุฎุงุฏู ููุชุญูู ูู ุงููุฑุญู. ูุชู ุฅุฑุณุงู ูุฐุง ูุทูุจ ุทุฑููุฉ ูุจุงุดุฑุฉ.

## ุงููููุฉ - ุงูุชุนุงูู ูุน ุทูุจ ุทุฑููุฉ ูุจุงุดุฑุฉ

1. ุฃุถู ุงูููุฏ ุงูุชุงูู ูุจู ุญููุฉ `while True`:

    ```python
    def handle_method_request(request):
        print("Direct method received - ", request.name)
    
        if request.name == "relay_on":
            relay.on()
        elif request.name == "relay_off":
            relay.off()    
    ```

    ูุฐุง ุงูููุฏ ูุนุฑูู ุทุฑููุฉุ `handle_method_request`ุ ุณูุชู ุงุณุชุฏุนุงุคูุง ุนูุฏ ุงุณุชุฏุนุงุก ุทุฑููุฉ ูุจุงุดุฑุฉ ูู ูุจู ูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก. ูู ุทุฑููุฉ ูุจุงุดุฑุฉ ููุง ุงุณูุ ููุชููุน ูุฐุง ุงูููุฏ ุทุฑููุฉ ุชุณูู `relay_on` ูุชุดุบูู ุงููุฑุญูุ ู`relay_off` ูุฅููุงูู.

    > ๐ ูููู ุฃูุถูุง ุชูููุฐ ุฐูู ูู ุทูุจ ุทุฑููุฉ ูุจุงุดุฑุฉ ูุงุญุฏุฉุ ูุน ุชูุฑูุฑ ุงูุญุงูุฉ ุงููุทููุจุฉ ูููุฑุญู ูู ุญูููุฉ ูููู ุชูุฑูุฑูุง ูุน ุทูุจ ุงูุทุฑููุฉ ูุชููู ูุชุงุญุฉ ูู ูุงุฆู `request`.

1. ุชุชุทูุจ ุงูุทุฑู ุงููุจุงุดุฑุฉ ุงุณุชุฌุงุจุฉ ูุฅุจูุงุบ ุงูููุฏ ุงููุณุชุฏุนู ุจุฃูู ุชู ุงูุชุนุงูู ูุนูุง. ุฃุถู ุงูููุฏ ุงูุชุงูู ูู ููุงูุฉ ูุธููุฉ `handle_method_request` ูุฅูุดุงุก ุงุณุชุฌุงุจุฉ ููุทูุจ:

    ```python
    method_response = MethodResponse.create_from_method_request(request, 200)
    device_client.send_method_response(method_response)
    ```

    ูุฐุง ุงูููุฏ ูุฑุณู ุงุณุชุฌุงุจุฉ ูุทูุจ ุงูุทุฑููุฉ ุงููุจุงุดุฑุฉ ูุน ุฑูุฒ ุญุงูุฉ HTTP 200ุ ููุฑุณููุง ูุฑุฉ ุฃุฎุฑู ุฅูู ูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก.

1. ุฃุถู ุงูููุฏ ุงูุชุงูู ุฃุณูู ุชุนุฑูู ูุฐู ุงููุธููุฉ:

    ```python
    device_client.on_method_request_received = handle_method_request
    ```

    ูุฐุง ุงูููุฏ ูุฎุจุฑ ุนููู ูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก ุจุงุณุชุฏุนุงุก ูุธููุฉ `handle_method_request` ุนูุฏ ุงุณุชุฏุนุงุก ุทุฑููุฉ ูุจุงุดุฑุฉ.

> ๐ ููููู ุงูุนุซูุฑ ุนูู ูุฐุง ุงูููุฏ ูู ูุฌูุฏ [code/pi](../../../../../2-farm/lessons/4-migrate-your-plant-to-the-cloud/code/pi) ุฃู [code/virtual-device](../../../../../2-farm/lessons/4-migrate-your-plant-to-the-cloud/code/virtual-device).

๐ ุจุฑูุงูุฌ ูุณุชุดุนุฑ ุฑุทูุจุฉ ุงูุชุฑุจุฉ ุงูุฎุงุต ุจู ูุชุตู ุจูุฑูุฒ ุฅูุชุฑูุช ุงูุฃุดูุงุก!

---

**ุฅุฎูุงุก ุงููุณุคูููุฉ**:  
ุชู ุชุฑุฌูุฉ ูุฐุง ุงููุณุชูุฏ ุจุงุณุชุฎุฏุงู ุฎุฏูุฉ ุงูุชุฑุฌูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู [Co-op Translator](https://github.com/Azure/co-op-translator). ุจูููุง ูุณุนู ูุชุญููู ุงูุฏูุฉุ ูุฑุฌู ุงูุนูู ุฃู ุงูุชุฑุฌูุงุช ุงูุขููุฉ ูุฏ ุชุญุชูู ุนูู ุฃุฎุทุงุก ุฃู ูุนูููุงุช ุบูุฑ ุฏูููุฉ. ูุฌุจ ุงุนุชุจุงุฑ ุงููุณุชูุฏ ุงูุฃุตูู ุจูุบุชู ุงูุฃุตููุฉ ุงููุตุฏุฑ ุงูููุซูู. ููุญุตูู ุนูู ูุนูููุงุช ุญุงุณูุฉุ ูููุตู ุจุงูุงุณุชุนุงูุฉ ุจุชุฑุฌูุฉ ุจุดุฑูุฉ ุงุญุชุฑุงููุฉ. ูุญู ุบูุฑ ูุณุคูููู ุนู ุฃู ุณูุก ููู ุฃู ุชูุณูุฑุงุช ุฎุงุทุฆุฉ ุชูุดุฃ ุนู ุงุณุชุฎุฏุงู ูุฐู ุงูุชุฑุฌูุฉ.