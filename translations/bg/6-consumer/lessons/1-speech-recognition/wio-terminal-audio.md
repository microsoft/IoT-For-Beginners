<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "2f336726b9410e97c3aaed76cc89b0d8",
  "translation_date": "2025-08-28T09:20:17+00:00",
  "source_file": "6-consumer/lessons/1-speech-recognition/wio-terminal-audio.md",
  "language_code": "bg"
}
-->
# –ó–∞–ø–∏—Å –Ω–∞ –∞—É–¥–∏–æ - Wio Terminal

–í —Ç–∞–∑–∏ —á–∞—Å—Ç –æ—Ç —É—Ä–æ–∫–∞ —â–µ –Ω–∞–ø–∏—à–µ—Ç–µ –∫–æ–¥ –∑–∞ –∑–∞–ø–∏—Å –Ω–∞ –∞—É–¥–∏–æ —Å –≤–∞—à–∏—è Wio Terminal. –ó–∞–ø–∏—Å—ä—Ç –Ω–∞ –∞—É–¥–∏–æ —â–µ —Å–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–∞ —á—Ä–µ–∑ –µ–¥–∏–Ω –æ—Ç –±—É—Ç–æ–Ω–∏—Ç–µ –≤ –≥–æ—Ä–Ω–∞—Ç–∞ —á–∞—Å—Ç –Ω–∞ Wio Terminal.

## –ü—Ä–æ–≥—Ä–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ—Ç–æ –∑–∞ –∑–∞–ø–∏—Å –Ω–∞ –∞—É–¥–∏–æ

–ú–æ–∂–µ—Ç–µ –¥–∞ –∑–∞–ø–∏—Å–≤–∞—Ç–µ –∞—É–¥–∏–æ –æ—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞, –∏–∑–ø–æ–ª–∑–≤–∞–π–∫–∏ C++ –∫–æ–¥. Wio Terminal —Ä–∞–∑–ø–æ–ª–∞–≥–∞ —Å–∞–º–æ —Å—ä—Å 192KB RAM, –∫–æ–µ—Ç–æ –Ω–µ –µ –¥–æ—Å—Ç–∞—Ç—ä—á–Ω–æ –∑–∞ –∑–∞–ø–∏—Å –Ω–∞ –ø–æ–≤–µ—á–µ –æ—Ç –Ω—è–∫–æ–ª–∫–æ —Å–µ–∫—É–Ω–¥–∏ –∞—É–¥–∏–æ. –û—Å–≤–µ–Ω —Ç–æ–≤–∞ –∏–º–∞ 4MB —Ñ–ª–∞—à –ø–∞–º–µ—Ç, –∫–æ—è—Ç–æ –º–æ–∂–µ –¥–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –∑–∞ —Å—ä—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –∑–∞–ø–∏—Å–∞–Ω–æ—Ç–æ –∞—É–¥–∏–æ.

–í–≥—Ä–∞–¥–µ–Ω–∏—è—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω —É–ª–∞–≤—è –∞–Ω–∞–ª–æ–≥–æ–≤ —Å–∏–≥–Ω–∞–ª, –∫–æ–π—Ç–æ —Å–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞ –≤ —Ü–∏—Ñ—Ä–æ–≤ —Å–∏–≥–Ω–∞–ª, –∫–æ–π—Ç–æ Wio Terminal –º–æ–∂–µ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞. –ü—Ä–∏ –∑–∞–ø–∏—Å –Ω–∞ –∞—É–¥–∏–æ –¥–∞–Ω–Ω–∏—Ç–µ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ —É–ª–∞–≤—è—Ç –≤ –ø—Ä–∞–≤–∏–ª–Ω–∏—è –º–æ–º–µ–Ω—Ç ‚Äì –Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞ –¥–∞ —Å–µ –∑–∞–ø–∏—Å–≤–∞ –∞—É–¥–∏–æ –Ω–∞ 16KHz, –¥–∞–Ω–Ω–∏—Ç–µ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ —É–ª–∞–≤—è—Ç —Ç–æ—á–Ω–æ 16 000 –ø—ä—Ç–∏ –≤ —Å–µ–∫—É–Ω–¥–∞, —Å —Ä–∞–≤–Ω–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏ –º–µ–∂–¥—É –≤—Å—è–∫–∞ –∏–∑–≤–∞–¥–∫–∞. –í–º–µ—Å—Ç–æ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ –∫–æ–¥–∞ —Å–∏ –∑–∞ —Ç–æ–≤–∞, –º–æ–∂–µ—Ç–µ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞ –∑–∞ –¥–∏—Ä–µ–∫—Ç–µ–Ω –¥–æ—Å—Ç—ä–ø –¥–æ –ø–∞–º–µ—Ç—Ç–∞ (DMAC). –¢–æ–≤–∞ –µ —Å—Ö–µ–º–∞, –∫–æ—è—Ç–æ –º–æ–∂–µ –¥–∞ —É–ª–∞–≤—è —Å–∏–≥–Ω–∞–ª –æ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –º—è—Å—Ç–æ –∏ –¥–∞ –≥–æ –∑–∞–ø–∏—Å–≤–∞ –≤ –ø–∞–º–µ—Ç—Ç–∞, –±–µ–∑ –¥–∞ –ø—Ä–µ–∫—ä—Å–≤–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏–µ—Ç–æ –Ω–∞ –∫–æ–¥–∞ –Ω–∞ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞.

‚úÖ –ü—Ä–æ—á–µ—Ç–µ—Ç–µ –ø–æ–≤–µ—á–µ –∑–∞ DMA –Ω–∞ [—Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞ –∑–∞ –¥–∏—Ä–µ–∫—Ç–µ–Ω –¥–æ—Å—Ç—ä–ø –¥–æ –ø–∞–º–µ—Ç—Ç–∞ –≤ Wikipedia](https://wikipedia.org/wiki/Direct_memory_access).

![–ê—É–¥–∏–æ –æ—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –ø—Ä–µ–º–∏–Ω–∞–≤–∞ –ø—Ä–µ–∑ ADC, —Å–ª–µ–¥ —Ç–æ–≤–∞ –∫—ä–º DMAC. –¢–æ–≤–∞ —Å–µ –∑–∞–ø–∏—Å–≤–∞ –≤ –µ–¥–∏–Ω –±—É—Ñ–µ—Ä. –ö–æ–≥–∞—Ç–æ —Ç–æ–∑–∏ –±—É—Ñ–µ—Ä —Å–µ –∑–∞–ø—ä–ª–Ω–∏, —Ç–æ–π —Å–µ –æ–±—Ä–∞–±–æ—Ç–≤–∞ –∏ DMAC –∑–∞–ø–∏—Å–≤–∞ –≤—ä–≤ –≤—Ç–æ—Ä–∏ –±—É—Ñ–µ—Ä](../../../../../translated_images/dmac-adc-buffers.4509aee49145c90bc2e1be472b8ed2ddfcb2b6a81ad3e559114aca55f5fff759.bg.png)

DMAC –º–æ–∂–µ –¥–∞ –∑–∞–ø–∏—Å–≤–∞ –∞—É–¥–∏–æ –æ—Ç ADC –Ω–∞ —Ñ–∏–∫—Å–∏—Ä–∞–Ω–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä 16 000 –ø—ä—Ç–∏ –≤ —Å–µ–∫—É–Ω–¥–∞ –∑–∞ –∞—É–¥–∏–æ –Ω–∞ 16KHz. –¢–æ–π –º–æ–∂–µ –¥–∞ –∑–∞–ø–∏—Å–≤–∞ —Ç–µ–∑–∏ –¥–∞–Ω–Ω–∏ –≤ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–æ –∑–∞–¥–∞–¥–µ–Ω –ø–∞–º–µ—Ç–µ–Ω –±—É—Ñ–µ—Ä, –∞ –∫–æ–≥–∞—Ç–æ —Ç–æ–∑–∏ –±—É—Ñ–µ—Ä —Å–µ –∑–∞–ø—ä–ª–Ω–∏, –¥–∞ –≥–æ –Ω–∞–ø—Ä–∞–≤–∏ –¥–æ—Å—Ç—ä–ø–µ–Ω –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç –≤–∞—à–∏—è –∫–æ–¥. –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ—Ç–æ –Ω–∞ —Ç–∞–∑–∏ –ø–∞–º–µ—Ç –º–æ–∂–µ –¥–∞ –∑–∞–±–∞–≤–∏ –∑–∞–ø–∏—Å–≤–∞–Ω–µ—Ç–æ –Ω–∞ –∞—É–¥–∏–æ, –Ω–æ –º–æ–∂–µ—Ç–µ –¥–∞ –Ω–∞—Å—Ç—Ä–æ–∏—Ç–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –±—É—Ñ–µ—Ä–∏. DMAC –∑–∞–ø–∏—Å–≤–∞ –≤ –±—É—Ñ–µ—Ä 1, —Å–ª–µ–¥ –∫–æ–µ—Ç–æ, –∫–æ–≥–∞—Ç–æ —Ç–æ–π —Å–µ –∑–∞–ø—ä–ª–Ω–∏, —É–≤–µ–¥–æ–º—è–≤–∞ –≤–∞—à–∏—è –∫–æ–¥ –¥–∞ –æ–±—Ä–∞–±–æ—Ç–∏ –±—É—Ñ–µ—Ä 1, –¥–æ–∫–∞—Ç–æ DMAC –∑–∞–ø–∏—Å–≤–∞ –≤ –±—É—Ñ–µ—Ä 2. –ö–æ–≥–∞—Ç–æ –±—É—Ñ–µ—Ä 2 —Å–µ –∑–∞–ø—ä–ª–Ω–∏, —Ç–æ–π —É–≤–µ–¥–æ–º—è–≤–∞ –≤–∞—à–∏—è –∫–æ–¥ –∏ —Å–µ –≤—Ä—ä—â–∞ –∫—ä–º –∑–∞–ø–∏—Å–≤–∞–Ω–µ –≤ –±—É—Ñ–µ—Ä 1. –ü–æ —Ç–æ–∑–∏ –Ω–∞—á–∏–Ω, —Å—Ç–∏–≥–∞ –¥–∞ –æ–±—Ä–∞–±–æ—Ç–≤–∞—Ç–µ –≤—Å–µ–∫–∏ –±—É—Ñ–µ—Ä –∑–∞ –ø–æ-–º–∞–ª–∫–æ –≤—Ä–µ–º–µ, –æ—Ç–∫–æ–ª–∫–æ—Ç–æ –µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞ –∑–∞–ø—ä–ª–≤–∞–Ω–µ—Ç–æ –º—É, –Ω—è–º–∞ –¥–∞ –∑–∞–≥—É–±–∏—Ç–µ –¥–∞–Ω–Ω–∏.

–°–ª–µ–¥ –∫–∞—Ç–æ –≤—Å–µ–∫–∏ –±—É—Ñ–µ—Ä –±—ä–¥–µ –∑–∞–ø–∏—Å–∞–Ω, —Ç–æ–π –º–æ–∂–µ –¥–∞ –±—ä–¥–µ –∑–∞–ø–∏—Å–∞–Ω –≤—ä–≤ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞. –§–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –∑–∞–ø–∏—Å–≤–∞, –∏–∑–ø–æ–ª–∑–≤–∞–π–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏ –∞–¥—Ä–µ—Å–∏, –∫–∞—Ç–æ —Å–µ –ø–æ—Å–æ—á–≤–∞ –∫—ä–¥–µ –¥–∞ —Å–µ –∑–∞–ø–∏—à–µ –∏ –∫–æ–ª–∫–æ –≥–æ–ª—è–º –¥–∞ –±—ä–¥–µ –∑–∞–ø–∏—Å—ä—Ç, –ø–æ–¥–æ–±–Ω–æ –Ω–∞ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –º–∞—Å–∏–≤ –æ—Ç –±–∞–π—Ç–æ–≤–µ –≤ –ø–∞–º–µ—Ç—Ç–∞. –§–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞ –∏–º–∞ –≥—Ä–∞–Ω—É–ª–∞—Ä–Ω–æ—Å—Ç, –∫–æ–µ—Ç–æ –æ–∑–Ω–∞—á–∞–≤–∞, —á–µ –æ–ø–µ—Ä–∞—Ü–∏–∏—Ç–µ –ø–æ –∏–∑—Ç—Ä–∏–≤–∞–Ω–µ –∏ –∑–∞–ø–∏—Å –∑–∞–≤–∏—Å—è—Ç –Ω–µ —Å–∞–º–æ –æ—Ç —Ñ–∏–∫—Å–∏—Ä–∞–Ω–∏—è —Ä–∞–∑–º–µ—Ä, –Ω–æ –∏ –æ—Ç –ø–æ–¥—Ä–∞–≤–Ω—è–≤–∞–Ω–µ—Ç–æ –∫—ä–º —Ç–æ–∑–∏ —Ä–∞–∑–º–µ—Ä. –ù–∞–ø—Ä–∏–º–µ—Ä, –∞–∫–æ –≥—Ä–∞–Ω—É–ª–∞—Ä–Ω–æ—Å—Ç—Ç–∞ –µ 4096 –±–∞–π—Ç–∞ –∏ –ø–æ–∏—Å–∫–∞—Ç–µ –∏–∑—Ç—Ä–∏–≤–∞–Ω–µ –Ω–∞ –∞–¥—Ä–µ—Å 4200, —Ç–æ–≤–∞ –º–æ–∂–µ –¥–∞ –∏–∑—Ç—Ä–∏–µ –≤—Å–∏—á–∫–∏ –¥–∞–Ω–Ω–∏ –æ—Ç –∞–¥—Ä–µ—Å 4096 –¥–æ 8192. –¢–æ–≤–∞ –æ–∑–Ω–∞—á–∞–≤–∞, —á–µ –∫–æ–≥–∞—Ç–æ –∑–∞–ø–∏—Å–≤–∞—Ç–µ –∞—É–¥–∏–æ –¥–∞–Ω–Ω–∏ –≤—ä–≤ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞, —Ç–µ —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–∞—Ç –Ω–∞ –ø–∞—Ä—á–µ—Ç–∞ —Å –ø—Ä–∞–≤–∏–ª–Ω–∏—è —Ä–∞–∑–º–µ—Ä.

### –ó–∞–¥–∞—á–∞ - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞

1. –°—ä–∑–¥–∞–π—Ç–µ –Ω–æ–≤ –ø—Ä–æ–µ–∫—Ç –∑–∞ Wio Terminal, –∏–∑–ø–æ–ª–∑–≤–∞–π–∫–∏ PlatformIO. –ù–∞—Ä–µ—á–µ—Ç–µ —Ç–æ–∑–∏ –ø—Ä–æ–µ–∫—Ç `smart-timer`. –î–æ–±–∞–≤–µ—Ç–µ –∫–æ–¥ –≤—ä–≤ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `setup`, –∑–∞ –¥–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞—Ç–µ —Å–µ—Ä–∏–π–Ω–∏—è –ø–æ—Ä—Ç.

1. –î–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ç–∞ –∫—ä–º —Ñ–∞–π–ª–∞ `platformio.ini`, –∑–∞ –¥–∞ –æ—Å–∏–≥—É—Ä–∏—Ç–µ –¥–æ—Å—Ç—ä–ø –¥–æ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞:

    ```ini
    lib_deps =
        seeed-studio/Seeed Arduino FS @ 2.1.1
        seeed-studio/Seeed Arduino SFUD @ 2.0.2
    ```

1. –û—Ç–≤–æ—Ä–µ—Ç–µ —Ñ–∞–π–ª–∞ `main.cpp` –∏ –¥–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–∞—Ç–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –∑–∞ –≤–∫–ª—é—á–≤–∞–Ω–µ –Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ç–∞ –∑–∞ —Ñ–ª–∞—à –ø–∞–º–µ—Ç –≤ –Ω–∞—á–∞–ª–æ—Ç–æ –Ω–∞ —Ñ–∞–π–ª–∞:

    ```cpp
    #include <sfud.h>
    #include <SPI.h>
    ```

    > üéì SFUD –æ–∑–Ω–∞—á–∞–≤–∞ Serial Flash Universal Driver –∏ –µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –∑–∞ —Ä–∞–±–æ—Ç–∞ —Å –≤—Å–∏—á–∫–∏ —á–∏–ø–æ–≤–µ –∑–∞ —Ñ–ª–∞—à –ø–∞–º–µ—Ç.

1. –í—ä–≤ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `setup` –¥–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–∏—è –∫–æ–¥, –∑–∞ –¥–∞ –Ω–∞—Å—Ç—Ä–æ–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ç–∞ –∑–∞ —Ñ–ª–∞—à –ø–∞–º–µ—Ç:

    ```cpp
    while (!(sfud_init() == SFUD_SUCCESS))
        ;

    sfud_qspi_fast_read_enable(sfud_get_device(SFUD_W25Q32_DEVICE_INDEX), 2);
    ```

    –¢–æ–≤–∞ —Å–µ –∏–∑–ø—ä–ª–Ω—è–≤–∞ –≤ —Ü–∏–∫—ä–ª, –¥–æ–∫–∞—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ç–∞ SFUD –Ω–µ –±—ä–¥–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–∞, —Å–ª–µ–¥ –∫–æ–µ—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä–∞ –±—ä—Ä–∑–æ—Ç–æ —á–µ—Ç–µ–Ω–µ. –í–≥—Ä–∞–¥–µ–Ω–∞—Ç–∞ —Ñ–ª–∞—à –ø–∞–º–µ—Ç –º–æ–∂–µ –¥–∞ –±—ä–¥–µ –¥–æ—Å—Ç—ä–ø–Ω–∞ —á—Ä–µ–∑ Queued Serial Peripheral Interface (QSPI), –≤–∏–¥ SPI –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä, –∫–æ–π—Ç–æ –ø–æ–∑–≤–æ–ª—è–≤–∞ –Ω–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç –¥–æ—Å—Ç—ä–ø —á—Ä–µ–∑ –æ–ø–∞—à–∫–∞ —Å –º–∏–Ω–∏–º–∞–ª–Ω–æ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞. –¢–æ–≤–∞ –ø—Ä–∞–≤–∏ —á–µ—Ç–µ–Ω–µ—Ç–æ –∏ –∑–∞–ø–∏—Å–≤–∞–Ω–µ—Ç–æ –≤—ä–≤ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞ –ø–æ-–±—ä—Ä–∑–æ.

1. –°—ä–∑–¥–∞–π—Ç–µ –Ω–æ–≤ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–∞—Ç–∞ `src`, –Ω–∞—Ä–µ—á–µ–Ω `flash_writer.h`.

1. –î–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–æ—Ç–æ –≤ –Ω–∞—á–∞–ª–æ—Ç–æ –Ω–∞ —Ç–æ–∑–∏ —Ñ–∞–π–ª:

    ```cpp
    #pragma once

    #include <Arduino.h>
    #include <sfud.h>
    ```

    –¢–æ–≤–∞ –≤–∫–ª—é—á–≤–∞ –Ω—è–∫–æ–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ –∑–∞–≥–ª–∞–≤–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ, –≤–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ –∑–∞–≥–ª–∞–≤–Ω–∏—è —Ñ–∞–π–ª –∑–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ç–∞ SFUD –∑–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞.

1. –î–µ—Ñ–∏–Ω–∏—Ä–∞–π—Ç–µ –∫–ª–∞—Å –≤ —Ç–æ–∑–∏ –Ω–æ–≤ –∑–∞–≥–ª–∞–≤–µ–Ω —Ñ–∞–π–ª, –Ω–∞—Ä–µ—á–µ–Ω `FlashWriter`:

    ```cpp
    class FlashWriter
    {
    public:
    
    private:
    };
    ```

1. –í —Å–µ–∫—Ü–∏—è—Ç–∞ `private` –¥–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–∏—è –∫–æ–¥:

    ```cpp
    byte *_sfudBuffer;
    size_t _sfudBufferSize;
    size_t _sfudBufferPos;
    size_t _sfudBufferWritePos;

    const sfud_flash *_flash;
    ```

    –¢–æ–≤–∞ –¥–µ—Ñ–∏–Ω–∏—Ä–∞ –Ω—è–∫–æ–∏ –ø–æ–ª–µ—Ç–∞ –∑–∞ –±—É—Ñ–µ—Ä–∞, –∫–æ–π—Ç–æ —â–µ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –∑–∞ —Å—ä—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –ø—Ä–µ–¥–∏ –∑–∞–ø–∏—Å–≤–∞–Ω–µ—Ç–æ –∏–º –≤—ä–≤ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞. –ò–º–∞ –º–∞—Å–∏–≤ –æ—Ç –±–∞–π—Ç–æ–≤–µ `_sfudBuffer`, –≤ –∫–æ–π—Ç–æ —Å–µ –∑–∞–ø–∏—Å–≤–∞—Ç –¥–∞–Ω–Ω–∏, –∞ –∫–æ–≥–∞—Ç–æ —Ç–æ–π —Å–µ –∑–∞–ø—ä–ª–Ω–∏, –¥–∞–Ω–Ω–∏—Ç–µ —Å–µ –∑–∞–ø–∏—Å–≤–∞—Ç –≤—ä–≤ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞. –ü–æ–ª–µ—Ç–æ `_sfudBufferPos` —Å—ä—Ö—Ä–∞–Ω—è–≤–∞ —Ç–µ–∫—É—â–æ—Ç–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∑–∞ –∑–∞–ø–∏—Å –≤ —Ç–æ–∑–∏ –±—É—Ñ–µ—Ä, –∞ `_sfudBufferWritePos` —Å—ä—Ö—Ä–∞–Ω—è–≤–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –≤—ä–≤ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞ –∑–∞ –∑–∞–ø–∏—Å. `_flash` –µ —É–∫–∞–∑–∞—Ç–µ–ª –∫—ä–º —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞, –≤ –∫–æ—è—Ç–æ —â–µ —Å–µ –∑–∞–ø–∏—Å–≤–∞ ‚Äì –Ω—è–∫–æ–∏ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∏ –∏–º–∞—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —á–∏–ø–æ–≤–µ –∑–∞ —Ñ–ª–∞—à –ø–∞–º–µ—Ç.

1. –î–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–∏—è –º–µ—Ç–æ–¥ –≤ —Å–µ–∫—Ü–∏—è—Ç–∞ `public`, –∑–∞ –¥–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞—Ç–µ —Ç–æ–∑–∏ –∫–ª–∞—Å:

    ```cpp
    void init()
    {
        _flash = sfud_get_device_table() + 0;
        _sfudBufferSize = _flash->chip.erase_gran;
        _sfudBuffer = new byte[_sfudBufferSize];
        _sfudBufferPos = 0;
        _sfudBufferWritePos = 0;
    }
    ```

    –¢–æ–≤–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞ –Ω–∞ Wio Terminal –∑–∞ –∑–∞–ø–∏—Å –∏ –Ω–∞—Å—Ç—Ä–æ–π–≤–∞ –±—É—Ñ–µ—Ä–∏—Ç–µ –≤—ä–∑ –æ—Å–Ω–æ–≤–∞ –Ω–∞ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –≥—Ä–∞–Ω—É–ª–∞—Ä–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞. –¢–æ–≤–∞ –µ –≤ –º–µ—Ç–æ–¥ `init`, –∞ –Ω–µ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, —Ç—ä–π –∫–∞—Ç–æ —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ –∏–∑–≤–∏–∫–∞–Ω–æ —Å–ª–µ–¥ –Ω–∞—Å—Ç—Ä–æ–π–≤–∞–Ω–µ—Ç–æ –Ω–∞ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞ –≤—ä–≤ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `setup`.

1. –î–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–∏—è –∫–æ–¥ –≤ —Å–µ–∫—Ü–∏—è—Ç–∞ `public`:

    ```cpp
    void writeSfudBuffer(byte b)
    {
        _sfudBuffer[_sfudBufferPos++] = b;
        if (_sfudBufferPos == _sfudBufferSize)
        {
            sfud_erase_write(_flash, _sfudBufferWritePos, _sfudBufferSize, _sfudBuffer);
            _sfudBufferWritePos += _sfudBufferSize;
            _sfudBufferPos = 0;
        }
    }

    void writeSfudBuffer(byte *b, size_t len)
    {
        for (size_t i = 0; i < len; ++i)
        {
            writeSfudBuffer(b[i]);
        }
    }

    void flushSfudBuffer()
    {
        if (_sfudBufferPos > 0)
        {
            sfud_erase_write(_flash, _sfudBufferWritePos, _sfudBufferSize, _sfudBuffer);
            _sfudBufferWritePos += _sfudBufferSize;
            _sfudBufferPos = 0;
        }
    }
    ```

    –¢–æ–∑–∏ –∫–æ–¥ –¥–µ—Ñ–∏–Ω–∏—Ä–∞ –º–µ—Ç–æ–¥–∏ –∑–∞ –∑–∞–ø–∏—Å –Ω–∞ –±–∞–π—Ç–æ–≤–µ –≤—ä–≤ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞. –¢–æ–π —Ä–∞–±–æ—Ç–∏, –∫–∞—Ç–æ –∑–∞–ø–∏—Å–≤–∞ –≤ –±—É—Ñ–µ—Ä –≤ –ø–∞–º–µ—Ç—Ç–∞, –∫–æ–π—Ç–æ –µ —Å –ø—Ä–∞–≤–∏–ª–Ω–∏—è —Ä–∞–∑–º–µ—Ä –∑–∞ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞, –∞ –∫–æ–≥–∞—Ç–æ —Ç–æ–∑–∏ –±—É—Ñ–µ—Ä —Å–µ –∑–∞–ø—ä–ª–Ω–∏, —Ç–æ–π —Å–µ –∑–∞–ø–∏—Å–≤–∞ –≤—ä–≤ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞, –∏–∑—Ç—Ä–∏–≤–∞–π–∫–∏ –≤—Å–∏—á–∫–∏ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞—â–∏ –¥–∞–Ω–Ω–∏ –Ω–∞ —Ç–æ–≤–∞ –º—è—Å—Ç–æ. –ò–º–∞ –∏ –º–µ—Ç–æ–¥ `flushSfudBuffer`, –∑–∞ –¥–∞ —Å–µ –∑–∞–ø–∏—à–µ –Ω–µ–ø—ä–ª–µ–Ω –±—É—Ñ–µ—Ä, —Ç—ä–π –∫–∞—Ç–æ –∑–∞–ø–∏—Å–≤–∞–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏ –Ω—è–º–∞ –¥–∞ —Å–∞ —Ç–æ—á–Ω–∏ –∫—Ä–∞—Ç–Ω–∏ –Ω–∞ —Ä–∞–∑–º–µ—Ä–∞ –Ω–∞ –≥—Ä–∞–Ω—É–ª–∞—Ä–Ω–æ—Å—Ç—Ç–∞, —Ç–∞–∫–∞ —á–µ –∫—Ä–∞–π–Ω–∞—Ç–∞ —á–∞—Å—Ç –æ—Ç –¥–∞–Ω–Ω–∏—Ç–µ —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ –∑–∞–ø–∏—Å–∞–Ω–∞.

    > üíÅ –ö—Ä–∞–π–Ω–∞—Ç–∞ —á–∞—Å—Ç –æ—Ç –¥–∞–Ω–Ω–∏—Ç–µ —â–µ –∑–∞–ø–∏—à–µ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –Ω–µ–∂–µ–ª–∞–Ω–∏ –¥–∞–Ω–Ω–∏, –Ω–æ —Ç–æ–≤–∞ –µ –ø—Ä–∏–µ–º–ª–∏–≤–æ, —Ç—ä–π –∫–∞—Ç–æ —â–µ —Å–µ —á–µ—Ç–µ —Å–∞–º–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—Ç–∞ —á–∞—Å—Ç –æ—Ç –¥–∞–Ω–Ω–∏—Ç–µ.

### –ó–∞–¥–∞—á–∞ - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ –∑–∞–ø–∏—Å –Ω–∞ –∞—É–¥–∏–æ

1. –°—ä–∑–¥–∞–π—Ç–µ –Ω–æ–≤ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–∞—Ç–∞ `src`, –Ω–∞—Ä–µ—á–µ–Ω `config.h`.

1. –î–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–æ—Ç–æ –≤ –Ω–∞—á–∞–ª–æ—Ç–æ –Ω–∞ —Ç–æ–∑–∏ —Ñ–∞–π–ª:

    ```cpp
    #pragma once

    #define RATE 16000
    #define SAMPLE_LENGTH_SECONDS 4
    #define SAMPLES RATE * SAMPLE_LENGTH_SECONDS
    #define BUFFER_SIZE (SAMPLES * 2) + 44
    #define ADC_BUF_LEN 1600
    ```

    –¢–æ–∑–∏ –∫–æ–¥ –∑–∞–¥–∞–≤–∞ –Ω—è–∫–æ–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏ –∑–∞ –∑–∞–ø–∏—Å–∞ –Ω–∞ –∞—É–¥–∏–æ.

    | –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞             | –°—Ç–æ–π–Ω–æ—Å—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
    | --------------------- | -------: | -------- |
    | RATE                  | 16000    | –ß–µ—Å—Ç–æ—Ç–∞—Ç–∞ –Ω–∞ –∏–∑–≤–∞–¥–∫–∏—Ç–µ –∑–∞ –∞—É–¥–∏–æ—Ç–æ. 16 000 –µ 16KHz |
    | SAMPLE_LENGTH_SECONDS | 4        | –ü—Ä–æ–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –∑–∞–ø–∏—Å–∞. –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –µ –Ω–∞ 4 —Å–µ–∫—É–Ω–¥–∏. –ó–∞ –ø–æ-–¥—ä–ª—ä–≥ –∑–∞–ø–∏—Å —É–≤–µ–ª–∏—á–µ—Ç–µ —Ç–∞–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç. |
    | SAMPLES               | 64000    | –û–±—â–∏—è—Ç –±—Ä–æ–π –∞—É–¥–∏–æ –∏–∑–≤–∞–¥–∫–∏, –∫–æ–∏—Ç–æ —â–µ –±—ä–¥–∞—Ç –∑–∞–ø–∏—Å–∞–Ω–∏. –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ —á–µ—Å—Ç–æ—Ç–∞—Ç–∞ –Ω–∞ –∏–∑–≤–∞–¥–∫–∏—Ç–µ * –±—Ä–æ—è —Å–µ–∫—É–Ω–¥–∏ |
    | BUFFER_SIZE           | 128044   | –†–∞–∑–º–µ—Ä—ä—Ç –Ω–∞ –∞—É–¥–∏–æ –±—É—Ñ–µ—Ä–∞ –∑–∞ –∑–∞–ø–∏—Å. –ê—É–¥–∏–æ—Ç–æ —â–µ –±—ä–¥–µ –∑–∞–ø–∏—Å–∞–Ω–æ –∫–∞—Ç–æ WAV —Ñ–∞–π–ª, –∫–æ–π—Ç–æ –µ 44 –±–∞–π—Ç–∞ –∑–∞–≥–ª–∞–≤–∏–µ, —Å–ª–µ–¥ —Ç–æ–≤–∞ 128 000 –±–∞–π—Ç–∞ –∞—É–¥–∏–æ –¥–∞–Ω–Ω–∏ (–≤—Å—è–∫–∞ –∏–∑–≤–∞–¥–∫–∞ –µ 2 –±–∞–π—Ç–∞) |
    | ADC_BUF_LEN           | 1600     | –†–∞–∑–º–µ—Ä—ä—Ç –Ω–∞ –±—É—Ñ–µ—Ä–∏—Ç–µ, –∫–æ–∏—Ç–æ —â–µ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç –∑–∞ –∑–∞–ø–∏—Å –Ω–∞ –∞—É–¥–∏–æ –æ—Ç DMAC |

    > üíÅ –ê–∫–æ —Å–º—è—Ç–∞—Ç–µ, —á–µ 4 —Å–µ–∫—É–Ω–¥–∏ —Å–∞ —Ç–≤—ä—Ä–¥–µ –∫—Ä–∞—Ç–∫–∏, –∑–∞ –¥–∞ –ø–æ–∏—Å–∫–∞—Ç–µ —Ç–∞–π–º–µ—Ä, –º–æ–∂–µ—Ç–µ –¥–∞ —É–≤–µ–ª–∏—á–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ `SAMPLE_LENGTH_SECONDS`, –∏ –≤—Å–∏—á–∫–∏ –æ—Å—Ç–∞–Ω–∞–ª–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ —â–µ —Å–µ –ø—Ä–µ–∏–∑—á–∏—Å–ª—è—Ç.

1. –°—ä–∑–¥–∞–π—Ç–µ –Ω–æ–≤ —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–∞—Ç–∞ `src`, –Ω–∞—Ä–µ—á–µ–Ω `mic.h`.

1. –î–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–æ—Ç–æ –≤ –Ω–∞—á–∞–ª–æ—Ç–æ –Ω–∞ —Ç–æ–∑–∏ —Ñ–∞–π–ª:

    ```cpp
    #pragma once

    #include <Arduino.h>

    #include "config.h"
    #include "flash_writer.h"
    ```

    –¢–æ–≤–∞ –≤–∫–ª—é—á–≤–∞ –Ω—è–∫–æ–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ –∑–∞–≥–ª–∞–≤–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ, –≤–∫–ª—é—á–∏—Ç–µ–ª–Ω–æ –∑–∞–≥–ª–∞–≤–Ω–∏—Ç–µ —Ñ–∞–π–ª–æ–≤–µ `config.h` –∏ `FlashWriter`.

1. –î–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–æ—Ç–æ, –∑–∞ –¥–∞ –¥–µ—Ñ–∏–Ω–∏—Ä–∞—Ç–µ –∫–ª–∞—Å `Mic`, –∫–æ–π—Ç–æ –º–æ–∂–µ –¥–∞ –∑–∞–ø–∏—Å–≤–∞ –æ—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞:

    ```cpp
    class Mic
    {
    public:
        Mic()
        {
            _isRecording = false;
            _isRecordingReady = false;
        }
    
        void startRecording()
        {
            _isRecording = true;
            _isRecordingReady = false;
        }
    
        bool isRecording()
        {
            return _isRecording;
        }
    
        bool isRecordingReady()
        {
            return _isRecordingReady;
        }
    
    private:
        volatile bool _isRecording;
        volatile bool _isRecordingReady;
        FlashWriter _writer;
    };
    
    Mic mic;
    ```

    –¢–æ–∑–∏ –∫–ª–∞—Å –≤ –º–æ–º–µ–Ω—Ç–∞ –∏–º–∞ —Å–∞–º–æ –Ω—è–∫–æ–ª–∫–æ –ø–æ–ª–µ—Ç–∞, –∑–∞ –¥–∞ —Å–ª–µ–¥–∏ –¥–∞–ª–∏ –∑–∞–ø–∏—Å—ä—Ç –µ –∑–∞–ø–æ—á–Ω–∞–ª –∏ –¥–∞–ª–∏ –∑–∞–ø–∏—Å—ä—Ç –µ –≥–æ—Ç–æ–≤ –∑–∞ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ. –ö–æ–≥–∞—Ç–æ DMAC –µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, —Ç–æ–π –Ω–µ–ø—Ä–µ–∫—ä—Å–Ω–∞—Ç–æ –∑–∞–ø–∏—Å–≤–∞ –≤ –ø–∞–º–µ—Ç–Ω–∏ –±—É—Ñ–µ—Ä–∏, —Ç–∞–∫–∞ —á–µ —Ñ–ª–∞–≥—ä—Ç `_isRecording` –æ–ø—Ä–µ–¥–µ–ª—è –¥–∞–ª–∏ —Ç–µ–∑–∏ –±—É—Ñ–µ—Ä–∏ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ –æ–±—Ä–∞–±–æ—Ç–≤–∞—Ç –∏–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–∞—Ç. –§–ª–∞–≥—ä—Ç `_isRecordingReady` —â–µ –±—ä–¥–µ –∑–∞–¥–∞–¥–µ–Ω, –∫–æ–≥–∞—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏—Ç–µ 4 —Å–µ–∫—É–Ω–¥–∏ –∞—É–¥–∏–æ –±—ä–¥–∞—Ç –∑–∞–ø–∏—Å–∞–Ω–∏. –ü–æ–ª–µ—Ç–æ `_writer` —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –∑–∞ —Å—ä—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –∞—É–¥–∏–æ –¥–∞–Ω–Ω–∏—Ç–µ –≤—ä–≤ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞.

    –°–ª–µ–¥ —Ç–æ–≤–∞ —Å–µ –¥–µ–∫–ª–∞—Ä–∏—Ä–∞ –≥–ª–æ–±–∞–ª–Ω–∞ –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∞ –∑–∞ –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è –Ω–∞ –∫–ª–∞—Å–∞ `Mic`.

1. –î–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–∏—è –∫–æ–¥ –≤ —Å–µ–∫—Ü–∏—è—Ç–∞ `private` –Ω–∞ –∫–ª–∞—Å–∞ `Mic`:

    ```cpp
    typedef struct
    {
        uint16_t btctrl;
        uint16_t btcnt;
        uint32_t srcaddr;
        uint32_t dstaddr;
        uint32_t descaddr;
    } dmacdescriptor;

    // Globals - DMA and ADC
    volatile dmacdescriptor _wrb[DMAC_CH_NUM] __attribute__((aligned(16)));
    dmacdescriptor _descriptor_section[DMAC_CH_NUM] __attribute__((aligned(16)));
    dmacdescriptor _descriptor __attribute__((aligned(16)));

    void configureDmaAdc()
    {
        // Configure DMA to sample from ADC at a regular interval (triggered by timer/counter)
        DMAC->BASEADDR.reg = (uint32_t)_descriptor_section;                    // Specify the location of the descriptors
        DMAC->WRBADDR.reg = (uint32_t)_wrb;                                    // Specify the location of the write back descriptors
        DMAC->CTRL.reg = DMAC_CTRL_DMAENABLE | DMAC_CTRL_LVLEN(0xf);           // Enable the DMAC peripheral
        DMAC->Channel[1].CHCTRLA.reg = DMAC_CHCTRLA_TRIGSRC(TC5_DMAC_ID_OVF) | // Set DMAC to trigger on TC5 timer overflow
                                        DMAC_CHCTRLA_TRIGACT_BURST;             // DMAC burst transfer

        _descriptor.descaddr = (uint32_t)&_descriptor_section[1];                    // Set up a circular descriptor
        _descriptor.srcaddr = (uint32_t)&ADC1->RESULT.reg;                           // Take the result from the ADC0 RESULT register
        _descriptor.dstaddr = (uint32_t)_adc_buf_0 + sizeof(uint16_t) * ADC_BUF_LEN; // Place it in the adc_buf_0 array
        _descriptor.btcnt = ADC_BUF_LEN;                                             // Beat count
        _descriptor.btctrl = DMAC_BTCTRL_BEATSIZE_HWORD |                            // Beat size is HWORD (16-bits)
                                DMAC_BTCTRL_DSTINC |                                    // Increment the destination address
                                DMAC_BTCTRL_VALID |                                     // Descriptor is valid
                                DMAC_BTCTRL_BLOCKACT_SUSPEND;                           // Suspend DMAC channel 0 after block transfer
        memcpy(&_descriptor_section[0], &_descriptor, sizeof(_descriptor));          // Copy the descriptor to the descriptor section

        _descriptor.descaddr = (uint32_t)&_descriptor_section[0];                    // Set up a circular descriptor
        _descriptor.srcaddr = (uint32_t)&ADC1->RESULT.reg;                           // Take the result from the ADC0 RESULT register
        _descriptor.dstaddr = (uint32_t)_adc_buf_1 + sizeof(uint16_t) * ADC_BUF_LEN; // Place it in the adc_buf_1 array
        _descriptor.btcnt = ADC_BUF_LEN;                                             // Beat count
        _descriptor.btctrl = DMAC_BTCTRL_BEATSIZE_HWORD |                            // Beat size is HWORD (16-bits)
                                DMAC_BTCTRL_DSTINC |                                    // Increment the destination address
                                DMAC_BTCTRL_VALID |                                     // Descriptor is valid
                                DMAC_BTCTRL_BLOCKACT_SUSPEND;                           // Suspend DMAC channel 0 after block transfer
        memcpy(&_descriptor_section[1], &_descriptor, sizeof(_descriptor));          // Copy the descriptor to the descriptor section

        // Configure NVIC
        NVIC_SetPriority(DMAC_1_IRQn, 0); // Set the Nested Vector Interrupt Controller (NVIC) priority for DMAC1 to 0 (highest)
        NVIC_EnableIRQ(DMAC_1_IRQn);      // Connect DMAC1 to Nested Vector Interrupt Controller (NVIC)

        // Activate the suspend (SUSP) interrupt on DMAC channel 1
        DMAC->Channel[1].CHINTENSET.reg = DMAC_CHINTENSET_SUSP;

        // Configure ADC
        ADC1->INPUTCTRL.bit.MUXPOS = ADC_INPUTCTRL_MUXPOS_AIN12_Val; // Set the analog input to ADC0/AIN2 (PB08 - A4 on Metro M4)
        while (ADC1->SYNCBUSY.bit.INPUTCTRL)
            ;                              // Wait for synchronization
        ADC1->SAMPCTRL.bit.SAMPLEN = 0x00; // Set max Sampling Time Length to half divided ADC clock pulse (2.66us)
        while (ADC1->SYNCBUSY.bit.SAMPCTRL)
            ;                                         // Wait for synchronization
        ADC1->CTRLA.reg = ADC_CTRLA_PRESCALER_DIV128; // Divide Clock ADC GCLK by 128 (48MHz/128 = 375kHz)
        ADC1->CTRLB.reg = ADC_CTRLB_RESSEL_12BIT |    // Set ADC resolution to 12 bits
                            ADC_CTRLB_FREERUN;          // Set ADC to free run mode
        while (ADC1->SYNCBUSY.bit.CTRLB)
            ;                       // Wait for synchronization
        ADC1->CTRLA.bit.ENABLE = 1; // Enable the ADC
        while (ADC1->SYNCBUSY.bit.ENABLE)
            ;                       // Wait for synchronization
        ADC1->SWTRIG.bit.START = 1; // Initiate a software trigger to start an ADC conversion
        while (ADC1->SYNCBUSY.bit.SWTRIG)
            ; // Wait for synchronization

        // Enable DMA channel 1
        DMAC->Channel[1].CHCTRLA.bit.ENABLE = 1;

        // Configure Timer/Counter 5
        GCLK->PCHCTRL[TC5_GCLK_ID].reg = GCLK_PCHCTRL_CHEN |     // Enable peripheral channel for TC5
                                            GCLK_PCHCTRL_GEN_GCLK1; // Connect generic clock 0 at 48MHz

        TC5->COUNT16.WAVE.reg = TC_WAVE_WAVEGEN_MFRQ; // Set TC5 to Match Frequency (MFRQ) mode
        TC5->COUNT16.CC[0].reg = 3000 - 1;            // Set the trigger to 16 kHz: (4Mhz / 16000) - 1
        while (TC5->COUNT16.SYNCBUSY.bit.CC0)
            ; // Wait for synchronization

        // Start Timer/Counter 5
        TC5->COUNT16.CTRLA.bit.ENABLE = 1; // Enable the TC5 timer
        while (TC5->COUNT16.SYNCBUSY.bit.ENABLE)
            ; // Wait for synchronization
    }

    uint16_t _adc_buf_0[ADC_BUF_LEN];
    uint16_t _adc_buf_1[ADC_BUF_LEN];
    ```

    –¢–æ–∑–∏ –∫–æ–¥ –¥–µ—Ñ–∏–Ω–∏—Ä–∞ –º–µ—Ç–æ–¥ `configureDmaAdc`, –∫–æ–π—Ç–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞ DMAC, —Å–≤—ä—Ä–∑–≤–∞–π–∫–∏ –≥–æ —Å ADC –∏ –Ω–∞—Å—Ç—Ä–æ–π–≤–∞–π–∫–∏ –≥–æ –¥–∞ –ø–æ–ø—ä–ª–≤–∞ –¥–≤–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ —Ä–µ–¥—É–≤–∞—â–∏ —Å–µ –±—É—Ñ–µ—Ä–∞, `_adc_buf_0` –∏ `_adc_buf_1`.

    > üíÅ –ï–¥–∏–Ω –æ—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç—ä—Ü–∏—Ç–µ –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –∑–∞ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∏ –µ —Å–ª–æ–∂–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –∫–æ–¥–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º –∑–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ö–∞—Ä–¥—É–µ—Ä–∞, —Ç—ä–π –∫–∞—Ç–æ –≤–∞—à–∏—è—Ç –∫–æ–¥ —Ä–∞–±–æ—Ç–∏ –Ω–∞ –º–Ω–æ–≥–æ –Ω–∏—Å–∫–æ –Ω–∏–≤–æ, –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∞–π–∫–∏ —Å —Ö–∞—Ä–¥—É–µ—Ä–∞. –¢–æ–∑–∏ –∫–æ–¥ –µ –ø–æ-—Å–ª–æ–∂–µ–Ω –æ—Ç —Ç–æ–≤–∞, –∫–æ–µ—Ç–æ –±–∏—Ö—Ç–µ –Ω–∞–ø–∏—Å–∞–ª–∏ –∑–∞ –µ–¥–Ω–æ–ø–ª–∞—Ç–∫–æ–≤ –∫–æ–º–ø—é—Ç—ä—Ä –∏–ª–∏ –Ω–∞—Å—Ç–æ–ª–µ–Ω –∫–æ–º–ø—é—Ç—ä—Ä, —Ç—ä–π –∫–∞—Ç–æ –Ω—è–º–∞ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞ —Å–∏—Å—Ç–µ–º–∞, –∫–æ—è—Ç–æ –¥–∞ –ø–æ–º–∞–≥–∞. –°—ä—â–µ—Å—Ç–≤—É–≤–∞—Ç –Ω—è–∫–æ–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∫–æ–∏—Ç–æ –º–æ–≥–∞—Ç –¥–∞ –æ–ø—Ä–æ—Å—Ç—è—Ç —Ç–æ–≤–∞, –Ω–æ –≤—Å–µ –ø–∞–∫ –∏–º–∞ –º–Ω–æ–≥–æ —Å–ª–æ–∂–Ω–æ—Å—Ç.

1. –ü–æ–¥ —Ç–æ–∑–∏ –∫–æ–¥ –¥–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–æ—Ç–æ:

    ```cpp
    // WAV files have a header. This struct defines that header
    struct wavFileHeader
    {
        char riff[4];         /* "RIFF"                                  */
        long flength;         /* file length in bytes                    */
        char wave[4];         /* "WAVE"                                  */
        char fmt[4];          /* "fmt "                                  */
        long chunk_size;      /* size of FMT chunk in bytes (usually 16) */
        short format_tag;     /* 1=PCM, 257=Mu-Law, 258=A-Law, 259=ADPCM */
        short num_chans;      /* 1=mono, 2=stereo                        */
        long srate;           /* Sampling rate in samples per second     */
        long bytes_per_sec;   /* bytes per second = srate*bytes_per_samp */
        short bytes_per_samp; /* 2=16-bit mono, 4=16-bit stereo          */
        short bits_per_samp;  /* Number of bits per sample               */
        char data[4];         /* "data"                                  */
        long dlength;         /* data length in bytes (filelength - 44)  */
    };

    void initBufferHeader()
    {
        wavFileHeader wavh;

        strncpy(wavh.riff, "RIFF", 4);
        strncpy(wavh.wave, "WAVE", 4);
        strncpy(wavh.fmt, "fmt ", 4);
        strncpy(wavh.data, "data", 4);

        wavh.chunk_size = 16;
        wavh.format_tag = 1; // PCM
        wavh.num_chans = 1;  // mono
        wavh.srate = RATE;
        wavh.bytes_per_sec = (RATE * 1 * 16 * 1) / 8;
        wavh.bytes_per_samp = 2;
        wavh.bits_per_samp = 16;
        wavh.dlength = RATE * 2 * 1 * 16 / 2;
        wavh.flength = wavh.dlength + 44;

        _writer.writeSfudBuffer((byte *)&wavh, 44);
    }
    ```

    –¢–æ–∑–∏ –∫–æ–¥ –¥–µ—Ñ–∏–Ω–∏—Ä–∞ –∑–∞–≥–ª–∞–≤–∏–µ—Ç–æ –Ω–∞ WAV —Ñ–∞–π–ª–∞ –∫–∞—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ—è—Ç–æ –∑–∞–µ–º–∞ 44 –±–∞–π—Ç–∞ –ø–∞–º–µ—Ç. –¢–æ–π –∑–∞–ø–∏—Å–≤–∞ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –∑–∞ —á–µ—Å—Ç–æ—Ç–∞—Ç–∞, —Ä–∞–∑–º–µ—Ä–∞ –∏ –±—Ä–æ—è –Ω–∞ –∫–∞–Ω–∞–ª–∏—Ç–µ –Ω–∞ –∞—É–¥–∏–æ —Ñ–∞–π–ª–∞. –¢–æ–≤–∞ –∑–∞–≥–ª–∞–≤–∏–µ —Å–ª–µ–¥ —Ç–æ–≤–∞ —Å–µ –∑–∞–ø–∏—Å–≤–∞ –≤—ä–≤ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞.

1. –ü–æ–¥ —Ç–æ–∑–∏ –∫–æ–¥ –¥–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–æ—Ç–æ, –∑–∞ –¥–∞ –¥–µ–∫–ª–∞—Ä–∏—Ä–∞—Ç–µ –º–µ—Ç–æ–¥, –∫–æ–π—Ç–æ —â–µ —Å–µ –∏–∑–≤–∏–∫–≤–∞, –∫–æ–≥–∞—Ç–æ –∞—É–¥–∏–æ –±—É—Ñ–µ—Ä–∏—Ç–µ —Å–∞ –≥–æ—Ç–æ–≤–∏ –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞:

    ```cpp
    void audioCallback(uint16_t *buf, uint32_t buf_len)
    {
        static uint32_t idx = 44;

        if (_isRecording)
        {
            for (uint32_t i = 0; i < buf_len; i++)
            {
                int16_t audio_value = ((int16_t)buf[i] - 2048) * 16;

                _writer.writeSfudBuffer(audio_value & 0xFF);
                _writer.writeSfudBuffer((audio_value >> 8) & 0xFF);
            }

            idx += buf_len;
                
            if (idx >= BUFFER_SIZE)
            {
                _writer.flushSfudBuffer();
                idx = 44;
                _isRecording = false;
                _isRecordingReady = true;
            }
        }
    }
    ```

    –ê—É–¥–∏–æ –±—É—Ñ–µ—Ä–∏—Ç–µ —Å–∞ –º–∞—Å–∏–≤–∏ –æ—Ç 16-–±–∏—Ç–æ–≤–∏ —Ü–µ–ª–∏ —á–∏—Å–ª–∞, —Å—ä–¥—ä—Ä–∂–∞—â–∏ –∞—É–¥–∏–æ—Ç–æ –æ—Ç ADC. ADC –≤—Ä—ä—â–∞ 12-–±–∏—Ç–æ–≤–∏ –±–µ–∑–∑–Ω–∞–∫–æ–≤–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (0-1023), —Ç–∞–∫–∞ —á–µ —Ç–µ —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–∞—Ç –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–∏ –≤ 16-–±–∏—Ç–æ–≤–∏ –∑–Ω–∞–∫–æ–≤–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏, –∞ —Å–ª–µ–¥ —Ç–æ–≤–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–∏ –≤ 2 –±–∞–π—Ç–∞, –∑–∞ –¥–∞ –±—ä–¥–∞—Ç —Å—ä—Ö—Ä–∞–Ω–µ–Ω–∏ –∫–∞—Ç–æ —Å—É—Ä–æ–≤–∏ –¥–≤–æ–∏—á–Ω–∏ –¥–∞–Ω–Ω–∏.

    –¢–µ–∑–∏ –±–∞–π—Ç–æ–≤–µ —Å–µ –∑–∞–ø–∏—Å–≤–∞—Ç –≤—ä–≤ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞. –ó–∞–ø–∏—Å—ä—Ç –∑–∞–ø–æ—á–≤–∞ –æ—Ç –∏–Ω–¥–µ–∫—Å 44 ‚Äì —Ç–æ–≤–∞ –µ –æ—Ç–º–µ—Å—Ç–≤–∞–Ω–µ—Ç–æ –æ—Ç 44-—Ç–µ –±–∞–π—Ç–∞, –∑–∞–ø–∏—Å–∞–Ω–∏ –∫–∞—Ç–æ –∑–∞–≥–ª–∞–≤–∏–µ –Ω–∞ WAV —Ñ–∞–π–ª–∞. –°–ª–µ–¥ –∫–∞—Ç–æ –≤—Å–∏—á–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏ –±–∞–π—Ç–æ–≤–µ –∑–∞ –∏–∑–∏—Å–∫–≤–∞–Ω–∞—Ç–∞ –¥—ä–ª–∂–∏–Ω–∞ –Ω–∞ –∞—É–¥–∏–æ—Ç–æ –±—ä–¥–∞—Ç –∑–∞–ø–∏—Å–∞–Ω–∏, –æ—Å—Ç–∞–Ω–∞–ª–∏—Ç–µ –¥–∞–Ω–Ω–∏ —Å–µ –∑–∞–ø–∏—Å–≤–∞—Ç –≤—ä–≤ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞.

1. –í —Å–µ–∫—Ü–∏—è—Ç–∞ `public` –Ω–∞ –∫–ª–∞—Å–∞ `Mic` –¥–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–∏—è –∫–æ–¥:

    ```cpp
    void dmaHandler()
    {
        static uint8_t count = 0;

        if (DMAC->Channel[1].CHINTFLAG.bit.SUSP)
        {
            DMAC->Channel[1].CHCTRLB.reg = DMAC_CHCTRLB_CMD_RESUME;
            DMAC->Channel[1].CHINTFLAG.bit.SUSP = 1;

            if (count)
            {
                audioCallback(_adc_buf_0, ADC_BUF_LEN);
            }
            else
            {
                audioCallback(_adc_buf_1, ADC_BUF_LEN);
            }

            count = (count + 1) % 2;
        }
    }
    ```

    –¢–æ–∑–∏ –∫–æ–¥ —â–µ –±—ä–¥–µ –∏–∑–≤–∏–∫–∞–Ω –æ—Ç DMAC, –∑–∞ –¥–∞ —É–≤–µ–¥–æ–º–∏ –≤–∞—à–∏—è –∫–æ–¥, —á–µ –±—É—Ñ–µ—Ä–∏—Ç–µ —Å–∞ –≥–æ—Ç–æ–≤–∏ –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞. –¢–æ–π –ø—Ä–æ–≤–µ—Ä—è–≤–∞ –¥–∞–ª–∏ –∏–º–∞ –¥–∞–Ω–Ω–∏ –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –∏–∑–≤–∏–∫–≤–∞ –º–µ—Ç–æ–¥–∞ `audioCallback` —Å –ø–æ–¥—Ö–æ–¥—è—â–∏—è –±—É—Ñ–µ—Ä.

1. –ò–∑–≤—ä–Ω –∫–ª–∞—Å–∞, —Å–ª–µ–¥ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è—Ç–∞ `Mic mic;`, –¥–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–∏—è –∫–æ–¥:

    ```cpp
    void DMAC_1_Handler()
    {
        mic.dmaHandler();
    }
    ```

    `DMAC_1_Handler` —â–µ –±—ä–¥–µ –∏–∑–≤–∏–∫–∞–Ω –æ—Ç DMAC, –∫–æ–≥–∞—Ç–æ –±—É—Ñ–µ—Ä–∏—Ç–µ —Å–∞ –≥–æ—Ç–æ–≤–∏ –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞. –¢–∞–∑–∏ —Ñ—É–Ω–∫—Ü–∏—è —Å–µ –Ω–∞–º–∏—Ä–∞ –ø–æ –∏–º–µ, —Ç–∞–∫–∞ —á–µ –ø—Ä–æ—Å—Ç–æ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞, –∑–∞ –¥–∞ –±—ä–¥–µ –∏–∑–≤–∏–∫–∞–Ω–∞.

1. –î–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–∏—Ç–µ –¥–≤–∞ –º–µ—Ç–æ–¥–∞ –≤ —Å–µ–∫—Ü–∏—è—Ç–∞ `public` –Ω–∞ –∫–ª–∞—Å–∞ `Mic`:

    ```cpp
    void init()
    {
        analogReference(AR_INTERNAL2V23);

        _writer.init();

        initBufferHeader();
        configureDmaAdc();
    }

    void reset()
    {
        _isRecordingReady = false;
        _isRecording = false;

        _writer.reset();

        initBufferHeader();
    }
    ```

    –ú–µ—Ç–æ–¥—ä—Ç `init` —Å—ä–¥—ä—Ä–∂–∞ –∫–æ–¥ –∑–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –∫–ª–∞—Å–∞ `Mic`. –¢–æ–∑–∏ –º–µ—Ç–æ–¥ –∑–∞–¥–∞–≤–∞ –ø—Ä–∞–≤–∏–ª–Ω–æ—Ç–æ –Ω–∞–ø—Ä–µ–∂–µ–Ω–∏–µ –∑–∞ –ø–∏–Ω–∞ –Ω–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞, –Ω–∞—Å—Ç—Ä–æ–π–≤–∞ –ø–∏—Å–∞—Ç–µ–ª—è –∑–∞ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞, –∑–∞–ø–∏—Å–≤–∞ –∑–∞–≥–ª–∞–≤–∏–µ—Ç–æ –Ω–∞ WAV —Ñ–∞–π–ª–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞ DMAC. –ú–µ—Ç–æ–¥—ä—Ç `reset` –Ω—É–ª–∏—Ä–∞ —Ñ–ª–∞—à –ø–∞–º–µ—Ç—Ç–∞ –∏ –ø—Ä–µ–∑–∞–ø–∏—Å–≤–∞ –∑–∞–≥–ª–∞–≤–∏–µ—Ç–æ, —Å–ª–µ–¥ –∫–∞—Ç–æ –∞—É–¥–∏–æ—Ç–æ –µ –∑–∞–ø–∏—Å–∞–Ω–æ –∏ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–æ.

### –ó–∞–¥–∞—á–∞ - –∑–∞–ø–∏—Å –Ω–∞ –∞—É–¥–∏–æ

1. –í—ä–≤ —Ñ–∞–π–ª–∞ `main.cpp` –¥–æ–±–∞–≤–µ—Ç–µ –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –∑–∞ –≤–∫–ª—é—á–≤–∞–Ω–µ –Ω–∞ –∑–∞–≥–ª–∞–≤–Ω–∏—è —Ñ–∞–π–ª `mic.h`:

    ```cpp
    #include "mic.h"
    ```

1. –í—ä–≤ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `setup` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–π—Ç–µ –±—É—Ç–æ–Ω–∞ C. –ó–∞–ø–∏—Å—ä—Ç –Ω–∞ –∞—É–¥–∏–æ —â–µ –∑–∞–ø–æ—á–Ω–µ, –∫–æ–≥–∞—Ç–æ —Ç–æ–∑–∏ –±—É—Ç–æ–Ω –±—ä–¥–µ –Ω–∞—Ç–∏—Å–Ω–∞—Ç, –∏ —â–µ –ø—Ä–æ–¥—ä–ª–∂–∏ 4 —Å–µ–∫—É–Ω–¥–∏:

    ```cpp
    pinMode(WIO_KEY_C, INPUT_PULLUP);
    ```

1. –ü–æ–¥ —Ç–æ–≤–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–π—Ç–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞, —Å–ª–µ–¥ –∫–æ–µ—Ç–æ –æ—Ç–ø–µ—á–∞—Ç–∞–π—Ç–µ –≤ –∫–æ–Ω–∑–æ–ª–∞—Ç–∞, —á–µ –∞—É–¥–∏–æ—Ç–æ –µ –≥–æ—Ç–æ–≤–æ –∑–∞ –∑–∞–ø–∏—Å:

    ```cpp
    mic.init();

    Serial.println("Ready.");
    ```

1. –ù–∞–¥ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `loop` –¥–µ—Ñ–∏–Ω–∏—Ä–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –∑–∞–ø–∏—Å–∞–Ω–æ—Ç–æ –∞—É–¥–∏–æ. –ó–∞—Å–µ–≥–∞ —Ç—è –Ω–µ –ø—Ä–∞–≤–∏ –Ω–∏—â–æ, –Ω–æ –ø–æ-–∫—ä—Å–Ω–æ –≤ —É—Ä–æ–∫–∞ —â–µ –∏–∑–ø—Ä–∞—Ç–∏ —Ä–µ—á—Ç–∞ –∑–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–µ –≤ —Ç–µ–∫—Å—Ç:

    ```cpp
    void processAudio()
    {
    
    }
    ```

1. –î–æ–±–∞–≤–µ—Ç–µ —Å–ª–µ–¥–Ω–æ—Ç–æ –≤—ä–≤ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `loop`:

    ```cpp
    void loop()
    {
        if (digitalRead(WIO_KEY_C) == LOW && !mic.isRecording())
        {
            Serial.println("Starting recording...");
            mic.startRecording();
        }
    
        if (!mic.isRecording() && mic.isRecordingReady())
        {
            Serial.println("Finished recording");
    
            processAudio();
    
            mic.reset();
        }
    }
    ```

    –¢–æ–∑–∏ –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä—è–≤–∞ –±—É—Ç–æ–Ω–∞ C –∏ –∞–∫–æ —Ç–æ–π –µ –Ω–∞—Ç–∏—Å–Ω–∞—Ç –∏ –∑–∞–ø–∏—Å—ä—Ç –Ω–µ –µ –∑–∞–ø–æ—á–Ω–∞–ª, –ø–æ–ª–µ—Ç–æ `_isRecording` –Ω–∞ –∫–ª–∞—Å–∞ `Mic` —Å–µ –∑–∞–¥–∞–≤–∞ –Ω–∞ true. –¢–æ–≤–∞ —â–µ –Ω–∞–∫–∞—Ä–∞ –º–µ—Ç–æ–¥–∞ `audioCallback` –Ω–∞ –∫–ª–∞—Å–∞ `Mic` –¥–∞ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞ –∞—É–¥–∏–æ, –¥–æ–∫–∞—Ç–æ –Ω–µ –±—ä–¥–∞—Ç –∑–∞–ø–∏—Å–∞–Ω–∏ 4 —Å–µ–∫—É–Ω–¥–∏. –°–ª–µ–¥ –∫–∞—Ç–æ –±—ä–¥–∞—Ç –∑–∞–ø–∏—Å–∞–Ω–∏ 4 —Å–µ–∫—É–Ω–¥–∏ –∞—É–¥–∏–æ, –ø–æ–ª–µ—Ç–æ `_isRecording` —Å–µ –∑–∞–¥–∞–≤–∞ –Ω–∞ false, –∞ –ø–æ–ª–µ—Ç–æ `_isRecordingReady` —Å–µ –∑–∞–¥–∞–≤–∞ –Ω–∞ true. –¢–æ–≤–∞ —Å–ª–µ–¥ —Ç–æ–≤–∞ —Å–µ –ø—Ä–æ–≤–µ—Ä—è–≤–∞ –≤—ä–≤ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `loop`, –∏ –∫–æ–≥–∞—Ç–æ –µ true, —Å–µ –∏–∑–≤–∏–∫–≤–∞ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `processAudio`, —Å–ª–µ–¥ –∫–æ–µ—Ç–æ –∫–ª–∞—Å—ä—Ç `Mic` —Å–µ –Ω—É–ª–∏—Ä–∞.

1. –ö–æ–º–ø–∏–ª–∏—Ä–∞–π—Ç–µ —Ç–æ–∑–∏ –∫–æ–¥, –∫–∞—á–µ—Ç–µ –≥–æ –Ω–∞ –≤–∞—à–∏—è Wio Terminal –∏ –≥–æ —Ç–µ—Å—Ç–≤–∞–π—Ç–µ –ø—Ä–µ–∑ —Å–µ—Ä–∏–π–Ω–∏—è –º–æ–Ω–∏—Ç–æ—Ä. –ù–∞—Ç–∏—Å–Ω–µ—Ç–µ –±—É—Ç–æ–Ω–∞ C (—Ç–æ–∑–∏ –æ—Ç –ª—è–≤–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∞, –Ω–∞–π-–±–ª–∏–∑–æ –¥–æ –ø—Ä–µ–≤–∫–ª—é—á–≤–∞—Ç–µ–ª—è –∑–∞ –∑–∞—Ö—Ä–∞–Ω–≤–∞–Ω–µ) –∏ –≥–æ–≤–æ—Ä–µ—Ç–µ. –©–µ –±—ä–¥–∞—Ç –∑–∞–ø–∏—Å–∞–Ω–∏ 4 —Å–µ–∫—É–Ω–¥–∏ –∞—É–¥–∏–æ.

    ```output
    --- Available filters and text transformations: colorize, debug, default, direct, hexlify, log2file, nocontrol, printable, send_on_enter, time
    --- More details at http://bit.ly/pio-monitor-filters
    --- Miniterm on /dev/cu.usbmodem1101  9600,8,N,1 ---
    --- Quit: Ctrl+C | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H ---
    Ready.
    Starting recording...
    Finished recording
    ```
üíÅ –ú–æ–∂–µ—Ç–µ –¥–∞ –Ω–∞–º–µ—Ä–∏—Ç–µ —Ç–æ–∑–∏ –∫–æ–¥ –≤ –ø–∞–ø–∫–∞—Ç–∞ [code-record/wio-terminal](../../../../../6-consumer/lessons/1-speech-recognition/code-record/wio-terminal).
üòÄ –í–∞—à–∞—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ –∑–∞ –∞—É–¥–∏–æ –∑–∞–ø–∏—Å –±–µ—à–µ —É—Å–ø–µ—à–Ω–∞!

---

**–û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç**:  
–¢–æ–∑–∏ –¥–æ–∫—É–º–µ–Ω—Ç –µ –ø—Ä–µ–≤–µ–¥–µ–Ω —Å –ø–æ–º–æ—â—Ç–∞ –Ω–∞ AI —É—Å–ª—É–≥–∞ –∑–∞ –ø—Ä–µ–≤–æ–¥ [Co-op Translator](https://github.com/Azure/co-op-translator). –í—ä–ø—Ä–µ–∫–∏ —á–µ —Å–µ —Å—Ç—Ä–µ–º–∏–º –∫—ä–º —Ç–æ—á–Ω–æ—Å—Ç, –º–æ–ª—è, –∏–º–∞–π—Ç–µ –ø—Ä–µ–¥–≤–∏–¥, —á–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—Ç–µ –ø—Ä–µ–≤–æ–¥–∏ –º–æ–∂–µ –¥–∞ —Å—ä–¥—ä—Ä–∂–∞—Ç –≥—Ä–µ—à–∫–∏ –∏–ª–∏ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏. –û—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏—è—Ç –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ –Ω–µ–≥–æ–≤–∏—è –∏–∑—Ö–æ–¥–µ–Ω –µ–∑–∏–∫ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ —Å—á–∏—Ç–∞ –∑–∞ –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–µ–Ω –∏–∑—Ç–æ—á–Ω–∏–∫. –ó–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–µ –ø—Ä–µ–ø–æ—Ä—ä—á–≤–∞ –ø—Ä–æ—Ñ–µ—Å–∏–æ–Ω–∞–ª–µ–Ω –ø—Ä–µ–≤–æ–¥ –æ—Ç —á–æ–≤–µ–∫. –ù–∏–µ –Ω–µ –Ω–æ—Å–∏–º –æ—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç –∑–∞ –∫–∞–∫–≤–∏—Ç–æ –∏ –¥–∞ –µ –Ω–µ–¥–æ—Ä–∞–∑—É–º–µ–Ω–∏—è –∏–ª–∏ –ø–æ–≥—Ä–µ—à–Ω–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏, –ø—Ä–æ–∏–∑—Ç–∏—á–∞—â–∏ –æ—Ç –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ—Ç–æ –Ω–∞ —Ç–æ–∑–∏ –ø—Ä–µ–≤–æ–¥.