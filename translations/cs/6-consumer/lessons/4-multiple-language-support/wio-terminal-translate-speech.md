<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "5f6c164e349f8989959e02a90f37908d",
  "translation_date": "2025-08-27T21:32:54+00:00",
  "source_file": "6-consumer/lessons/4-multiple-language-support/wio-terminal-translate-speech.md",
  "language_code": "cs"
}
-->
# P≈ôeklad ≈ôeƒçi - Wio Terminal

V t√©to ƒç√°sti lekce nap√≠≈°ete k√≥d pro p≈ôeklad textu pomoc√≠ slu≈æby p≈ôekladaƒçe.

## P≈ôevod textu na ≈ôeƒç pomoc√≠ slu≈æby p≈ôekladaƒçe

REST API slu≈æby pro ≈ôeƒç nepodporuje p≈ô√≠m√© p≈ôeklady, m√≠sto toho m≈Ø≈æete pou≈æ√≠t slu≈æbu Translator k p≈ôekladu textu generovan√©ho slu≈æbou pro p≈ôevod ≈ôeƒçi na text a textu mluven√© odpovƒõdi. Tato slu≈æba m√° REST API, kter√© m≈Ø≈æete pou≈æ√≠t k p≈ôekladu textu, ale pro zjednodu≈°en√≠ bude zabalena do dal≈°√≠ho HTTP triggeru ve va≈°√≠ aplikaci funkc√≠.

### √ökol - vytvo≈ôen√≠ serverless funkce pro p≈ôeklad textu

1. Otev≈ôete sv≈Øj projekt `smart-timer-trigger` v VS Code a otev≈ôete termin√°l, ujistƒõte se, ≈æe je aktivov√°no virtu√°ln√≠ prost≈ôed√≠. Pokud ne, ukonƒçete a znovu vytvo≈ôte termin√°l.

1. Otev≈ôete soubor `local.settings.json` a p≈ôidejte nastaven√≠ pro API kl√≠ƒç a um√≠stƒõn√≠ slu≈æby p≈ôekladaƒçe:

    ```json
    "TRANSLATOR_KEY": "<key>",
    "TRANSLATOR_LOCATION": "<location>"
    ```

    Nahraƒète `<key>` API kl√≠ƒçem pro v√°≈° zdroj slu≈æby p≈ôekladaƒçe. Nahraƒète `<location>` um√≠stƒõn√≠m, kter√© jste pou≈æili p≈ôi vytvo≈ôen√≠ zdroje slu≈æby p≈ôekladaƒçe.

1. P≈ôidejte nov√Ω HTTP trigger do t√©to aplikace nazvan√Ω `translate-text` pomoc√≠ n√°sleduj√≠c√≠ho p≈ô√≠kazu z termin√°lu VS Code v ko≈ôenov√© slo≈æce projektu aplikace funkc√≠:

    ```sh
    func new --name translate-text --template "HTTP trigger"
    ```

    T√≠m se vytvo≈ô√≠ HTTP trigger nazvan√Ω `translate-text`.

1. Nahraƒète obsah souboru `__init__.py` ve slo≈æce `translate-text` n√°sleduj√≠c√≠m:

    ```python
    import logging
    import os
    import requests
    
    import azure.functions as func
    
    location = os.environ['TRANSLATOR_LOCATION']
    translator_key = os.environ['TRANSLATOR_KEY']
    
    def main(req: func.HttpRequest) -> func.HttpResponse:
        req_body = req.get_json()
        from_language = req_body['from_language']
        to_language = req_body['to_language']
        text = req_body['text']
        
        logging.info(f'Translating {text} from {from_language} to {to_language}')
    
        url = f'https://api.cognitive.microsofttranslator.com/translate?api-version=3.0'
    
        headers = {
            'Ocp-Apim-Subscription-Key': translator_key,
            'Ocp-Apim-Subscription-Region': location,
            'Content-type': 'application/json'
        }
    
        params = {
            'from': from_language,
            'to': to_language
        }
    
        body = [{
            'text' : text
        }]
        
        response = requests.post(url, headers=headers, params=params, json=body)
        return func.HttpResponse(response.json()[0]['translations'][0]['text'])
    ```

    Tento k√≥d extrahuje text a jazyky z HTTP po≈æadavku. Pot√© provede po≈æadavek na REST API p≈ôekladaƒçe, p≈ôiƒçem≈æ jazyky p≈ôed√° jako parametry URL a text k p≈ôekladu jako tƒõlo. Nakonec se vr√°t√≠ p≈ôeklad.

1. Spus≈•te svou aplikaci funkc√≠ lok√°lnƒõ. Pot√© ji m≈Ø≈æete volat pomoc√≠ n√°stroje jako curl stejn√Ωm zp≈Øsobem, jak√Ωm jste testovali HTTP trigger `text-to-timer`. Ujistƒõte se, ≈æe p≈ôed√°v√°te text k p≈ôekladu a jazyky jako JSON tƒõlo:

    ```json
    {
        "text": "D√©finir une minuterie de 30 secondes",
        "from_language": "fr-FR",
        "to_language": "en-US"
    }
    ```

    Tento p≈ô√≠klad p≈ôekl√°d√° *D√©finir une minuterie de 30 secondes* z francouz≈°tiny do americk√© angliƒçtiny. Vr√°t√≠ *Set a 30-second timer*.

> üíÅ Tento k√≥d najdete ve slo≈æce [code/functions](../../../../../6-consumer/lessons/4-multiple-language-support/code/functions).

### √ökol - pou≈æit√≠ funkce p≈ôekladaƒçe k p≈ôekladu textu

1. Otev≈ôete projekt `smart-timer` v VS Code, pokud ji≈æ nen√≠ otev≈ôen√Ω.

1. V√°≈° chytr√Ω ƒçasovaƒç bude m√≠t nastaveny 2 jazyky - jazyk serveru, kter√Ω byl pou≈æit k tr√©nov√°n√≠ LUIS (stejn√Ω jazyk je tak√© pou≈æit k sestaven√≠ zpr√°v pro u≈æivatele), a jazyk, kter√Ωm mluv√≠ u≈æivatel. Aktualizujte konstantu `LANGUAGE` v hlaviƒçkov√©m souboru `config.h` na jazyk, kter√Ωm bude mluvit u≈æivatel, a p≈ôidejte novou konstantu nazvanou `SERVER_LANGUAGE` pro jazyk pou≈æit√Ω k tr√©nov√°n√≠ LUIS:

    ```cpp
    const char *LANGUAGE = "<user language>";
    const char *SERVER_LANGUAGE = "<server language>";
    ```

    Nahraƒète `<user language>` n√°zvem m√≠stn√≠ho nastaven√≠ jazyka, kter√Ωm budete mluvit, nap≈ô√≠klad `fr-FR` pro francouz≈°tinu nebo `zn-HK` pro kanton≈°tinu.

    Nahraƒète `<server language>` n√°zvem m√≠stn√≠ho nastaven√≠ jazyka pou≈æit√©ho k tr√©nov√°n√≠ LUIS.

    Seznam podporovan√Ωch jazyk≈Ø a jejich n√°zv≈Ø m√≠stn√≠ho nastaven√≠ najdete v [dokumentaci o podpo≈ôe jazyk≈Ø a hlas≈Ø na Microsoft docs](https://docs.microsoft.com/azure/cognitive-services/speech-service/language-support?WT.mc_id=academic-17441-jabenn#speech-to-text).

    > üíÅ Pokud nemluv√≠te v√≠ce jazyky, m≈Ø≈æete pou≈æ√≠t slu≈æbu jako [Bing Translate](https://www.bing.com/translator) nebo [Google Translate](https://translate.google.com) k p≈ôekladu z va≈°eho preferovan√©ho jazyka do jazyka dle va≈°eho v√Ωbƒõru. Tyto slu≈æby pak mohou p≈ôehr√°t audio p≈ôelo≈æen√©ho textu.
    >
    > Nap≈ô√≠klad pokud tr√©nujete LUIS v angliƒçtinƒõ, ale chcete pou≈æ√≠t francouz≈°tinu jako jazyk u≈æivatele, m≈Ø≈æete p≈ôelo≈æit vƒõty jako "set a 2 minute and 27 second timer" z angliƒçtiny do francouz≈°tiny pomoc√≠ Bing Translate, pot√© pou≈æ√≠t tlaƒç√≠tko **Listen translation** k p≈ôehr√°n√≠ p≈ôekladu do mikrofonu.
    >
    > ![Tlaƒç√≠tko pro poslech p≈ôekladu na Bing Translate](../../../../../translated_images/bing-translate.348aa796d6efe2a92f41ea74a5cf42bb4c63d6faaa08e7f46924e072a35daa48.cs.png)

1. P≈ôidejte API kl√≠ƒç a um√≠stƒõn√≠ p≈ôekladaƒçe pod `SPEECH_LOCATION`:

    ```cpp
    const char *TRANSLATOR_API_KEY = "<KEY>";
    const char *TRANSLATOR_LOCATION = "<LOCATION>";
    ```

    Nahraƒète `<KEY>` API kl√≠ƒçem pro v√°≈° zdroj slu≈æby p≈ôekladaƒçe. Nahraƒète `<LOCATION>` um√≠stƒõn√≠m, kter√© jste pou≈æili p≈ôi vytvo≈ôen√≠ zdroje slu≈æby p≈ôekladaƒçe.

1. P≈ôidejte URL triggeru p≈ôekladaƒçe pod `VOICE_URL`:

    ```cpp
    const char *TRANSLATE_FUNCTION_URL = "<URL>";
    ```

    Nahraƒète `<URL>` URL pro HTTP trigger `translate-text` ve va≈°√≠ aplikaci funkc√≠. Toto bude stejn√© jako hodnota `TEXT_TO_TIMER_FUNCTION_URL`, kromƒõ n√°zvu funkce `translate-text` m√≠sto `text-to-timer`.

1. P≈ôidejte nov√Ω soubor do slo≈æky `src` nazvan√Ω `text_translator.h`.

1. Tento nov√Ω hlaviƒçkov√Ω soubor `text_translator.h` bude obsahovat t≈ô√≠du pro p≈ôeklad textu. P≈ôidejte n√°sleduj√≠c√≠ do tohoto souboru pro deklaraci t√©to t≈ô√≠dy:

    ```cpp
    #pragma once
    
    #include <Arduino.h>
    #include <ArduinoJson.h>
    #include <HTTPClient.h>
    #include <WiFiClient.h>
    
    #include "config.h"
    
    class TextTranslator
    {
    public:   
    private:
        WiFiClient _client;
    };
    
    TextTranslator textTranslator;
    ```

    T√≠m se deklaruje t≈ô√≠da `TextTranslator` spolu s instanc√≠ t√©to t≈ô√≠dy. T≈ô√≠da m√° jedno pole pro WiFi klienta.

1. Do sekce `public` t√©to t≈ô√≠dy p≈ôidejte metodu pro p≈ôeklad textu:

    ```cpp
    String translateText(String text, String from_language, String to_language)
    {
    }
    ```

    Tato metoda bere jazyk, ze kter√©ho se p≈ôekl√°d√°, a jazyk, do kter√©ho se p≈ôekl√°d√°. P≈ôi zpracov√°n√≠ ≈ôeƒçi bude ≈ôeƒç p≈ôelo≈æena z jazyka u≈æivatele do jazyka serveru LUIS, a p≈ôi poskytov√°n√≠ odpovƒõd√≠ bude p≈ôelo≈æena z jazyka serveru LUIS do jazyka u≈æivatele.

1. V t√©to metodƒõ p≈ôidejte k√≥d pro sestaven√≠ JSON tƒõla obsahuj√≠c√≠ho text k p≈ôekladu a jazyky:

    ```cpp
    DynamicJsonDocument doc(1024);
    doc["text"] = text;
    doc["from_language"] = from_language;
    doc["to_language"] = to_language;

    String body;
    serializeJson(doc, body);

    Serial.print("Translating ");
    Serial.print(text);
    Serial.print(" from ");
    Serial.print(from_language);
    Serial.print(" to ");
    Serial.print(to_language);
    ```

1. Pod t√≠mto p≈ôidejte n√°sleduj√≠c√≠ k√≥d pro odesl√°n√≠ tƒõla do serverless funkce:

    ```cpp
    HTTPClient httpClient;
    httpClient.begin(_client, TRANSLATE_FUNCTION_URL);

    int httpResponseCode = httpClient.POST(body);
    ```

1. D√°le p≈ôidejte k√≥d pro z√≠sk√°n√≠ odpovƒõdi:

    ```cpp
    String translated_text = "";

    if (httpResponseCode == 200)
    {
        translated_text = httpClient.getString();
        Serial.print("Translated: ");
        Serial.println(translated_text);
    }
    else
    {
        Serial.print("Failed to translate text - error ");
        Serial.println(httpResponseCode);
    }
    ```

1. Nakonec p≈ôidejte k√≥d pro uzav≈ôen√≠ spojen√≠ a vr√°cen√≠ p≈ôelo≈æen√©ho textu:

    ```cpp
    httpClient.end();

    return translated_text;
    ```

### √ökol - p≈ôeklad rozpoznan√© ≈ôeƒçi a odpovƒõd√≠

1. Otev≈ôete soubor `main.cpp`.

1. P≈ôidejte direktivu include na zaƒç√°tek souboru pro hlaviƒçkov√Ω soubor t≈ô√≠dy `TextTranslator`:

    ```cpp
    #include "text_translator.h"
    ```

1. Text, kter√Ω je vysloven p≈ôi nastaven√≠ nebo vypr≈°en√≠ ƒçasovaƒçe, je t≈ôeba p≈ôelo≈æit. K tomu p≈ôidejte n√°sleduj√≠c√≠ jako prvn√≠ ≈ô√°dek funkce `say`:

    ```cpp
    text = textTranslator.translateText(text, LANGUAGE, SERVER_LANGUAGE);
    ```

    T√≠m se text p≈ôelo≈æ√≠ do jazyka u≈æivatele.

1. Ve funkci `processAudio` je text z√≠sk√°n z zachycen√©ho audia pomoc√≠ vol√°n√≠ `String text = speechToText.convertSpeechToText();`. Po tomto vol√°n√≠ p≈ôelo≈æte text:

    ```cpp
    String text = speechToText.convertSpeechToText();
    text = textTranslator.translateText(text, LANGUAGE, SERVER_LANGUAGE);
    ```

    T√≠m se text p≈ôelo≈æ√≠ z jazyka u≈æivatele do jazyka pou≈æit√©ho na serveru.

1. Sestavte tento k√≥d, nahrajte jej do sv√©ho Wio Terminalu a otestujte jej p≈ôes s√©riov√Ω monitor. Jakmile uvid√≠te `Ready` v s√©riov√©m monitoru, stisknƒõte tlaƒç√≠tko C (to na lev√© stranƒõ, nejbl√≠≈æe k vyp√≠naƒçi) a mluvte. Ujistƒõte se, ≈æe va≈°e aplikace funkc√≠ bƒõ≈æ√≠, a po≈æ√°dejte o ƒçasovaƒç v jazyce u≈æivatele, buƒè mluven√≠m t√≠mto jazykem, nebo pou≈æit√≠m aplikace pro p≈ôeklad.

    ```output
    Connecting to WiFi..
    Connected!
    Got access token.
    Ready.
    Starting recording...
    Finished recording
    Sending speech...
    Speech sent!
    {"RecognitionStatus":"Success","DisplayText":"D√©finir une minuterie de 2 minutes 27 secondes.","Offset":9600000,"Duration":40400000}
    Translating D√©finir une minuterie de 2 minutes 27 secondes. from fr-FR to en-US
    Translated: Set a timer of 2 minutes 27 seconds.
    Set a timer of 2 minutes 27 seconds.
    {"seconds": 147}
    Translating 2 minute 27 second timer started. from en-US to fr-FR
    Translated: 2 minute 27 seconde minute a commenc√©.
    2 minute 27 seconde minute a commenc√©.
    Translating Times up on your 2 minute 27 second timer. from en-US to fr-FR
    Translated: Chronom√©trant votre minuterie de 2 minutes 27 secondes.
    Chronom√©trant votre minuterie de 2 minutes 27 secondes.
    ```

> üíÅ Tento k√≥d najdete ve slo≈æce [code/wio-terminal](../../../../../6-consumer/lessons/4-multiple-language-support/code/wio-terminal).

üòÄ V√°≈° v√≠cejazyƒçn√Ω program ƒçasovaƒçe byl √∫spƒõ≈°n√Ω!

---

**Prohl√°≈°en√≠**:  
Tento dokument byl p≈ôelo≈æen pomoc√≠ slu≈æby pro automatick√Ω p≈ôeklad [Co-op Translator](https://github.com/Azure/co-op-translator). I kdy≈æ se sna≈æ√≠me o p≈ôesnost, mƒõjte na pamƒõti, ≈æe automatick√© p≈ôeklady mohou obsahovat chyby nebo nep≈ôesnosti. P≈Øvodn√≠ dokument v jeho p≈Øvodn√≠m jazyce by mƒõl b√Ωt pova≈æov√°n za autoritativn√≠ zdroj. Pro d≈Øle≈æit√© informace se doporuƒçuje profesion√°ln√≠ lidsk√Ω p≈ôeklad. Nenese odpovƒõdnost za ≈æ√°dn√© nedorozumƒõn√≠ nebo nespr√°vn√© interpretace vypl√Ωvaj√≠c√≠ z pou≈æit√≠ tohoto p≈ôekladu.