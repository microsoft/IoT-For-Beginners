<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "52b4de6144b2efdced7797a5339d6035",
  "translation_date": "2025-08-27T21:58:35+00:00",
  "source_file": "1-getting-started/lessons/1-introduction-to-iot/virtual-device.md",
  "language_code": "no"
}
-->
# Virtuell en-kort datamaskin

I stedet for √• kj√∏pe en IoT-enhet sammen med sensorer og aktuatorer, kan du bruke datamaskinen din til √• simulere IoT-maskinvare. [CounterFit-prosjektet](https://github.com/CounterFit-IoT/CounterFit) lar deg kj√∏re en app lokalt som simulerer IoT-maskinvare som sensorer og aktuatorer, og gir deg tilgang til sensorene og aktuatorene fra lokal Python-kode skrevet p√• samme m√•te som du ville gjort p√• en Raspberry Pi med fysisk maskinvare.

## Oppsett

For √• bruke CounterFit m√• du installere gratis programvare p√• datamaskinen din.

### Oppgave

Installer n√∏dvendig programvare.

1. Installer Python. Se [Python nedlastingssiden](https://www.python.org/downloads/) for instruksjoner om hvordan du installerer den nyeste versjonen av Python.

1. Installer Visual Studio Code (VS Code). Dette er editoren du vil bruke til √• skrive kode for den virtuelle enheten i Python. Se [VS Code-dokumentasjonen](https://code.visualstudio.com?WT.mc_id=academic-17441-jabenn) for instruksjoner om hvordan du installerer VS Code.

    > üíÅ Du st√•r fritt til √• bruke hvilken som helst Python IDE eller editor for disse leksjonene hvis du har et foretrukket verkt√∏y, men leksjonene vil gi instruksjoner basert p√• bruk av VS Code.

1. Installer VS Code Pylance-utvidelsen. Dette er en utvidelse for VS Code som gir st√∏tte for Python-spr√•ket. Se [Pylance-utvidelsesdokumentasjonen](https://marketplace.visualstudio.com/items?WT.mc_id=academic-17441-jabenn&itemName=ms-python.vscode-pylance) for instruksjoner om hvordan du installerer denne utvidelsen i VS Code.

Instruksjonene for √• installere og konfigurere CounterFit-appen vil bli gitt p√• det relevante tidspunktet i oppgaveinstruksjonene, da den installeres per prosjekt.

## Hello world

Det er tradisjonelt n√•r man starter med et nytt programmeringsspr√•k eller teknologi √• lage en 'Hello World'-applikasjon - en liten applikasjon som viser tekst som `"Hello World"` for √• bekrefte at alle verkt√∏yene er riktig konfigurert.

Hello World-appen for den virtuelle IoT-maskinvaren vil sikre at du har Python og Visual Studio Code installert riktig. Den vil ogs√• koble til CounterFit for de virtuelle IoT-sensorene og aktuatorene. Den vil ikke bruke noen maskinvare, den vil bare koble til for √• bekrefte at alt fungerer.

Denne appen vil ligge i en mappe kalt `nightlight`, og den vil bli gjenbrukt med forskjellig kode i senere deler av denne oppgaven for √• bygge nattlys-applikasjonen.

### Konfigurer et virtuelt Python-milj√∏

En av de kraftige funksjonene i Python er muligheten til √• installere [Pip-pakker](https://pypi.org) - dette er pakker med kode skrevet av andre og publisert p√• Internett. Du kan installere en Pip-pakke p√• datamaskinen din med √©n kommando, og deretter bruke den pakken i koden din. Du vil bruke Pip til √• installere en pakke for √• kommunisere med CounterFit.

Som standard, n√•r du installerer en pakke, er den tilgjengelig overalt p√• datamaskinen din, og dette kan f√∏re til problemer med pakkeversjoner - for eksempel at √©n applikasjon avhenger av √©n versjon av en pakke som slutter √• fungere n√•r du installerer en ny versjon for en annen applikasjon. For √• unng√• dette problemet kan du bruke et [virtuelt Python-milj√∏](https://docs.python.org/3/library/venv.html), som i hovedsak er en kopi av Python i en dedikert mappe, og n√•r du installerer Pip-pakker, blir de kun installert i den mappen.

> üíÅ Hvis du bruker en Raspberry Pi, har du ikke satt opp et virtuelt milj√∏ p√• den enheten for √• administrere Pip-pakker, i stedet bruker du globale pakker, da Grove-pakkene er installert globalt av installasjonsskriptet.

#### Oppgave - konfigurer et virtuelt Python-milj√∏

Konfigurer et virtuelt Python-milj√∏ og installer Pip-pakkene for CounterFit.

1. Fra terminalen eller kommandolinjen, kj√∏r f√∏lgende p√• et sted du velger for √• opprette og navigere til en ny katalog:

    ```sh
    mkdir nightlight
    cd nightlight
    ```

1. Kj√∏r deretter f√∏lgende for √• opprette et virtuelt milj√∏ i `.venv`-mappen:

    ```sh
    python3 -m venv .venv
    ```

    > üíÅ Du m√• eksplisitt kalle `python3` for √• opprette det virtuelle milj√∏et, i tilfelle du har Python 2 installert i tillegg til Python 3 (den nyeste versjonen). Hvis du har Python 2 installert, vil kall til `python` bruke Python 2 i stedet for Python 3.

1. Aktiver det virtuelle milj√∏et:

    * P√• Windows:
        * Hvis du bruker Command Prompt, eller Command Prompt gjennom Windows Terminal, kj√∏r:

            ```cmd
            .venv\Scripts\activate.bat
            ```

        * Hvis du bruker PowerShell, kj√∏r:

            ```powershell
            .\.venv\Scripts\Activate.ps1
            ```

            > Hvis du f√•r en feil om at kj√∏ring av skript er deaktivert p√• dette systemet, m√• du aktivere kj√∏ring av skript ved √• sette en passende kj√∏ringspolicy. Du kan gj√∏re dette ved √• starte PowerShell som administrator, og deretter kj√∏re f√∏lgende kommando:

            ```powershell
            Set-ExecutionPolicy -ExecutionPolicy Unrestricted
            ```

            Skriv `Y` n√•r du blir bedt om √• bekrefte. Start deretter PowerShell p√• nytt og pr√∏v igjen.

            Du kan tilbakestille denne kj√∏ringspolicyen p√• et senere tidspunkt hvis n√∏dvendig. Du kan lese mer om dette p√• [Execution Policies-siden p√• Microsoft Docs](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_execution_policies?WT.mc_id=academic-17441-jabenn).

    * P√• macOS eller Linux, kj√∏r:

        ```cmd
        source ./.venv/bin/activate
        ```

    > üíÅ Disse kommandoene b√∏r kj√∏res fra samme sted som du kj√∏rte kommandoen for √• opprette det virtuelle milj√∏et. Du trenger aldri √• navigere inn i `.venv`-mappen, du b√∏r alltid kj√∏re aktiveringskommandoen og eventuelle kommandoer for √• installere pakker eller kj√∏re kode fra mappen du var i da du opprettet det virtuelle milj√∏et.

1. N√•r det virtuelle milj√∏et er aktivert, vil standard `python`-kommandoen kj√∏re versjonen av Python som ble brukt til √• opprette det virtuelle milj√∏et. Kj√∏r f√∏lgende for √• f√• versjonen:

    ```sh
    python --version
    ```

    Utdataene b√∏r inneholde f√∏lgende:

    ```output
    (.venv) ‚ûú  nightlight python --version
    Python 3.9.1
    ```

    > üíÅ Python-versjonen din kan v√¶re annerledes - s√• lenge den er versjon 3.6 eller h√∏yere er du klar. Hvis ikke, slett denne mappen, installer en nyere versjon av Python og pr√∏v igjen.

1. Kj√∏r f√∏lgende kommandoer for √• installere Pip-pakkene for CounterFit. Disse pakkene inkluderer hovedappen CounterFit samt shims for Grove-maskinvare. Disse shimsene lar deg skrive kode som om du programmerte med fysiske sensorer og aktuatorer fra Grove-√∏kosystemet, men koblet til virtuelle IoT-enheter.

    ```sh
    pip install CounterFit
    pip install counterfit-connection
    pip install counterfit-shims-grove
    ```

    Disse Pip-pakkene vil kun bli installert i det virtuelle milj√∏et, og vil ikke v√¶re tilgjengelige utenfor dette.

### Skriv koden

N√•r det virtuelle Python-milj√∏et er klart, kan du skrive koden for 'Hello World'-applikasjonen.

#### Oppgave - skriv koden

Opprett en Python-applikasjon for √• skrive `"Hello World"` til konsollen.

1. Fra terminalen eller kommandolinjen, kj√∏r f√∏lgende inne i det virtuelle milj√∏et for √• opprette en Python-fil kalt `app.py`:

    * Fra Windows, kj√∏r:

        ```cmd
        type nul > app.py
        ```

    * P√• macOS eller Linux, kj√∏r:

        ```cmd
        touch app.py
        ```

1. √Öpne den n√•v√¶rende mappen i VS Code:

    ```sh
    code .
    ```

    > üíÅ Hvis terminalen din returnerer `command not found` p√• macOS, betyr det at VS Code ikke har blitt lagt til PATH. Du kan legge til VS Code i PATH ved √• f√∏lge instruksjonene i [Launching from the command line-delen av VS Code-dokumentasjonen](https://code.visualstudio.com/docs/setup/mac?WT.mc_id=academic-17441-jabenn#_launching-from-the-command-line) og kj√∏re kommandoen etterp√•. VS Code legges til PATH som standard p√• Windows og Linux.

1. N√•r VS Code starter, vil det aktivere det virtuelle Python-milj√∏et. Det valgte virtuelle milj√∏et vil vises i statuslinjen nederst:

    ![VS Code viser det valgte virtuelle milj√∏et](../../../../../translated_images/vscode-virtual-env.8ba42e04c3d533cf677e16cbe5ed9a3b80f62c6964472dc84b6f940800f0909f.no.png)

1. Hvis VS Code-terminalen allerede kj√∏rer n√•r VS Code starter opp, vil den ikke ha det virtuelle milj√∏et aktivert i seg. Det enkleste er √• avslutte terminalen ved √• bruke **Kill the active terminal instance**-knappen:

    ![VS Code Kill the active terminal instance-knappen](../../../../../translated_images/vscode-kill-terminal.1cc4de7c6f25ee08f423f0ead714e61d069fac1eb2089e97b8a7bbcb3d45fe5e.no.png)

    Du kan se om terminalen har det virtuelle milj√∏et aktivert, da navnet p√• det virtuelle milj√∏et vil v√¶re et prefiks p√• terminalprompten. For eksempel kan det v√¶re:

    ```sh
    (.venv) ‚ûú  nightlight
    ```

    Hvis du ikke har `.venv` som prefiks p√• prompten, er det virtuelle milj√∏et ikke aktivert i terminalen.

1. Start en ny VS Code-terminal ved √• velge *Terminal -> New Terminal*, eller ved √• trykke `` CTRL+` ``. Den nye terminalen vil laste det virtuelle milj√∏et, og kallet for √• aktivere dette vil vises i terminalen. Prompten vil ogs√• ha navnet p√• det virtuelle milj√∏et (`.venv`):

    ```output
    ‚ûú  nightlight source .venv/bin/activate
    (.venv) ‚ûú  nightlight 
    ```

1. √Öpne `app.py`-filen fra VS Code-utforskeren og legg til f√∏lgende kode:

    ```python
    print('Hello World!')
    ```

    `print`-funksjonen skriver det som sendes til den til konsollen.

1. Fra VS Code-terminalen, kj√∏r f√∏lgende for √• kj√∏re Python-appen din:

    ```sh
    python app.py
    ```

    F√∏lgende vil v√¶re i utdataene:

    ```output
    (.venv) ‚ûú  nightlight python app.py 
    Hello World!
    ```

üòÄ 'Hello World'-programmet ditt var en suksess!

### Koble til 'maskinvaren'

Som et andre 'Hello World'-steg, vil du kj√∏re CounterFit-appen og koble koden din til den. Dette er den virtuelle ekvivalenten til √• koble til IoT-maskinvare til et utviklingskort.

#### Oppgave - koble til 'maskinvaren'

1. Fra VS Code-terminalen, start CounterFit-appen med f√∏lgende kommando:

    ```sh
    counterfit
    ```

    Appen vil starte og √•pne i nettleseren din:

    ![CounterFit-appen kj√∏rer i en nettleser](../../../../../translated_images/counterfit-first-run.433326358b669b31d0e99c3513cb01bfbb13724d162c99cdcc8f51ecf5f9c779.no.png)

    Den vil v√¶re merket som *Disconnected*, med LED-en √∏verst til h√∏yre sl√•tt av.

1. Legg til f√∏lgende kode √∏verst i `app.py`:

    ```python
    from counterfit_connection import CounterFitConnection
    CounterFitConnection.init('127.0.0.1', 5000)
    ```

    Denne koden importerer `CounterFitConnection`-klassen fra `counterfit_connection`-modulen, som kommer fra `counterfit-connection` Pip-pakken du installerte tidligere. Den initialiserer deretter en tilkobling til CounterFit-appen som kj√∏rer p√• `127.0.0.1`, som er en IP-adresse du alltid kan bruke for √• f√• tilgang til din lokale datamaskin (ofte referert til som *localhost*), p√• port 5000.

    > üíÅ Hvis du har andre apper som kj√∏rer p√• port 5000, kan du endre dette ved √• oppdatere porten i koden og kj√∏re CounterFit ved √• bruke `CounterFit --port <port_number>`, der `<port_number>` erstattes med porten du vil bruke.

1. Du m√• starte en ny VS Code-terminal ved √• velge **Create a new integrated terminal**-knappen. Dette er fordi CounterFit-appen kj√∏rer i den n√•v√¶rende terminalen.

    ![VS Code Create a new integrated terminal-knappen](../../../../../translated_images/vscode-new-terminal.77db8fc0f9cd31824b0e49a201beafe4ae4616d6c7339992cb2819e789b3eff9.no.png)

1. I denne nye terminalen, kj√∏r `app.py`-filen som f√∏r. Statusen til CounterFit vil endres til **Connected**, og LED-en vil lyse opp.

    ![CounterFit viser som tilkoblet](../../../../../translated_images/counterfit-connected.ed30b46d8f79b0921f3fc70be10366e596a89dca3f80c2224a9d9fc98fccf884.no.png)

> üíÅ Du kan finne denne koden i [code/virtual-device](../../../../../1-getting-started/lessons/1-introduction-to-iot/code/virtual-device)-mappen.

üòÄ Tilkoblingen til maskinvaren var en suksess!

---

**Ansvarsfraskrivelse**:  
Dette dokumentet er oversatt ved hjelp av AI-oversettelsestjenesten [Co-op Translator](https://github.com/Azure/co-op-translator). Selv om vi streber etter n√∏yaktighet, v√¶r oppmerksom p√• at automatiserte oversettelser kan inneholde feil eller un√∏yaktigheter. Det originale dokumentet p√• sitt opprinnelige spr√•k b√∏r anses som den autoritative kilden. For kritisk informasjon anbefales profesjonell menneskelig oversettelse. Vi er ikke ansvarlige for misforst√•elser eller feiltolkninger som oppst√•r ved bruk av denne oversettelsen.