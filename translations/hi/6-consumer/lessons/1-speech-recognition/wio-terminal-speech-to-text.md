<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "3f92edf2975175577174910caca4a389",
  "translation_date": "2025-08-25T17:55:19+00:00",
  "source_file": "6-consumer/lessons/1-speech-recognition/wio-terminal-speech-to-text.md",
  "language_code": "hi"
}
-->
# рд╡рд╛рдХ рд╕реЗ рдкрд╛рда - Wio Terminal

рдЗрд╕ рдкрд╛рда рдХреЗ рдЗрд╕ рднрд╛рдЧ рдореЗрдВ, рдЖрдк рдХреЛрдб рд▓рд┐рдЦреЗрдВрдЧреЗ рдЬреЛ рдХреИрдкреНрдЪрд░ рдХрд┐рдП рдЧрдП рдСрдбрд┐рдпреЛ рдореЗрдВ рд╡рд╛рдХ рдХреЛ рдкрд╛рда рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдкреАрдЪ рд╕рд░реНрд╡рд┐рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ред

## рдСрдбрд┐рдпреЛ рдХреЛ рд╕реНрдкреАрдЪ рд╕рд░реНрд╡рд┐рд╕ рдкрд░ рднреЗрдЬреЗрдВ

рдСрдбрд┐рдпреЛ рдХреЛ REST API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрдкреАрдЪ рд╕рд░реНрд╡рд┐рд╕ рдкрд░ рднреЗрдЬрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╕реНрдкреАрдЪ рд╕рд░реНрд╡рд┐рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкрд╣рд▓реЗ рдЖрдкрдХреЛ рдПрдХ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдлрд┐рд░ рдЙрд╕ рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ REST API рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдпреЗ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди 10 рдорд┐рдирдЯ рдХреЗ рдмрд╛рдж рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЗ рдХреЛрдб рдХреЛ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдЗрдиреНрд╣реЗрдВ рдЕрдиреБрд░реЛрдз рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╡реЗ рд╣рдореЗрд╢рд╛ рдЕрджреНрдпрддрди рд░рд╣реЗрдВред

### рдХрд╛рд░реНрдп - рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

1. `smart-timer` рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдЦреЛрд▓реЗрдВ рдпрджрд┐ рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рдЦреБрд▓рд╛ рдирд╣реАрдВ рд╣реИред

1. `platformio.ini` рдлрд╛рдЗрд▓ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдбрд┐рдкреЗрдВрдбреЗрдВрд╕реА рдЬреЛрдбрд╝реЗрдВ рддрд╛рдХрд┐ WiFi рддрдХ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ JSON рдХреЛ рд╣реИрдВрдбрд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ:

    ```ini
    seeed-studio/Seeed Arduino rpcWiFi @ 1.0.5
    seeed-studio/Seeed Arduino rpcUnified @ 2.1.3
    seeed-studio/Seeed_Arduino_mbedtls @ 3.0.1
    seeed-studio/Seeed Arduino RTC @ 2.0.0
    bblanchon/ArduinoJson @ 6.17.3
    ```

1. `config.h` рд╣реЗрдбрд░ рдлрд╛рдЗрд▓ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    const char *SSID = "<SSID>";
    const char *PASSWORD = "<PASSWORD>";
    
    const char *SPEECH_API_KEY = "<API_KEY>";
    const char *SPEECH_LOCATION = "<LOCATION>";
    const char *LANGUAGE = "<LANGUAGE>";

    const char *TOKEN_URL = "https://%s.api.cognitive.microsoft.com/sts/v1.0/issuetoken";
    ```

    `<SSID>` рдФрд░ `<PASSWORD>` рдХреЛ рдЕрдкрдиреЗ WiFi рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдорд╛рдиреЛрдВ рд╕реЗ рдмрджрд▓реЗрдВред

    `<API_KEY>` рдХреЛ рдЕрдкрдиреА рд╕реНрдкреАрдЪ рд╕рд░реНрд╡рд┐рд╕ рд░рд┐рд╕реЛрд░реНрд╕ рдХреА API рдХреБрдВрдЬреА рд╕реЗ рдмрджрд▓реЗрдВред `<LOCATION>` рдХреЛ рдЙрд╕ рд╕реНрдерд╛рди рд╕реЗ рдмрджрд▓реЗрдВ рдЬрд┐рд╕реЗ рдЖрдкрдиреЗ рд╕реНрдкреАрдЪ рд╕рд░реНрд╡рд┐рд╕ рд░рд┐рд╕реЛрд░реНрд╕ рдмрдирд╛рддреЗ рд╕рдордп рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдерд╛ред

    `<LANGUAGE>` рдХреЛ рдЙрд╕ рднрд╛рд╖рд╛ рдХреЗ рд▓реЛрдХрд▓ рдирд╛рдо рд╕реЗ рдмрджрд▓реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдЖрдк рдмреЛрд▓реЗрдВрдЧреЗ, рдЬреИрд╕реЗ `en-GB` рдЕрдВрдЧреНрд░реЗрдЬреА рдХреЗ рд▓рд┐рдП, рдпрд╛ `zn-HK` рдХреИрдВрдЯреЛрдиреАрдЬрд╝ рдХреЗ рд▓рд┐рдПред рд╕рдорд░реНрдерд┐рдд рднрд╛рд╖рд╛рдУрдВ рдФрд░ рдЙрдирдХреЗ рд▓реЛрдХрд▓ рдирд╛рдореЛрдВ рдХреА рд╕реВрдЪреА [Microsoft Docs рдкрд░ рднрд╛рд╖рд╛ рдФрд░ рдЖрд╡рд╛рдЬрд╝ рд╕рдорд░реНрдерди рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://docs.microsoft.com/azure/cognitive-services/speech-service/language-support?WT.mc_id=academic-17441-jabenn#speech-to-text) рдореЗрдВ рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИред

    `TOKEN_URL` рдХреЙрдиреНрд╕реНрдЯреЗрдВрдЯ рдЯреЛрдХрди рдЬрд╛рд░реАрдХрд░реНрддрд╛ рдХрд╛ URL рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕реНрдерд╛рди рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИред рдЗрд╕реЗ рдмрд╛рдж рдореЗрдВ рд╕реНрдерд╛рди рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ рддрд╛рдХрд┐ рдкреВрд░рд╛ URL рдкреНрд░рд╛рдкреНрдд рд╣реЛ рд╕рдХреЗред

1. Custom Vision рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рддрд░рд╣, рдЖрдкрдХреЛ рдЯреЛрдХрди рдЬрд╛рд░реА рдХрд░рдиреЗ рд╡рд╛рд▓реА рд╕рд░реНрд╡рд┐рд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП HTTPS рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред `config.h` рдХреЗ рдЕрдВрдд рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    const char *TOKEN_CERTIFICATE =
        "-----BEGIN CERTIFICATE-----\r\n"
        "MIIF8zCCBNugAwIBAgIQAueRcfuAIek/4tmDg0xQwDANBgkqhkiG9w0BAQwFADBh\r\n"
        "MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\r\n"
        "d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBH\r\n"
        "MjAeFw0yMDA3MjkxMjMwMDBaFw0yNDA2MjcyMzU5NTlaMFkxCzAJBgNVBAYTAlVT\r\n"
        "MR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKjAoBgNVBAMTIU1pY3Jv\r\n"
        "c29mdCBBenVyZSBUTFMgSXNzdWluZyBDQSAwNjCCAiIwDQYJKoZIhvcNAQEBBQAD\r\n"
        "ggIPADCCAgoCggIBALVGARl56bx3KBUSGuPc4H5uoNFkFH4e7pvTCxRi4j/+z+Xb\r\n"
        "wjEz+5CipDOqjx9/jWjskL5dk7PaQkzItidsAAnDCW1leZBOIi68Lff1bjTeZgMY\r\n"
        "iwdRd3Y39b/lcGpiuP2d23W95YHkMMT8IlWosYIX0f4kYb62rphyfnAjYb/4Od99\r\n"
        "ThnhlAxGtfvSbXcBVIKCYfZgqRvV+5lReUnd1aNjRYVzPOoifgSx2fRyy1+pO1Uz\r\n"
        "aMMNnIOE71bVYW0A1hr19w7kOb0KkJXoALTDDj1ukUEDqQuBfBxReL5mXiu1O7WG\r\n"
        "0vltg0VZ/SZzctBsdBlx1BkmWYBW261KZgBivrql5ELTKKd8qgtHcLQA5fl6JB0Q\r\n"
        "gs5XDaWehN86Gps5JW8ArjGtjcWAIP+X8CQaWfaCnuRm6Bk/03PQWhgdi84qwA0s\r\n"
        "sRfFJwHUPTNSnE8EiGVk2frt0u8PG1pwSQsFuNJfcYIHEv1vOzP7uEOuDydsmCjh\r\n"
        "lxuoK2n5/2aVR3BMTu+p4+gl8alXoBycyLmj3J/PUgqD8SL5fTCUegGsdia/Sa60\r\n"
        "N2oV7vQ17wjMN+LXa2rjj/b4ZlZgXVojDmAjDwIRdDUujQu0RVsJqFLMzSIHpp2C\r\n"
        "Zp7mIoLrySay2YYBu7SiNwL95X6He2kS8eefBBHjzwW/9FxGqry57i71c2cDAgMB\r\n"
        "AAGjggGtMIIBqTAdBgNVHQ4EFgQU1cFnOsKjnfR3UltZEjgp5lVou6UwHwYDVR0j\r\n"
        "BBgwFoAUTiJUIBiV5uNu5g/6+rkS7QYXjzkwDgYDVR0PAQH/BAQDAgGGMB0GA1Ud\r\n"
        "JQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMHYG\r\n"
        "CCsGAQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQu\r\n"
        "Y29tMEAGCCsGAQUFBzAChjRodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGln\r\n"
        "aUNlcnRHbG9iYWxSb290RzIuY3J0MHsGA1UdHwR0MHIwN6A1oDOGMWh0dHA6Ly9j\r\n"
        "cmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RHMi5jcmwwN6A1oDOG\r\n"
        "MWh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RHMi5j\r\n"
        "cmwwHQYDVR0gBBYwFDAIBgZngQwBAgEwCAYGZ4EMAQICMBAGCSsGAQQBgjcVAQQD\r\n"
        "AgEAMA0GCSqGSIb3DQEBDAUAA4IBAQB2oWc93fB8esci/8esixj++N22meiGDjgF\r\n"
        "+rA2LUK5IOQOgcUSTGKSqF9lYfAxPjrqPjDCUPHCURv+26ad5P/BYtXtbmtxJWu+\r\n"
        "cS5BhMDPPeG3oPZwXRHBJFAkY4O4AF7RIAAUW6EzDflUoDHKv83zOiPfYGcpHc9s\r\n"
        "kxAInCedk7QSgXvMARjjOqdakor21DTmNIUotxo8kHv5hwRlGhBJwps6fEVi1Bt0\r\n"
        "trpM/3wYxlr473WSPUFZPgP1j519kLpWOJ8z09wxay+Br29irPcBYv0GMXlHqThy\r\n"
        "8y4m/HyTQeI2IMvMrQnwqPpY+rLIXyviI2vLoI+4xKE4Rn38ZZ8m\r\n"
        "-----END CERTIFICATE-----\r\n";
    ```

    рдпрд╣ рд╡рд╣реА рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдкрдиреЗ Custom Vision рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рддреЗ рд╕рдордп рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдерд╛ред

1. `main.cpp` рдлрд╛рдЗрд▓ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ WiFi рд╣реЗрдбрд░ рдлрд╛рдЗрд▓ рдФрд░ config рд╣реЗрдбрд░ рдлрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рдЗрдирдХреНрд▓реВрдб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    #include <rpcWiFi.h>

    #include "config.h"
    ```

1. `setup` рдлрдВрдХреНрд╢рди рдХреЗ рдКрдкрд░ `main.cpp` рдореЗрдВ WiFi рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    void connectWiFi()
    {
        while (WiFi.status() != WL_CONNECTED)
        {
            Serial.println("Connecting to WiFi..");
            WiFi.begin(SSID, PASSWORD);
            delay(500);
        }
    
        Serial.println("Connected!");
    }
    ```

1. рдЗрд╕ рдлрдВрдХреНрд╢рди рдХреЛ `setup` рдлрдВрдХреНрд╢рди рд╕реЗ рдХреЙрд▓ рдХрд░реЗрдВ, рд╕реАрд░рд┐рдпрд▓ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж:

    ```cpp
    connectWiFi();
    ```

1. `src` рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ рдирдИ рд╣реЗрдбрд░ рдлрд╛рдЗрд▓ рдмрдирд╛рдПрдВ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо `speech_to_text.h` рд╣реЛред рдЗрд╕ рд╣реЗрдбрд░ рдлрд╛рдЗрд▓ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    #pragma once
    
    #include <Arduino.h>
    #include <ArduinoJson.h>
    #include <HTTPClient.h>
    #include <WiFiClientSecure.h>
    
    #include "config.h"
    #include "mic.h"
    
    class SpeechToText
    {
    public:

    private:

    };

    SpeechToText speechToText;
    ```

    рдЗрд╕рдореЗрдВ HTTP рдХрдиреЗрдХреНрд╢рди, рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ `mic.h` рд╣реЗрдбрд░ рдлрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдЖрд╡рд╢реНрдпрдХ рд╣реЗрдбрд░ рдлрд╛рдЗрд▓реЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, рдФрд░ `SpeechToText` рдирд╛рдордХ рдПрдХ рдХреНрд▓рд╛рд╕ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдлрд┐рд░ рдЙрд╕ рдХреНрд▓рд╛рд╕ рдХрд╛ рдПрдХ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдмрд╛рдж рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

1. рдЗрд╕ рдХреНрд▓рд╛рд╕ рдХреЗ `private` рд╕реЗрдХреНрд╢рди рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд 2 рдлреАрд▓реНрдб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    WiFiClientSecure _token_client;
    String _access_token;
    ```

    `_token_client` рдПрдХ WiFi рдХреНрд▓рд╛рдЗрдВрдЯ рд╣реИ рдЬреЛ HTTPS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ рдЯреЛрдХрди рдлрд┐рд░ `_access_token` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

1. `private` рд╕реЗрдХреНрд╢рди рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдердб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    String getAccessToken()
    {
        char url[128];
        sprintf(url, TOKEN_URL, SPEECH_LOCATION);
    
        HTTPClient httpClient;
        httpClient.begin(_token_client, url);
    
        httpClient.addHeader("Ocp-Apim-Subscription-Key", SPEECH_API_KEY);
        int httpResultCode = httpClient.POST("{}");
    
        if (httpResultCode != 200)
        {
            Serial.println("Error getting access token, trying again...");
            delay(10000);
            return getAccessToken();
        }
    
        Serial.println("Got access token.");
        String result = httpClient.getString();
    
        httpClient.end();
    
        return result;
    }
    ```

    рдпрд╣ рдХреЛрдб рд╕реНрдкреАрдЪ рд░рд┐рд╕реЛрд░реНрд╕ рдХреЗ рд╕реНрдерд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреЛрдХрди рдЬрд╛рд░реАрдХрд░реНрддрд╛ API рдХреЗ рд▓рд┐рдП URL рдмрдирд╛рддрд╛ рд╣реИред рдлрд┐рд░ рдпрд╣ рдПрдХ `HTTPClient` рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рд╡реЗрдм рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ, рдЗрд╕реЗ рдЯреЛрдХрди рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП WiFi рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред рдпрд╣ API рдХреБрдВрдЬреА рдХреЛ рдХреЙрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реЗрдбрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред рдлрд┐рд░ рдпрд╣ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ POST рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдпрджрд┐ рдХреЛрдИ рддреНрд░реБрдЯрд┐ рд╣реЛрддреА рд╣реИ рддреЛ рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред рдЕрдВрдд рдореЗрдВ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

1. `public` рд╕реЗрдХреНрд╢рди рдореЗрдВ, рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдореЗрдердб рдЬреЛрдбрд╝реЗрдВред рдпрд╣ рдмрд╛рдж рдХреЗ рдкрд╛рдареЛрдВ рдореЗрдВ рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рд╡рд╛рдХ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧрд╛ред

    ```cpp
    String AccessToken()
    {
        return _access_token;
    }
    ```

1. `public` рд╕реЗрдХреНрд╢рди рдореЗрдВ, рдПрдХ `init` рдореЗрдердб рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рдЯреЛрдХрди рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ:

    ```cpp
    void init()
    {
        _token_client.setCACert(TOKEN_CERTIFICATE);
        _access_token = getAccessToken();
    }
    ```

    рдпрд╣ WiFi рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ, рдлрд┐рд░ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред

1. `main.cpp` рдореЗрдВ, рдЗрд╕ рдирдИ рд╣реЗрдбрд░ рдлрд╛рдЗрд▓ рдХреЛ рдЗрдирдХреНрд▓реВрдб рдбрд╛рдпрд░реЗрдХреНрдЯрд┐рд╡реНрд╕ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    #include "speech_to_text.h"
    ```

1. `setup` рдлрдВрдХреНрд╢рди рдХреЗ рдЕрдВрдд рдореЗрдВ, `mic.init` рдХреЙрд▓ рдХреЗ рдмрд╛рдж рд▓реЗрдХрд┐рди рд╕реАрд░рд┐рдпрд▓ рдореЙрдирд┐рдЯрд░ рдореЗрдВ `Ready` рд▓рд┐рдЦрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ `SpeechToText` рдХреНрд▓рд╛рд╕ рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░реЗрдВ:

    ```cpp
    speechToText.init();
    ```

### рдХрд╛рд░реНрдп - рдлреНрд▓реИрд╢ рдореЗрдореЛрд░реА рд╕реЗ рдСрдбрд┐рдпреЛ рдкрдврд╝реЗрдВ

1. рдЗрд╕ рдкрд╛рда рдХреЗ рдкрд╣рд▓реЗ рднрд╛рдЧ рдореЗрдВ, рдСрдбрд┐рдпреЛ рдХреЛ рдлреНрд▓реИрд╢ рдореЗрдореЛрд░реА рдореЗрдВ рд░рд┐рдХреЙрд░реНрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдЗрд╕ рдСрдбрд┐рдпреЛ рдХреЛ рд╕реНрдкреАрдЪ рд╕рд░реНрд╡рд┐рд╕ REST API рдкрд░ рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдлреНрд▓реИрд╢ рдореЗрдореЛрд░реА рд╕реЗ рдкрдврд╝рд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЗрд╕реЗ рдЗрди-рдореЗрдореЛрд░реА рдмрдлрд░ рдореЗрдВ рд▓реЛрдб рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдмрд╣реБрдд рдмрдбрд╝рд╛ рд╣реЛрдЧрд╛ред `HTTPClient` рдХреНрд▓рд╛рд╕ рдЬреЛ REST рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ, рд╡рд╣ Arduino рд╕реНрдЯреНрд░реАрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рд╕реНрдЯреНрд░реАрдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ - рдПрдХ рдХреНрд▓рд╛рд╕ рдЬреЛ рдЫреЛрдЯреЗ рдЯреБрдХрдбрд╝реЛрдВ рдореЗрдВ рдбреЗрдЯрд╛ рд▓реЛрдб рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдПрдХ рд╕рдордп рдореЗрдВ рдПрдХ рдЯреБрдХрдбрд╝рд╛ рдЕрдиреБрд░реЛрдз рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИред рдЬрдм рднреА рдЖрдк рд╕реНрдЯреНрд░реАрдо рдкрд░ `read` рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВ, рдпрд╣ рдбреЗрдЯрд╛ рдХрд╛ рдЕрдЧрд▓рд╛ рдмреНрд▓реЙрдХ рд▓реМрдЯрд╛рддрд╛ рд╣реИред рдПрдХ Arduino рд╕реНрдЯреНрд░реАрдо рдмрдирд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИ рдЬреЛ рдлреНрд▓реИрд╢ рдореЗрдореЛрд░реА рд╕реЗ рдкрдврд╝ рд╕рдХрддреА рд╣реИред `src` рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ рдирдИ рдлрд╛рдЗрд▓ рдмрдирд╛рдПрдВ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо `flash_stream.h` рд╣реЛ, рдФрд░ рдЗрд╕рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    #pragma once
    
    #include <Arduino.h>
    #include <HTTPClient.h>
    #include <sfud.h>

    #include "config.h"
    
    class FlashStream : public Stream
    {
    public:
        virtual size_t write(uint8_t val)
        {    
        }
    
        virtual int available()
        {
        }
    
        virtual int read()
        {
        }
    
        virtual int peek()
        {
        }
    private:
    
    };
    ```

    рдпрд╣ `FlashStream` рдХреНрд▓рд╛рд╕ рдХреЛ рдШреЛрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬреЛ Arduino `Stream` рдХреНрд▓рд╛рд╕ рд╕реЗ рд╡реНрдпреБрддреНрдкрдиреНрди рд╣реИред рдпрд╣ рдПрдХ рдЕрдореВрд░реНрдд рдХреНрд▓рд╛рд╕ рд╣реИ - рд╡реНрдпреБрддреНрдкрдиреНрди рдХреНрд▓рд╛рд╕ рдХреЛ рдХреБрдЫ рдореЗрдердбреНрд╕ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рдХреНрд▓рд╛рд╕ рдХреЛ рдЗрдВрд╕реНрдЯреЗрдВрдЯрд┐рдПрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдФрд░ рдпреЗ рдореЗрдердбреНрд╕ рдЗрд╕ рдХреНрд▓рд╛рд╕ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реИрдВред

    тЬЕ Arduino рд╕реНрдЯреНрд░реАрдо рдкрд░ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВ [Arduino Stream рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://www.arduino.cc/reference/en/language/functions/communication/stream/) рдореЗрдВред

1. `private` рд╕реЗрдХреНрд╢рди рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлреАрд▓реНрдб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    size_t _pos;
    size_t _flash_address;
    const sfud_flash *_flash;

    byte _buffer[HTTP_TCP_BUFFER_SIZE];
    ```

    рдпрд╣ рдлреНрд▓реИрд╢ рдореЗрдореЛрд░реА рд╕реЗ рдкрдврд╝реЗ рдЧрдП рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдмрдлрд░ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдмрдлрд░ рд╕реЗ рдкрдврд╝рдиреЗ рдХреЗ рд╕рдордп рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐, рдлреНрд▓реИрд╢ рдореЗрдореЛрд░реА рд╕реЗ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд░реНрддрдорд╛рди рдкрддрд╛, рдФрд░ рдлреНрд▓реИрд╢ рдореЗрдореЛрд░реА рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред

1. `private` рд╕реЗрдХреНрд╢рди рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдердб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    void populateBuffer()
    {
        sfud_read(_flash, _flash_address, HTTP_TCP_BUFFER_SIZE, _buffer);
        _flash_address += HTTP_TCP_BUFFER_SIZE;
        _pos = 0;
    }
    ```

    рдпрд╣ рдХреЛрдб рдлреНрд▓реИрд╢ рдореЗрдореЛрд░реА рд╕реЗ рд╡рд░реНрддрдорд╛рди рдкрддреЗ рдкрд░ рдкрдврд╝рддрд╛ рд╣реИ рдФрд░ рдбреЗрдЯрд╛ рдХреЛ рдмрдлрд░ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред рдлрд┐рд░ рдпрд╣ рдкрддрд╛ рдмрдврд╝рд╛рддрд╛ рд╣реИ, рддрд╛рдХрд┐ рдЕрдЧрд▓реА рдХреЙрд▓ рдореЗрдореЛрд░реА рдХреЗ рдЕрдЧрд▓реЗ рдмреНрд▓реЙрдХ рдХреЛ рдкрдврд╝реЗред рдмрдлрд░ рдХрд╛ рдЖрдХрд╛рд░ HTTPClient рджреНрд╡рд╛рд░рд╛ REST API рдкрд░ рдПрдХ рд╕рдордп рдореЗрдВ рднреЗрдЬреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рдмрд╕реЗ рдмрдбрд╝реЗ рдЯреБрдХрдбрд╝реЗ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╣реЛрддрд╛ рд╣реИред

    > ЁЯТБ рдлреНрд▓реИрд╢ рдореЗрдореЛрд░реА рдХреЛ рдорд┐рдЯрд╛рдирд╛ рдЧреНрд░реЗрди рд╕рд╛рдЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрдмрдХрд┐ рдкрдврд╝рдирд╛ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд рдирд╣реАрдВ рд╣реИред

1. рдЗрд╕ рдХреНрд▓рд╛рд╕ рдХреЗ `public` рд╕реЗрдХреНрд╢рди рдореЗрдВ рдПрдХ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    FlashStream()
    {
        _pos = 0;
        _flash_address = 0;
        _flash = sfud_get_device_table() + 0;
        
        populateBuffer();
    }
    ```

    рдпрд╣ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рд╕рднреА рдлреАрд▓реНрдбреНрд╕ рдХреЛ рдлреНрд▓реИрд╢ рдореЗрдореЛрд░реА рдмреНрд▓реЙрдХ рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдкрдврд╝рдирд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдмрдлрд░ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ рдкрд╣рд▓реЗ рдЯреБрдХрдбрд╝реЗ рдХреЛ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИред

1. `write` рдореЗрдердб рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВред рдпрд╣ рд╕реНрдЯреНрд░реАрдо рдХреЗрд╡рд▓ рдбреЗрдЯрд╛ рдкрдврд╝реЗрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдХреБрдЫ рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ рдФрд░ 0 рд▓реМрдЯрд╛рдПрдЧрд╛:

    ```cpp
    virtual size_t write(uint8_t val)
    {
        return 0;
    }
    ```

1. `peek` рдореЗрдердб рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВред рдпрд╣ рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдкрд░ рдбреЗрдЯрд╛ рд▓реМрдЯрд╛рддрд╛ рд╣реИ рдмрд┐рдирд╛ рд╕реНрдЯреНрд░реАрдо рдХреЛ рдЖрдЧреЗ рдмрдврд╝рд╛рдПред `peek` рдХреЛ рдХрдИ рдмрд╛рд░ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рд╣рдореЗрд╢рд╛ рд╡рд╣реА рдбреЗрдЯрд╛ рд▓реМрдЯреЗрдЧрд╛ рдЬрдм рддрдХ рдХрд┐ рд╕реНрдЯреНрд░реАрдо рд╕реЗ рдХреЛрдИ рдбреЗрдЯрд╛ рдирд╣реАрдВ рдкрдврд╝рд╛ рдЬрд╛рддрд╛ред

    ```cpp
    virtual int peek()
    {
        return _buffer[_pos];
    }
    ```

1. `available` рдлрдВрдХреНрд╢рди рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВред рдпрд╣ рд╕реНрдЯреНрд░реАрдо рд╕реЗ рдкрдврд╝реЗ рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рдмрд╛рдЗрдЯреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рд▓реМрдЯрд╛рддрд╛ рд╣реИ, рдпрд╛ -1 рдпрджрд┐ рд╕реНрдЯреНрд░реАрдо рдкреВрд░реА рд╣реЛ рдЪреБрдХреА рд╣реИред рдЗрд╕ рдХреНрд▓рд╛рд╕ рдХреЗ рд▓рд┐рдП, рдЕрдзрд┐рдХрддрдо рдЙрдкрд▓рдмреНрдзрддрд╛ HTTPClient рдХреЗ рдЪрдВрдХ рд╕рд╛рдЗрдЬ рд╕реЗ рдЕрдзрд┐рдХ рдирд╣реАрдВ рд╣реЛрдЧреАред рдЬрдм рдпрд╣ рд╕реНрдЯреНрд░реАрдо HTTP рдХреНрд▓рд╛рдЗрдВрдЯ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рдпрд╣ рдлрдВрдХреНрд╢рди рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХрд┐рддрдирд╛ рдбреЗрдЯрд╛ рдЙрдкрд▓рдмреНрдз рд╣реИ, рдлрд┐рд░ REST API рдкрд░ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрддрдирд╛ рдбреЗрдЯрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИред рд╣рдо рдирд╣реАрдВ рдЪрд╛рд╣рддреЗ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЪрдВрдХ HTTP рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдЪрдВрдХ рд╕рд╛рдЗрдЬ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЙрд╕рд╕реЗ рдЕрдзрд┐рдХ рдЙрдкрд▓рдмреНрдз рд╣реИ, рддреЛ рдЪрдВрдХ рд╕рд╛рдЗрдЬ рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдХрдо рд╣реИ, рддреЛ рдЬрд┐рддрдирд╛ рдЙрдкрд▓рдмреНрдз рд╣реИ рд╡рд╣ рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ рдмрд╛рд░ рдЬрдм рд╕рднреА рдбреЗрдЯрд╛ рд╕реНрдЯреНрд░реАрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ -1 рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

    ```cpp
    virtual int available()
    {
        int remaining = BUFFER_SIZE - ((_flash_address - HTTP_TCP_BUFFER_SIZE) + _pos);
        int bytes_available = min(HTTP_TCP_BUFFER_SIZE, remaining);

        if (bytes_available == 0)
        {
            bytes_available = -1;
        }

        return bytes_available;
    }
    ```

1. `read` рдореЗрдердб рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдмрдлрд░ рд╕реЗ рдЕрдЧрд▓рд╛ рдмрд╛рдЗрдЯ рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рд╕реНрдерд┐рддрд┐ рдХреЛ рдмрдврд╝рд╛рддреЗ рд╣реБрдПред рдпрджрд┐ рд╕реНрдерд┐рддрд┐ рдмрдлрд░ рдХреЗ рдЖрдХрд╛рд░ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛ рдЬрд╛рддреА рд╣реИ, рддреЛ рдпрд╣ рдлреНрд▓реИрд╢ рдореЗрдореЛрд░реА рд╕реЗ рдЕрдЧрд▓реЗ рдмреНрд▓реЙрдХ рдХреЗ рд╕рд╛рде рдмрдлрд░ рдХреЛ рдкреЙрдкреНрдпреБрд▓реЗрдЯ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕реНрдерд┐рддрд┐ рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред

    ```cpp
    virtual int read()
    {
        int retVal = _buffer[_pos++];

        if (_pos == HTTP_TCP_BUFFER_SIZE)
        {
            populateBuffer();
        }

        return retVal;
    }
    ```

1. `speech_to_text.h` рд╣реЗрдбрд░ рдлрд╛рдЗрд▓ рдореЗрдВ, рдЗрд╕ рдирдИ рд╣реЗрдбрд░ рдлрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рдЗрдирдХреНрд▓реВрдб рдбрд╛рдпрд░реЗрдХреНрдЯрд┐рд╡ рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    #include "flash_stream.h"
    ```

### рдХрд╛рд░реНрдп - рд╡рд╛рдХ рдХреЛ рдкрд╛рда рдореЗрдВ рдмрджрд▓реЗрдВ

1. рд╡рд╛рдХ рдХреЛ рдкрд╛рда рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдСрдбрд┐рдпреЛ рдХреЛ REST API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдкреАрдЪ рд╕рд░реНрд╡рд┐рд╕ рдкрд░ рднреЗрдЬрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ REST API рдХрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЯреЛрдХрди рдЬрд╛рд░реАрдХрд░реНрддрд╛ рд╕реЗ рдЕрд▓рдЧ рд╣реИ, рдЗрд╕рд▓рд┐рдП `config.h` рд╣реЗрдбрд░ рдлрд╛рдЗрд▓ рдореЗрдВ рдЗрд╕ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    const char *SPEECH_CERTIFICATE =
        "-----BEGIN CERTIFICATE-----\r\n"
        "MIIF8zCCBNugAwIBAgIQCq+mxcpjxFFB6jvh98dTFzANBgkqhkiG9w0BAQwFADBh\r\n"
        "MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\r\n"
        "d3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBH\r\n"
        "MjAeFw0yMDA3MjkxMjMwMDBaFw0yNDA2MjcyMzU5NTlaMFkxCzAJBgNVBAYTAlVT\r\n"
        "MR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xKjAoBgNVBAMTIU1pY3Jv\r\n"
        "c29mdCBBenVyZSBUTFMgSXNzdWluZyBDQSAwMTCCAiIwDQYJKoZIhvcNAQEBBQAD\r\n"
        "ggIPADCCAgoCggIBAMedcDrkXufP7pxVm1FHLDNA9IjwHaMoaY8arqqZ4Gff4xyr\r\n"
        "RygnavXL7g12MPAx8Q6Dd9hfBzrfWxkF0Br2wIvlvkzW01naNVSkHp+OS3hL3W6n\r\n"
        "l/jYvZnVeJXjtsKYcXIf/6WtspcF5awlQ9LZJcjwaH7KoZuK+THpXCMtzD8XNVdm\r\n"
        "GW/JI0C/7U/E7evXn9XDio8SYkGSM63aLO5BtLCv092+1d4GGBSQYolRq+7Pd1kR\r\n"
        "EkWBPm0ywZ2Vb8GIS5DLrjelEkBnKCyy3B0yQud9dpVsiUeE7F5sY8Me96WVxQcb\r\n"
        "OyYdEY/j/9UpDlOG+vA+YgOvBhkKEjiqygVpP8EZoMMijephzg43b5Qi9r5UrvYo\r\n"
        "o19oR/8pf4HJNDPF0/FJwFVMW8PmCBLGstin3NE1+NeWTkGt0TzpHjgKyfaDP2tO\r\n"
        "4bCk1G7pP2kDFT7SYfc8xbgCkFQ2UCEXsaH/f5YmpLn4YPiNFCeeIida7xnfTvc4\r\n"
        "7IxyVccHHq1FzGygOqemrxEETKh8hvDR6eBdrBwmCHVgZrnAqnn93JtGyPLi6+cj\r\n"
        "WGVGtMZHwzVvX1HvSFG771sskcEjJxiQNQDQRWHEh3NxvNb7kFlAXnVdRkkvhjpR\r\n"
        "GchFhTAzqmwltdWhWDEyCMKC2x/mSZvZtlZGY+g37Y72qHzidwtyW7rBetZJAgMB\r\n"
        "AAGjggGtMIIBqTAdBgNVHQ4EFgQUDyBd16FXlduSzyvQx8J3BM5ygHYwHwYDVR0j\r\n"
        "BBgwFoAUTiJUIBiV5uNu5g/6+rkS7QYXjzkwDgYDVR0PAQH/BAQDAgGGMB0GA1Ud\r\n"
        "JQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMHYG\r\n"
        "CCsGAQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZGlnaWNlcnQu\r\n"
        "Y29tMEAGCCsGAQUFBzAChjRodHRwOi8vY2FjZXJ0cy5kaWdpY2VydC5jb20vRGln\r\n"
        "aUNlcnRHbG9iYWxSb290RzIuY3J0MHsGA1UdHwR0MHIwN6A1oDOGMWh0dHA6Ly9j\r\n"
        "cmwzLmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RHMi5jcmwwN6A1oDOG\r\n"
        "MWh0dHA6Ly9jcmw0LmRpZ2ljZXJ0LmNvbS9EaWdpQ2VydEdsb2JhbFJvb3RHMi5j\r\n"
        "cmwwHQYDVR0gBBYwFDAIBgZngQwBAgEwCAYGZ4EMAQICMBAGCSsGAQQBgjcVAQQD\r\n"
        "AgEAMA0GCSqGSIb3DQEBDAUAA4IBAQAlFvNh7QgXVLAZSsNR2XRmIn9iS8OHFCBA\r\n"
        "WxKJoi8YYQafpMTkMqeuzoL3HWb1pYEipsDkhiMnrpfeYZEA7Lz7yqEEtfgHcEBs\r\n"
        "K9KcStQGGZRfmWU07hPXHnFz+5gTXqzCE2PBMlRgVUYJiA25mJPXfB00gDvGhtYa\r\n"
        "+mENwM9Bq1B9YYLyLjRtUz8cyGsdyTIG/bBM/Q9jcV8JGqMU/UjAdh1pFyTnnHEl\r\n"
        "Y59Npi7F87ZqYYJEHJM2LGD+le8VsHjgeWX2CJQko7klXvcizuZvUEDTjHaQcs2J\r\n"
        "+kPgfyMIOY1DMJ21NxOJ2xPRC/wAh/hzSBRVtoAnyuxtkZ4VjIOh\r\n"
        "-----END CERTIFICATE-----\r\n";
    ```

1. рдЗрд╕ рдлрд╛рдЗрд▓ рдореЗрдВ рдПрдХ рдХреЙрдиреНрд╕реНрдЯреЗрдВрдЯ рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рд╕реНрдерд╛рди рдХреЗ рдмрд┐рдирд╛ рд╕реНрдкреАрдЪ URL рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕реЗ рдмрд╛рдж рдореЗрдВ рд╕реНрдерд╛рди рдФрд░ рднрд╛рд╖рд╛ рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ рддрд╛рдХрд┐ рдкреВрд░рд╛ URL рдкреНрд░рд╛рдкреНрдд рд╣реЛ рд╕рдХреЗред

    ```cpp
    const char *SPEECH_URL = "https://%s.stt.speech.microsoft.com/speech/recognition/conversation/cognitiveservices/v1?language=%s";
    ```

1. `speech_to_text.h` рд╣реЗрдбрд░ рдлрд╛рдЗрд▓ рдореЗрдВ, `SpeechToText` рдХреНрд▓рд╛рд╕ рдХреЗ `private` рд╕реЗрдХреНрд╢рди рдореЗрдВ, рд╕реНрдкреАрдЪ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ WiFi рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдПрдХ рдлреАрд▓реНрдб рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ:

    ```cpp
    WiFiClientSecure _speech_client;
    ```

1. `init` рдореЗрдердб рдореЗрдВ, рдЗрд╕ WiFi рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕реЗрдЯ рдХрд░реЗрдВ:

    ```cpp
    _speech_client.setCACert(SPEECH_CERTIFICATE);
    ```

1. `SpeechToText` рдХреНрд▓рд╛рд╕ рдХреЗ `public` рд╕реЗрдХреНрд╢рди рдореЗрдВ, рд╡рд╛рдХ рдХреЛ рдкрд╛рда рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдореЗрдердб рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ:

    ```cpp
    String convertSpeechToText()
    {
        
    }
    ```

1. рдЗрд╕ рдореЗрдердб рдореЗрдВ, рд╕реНрдкреАрдЪ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП WiFi рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ HTTP рдХреНрд▓рд╛рдЗрдВрдЯ рдмрдирд╛рдиреЗ рдФрд░ рд╕реНрдерд╛рди рдФрд░ рднрд╛рд╖рд╛ рдХреЗ рд╕рд╛рде рд╕реЗрдЯ рдХрд┐рдП рдЧрдП рд╕реНрдкреАрдЪ URL рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    char url[128];
    sprintf(url, SPEECH_URL, SPEECH_LOCATION, LANGUAGE);

    HTTPClient httpClient;
    httpClient.begin(_speech_client, url);
    ```

1. рдХрдиреЗрдХреНрд╢рди рдкрд░ рдХреБрдЫ рд╣реЗрдбрд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:

    ```cpp
    httpClient.addHeader("Authorization", String("Bearer ") + _access_token);
    httpClient.addHeader("Content-Type", String("audio/wav; codecs=audio/pcm; samplerate=") + String(RATE));
    httpClient.addHeader("Accept", "application/json;text/xml");
    ```

    рдпрд╣ рд╣реЗрдбрд░ рдХреЛ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ, рдСрдбрд┐рдпреЛ рдкреНрд░рд╛рд░реВрдк рдХреЛ рд╕реИрдВрдкрд▓ рд░реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░рд┐рдгрд╛рдо рдХреЛ JSON рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдкреЗрдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред

1. рдЗрд╕рдХреЗ рдмрд╛рдж, REST API рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    Serial.println("Sending speech...");

    FlashStream stream;
    int httpResponseCode = httpClient.sendRequest("POST", &stream, BUFFER_SIZE);

    Serial.println("Speech sent!");
    ```

    рдпрд╣ рдПрдХ `FlashStream` рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ REST API рдкрд░ рдбреЗрдЯрд╛ рд╕реНрдЯреНрд░реАрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

1. рдЗрд╕рдХреЗ рдиреАрдЪреЗ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ:

    ```cpp
    String text = "";

    if (httpResponseCode == 200)
    {
        String result = httpClient.getString();
        Serial.println(result);

        DynamicJsonDocument doc(1024);
        deserializeJson(doc, result.c_str());

        JsonObject obj = doc.as<JsonObject>();
        text = obj["DisplayText"].as<String>();
    }
    else if (httpResponseCode == 401)
    {
        Serial.println("Access token expired, trying again with a new token");
        _access_token = getAccessToken();
        return convertSpeechToText();
    }
    else
    {
        Serial.print("Failed to convert text to speech - error ");
        Serial.println(httpResponseCode);
    }
    ```

    рдпрд╣ рдХреЛрдб рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИред

    рдпрджрд┐ рдпрд╣ 200 рд╣реИ, рдЬреЛ рд╕рдлрд▓рддрд╛ рдХрд╛ рдХреЛрдб рд╣реИ, рддреЛ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, JSON рд╕реЗ рдбрд┐рдХреЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ `DisplayText` рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЛ `text` рд╡реЗрд░рд┐рдПрдмрд▓ рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рд╡рд╣ рдкреНрд░реЙрдкрд░реНрдЯреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╡рд╛рдХ рдХрд╛ рдЯреЗрдХреНрд╕реНрдЯ рд╕рдВрд╕реНрдХрд░рдг рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

    рдпрджрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛрдб 401 рд╣реИ, рддреЛ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдпрд╛ рд╣реИ (рдпреЗ рдЯреЛрдХрди рдХреЗрд╡рд▓ 10 рдорд┐рдирдЯ рддрдХ рдЪрд▓рддреЗ рд╣реИрдВ)ред рдПрдХ рдирдпрд╛ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдХреЙрд▓ рдХреЛ рдлрд┐рд░ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

    рдЕрдиреНрдпрдерд╛, рдПрдХ рддреНрд░реБрдЯрд┐ рд╕реАрд░рд┐рдпрд▓ рдореЙрдирд┐рдЯрд░ рдкрд░ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИ, рдФрд░ `text` рдЦрд╛рд▓реА рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

1. рдЗрд╕ рдореЗрдердб рдХреЗ рдЕрдВрдд рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ рддрд╛рдХрд┐ HTTP рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рдмрдВрдж рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ рдЯреЗрдХреНрд╕реНрдЯ рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ:

    ```cpp
    httpClient.end();

    return text;
    ```

1. `main.cpp` рдореЗрдВ, рдЗрд╕ рдирдП `convertSpeechToText` рдореЗрдердб рдХреЛ `processAudio` рдлрдВрдХреНрд╢рди рдореЗрдВ рдХреЙрд▓ рдХрд░реЗрдВ, рдлрд┐рд░ рд╡рд╛рдХ рдХреЛ рд╕реАрд░рд┐рдпрд▓ рдореЙрдирд┐рдЯрд░ рдкрд░ рд▓реЙрдЧ рдХрд░реЗрдВ:

    ```cpp
    String text = speechToText.convertSpeechToText();
    Serial.println(text);
    ```

1. рдЗрд╕ рдХреЛрдб рдХреЛ рдмрдирд╛рдПрдВ, рдЗрд╕реЗ рдЕрдкрдиреЗ Wio Terminal рдкрд░ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ рд╕реАрд░рд┐рдпрд▓ рдореЙрдирд┐рдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЯреЗрд╕реНрдЯ рдХрд░реЗрдВред рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк рд╕реАрд░рд┐рдпрд▓ рдореЙрдирд┐рдЯрд░ рдореЗрдВ `Ready` рджреЗрдЦреЗрдВ, рддреЛ C рдмрдЯрди рджрдмрд╛рдПрдВ (рдЬреЛ рдмрд╛рдИрдВ рдУрд░ рд╣реИ, рдкрд╛рд╡рд░ рд╕реНрд╡рд┐рдЪ рдХреЗ рд╕рдмрд╕реЗ рдХрд░реАрдм), рдФрд░ рдмреЛрд▓реЗрдВред 4 рд╕реЗрдХрдВрдб рдХрд╛ рдСрдбрд┐рдпреЛ рдХреИрдкреНрдЪрд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдлрд┐рд░ рдЗрд╕реЗ рдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

    ```output
    --- Available filters and text transformations: colorize, debug, default, direct, hexlify, log2file, nocontrol, printable, send_on_enter, time
    --- More details at http://bit.ly/pio-monitor-filters
    --- Miniterm on /dev/cu.usbmodem1101  9600,8,N,1 ---
    --- Quit: Ctrl+C | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H ---
    Connecting to WiFi..
    Connected!
    Got access token.
    Ready.
    Starting recording...
    Finished recording
    Sending speech...
    Speech sent!
    {"RecognitionStatus":"Success","DisplayText":"Set a 2 minute and 27 second timer.","Offset":4700000,"Duration":35300000}
    Set a 2 minute and 27 second timer.
    ```

> ЁЯТБ рдЖрдк рдЗрд╕ рдХреЛрдб рдХреЛ [code-speech-to-text/wio-terminal](../../../../../6-consumer/lessons/1-speech-recognition/code-speech-to-text/wio-terminal) рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

ЁЯША рдЖрдкрдХрд╛ рд╡рд╛рдХ рд╕реЗ рдкрд╛рда рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕рдлрд▓ рд░рд╣рд╛!

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬрдмрдХрд┐ рд╣рдо рд╕рдЯреАрдХрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рдж рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рдпрд╛ рдЕрд╢реБрджреНрдзрд┐рдпрд╛рдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдореВрд▓ рднрд╛рд╖рд╛ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдкреНрд░рд╛рдорд╛рдгрд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдкреЗрд╢реЗрд╡рд░ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕ рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рд╕реА рднреА рдЧрд▓рддрдлрд╣рдореА рдпрд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП рд╣рдо рдЙрддреНрддрд░рджрд╛рдпреА рдирд╣реАрдВ рд╣реИрдВред