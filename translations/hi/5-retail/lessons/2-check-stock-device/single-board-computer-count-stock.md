<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "9c4320311c0f2c1884a6a21265d98a51",
  "translation_date": "2025-08-25T16:22:43+00:00",
  "source_file": "5-retail/lessons/2-check-stock-device/single-board-computer-count-stock.md",
  "language_code": "hi"
}
-->
# рдЕрдкрдиреЗ IoT рдбрд┐рд╡рд╛рдЗрд╕ рд╕реЗ рд╕реНрдЯреЙрдХ рдЧрд┐рдиреЗрдВ - рд╡рд░реНрдЪреБрдЕрд▓ IoT рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдФрд░ рд░рд╛рд╕реНрдкрдмреЗрд░реА рдкрд╛рдИ

рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдиреЛрдВ рдФрд░ рдЙрдирдХреЗ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХрд╛ рд╕рдВрдпреЛрдЬрди рдЫрд╡рд┐ рдореЗрдВ рд╕реНрдЯреЙрдХ рдЧрд┐рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рджрд┐рдЦрд╛рдПрдВ

рдбрд┐рдмрдЧрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╣рд╛рдпрдХ рдХрджрдо рдХреЗ рд░реВрдк рдореЗрдВ, рдЖрдк рди рдХреЗрд╡рд▓ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдмрд▓реНрдХрд┐ рдЙрдиреНрд╣реЗрдВ рдЙрд╕ рдЫрд╡рд┐ рдкрд░ рднреА рдЦреАрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЫрд╡рд┐ рдХреИрдкреНрдЪрд░ рд╣реЛрдиреЗ рдкрд░ рдбрд┐рд╕реНрдХ рдкрд░ рд▓рд┐рдЦреА рдЧрдИ рдереАред

### рдХрд╛рд░реНрдп - рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ

1. рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ `stock-counter` рдкреНрд░реЛрдЬреЗрдХреНрдЯ VS Code рдореЗрдВ рдЦреБрд▓рд╛ рд╣реИ, рдФрд░ рдпрджрд┐ рдЖрдк рд╡рд░реНрдЪреБрдЕрд▓ IoT рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рддреЛ рд╡рд░реНрдЪреБрдЕрд▓ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рд╕рдХреНрд░рд┐рдп рд╣реИред

1. `for` рд▓реВрдк рдореЗрдВ `print` рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдВ рдмрджрд▓реЗрдВ рддрд╛рдХрд┐ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреЛ рдХрдВрд╕реЛрд▓ рдореЗрдВ рдкреНрд░рд┐рдВрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ:

    ```python
    print(f'{prediction.tag_name}:\t{prediction.probability * 100:.2f}%\t{prediction.bounding_box}')
    ```

1. рдРрдк рдХреЛ рдЪрд▓рд╛рдПрдВ рдФрд░ рдХреИрдорд░реЗ рдХреЛ рд╢реЗрд▓реНрдл рдкрд░ рд░рдЦреЗ рд╕реНрдЯреЙрдХ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдВред рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХрдВрд╕реЛрд▓ рдореЗрдВ рдкреНрд░рд┐рдВрдЯ рд╣реЛрдВрдЧреЗ, рдЬрд┐рдирдореЗрдВ 0-1 рдХреЗ рдмреАрдЪ рдХреЗ рд▓реЗрдлреНрдЯ, рдЯреЙрдк, рдЪреМрдбрд╝рд╛рдИ рдФрд░ рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди рд╣реЛрдВрдЧреЗред

    ```output
    pi@raspberrypi:~/stock-counter $ python3 app.py 
    tomato paste:   33.42%  {'additional_properties': {}, 'left': 0.3455171, 'top': 0.09916268, 'width': 0.14175442, 'height': 0.29405564}
    tomato paste:   34.41%  {'additional_properties': {}, 'left': 0.48283678, 'top': 0.10242918, 'width': 0.11782813, 'height': 0.27467814}
    tomato paste:   31.25%  {'additional_properties': {}, 'left': 0.4923783, 'top': 0.35007596, 'width': 0.13668466, 'height': 0.28304994}
    tomato paste:   31.05%  {'additional_properties': {}, 'left': 0.36416405, 'top': 0.37494493, 'width': 0.14024884, 'height': 0.26880276}
    ```

### рдХрд╛рд░реНрдп - рдЫрд╡рд┐ рдкрд░ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдЦреАрдВрдЪреЗрдВ

1. [Pillow](https://pypi.org/project/Pillow/) рдирд╛рдордХ Pip рдкреИрдХреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЫрд╡рд┐рдпреЛрдВ рдкрд░ рдЦреАрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ:

    ```sh
    pip3 install pillow
    ```

    рдпрджрд┐ рдЖрдк рд╡рд░реНрдЪреБрдЕрд▓ IoT рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЗрд╕реЗ рд╕рдХреНрд░рд┐рдп рд╡рд░реНрдЪреБрдЕрд▓ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рдХреЗ рдЕрдВрджрд░ рд╕реЗ рдЪрд▓рд╛рдПрдВред

1. `app.py` рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЗрдореНрдкреЛрд░реНрдЯ рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рдЬреЛрдбрд╝реЗрдВ:

    ```python
    from PIL import Image, ImageDraw, ImageColor
    ```

    рдпрд╣ рдХреЛрдб рдЗрдореНрдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЫрд╡рд┐ рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред

1. `app.py` рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрдд рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ:

    ```python
    with Image.open('image.jpg') as im:
        draw = ImageDraw.Draw(im)
    
        for prediction in predictions:
            scale_left = prediction.bounding_box.left
            scale_top = prediction.bounding_box.top
            scale_right = prediction.bounding_box.left + prediction.bounding_box.width
            scale_bottom = prediction.bounding_box.top + prediction.bounding_box.height
            
            left = scale_left * im.width
            top = scale_top * im.height
            right = scale_right * im.width
            bottom = scale_bottom * im.height
    
            draw.rectangle([left, top, right, bottom], outline=ImageColor.getrgb('red'), width=2)
    
        im.save('image.jpg')
    ```

    рдпрд╣ рдХреЛрдб рдкрд╣рд▓реЗ рд╕реЗ рд╕рд╣реЗрдЬреА рдЧрдИ рдЫрд╡рд┐ рдХреЛ рд╕рдВрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдЦреЛрд▓рддрд╛ рд╣реИред рдлрд┐рд░ рдпрд╣ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдиреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реВрдк рдХрд░рддрд╛ рд╣реИ, рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдорд╛рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдиреАрдЪреЗ рджрд╛рдПрдВ рдХреЛрдиреЗ рдХрд╛ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИред рдЗрди рдорд╛рдиреЛрдВ рдХреЛ рдЫрд╡рд┐ рдХреЗ рдЖрдпрд╛рдореЛрдВ рд╕реЗ рдЧреБрдгрд╛ рдХрд░рдХреЗ рдЫрд╡рд┐ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рд▓реЗрдлреНрдЯ рдорд╛рди 0.5 рд╣реИ рдФрд░ рдЫрд╡рд┐ 600 рдкрд┐рдХреНрд╕рд▓ рдЪреМрдбрд╝реА рд╣реИ, рддреЛ рдпрд╣ 300 рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛрдЧрд╛ (0.5 x 600 = 300)ред

    рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреЛ рдЫрд╡рд┐ рдкрд░ рдПрдХ рд▓рд╛рд▓ рд░реЗрдЦрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦреАрдВрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЕрдВрдд рдореЗрдВ, рд╕рдВрдкрд╛рджрд┐рдд рдЫрд╡рд┐ рдХреЛ рд╕рд╣реЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдореВрд▓ рдЫрд╡рд┐ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

1. рдРрдк рдХреЛ рдЪрд▓рд╛рдПрдВ рдФрд░ рдХреИрдорд░реЗ рдХреЛ рд╢реЗрд▓реНрдл рдкрд░ рд░рдЦреЗ рд╕реНрдЯреЙрдХ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдВред рдЖрдк VS Code рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рдореЗрдВ `image.jpg` рдлрд╝рд╛рдЗрд▓ рджреЗрдЦреЗрдВрдЧреЗ рдФрд░ рдЗрд╕реЗ рдЪреБрдирдХрд░ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рджреЗрдЦ рд╕рдХреЗрдВрдЧреЗред

    ![4 рдЯрдорд╛рдЯрд░ рдкреЗрд╕реНрдЯ рдХреЗ рдбрд┐рдмреНрдмреЗ, рдЬрд┐рдирдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рд╣реИрдВ](../../../../../translated_images/rpi-stock-with-bounding-boxes.b5540e2ecb7cd49f1271828d3be412671d950e87625c5597ea97c90f11e01097.hi.jpg)

## рд╕реНрдЯреЙрдХ рдЧрд┐рдиреЗрдВ

рдКрдкрд░ рджрд┐рдЦрд╛рдИ рдЧрдИ рдЫрд╡рд┐ рдореЗрдВ, рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдореЗрдВ рдереЛрдбрд╝рд╛ рдУрд╡рд░рд▓реИрдк рд╣реИред рдпрджрд┐ рдпрд╣ рдУрд╡рд░рд▓реИрдк рдмрд╣реБрдд рдмрдбрд╝рд╛ рд╣реЛрддрд╛, рддреЛ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдПрдХ рд╣реА рд╡рд╕реНрддреБ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░ рд╕рдХрддреЗ рдереЗред рд╡рд╕реНрддреБрдУрдВ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдЧрд┐рдирдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдЙрди рдмреЙрдХреНрд╕ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рдирдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдУрд╡рд░рд▓реИрдк рд╣реИред

### рдХрд╛рд░реНрдп - рдУрд╡рд░рд▓реИрдк рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рддреЗ рд╣реБрдП рд╕реНрдЯреЙрдХ рдЧрд┐рдиреЗрдВ

1. [Shapely](https://pypi.org/project/Shapely/) рдирд╛рдордХ Pip рдкреИрдХреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрдВрдЯрд░рд╕реЗрдХреНрд╢рди рдХреА рдЧрдгрдирд╛ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдЖрдк рд░рд╛рд╕реНрдкрдмреЗрд░реА рдкрд╛рдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдкрд╣рд▓реЗ рдПрдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдбрд┐рдкреЗрдВрдбреЗрдВрд╕реА рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ:

    ```sh
    sudo apt install libgeos-dev
    ```

1. Shapely Pip рдкреИрдХреЗрдЬ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ:

    ```sh
    pip3 install shapely
    ```

    рдпрджрд┐ рдЖрдк рд╡рд░реНрдЪреБрдЕрд▓ IoT рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЗрд╕реЗ рд╕рдХреНрд░рд┐рдп рд╡рд░реНрдЪреБрдЕрд▓ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рдХреЗ рдЕрдВрджрд░ рд╕реЗ рдЪрд▓рд╛рдПрдВред

1. `app.py` рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЗрдореНрдкреЛрд░реНрдЯ рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рдЬреЛрдбрд╝реЗрдВ:

    ```python
    from shapely.geometry import Polygon
    ```

    рдпрд╣ рдХреЛрдб рдЗрдореНрдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдУрд╡рд░рд▓реИрдк рдХреА рдЧрдгрдирд╛ рдХреЗ рд▓рд┐рдП рдкреЙрд▓реАрдЧреЙрди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред

1. рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдЦреАрдВрдЪрдиреЗ рд╡рд╛рд▓реЗ рдХреЛрдб рдХреЗ рдКрдкрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЬреЛрдбрд╝реЗрдВ:

    ```python
    overlap_threshold = 0.20
    ```

    рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреЛ рдПрдХ рд╣реА рд╡рд╕реНрддреБ рдорд╛рдирдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐рддрдирд╛ рдкреНрд░рддрд┐рд╢рдд рдУрд╡рд░рд▓реИрдк рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред 0.20 рдХрд╛ рдЕрд░реНрде рд╣реИ 20% рдУрд╡рд░рд▓реИрдкред

1. Shapely рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдУрд╡рд░рд▓реИрдк рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреЛ Shapely рдкреЙрд▓реАрдЧреЙрди рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝рдВрдХреНрд╢рди рдЬреЛрдбрд╝реЗрдВ:

    ```python
    def create_polygon(prediction):
        scale_left = prediction.bounding_box.left
        scale_top = prediction.bounding_box.top
        scale_right = prediction.bounding_box.left + prediction.bounding_box.width
        scale_bottom = prediction.bounding_box.top + prediction.bounding_box.height
    
        return Polygon([(scale_left, scale_top), (scale_right, scale_top), (scale_right, scale_bottom), (scale_left, scale_bottom)])
    ```

    рдпрд╣ рдПрдХ рдкреЙрд▓реАрдЧреЙрди рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХреЗ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

1. рдУрд╡рд░рд▓реИрдкрд┐рдВрдЧ рд╡рд╕реНрддреБрдУрдВ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЙрдЬрд┐рдХ рдореЗрдВ рд╕рднреА рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреА рддреБрд▓рдирд╛ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдпрджрд┐ рдХрд┐рд╕реА рднреА рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдЬреЛрдбрд╝реЗ рдХреЗ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдУрд╡рд░рд▓реИрдк рдереНрд░реЗрд╢реЛрд▓реНрдб рд╕реЗ рдЕрдзрд┐рдХ рдУрд╡рд░рд▓реИрдк рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЙрдирдореЗрдВ рд╕реЗ рдПрдХ рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╕рднреА рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдиреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди 1 рдХреА рддреБрд▓рдирд╛ 2, 3, 4 рдЖрджрд┐ рд╕реЗ рдХрд░рддреЗ рд╣реИрдВ, рдлрд┐рд░ 2 рдХреА рддреБрд▓рдирд╛ 3, 4 рдЖрджрд┐ рд╕реЗ рдХрд░рддреЗ рд╣реИрдВред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдпрд╣ рдХрд░рддрд╛ рд╣реИ:

    ```python
    to_delete = []

    for i in range(0, len(predictions)):
        polygon_1 = create_polygon(predictions[i])
    
        for j in range(i+1, len(predictions)):
            polygon_2 = create_polygon(predictions[j])
            overlap = polygon_1.intersection(polygon_2).area

            smallest_area = min(polygon_1.area, polygon_2.area)
    
            if overlap > (overlap_threshold * smallest_area):
                to_delete.append(predictions[i])
                break
    
    for d in to_delete:
        predictions.remove(d)

    print(f'Counted {len(predictions)} stock items')
    ```

    рдУрд╡рд░рд▓реИрдк рдХреА рдЧрдгрдирд╛ Shapely рдХреЗ `Polygon.intersection` рдореЗрдердб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреА рдЬрд╛рддреА рд╣реИ, рдЬреЛ рдУрд╡рд░рд▓реИрдк рдХрд╛ рдкреЙрд▓реАрдЧреЙрди рд▓реМрдЯрд╛рддрд╛ рд╣реИред рдЗрд╕ рдкреЙрд▓реАрдЧреЙрди рд╕реЗ рдХреНрд╖реЗрддреНрд░рдлрд▓ рдХреА рдЧрдгрдирд╛ рдХреА рдЬрд╛рддреА рд╣реИред рдпрд╣ рдУрд╡рд░рд▓реИрдк рдереНрд░реЗрд╢реЛрд▓реНрдб рдПрдХ рдкреВрд░реНрдг рдорд╛рди рдирд╣реАрдВ рд╣реИ, рдмрд▓реНрдХрд┐ рдпрд╣ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХрд╛ рдкреНрд░рддрд┐рд╢рдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рдЗрд╕рд▓рд┐рдП рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдУрд╡рд░рд▓реИрдк рдереНрд░реЗрд╢реЛрд▓реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдпрд╣ рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдУрд╡рд░рд▓реИрдк рдХрд╛ рдХреНрд╖реЗрддреНрд░ рдХрд┐рддрдирд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рд╕рдмрд╕реЗ рдЫреЛрдЯреЗ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреЗ рдкреНрд░рддрд┐рд╢рдд рдУрд╡рд░рд▓реИрдк рдереНрд░реЗрд╢реЛрд▓реНрдб рд╕реЗ рдЕрдзрд┐рдХ рди рд╣реЛред рдпрджрд┐ рдУрд╡рд░рд▓реИрдк рдЗрд╕реЗ рдкрд╛рд░ рдХрд░ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

    рдПрдХ рдмрд╛рд░ рдЬрдм рдХрд┐рд╕реА рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЪрд┐рд╣реНрдирд┐рдд рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рдлрд┐рд░ рд╕реЗ рдЬрд╛рдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдВрддрд░рд┐рдХ рд▓реВрдк рдЕрдЧрд▓реЗ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреНрд░реЗрдХ рдХрд░ рджреЗрддрд╛ рд╣реИред рдЖрдк рд╕реВрдЪреА рд╕реЗ рдЖрдЗрдЯрдо рдХреЛ рд╣рдЯрд╛рддреЗ рд╕рдордп рдЙрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрдЯрд░реЗрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ, рдЗрд╕рд▓рд┐рдП рдЬреЛ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдереНрд░реЗрд╢реЛрд▓реНрдб рд╕реЗ рдЕрдзрд┐рдХ рдУрд╡рд░рд▓реИрдк рдХрд░рддреЗ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ `to_delete` рд╕реВрдЪреА рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЕрдВрдд рдореЗрдВ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

    рдЕрдВрдд рдореЗрдВ, рд╕реНрдЯреЙрдХ рдХрд╛рдЙрдВрдЯ рдХрдВрд╕реЛрд▓ рдореЗрдВ рдкреНрд░рд┐рдВрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕реЗ IoT рд╕реЗрд╡рд╛ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╕реНрдЯреЙрдХ рд╕реНрддрд░ рдХрдо рд╣реЛрдиреЗ рдкрд░ рдЕрд▓рд░реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдпрд╣ рд╕рд╛рд░рд╛ рдХреЛрдб рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдЦреАрдВрдЪрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдк рдЙрддреНрдкрдиреНрди рдЫрд╡рд┐рдпреЛрдВ рдкрд░ рдУрд╡рд░рд▓реИрдк рдХреЗ рдмрд┐рдирд╛ рд╕реНрдЯреЙрдХ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рджреЗрдЦреЗрдВрдЧреЗред

    > ЁЯТБ рдпрд╣ рдУрд╡рд░рд▓реИрдк рдХреЛ рд╣рдЯрд╛рдиреЗ рдХрд╛ рдПрдХ рдмрд╣реБрдд рд╣реА рд╕рд░рд▓ рддрд░реАрдХрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдХреЗрд╡рд▓ рдУрд╡рд░рд▓реИрдкрд┐рдВрдЧ рдЬреЛрдбрд╝реЗ рдореЗрдВ рд╕реЗ рдкрд╣рд▓реЗ рд╡рд╛рд▓реЗ рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдкреНрд░реЛрдбрдХреНрд╢рди рдХреЛрдб рдХреЗ рд▓рд┐рдП, рдЖрдк рдпрд╣рд╛рдВ рдЕрдзрд┐рдХ рд▓реЙрдЬрд┐рдХ рдЬреЛрдбрд╝рдирд╛ рдЪрд╛рд╣реЗрдВрдЧреЗ, рдЬреИрд╕реЗ рдХрд┐ рдХрдИ рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдмреАрдЪ рдУрд╡рд░рд▓реИрдк рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рдирд╛, рдпрд╛ рдпрджрд┐ рдПрдХ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рджреВрд╕рд░реЗ рдХреЗ рдЕрдВрджрд░ рд╣реИред

1. рдРрдк рдХреЛ рдЪрд▓рд╛рдПрдВ рдФрд░ рдХреИрдорд░реЗ рдХреЛ рд╢реЗрд▓реНрдл рдкрд░ рд░рдЦреЗ рд╕реНрдЯреЙрдХ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдВред рдЖрдЙрдЯрдкреБрдЯ рдпрд╣ рджрд┐рдЦрд╛рдПрдЧрд╛ рдХрд┐ рдереНрд░реЗрд╢реЛрд▓реНрдб рд╕реЗ рдЕрдзрд┐рдХ рдУрд╡рд░рд▓реИрдк рдХреЗ рдмрд┐рдирд╛ рдХрд┐рддрдиреЗ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рд╣реИрдВред `overlap_threshold` рдорд╛рди рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдХреЗ рджреЗрдЦреЗрдВ рдХрд┐ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХреИрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

> ЁЯТБ рдЖрдк рдЗрд╕ рдХреЛрдб рдХреЛ [code-count/pi](../../../../../5-retail/lessons/2-check-stock-device/code-count/pi) рдпрд╛ [code-count/virtual-iot-device](../../../../../5-retail/lessons/2-check-stock-device/code-count/virtual-iot-device) рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

ЁЯША рдЖрдкрдХрд╛ рд╕реНрдЯреЙрдХ рдХрд╛рдЙрдВрдЯрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕рдлрд▓ рд░рд╣рд╛!

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ AI рдЕрдиреБрд╡рд╛рдж рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬрдмрдХрд┐ рд╣рдо рд╕рдЯреАрдХрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рдж рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рдпрд╛ рдЕрд╢реБрджреНрдзрд┐рдпрд╛рдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдореВрд▓ рднрд╛рд╖рд╛ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдореВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, рдкреЗрд╢реЗрд╡рд░ рдорд╛рдирд╡ рдЕрдиреБрд╡рд╛рдж рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕ рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рд╕реА рднреА рдЧрд▓рддрдлрд╣рдореА рдпрд╛ рдЧрд▓рдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП рд╣рдо рдЬрд┐рдореНрдореЗрджрд╛рд░ рдирд╣реАрдВ рд╣реИрдВред