<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "52b4de6144b2efdced7797a5339d6035",
  "translation_date": "2025-08-27T21:57:25+00:00",
  "source_file": "1-getting-started/lessons/1-introduction-to-iot/virtual-device.md",
  "language_code": "sv"
}
-->
# Virtuell enkortsdator

Ist√§llet f√∂r att k√∂pa en IoT-enhet tillsammans med sensorer och st√§lldon kan du anv√§nda din dator f√∂r att simulera IoT-h√•rdvara. [CounterFit-projektet](https://github.com/CounterFit-IoT/CounterFit) l√•ter dig k√∂ra en app lokalt som simulerar IoT-h√•rdvara som sensorer och st√§lldon, och du kan komma √•t dessa fr√•n lokal Python-kod som skrivs p√• samma s√§tt som om du skulle anv√§nda en Raspberry Pi med fysisk h√•rdvara.

## Installation

F√∂r att anv√§nda CounterFit beh√∂ver du installera viss gratis programvara p√• din dator.

### Uppgift

Installera den n√∂dv√§ndiga programvaran.

1. Installera Python. Se [Pythons nedladdningssida](https://www.python.org/downloads/) f√∂r instruktioner om hur du installerar den senaste versionen av Python.

1. Installera Visual Studio Code (VS Code). Detta √§r den editor du kommer att anv√§nda f√∂r att skriva din virtuella enhetskod i Python. Se [VS Code-dokumentationen](https://code.visualstudio.com?WT.mc_id=academic-17441-jabenn) f√∂r instruktioner om hur du installerar VS Code.

    > üíÅ Du √§r fri att anv√§nda vilken Python-IDE eller editor du f√∂redrar f√∂r dessa lektioner, men instruktionerna kommer att baseras p√• anv√§ndning av VS Code.

1. Installera VS Code-till√§gget Pylance. Detta √§r ett till√§gg f√∂r VS Code som ger st√∂d f√∂r Python-spr√•ket. Se [Pylance-till√§ggets dokumentation](https://marketplace.visualstudio.com/items?WT.mc_id=academic-17441-jabenn&itemName=ms-python.vscode-pylance) f√∂r instruktioner om hur du installerar detta till√§gg i VS Code.

Instruktionerna f√∂r att installera och konfigurera CounterFit-appen kommer att ges vid r√§tt tidpunkt i uppdragsinstruktionerna, eftersom den installeras per projekt.

## Hello world

Det √§r traditionellt att n√§r man b√∂rjar med ett nytt programmeringsspr√•k eller en ny teknik skapa en "Hello World"-applikation ‚Äì en liten applikation som skriver ut n√•got som texten `"Hello World"` f√∂r att visa att alla verktyg √§r korrekt konfigurerade.

Hello World-appen f√∂r den virtuella IoT-h√•rdvaran kommer att s√§kerst√§lla att du har Python och Visual Studio Code korrekt installerade. Den kommer ocks√• att ansluta till CounterFit f√∂r de virtuella IoT-sensorerna och st√§lldonen. Den kommer inte att anv√§nda n√•gon h√•rdvara, utan bara ansluta f√∂r att bevisa att allt fungerar.

Denna app kommer att finnas i en mapp som heter `nightlight`, och den kommer att √•teranv√§ndas med olika kod i senare delar av detta uppdrag f√∂r att bygga nattlampa-applikationen.

### Konfigurera en virtuell Python-milj√∂

En av de kraftfulla funktionerna i Python √§r m√∂jligheten att installera [Pip-paket](https://pypi.org) ‚Äì dessa √§r paket med kod skrivna av andra och publicerade p√• Internet. Du kan installera ett Pip-paket p√• din dator med ett kommando och sedan anv√§nda det paketet i din kod. Du kommer att anv√§nda Pip f√∂r att installera ett paket f√∂r att kommunicera med CounterFit.

Som standard, n√§r du installerar ett paket, √§r det tillg√§ngligt √∂verallt p√• din dator, och detta kan leda till problem med paketversioner ‚Äì till exempel att en applikation √§r beroende av en version av ett paket som slutar fungera n√§r du installerar en ny version f√∂r en annan applikation. F√∂r att undvika detta problem kan du anv√§nda en [virtuell Python-milj√∂](https://docs.python.org/3/library/venv.html), i princip en kopia av Python i en dedikerad mapp, och n√§r du installerar Pip-paket installeras de bara i den mappen.

> üíÅ Om du anv√§nder en Raspberry Pi s√• konfigurerade du inte en virtuell milj√∂ p√• den enheten f√∂r att hantera Pip-paket, utan du anv√§nder globala paket, eftersom Grove-paketen installeras globalt av installationsskriptet.

#### Uppgift ‚Äì konfigurera en virtuell Python-milj√∂

Konfigurera en virtuell Python-milj√∂ och installera Pip-paketen f√∂r CounterFit.

1. Fr√•n din terminal eller kommandorad, k√∂r f√∂ljande p√• en plats du v√§ljer f√∂r att skapa och navigera till en ny katalog:

    ```sh
    mkdir nightlight
    cd nightlight
    ```

1. K√∂r nu f√∂ljande f√∂r att skapa en virtuell milj√∂ i `.venv`-mappen:

    ```sh
    python3 -m venv .venv
    ```

    > üíÅ Du m√•ste uttryckligen kalla p√• `python3` f√∂r att skapa den virtuella milj√∂n, ifall du har Python 2 installerat ut√∂ver Python 3 (den senaste versionen). Om du har Python 2 installerat kommer anropet `python` att anv√§nda Python 2 ist√§llet f√∂r Python 3.

1. Aktivera den virtuella milj√∂n:

    * P√• Windows:
        * Om du anv√§nder Kommandotolken eller Kommandotolken via Windows Terminal, k√∂r:

            ```cmd
            .venv\Scripts\activate.bat
            ```

        * Om du anv√§nder PowerShell, k√∂r:

            ```powershell
            .\.venv\Scripts\Activate.ps1
            ```

            > Om du f√•r ett felmeddelande om att k√∂rning av skript √§r inaktiverad p√• detta system, m√•ste du aktivera k√∂rning av skript genom att st√§lla in en l√§mplig exekveringspolicy. Du kan g√∂ra detta genom att starta PowerShell som administrat√∂r och sedan k√∂ra f√∂ljande kommando:

            ```powershell
            Set-ExecutionPolicy -ExecutionPolicy Unrestricted
            ```

            Skriv `Y` n√§r du ombeds bekr√§fta. Starta sedan om PowerShell och f√∂rs√∂k igen.

            Du kan √•terst√§lla denna exekveringspolicy vid ett senare tillf√§lle om det beh√∂vs. Du kan l√§sa mer om detta p√• [sidan om exekveringspolicyer p√• Microsoft Docs](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_execution_policies?WT.mc_id=academic-17441-jabenn).

    * P√• macOS eller Linux, k√∂r:

        ```cmd
        source ./.venv/bin/activate
        ```

    > üíÅ Dessa kommandon b√∂r k√∂ras fr√•n samma plats d√§r du k√∂rde kommandot f√∂r att skapa den virtuella milj√∂n. Du beh√∂ver aldrig navigera in i `.venv`-mappen, du b√∂r alltid k√∂ra aktiveringskommandot och alla kommandon f√∂r att installera paket eller k√∂ra kod fr√•n mappen du var i n√§r du skapade den virtuella milj√∂n.

1. N√§r den virtuella milj√∂n har aktiverats kommer standardkommandot `python` att k√∂ra den version av Python som anv√§ndes f√∂r att skapa den virtuella milj√∂n. K√∂r f√∂ljande f√∂r att f√• versionen:

    ```sh
    python --version
    ```

    Utdata b√∂r inneh√•lla f√∂ljande:

    ```output
    (.venv) ‚ûú  nightlight python --version
    Python 3.9.1
    ```

    > üíÅ Din Python-version kan vara annorlunda ‚Äì s√• l√§nge den √§r version 3.6 eller h√∂gre √§r det bra. Om inte, ta bort denna mapp, installera en nyare version av Python och f√∂rs√∂k igen.

1. K√∂r f√∂ljande kommandon f√∂r att installera Pip-paketen f√∂r CounterFit. Dessa paket inkluderar huvudappen CounterFit samt shims f√∂r Grove-h√•rdvara. Dessa shims l√•ter dig skriva kod som om du programmerade med fysiska sensorer och st√§lldon fr√•n Grove-ekosystemet men anslutna till virtuella IoT-enheter.

    ```sh
    pip install CounterFit
    pip install counterfit-connection
    pip install counterfit-shims-grove
    ```

    Dessa Pip-paket kommer endast att installeras i den virtuella milj√∂n och kommer inte att vara tillg√§ngliga utanf√∂r denna.

### Skriv koden

N√§r den virtuella Python-milj√∂n √§r klar kan du skriva koden f√∂r "Hello World"-applikationen.

#### Uppgift ‚Äì skriv koden

Skapa en Python-applikation som skriver ut `"Hello World"` till konsolen.

1. Fr√•n din terminal eller kommandorad, k√∂r f√∂ljande inuti den virtuella milj√∂n f√∂r att skapa en Python-fil som heter `app.py`:

    * P√• Windows, k√∂r:

        ```cmd
        type nul > app.py
        ```

    * P√• macOS eller Linux, k√∂r:

        ```cmd
        touch app.py
        ```

1. √ñppna den aktuella mappen i VS Code:

    ```sh
    code .
    ```

    > üíÅ Om din terminal returnerar `command not found` p√• macOS betyder det att VS Code inte har lagts till i din PATH. Du kan l√§gga till VS Code i din PATH genom att f√∂lja instruktionerna i [avsnittet om att starta fr√•n kommandoraden i VS Code-dokumentationen](https://code.visualstudio.com/docs/setup/mac?WT.mc_id=academic-17441-jabenn#_launching-from-the-command-line) och k√∂ra kommandot d√§refter. VS Code l√§ggs till i din PATH som standard p√• Windows och Linux.

1. N√§r VS Code startar kommer det att aktivera den virtuella Python-milj√∂n. Den valda virtuella milj√∂n kommer att visas i statusf√§ltet l√§ngst ner:

    ![VS Code visar den valda virtuella milj√∂n](../../../../../translated_images/vscode-virtual-env.8ba42e04c3d533cf677e16cbe5ed9a3b80f62c6964472dc84b6f940800f0909f.sv.png)

1. Om VS Code-terminalen redan k√∂rs n√§r VS Code startar kommer den inte att ha den virtuella milj√∂n aktiverad i sig. Det enklaste √§r att st√§nga terminalen med knappen **Kill the active terminal instance**:

    ![VS Code-knappen Kill the active terminal instance](../../../../../translated_images/vscode-kill-terminal.1cc4de7c6f25ee08f423f0ead714e61d069fac1eb2089e97b8a7bbcb3d45fe5e.sv.png)

    Du kan se om terminalen har den virtuella milj√∂n aktiverad eftersom namnet p√• den virtuella milj√∂n kommer att vara ett prefix p√• terminalprompten. Till exempel kan det vara:

    ```sh
    (.venv) ‚ûú  nightlight
    ```

    Om du inte har `.venv` som ett prefix p√• prompten √§r den virtuella milj√∂n inte aktiv i terminalen.

1. Starta en ny VS Code-terminal genom att v√§lja *Terminal -> New Terminal*, eller trycka p√• `` CTRL+` ``. Den nya terminalen kommer att ladda den virtuella milj√∂n, och anropet f√∂r att aktivera detta kommer att visas i terminalen. Prompten kommer ocks√• att ha namnet p√• den virtuella milj√∂n (`.venv`):

    ```output
    ‚ûú  nightlight source .venv/bin/activate
    (.venv) ‚ûú  nightlight 
    ```

1. √ñppna filen `app.py` fr√•n VS Code Explorer och l√§gg till f√∂ljande kod:

    ```python
    print('Hello World!')
    ```

    Funktionen `print` skriver ut det som skickas till den till konsolen.

1. Fr√•n VS Code-terminalen, k√∂r f√∂ljande f√∂r att k√∂ra din Python-app:

    ```sh
    python app.py
    ```

    F√∂ljande kommer att visas i utdata:

    ```output
    (.venv) ‚ûú  nightlight python app.py 
    Hello World!
    ```

üòÄ Ditt "Hello World"-program var en framg√•ng!

### Anslut "h√•rdvaran"

Som ett andra "Hello World"-steg kommer du att k√∂ra CounterFit-appen och ansluta din kod till den. Detta √§r den virtuella motsvarigheten till att ansluta IoT-h√•rdvara till en utvecklingssats.

#### Uppgift ‚Äì anslut "h√•rdvaran"

1. Fr√•n VS Code-terminalen, starta CounterFit-appen med f√∂ljande kommando:

    ```sh
    counterfit
    ```

    Appen kommer att b√∂rja k√∂ras och √∂ppnas i din webbl√§sare:

    ![CounterFit-appen k√∂rs i en webbl√§sare](../../../../../translated_images/counterfit-first-run.433326358b669b31d0e99c3513cb01bfbb13724d162c99cdcc8f51ecf5f9c779.sv.png)

    Den kommer att markeras som *Disconnected*, med LED-lampan i det √∂vre h√∂gra h√∂rnet sl√§ckt.

1. L√§gg till f√∂ljande kod h√∂gst upp i `app.py`:

    ```python
    from counterfit_connection import CounterFitConnection
    CounterFitConnection.init('127.0.0.1', 5000)
    ```

    Denna kod importerar klassen `CounterFitConnection` fr√•n modulen `counterfit_connection`, som kommer fr√•n Pip-paketet `counterfit-connection` som du installerade tidigare. Den initierar sedan en anslutning till CounterFit-appen som k√∂rs p√• `127.0.0.1`, vilket √§r en IP-adress du alltid kan anv√§nda f√∂r att komma √•t din lokala dator (ofta kallad *localhost*), p√• port 5000.

    > üíÅ Om du har andra appar som k√∂rs p√• port 5000 kan du √§ndra detta genom att uppdatera porten i koden och k√∂ra CounterFit med `CounterFit --port <port_number>`, d√§r `<port_number>` ers√§tts med den port du vill anv√§nda.

1. Du beh√∂ver starta en ny VS Code-terminal genom att v√§lja knappen **Create a new integrated terminal**. Detta eftersom CounterFit-appen k√∂rs i den aktuella terminalen.

    ![VS Code-knappen Create a new integrated terminal](../../../../../translated_images/vscode-new-terminal.77db8fc0f9cd31824b0e49a201beafe4ae4616d6c7339992cb2819e789b3eff9.sv.png)

1. I denna nya terminal, k√∂r filen `app.py` som tidigare. Statusen f√∂r CounterFit kommer att √§ndras till **Connected** och LED-lampan kommer att t√§ndas.

    ![CounterFit visar som ansluten](../../../../../translated_images/counterfit-connected.ed30b46d8f79b0921f3fc70be10366e596a89dca3f80c2224a9d9fc98fccf884.sv.png)

> üíÅ Du kan hitta denna kod i mappen [code/virtual-device](../../../../../1-getting-started/lessons/1-introduction-to-iot/code/virtual-device).

üòÄ Din anslutning till h√•rdvaran var en framg√•ng!

---

**Ansvarsfriskrivning**:  
Detta dokument har √∂versatts med hj√§lp av AI-√∂vers√§ttningstj√§nsten [Co-op Translator](https://github.com/Azure/co-op-translator). √Ñven om vi str√§var efter noggrannhet, v√§nligen notera att automatiska √∂vers√§ttningar kan inneh√•lla fel eller felaktigheter. Det ursprungliga dokumentet p√• sitt originalspr√•k b√∂r betraktas som den auktoritativa k√§llan. F√∂r kritisk information rekommenderas professionell m√§nsklig √∂vers√§ttning. Vi ansvarar inte f√∂r eventuella missf√∂rst√•nd eller feltolkningar som uppst√•r vid anv√§ndning av denna √∂vers√§ttning.