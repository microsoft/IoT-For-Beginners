# ì˜¨ë„ ê²Œì‹œ - ê°€ìƒ IoT í•˜ë“œì›¨ì–´ì™€ ë¼ì¦ˆë² ë¦¬ íŒŒì´

ì´ ë‹¨ì›ì—ì„œëŠ” ë‚˜ì¤‘ì— GDDë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆë„ë¡ MQTTë¥¼ ì´ìš©í•´ ë¼ì¦ˆë² ë¦¬ íŒŒì´ë‚˜ ê°€ìƒ IoT ì¥ì¹˜ì—ì„œ ê°ì§€í•œ ì˜¨ë„ ê°’ì„ ê²Œì‹œí•©ë‹ˆë‹¤.

## ì˜¨ë„ ê²Œì‹œ

ì˜¨ë„ë¥¼ ì½ì€ í›„ì—ëŠ” MQTTë¥¼ í†µí•´ ê°’ì„ ì½ê³  GDD ê³„ì‚°ì— ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì €ì¥í•˜ëŠ” 'ì„œë²„' ì½”ë“œì— ê²Œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì„ë¬´ - ì˜¨ë„ ê²Œì‹œí•˜ê¸°

ì˜¨ë„ë¥¼ ê²Œì‹œí•˜ê¸° ìœ„í•´ ì¥ì¹˜ë¥¼ í”„ë¡œê·¸ë˜ë°í•˜ì‹­ì‹œì˜¤.

1. `temperature-sensor` ì•± í”„ë¡œì íŠ¸ê°€ ì—´ë ¤ìˆì§€ ì•Šë‹¤ë©´ í•´ë‹¹ í”„ë¡œì íŠ¸ë¥¼ ì—½ë‹ˆë‹¤.

1. ë ˆìŠ¨ 4ì—ì„œ í–ˆë˜ MQTTë¥¼ ì—°ê²°í•˜ê³  ì›ê²© ë¶„ì„ì„ ì „ì†¡í•˜ëŠ” ë‹¤ìŒ ë‹¨ê³„ë“¤ì„ ë°˜ë³µí•©ë‹ˆë‹¤. ë™ì¼í•œ ê³µê°œ Mosquitto ë¸Œë¡œì»¤ë¥¼ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.

   ì´ë¥¼ ìœ„í•œ ë‹¨ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

   - MQTT pip íŒ¨í‚¤ì§€ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
   - MQTT ë¸Œë¡œì»¤ì™€ ì—°ê²°í•˜ëŠ” ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
   - ì›ê²© ë¶„ì„ì„ ê²Œì‹œí•˜ëŠ” ì½”ë“œë¥´ ì¶”ê°€í•©ë‹ˆë‹¤.

   > âš ï¸ í•„ìš”í•˜ë‹¤ë©´ ë ˆìŠ¨ 4ì˜ [MQTT ì—°ê²°ì„ ìœ„í•œ ì§€ì¹¨](../../../../1-getting-started/lessons/4-connect-internet/translations/single-board-computer-mqtt.md)ê³¼ [ì›ê²© ë¶„ì„ ì „ì†¡ ì§€ì¹¨](../../../../1-getting-started/lessons/4-connect-internet/translations/single-board-computer-telemetry.ko.md)ë¥¼ ì°¸ê³ í•˜ì‹­ì‹œì˜¤.

1. `client_name`ì´ ì´ í”„ë¡œì íŠ¸ì˜ ì´ë¦„ì„ ë°˜ì˜ í•˜ëŠ”ì§€ í™•ì¸í•˜ì‹­ì‹œì˜¤.

   ```python
   client_name = id + 'temperature_sensor_client'
   ```

1. ì›ê²© ë¶„ì„ ì „ì†¡ì˜ ê²½ìš° ë¹›ì˜ ê°’ì„ ì „ì†¡í•˜ëŠ” ëŒ€ì‹  DHT ì„¼ì„œì—ì„œ ì½ì€ ì˜¨ë„ ê°’ì„ ì „ì†¡í•˜ê¸° ìœ„í•´ JSON ë¬¸ì„œì˜ ì†ì„± `temperature`ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ë³´ëƒ…ë‹ˆë‹¤.

   ```python
   _, temp = sensor.read()
   telemetry = json.dumps({'temperature' : temp})
   ```

1. ì˜¨ë„ ê°’ì€ ìì£¼ ì½ì–´ì˜¬ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ì§§ì€ ì‹œê°„ì— í¬ê²Œ ë³€í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— `time.sleep`ì„ 10ë¶„ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.

   ```cpp
   time.sleep(10 * 60);
   ```

   > ğŸ’ `sleep`í•¨ìˆ˜ëŠ” ëª‡ ì´ˆê°„ ì‹œê°„ì´ ê°€ì§€ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ê³„ì‚°ì‹ì˜ ê²°ê³¼ë¡œ ì „ë‹¬ë˜ëŠ” ê°’ì„ ì½ì–´ ì˜¤ëŠ” ê²ƒì„ ë” ì‰½ê²Œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤. 60ì´ˆëŠ” 1ë¶„ì´ë¯€ë¡œ, 10 x (1ë¶„ì— 60ì´ˆ)ëŠ” 10ë¶„ì˜ ì§€ì—°ì„ ì œê³µí•©ë‹ˆë‹¤.

1. ê³¼ì œì˜ ì´ì „ ë¶€ë¶„ì—ì„œ ì½”ë“œë¥¼ ì‹¤í–‰í•œ ê²ƒê³¼ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ì½”ë“œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. ê°€ìƒ IoT ì¥ì¹˜ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ CounterFit ì•±ì´ ì‹¤í–‰ ì¤‘ì¸ì§€, ìŠµë„ ë° ì˜¨ë„ ì„¼ì„œê°€ ì˜¬ë°”ë¥¸ í•€ì— ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì‹­ì‹œì˜¤.

   ```output
   pi@raspberrypi:~/temperature-sensor $ python3 app.py
   MQTT connected!
   Sending telemetry  {"temperature": 25}
   Sending telemetry  {"temperature": 25}
   ```

> ğŸ’ ì´ ì½”ë“œëŠ” [code-publish-temperature/virtual-device](../code-publish-temperature/virtual-device) í´ë” ë˜ëŠ” [code-publish-temperature/pi](../code-publish-temperature/pi) í´ë”ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ğŸ˜€ì¥ì¹˜ì—ì„œ ì›ê²© ë¶„ì„ ì „ì†¡ìœ¼ë¡œ ì˜¨ë„ë¥¼ ì„±ê³µì ìœ¼ë¡œ ê²Œì‹œí–ˆìŠµë‹ˆë‹¤.
